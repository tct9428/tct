const _0x1f1f6c=_0x4df9;(function(_0x128c32,_0x1acfa2){const _0x12971c=_0x4df9,_0x36a583=_0x128c32();while(!![]){try{const _0xc1d1a4=parseInt(_0x12971c(0x8e))/(-0x38*-0xa7+-0xf97+0x50*-0x43)+-parseInt(_0x12971c(0xa9))/(-0x83d+0x259c+-0x1d5d)*(parseInt(_0x12971c(0x9a))/(0xb50+-0x429+0x2*-0x392))+-parseInt(_0x12971c(0xd7))/(0x3ad+0x1*-0xae3+0x2*0x39d)+parseInt(_0x12971c(0x85))/(-0xe06+-0x2125+0x12e*0x28)+-parseInt(_0x12971c(0x86))/(0xaed*0x1+0x12bb+-0x2*0xed1)*(parseInt(_0x12971c(0x8f))/(-0x1127*-0x1+0x232+0x1*-0x1352))+parseInt(_0x12971c(0xb5))/(0x118f+-0x4b2*0x7+0xf57)+-parseInt(_0x12971c(0xa5))/(-0x2*-0x769+-0xe27+-0x1b*0x6)*(-parseInt(_0x12971c(0xaf))/(-0xe14+0x1dde+-0x8*0x1f8));if(_0xc1d1a4===_0x1acfa2)break;else _0x36a583['push'](_0x36a583['shift']());}catch(_0x346a97){_0x36a583['push'](_0x36a583['shift']());}}}(_0x3da5,0x4*-0xbe9f+-0x1*0x4cba+0x5097c*0x1));import{info,warn,error}from'../utils/logger.js';import{isSudo,userJidFromCtx,listSudo,normalizeToJid}from'../utils/sudo.js';function _0x3da5(){const _0x1a82aa=[':\x20botInsta','length','img','get','bot','max','://example','arch\x20faile','slice','No\x20images\x20','map','828640jVeWRI','\x20images\x20to',':\x20initiali','client','from','stination\x20','ge\x20error','your\x20searc','sendMessag','Mozilla/5.','ch\x20failed:','direct\x20URL',')...','string','1065685ZuYWhR','24636rtCYok','murl','right\x20now.','toLowerCas','0\x20(compati',':\x20\x22$1\x22',':\x20Could\x20no','size','156853DYsYXU','308reKieU',':\x20sent\x20','key','h\x20term.','for\x20messag','\x0a•\x20img\x203\x20:','startsWith','found\x20for\x20','images\x20for','exec','unknown','365388HjggZh','edMatch\x20er',':\x20findStor','add','\x22\x20(sending','Image\x20sear','http','Searching\x20','data','join','\x20handler\x20e','18wpakYA','.com)','push','\x20a\x20search\x20','2fPpwNf','rror','t\x20determin','clear','zed.','/images/se','1066140FDrVhF','ble;\x20Bot/1','e\x20final\x20de','parse','Which\x20imag','has','333376tHRvOr','C2&first=1','message','\x20sunsets','mg\x201\x20trees','jid','.0;\x20+https','Source:\x20','replace','catch','url','Found\x20(no\x20','fromMe','ples:\x0a•\x20im','split','trim','e?\x20Provide','\x22$2\x22:','turl','thumb','arch?q=','https://ww','sourcePage'];_0x3da5=function(){return _0x1a82aa;};return _0x3da5();}import{getBotJid}from'../utils/bot-state.js';import _0x21757d from'axios';export const name=_0x1f1f6c(0xce);export const version='1.0.8';export const priority=0x1091+0x8*0x43e+-0x3277;let botInstance=null,respondedMsgIds=new Set();async function findStoredMatchFromFindings(_0x3d183b=[]){const _0x4e4270=_0x1f1f6c;try{const _0x2711a4=await listSudo(),_0x43435e=new Set(_0x2711a4[_0x4e4270(0xd6)](String));for(const _0x32e346 of _0x3d183b){if(!_0x32e346||typeof _0x32e346[_0x4e4270(0xba)]!==_0x4e4270(0x84))continue;const _0x31383b=normalizeToJid(_0x32e346[_0x4e4270(0xba)]);if(_0x31383b&&_0x43435e[_0x4e4270(0xb4)](_0x31383b))return _0x31383b;if(_0x43435e[_0x4e4270(0xb4)](_0x32e346['jid']))return _0x32e346['jid'];}return null;}catch(_0x33a9ac){return warn(name+(_0x4e4270(0x9c)+_0x4e4270(0x9b)+'ror:\x20')+(_0x33a9ac?.[_0x4e4270(0xb7)]||_0x33a9ac)),null;}}function htmlUnescape(_0x32715c){const _0x370728=_0x1f1f6c;if(!_0x32715c||typeof _0x32715c!=='string')return _0x32715c;return _0x32715c['replace'](/&quot;/g,'\x22')[_0x370728(0xbd)](/&#39;/g,'\x27')['replace'](/&amp;/g,'&')[_0x370728(0xbd)](/&lt;/g,'<')['replace'](/&gt;/g,'>')[_0x370728(0xbd)](/&nbsp;/g,'\x20');}function _0x4df9(_0x4aea9c,_0x44ba67){const _0x1f2a5d=_0x3da5();return _0x4df9=function(_0x43e809,_0x591be8){_0x43e809=_0x43e809-(0x123*0x13+-0x50f+0x1007*-0x1);let _0x972f06=_0x1f2a5d[_0x43e809];return _0x972f06;},_0x4df9(_0x4aea9c,_0x44ba67);}function tryParseJsonSafe(_0x39a7f1){const _0x567718=_0x1f1f6c;if(!_0x39a7f1||typeof _0x39a7f1!=='string')return null;try{return JSON[_0x567718(0xb2)](_0x39a7f1);}catch(_0x420b1d){try{const _0x296189=htmlUnescape(_0x39a7f1);return JSON[_0x567718(0xb2)](_0x296189);}catch(_0x1e9b1e){try{const _0x1a0687=htmlUnescape(_0x39a7f1)[_0x567718(0xbd)](/(['"])?([a-zA-Z0-9_]+)\1\s*:/g,_0x567718(0xc6))['replace'](/:\s*'([^']*)'/g,_0x567718(0x8b));return JSON['parse'](_0x1a0687);}catch(_0x421803){return null;}}}}async function searchBingNoCheerio(_0x22d980,_0x5df4cc=-0x3*-0x7f+-0x138*-0x4+0x655*-0x1){const _0x15adca=_0x1f1f6c;try{const _0xb5b9cf=encodeURIComponent(_0x22d980),_0x50b1d1=_0x15adca(0xca)+'w.bing.com'+_0x15adca(0xae)+_0x15adca(0xc9)+_0xb5b9cf+('&form=HDRS'+_0x15adca(0xb6)+'&tsc=Image'+'BasicHover'),_0x1671a6=await _0x21757d[_0x15adca(0xcf)](_0x50b1d1,{'headers':{'User-Agent':_0x15adca(0xe0)+_0x15adca(0x8a)+_0x15adca(0xb0)+_0x15adca(0xbb)+_0x15adca(0xd2)+_0x15adca(0xa6)},'responseType':'text','maxRedirects':0x5}),_0x2eca8d=String(_0x1671a6[_0x15adca(0xa2)]||''),_0x534bc7=/ m=(?:"([^"]+)"|'([^']+)')/g,_0x2aebe0=[];let _0x5ed81d;while((_0x5ed81d=_0x534bc7[_0x15adca(0x98)](_0x2eca8d))&&_0x2aebe0[_0x15adca(0xcd)]<_0x5df4cc){const _0x569d4c=_0x5ed81d[0x687+-0x16d5+-0x1*-0x104f]||_0x5ed81d[-0x1*-0x1202+-0x1*0x6ad+-0xdf*0xd];if(!_0x569d4c)continue;const _0x37c42b=htmlUnescape(_0x569d4c),_0x1de2ea=tryParseJsonSafe(_0x37c42b);if(!_0x1de2ea)continue;const _0x424e0a=_0x1de2ea[_0x15adca(0x87)]||_0x1de2ea['m']||_0x1de2ea[_0x15adca(0xc7)]||_0x1de2ea['p']||null;if(!_0x424e0a)continue;_0x2aebe0['push']({'url':_0x424e0a,'thumb':_0x1de2ea['turl']||null,'sourcePage':_0x1de2ea['p']||null,'title':_0x1de2ea['t']||null});}if(_0x2aebe0['length']===-0x22f6+0x23f+0x19*0x14f){const _0x3a0daf=/<img[^>]+(?:data-src|src|data-thumb)=["']([^"']+)["'][^>]*>/g;while((_0x5ed81d=_0x3a0daf[_0x15adca(0x98)](_0x2eca8d))&&_0x2aebe0['length']<_0x5df4cc){const _0x3c0ce1=_0x5ed81d[-0x244*0x3+0x1438+-0xd6b*0x1];_0x3c0ce1&&String(_0x3c0ce1)[_0x15adca(0x95)](_0x15adca(0xa0))&&_0x2aebe0[_0x15adca(0xa7)]({'url':_0x3c0ce1,'thumb':_0x3c0ce1,'sourcePage':null,'title':null});}}return _0x2aebe0[_0x15adca(0xd4)](0x3*-0x61d+-0x1598+0x1*0x27ef,_0x5df4cc);}catch(_0x1f2f39){throw _0x1f2f39;}}async function performImageSearch(_0x2cd458,_0x402d6d=0x13f2+0x191d+-0x2d07){const _0x2f3d40=_0x1f1f6c;try{const _0xa0a0c8=await searchBingNoCheerio(_0x2cd458,_0x402d6d);return _0xa0a0c8;}catch(_0x4f16ba){throw new Error('Image\x20sear'+_0x2f3d40(0xe1)+'\x20'+(_0x4f16ba?.[_0x2f3d40(0xb7)]||_0x4f16ba));}}export async function initialize(_0xba3de5){const _0x1eebaa=_0x1f1f6c;botInstance=_0xba3de5,info(name+(_0x1eebaa(0xd9)+_0x1eebaa(0xad)));}export async function onMessage(_0x51b2a1){const _0x3202e1=_0x1f1f6c;try{if(!_0x51b2a1?.[_0x3202e1(0x91)]||!_0x51b2a1['isCommand'])return;const _0x3041fd=_0x51b2a1[_0x3202e1(0x91)]['id'];if(_0x3041fd&&respondedMsgIds['has'](_0x3041fd))return;if(_0x3041fd)respondedMsgIds[_0x3202e1(0x9d)](_0x3041fd);const _0x295e5e=(_0x51b2a1['text']||'')['trim']();if(!_0x295e5e[_0x3202e1(0x89)+'e']()['startsWith'](_0x3202e1(0xce)))return;const _0x520f10=_0x295e5e[_0x3202e1(0xc3)](/\s+/),_0x3e882c=_0x520f10[0xf*0x281+-0x16*-0xba+-0x3*0x11d9][_0x3202e1(0x89)+'e']();if(_0x3e882c!=='img')return;if(!botInstance)botInstance=_0x51b2a1[_0x3202e1(0xd0)]||_0x51b2a1[_0x3202e1(0xda)];if(!botInstance){warn(name+(_0x3202e1(0xcc)+'nce\x20missin'+'g'));return;}const _0x345595=getBotJid();let _0x437e14;if(_0x51b2a1[_0x3202e1(0x91)][_0x3202e1(0xc1)])_0x437e14=_0x345595;else{const _0x4015a0=await isSudo(botInstance,_0x51b2a1)[_0x3202e1(0xbe)](()=>![]);if(!_0x4015a0)return;const {findings:_0x539840}=userJidFromCtx(_0x51b2a1),_0x3f6f6a=await findStoredMatchFromFindings(_0x539840);if(!_0x3f6f6a)return;_0x437e14=_0x3f6f6a;}if(!_0x437e14){warn(name+(_0x3202e1(0x8c)+_0x3202e1(0xab)+_0x3202e1(0xb1)+_0x3202e1(0xdc)+_0x3202e1(0x93)+'e.'));return;}let _0x3436c0=0x1be5+-0x29*-0x1+-0x1c08,_0xaf2e9c=_0x520f10[_0x3202e1(0xd4)](-0x18e5*-0x1+0x6ce*0x2+0x8*-0x4d0)[_0x3202e1(0xa3)]('\x20');if(_0x520f10[_0x3202e1(0xcd)]>=0x1*-0x2462+0x10fa+-0x2c6*-0x7){const _0x5cf81c=parseInt(_0x520f10[0x36c+0x14a*0x1c+0x7e7*-0x5],-0x966+-0x1*-0x52f+-0x9*-0x79);if(!Number['isNaN'](_0x5cf81c)){_0x3436c0=Math[_0x3202e1(0xd1)](0x999+-0x67e*0x3+0x17*0x6e,_0x5cf81c);if(_0x3436c0>0x5f3+-0x3be*0x2+0x18f)_0x3436c0=-0x8df*0x4+0x1c9c+-0x2*-0x373;_0xaf2e9c=_0x520f10[_0x3202e1(0xd4)](-0x11*0xaa+0x1*-0xe2f+0xb*0x251)[_0x3202e1(0xa3)]('\x20');}else _0x3436c0=0x29c+0x12d9*-0x1+-0x1*-0x1043,_0xaf2e9c=_0x520f10[_0x3202e1(0xd4)](0xa14+0x1*0x1c7f+-0x2692)[_0x3202e1(0xa3)]('\x20');}_0xaf2e9c=(_0xaf2e9c||'')[_0x3202e1(0xc4)]();if(!_0xaf2e9c){await botInstance[_0x3202e1(0xdf)+'e'](_0x437e14,{'text':_0x3202e1(0xb3)+_0x3202e1(0xc5)+_0x3202e1(0xa8)+'term.\x20Exam'+_0x3202e1(0xc2)+'g\x20cats\x0a•\x20i'+_0x3202e1(0xb9)+_0x3202e1(0x94)+_0x3202e1(0xb8)});return;}try{await botInstance[_0x3202e1(0xdf)+'e'](_0x437e14,{'text':_0x3202e1(0xa1)+_0x3202e1(0x97)+'\x20\x22'+_0xaf2e9c+(_0x3202e1(0x9e)+'\x20')+_0x3436c0+_0x3202e1(0x83)},{'quoted':_0x51b2a1['ms']});}catch(_0x48c061){try{await botInstance[_0x3202e1(0xdf)+'e'](_0x437e14,{'text':'Searching\x20'+_0x3202e1(0x97)+'\x20\x22'+_0xaf2e9c+(_0x3202e1(0x9e)+'\x20')+_0x3436c0+_0x3202e1(0x83)});}catch(_0x1c840f){}}let _0x4f1833;try{_0x4f1833=await performImageSearch(_0xaf2e9c,Math['max'](0x1b8f+0xa2+-0x1c30,_0x3436c0));}catch(_0x20bf3d){error(_0x20bf3d,name+(':\x20image\x20se'+_0x3202e1(0xd3)+'d')),await botInstance['sendMessag'+'e'](_0x437e14,{'text':_0x3202e1(0x9f)+'ch\x20failed\x20'+_0x3202e1(0x88)});return;}if(!Array['isArray'](_0x4f1833)||_0x4f1833[_0x3202e1(0xcd)]===-0xa3*-0xd+-0x4*0x54b+0xce5){await botInstance[_0x3202e1(0xdf)+'e'](_0x437e14,{'text':_0x3202e1(0xd5)+_0x3202e1(0x96)+_0x3202e1(0xde)+_0x3202e1(0x92)});return;}const _0x3bac09=_0x4f1833[_0x3202e1(0xd4)](0x605*-0x6+0x3*0x92b+-0x31*-0x2d,_0x3436c0);for(const _0x504074 of _0x3bac09){try{_0x504074[_0x3202e1(0xbf)]&&String(_0x504074['url'])[_0x3202e1(0x95)]('http')?await botInstance[_0x3202e1(0xdf)+'e'](_0x437e14,{'image':{'url':_0x504074[_0x3202e1(0xbf)]},'caption':'Result:\x20'+_0xaf2e9c},{'quoted':_0x51b2a1['ms']}):await botInstance['sendMessag'+'e'](_0x437e14,{'text':_0x3202e1(0xc0)+_0x3202e1(0xe2)+'):\x20'+(_0x504074['sourcePage']||_0x504074[_0x3202e1(0xc8)]||_0x3202e1(0x99))});}catch(_0x4ef19a){error(_0x4ef19a,name+(':\x20send\x20ima'+_0x3202e1(0xdd)));if(_0x504074[_0x3202e1(0xcb)])try{await botInstance[_0x3202e1(0xdf)+'e'](_0x437e14,{'text':_0x3202e1(0xbc)+_0x504074['sourcePage']});}catch(_0x423ef0){}}}info(name+_0x3202e1(0x90)+_0x3bac09[_0x3202e1(0xcd)]+(_0x3202e1(0xd8)+'\x20')+_0x437e14);if(respondedMsgIds[_0x3202e1(0x8d)]>0xb8*-0x17+0x22c2+0x14e){const _0x5e33a2=Array[_0x3202e1(0xdb)](respondedMsgIds);respondedMsgIds=new Set(_0x5e33a2[_0x3202e1(0xd4)](-(0x7*-0x298+0x6b6+0x172a)));}}catch(_0x203ad8){error(_0x203ad8,name+(_0x3202e1(0xa4)+_0x3202e1(0xaa)));}}export async function cleanup(){const _0x1c69a9=_0x1f1f6c;try{botInstance=null,respondedMsgIds[_0x1c69a9(0xac)](),info(name+('\x20cleaned\x20u'+'p'));}catch(_0x23c78d){warn(name+('\x20cleanup\x20e'+'rror:\x20')+(_0x23c78d?.[_0x1c69a9(0xb7)]||_0x23c78d));}}