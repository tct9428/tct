const _0xe12503=_0x16a9;(function(_0x33c584,_0xcb221d){const _0x20f522=_0x16a9,_0x28757e=_0x33c584();while(!![]){try{const _0x56ea7f=parseInt(_0x20f522(0x119))/(0x1*-0x2039+-0xf7*0x17+0x366b)*(parseInt(_0x20f522(0x11a))/(0x26be+0x1*0xa81+0x313d*-0x1))+parseInt(_0x20f522(0x121))/(-0x3*0x764+-0x2aa*-0x4+-0x1*-0xb87)+-parseInt(_0x20f522(0x134))/(0x172d+0x26ab*0x1+-0x3dd4)+-parseInt(_0x20f522(0xe9))/(0x16dc+0x1579+-0x2c50)+-parseInt(_0x20f522(0x108))/(-0x1c5*-0x10+0x1a*-0xa6+-0xb6e)+parseInt(_0x20f522(0xfe))/(0x1*0x219b+-0x91*-0x19+-0x2fbd)+-parseInt(_0x20f522(0x11b))/(-0x10ba*-0x2+-0x1ac1+-0x6ab)*(parseInt(_0x20f522(0xed))/(0xb1d+-0x2426+0x1912));if(_0x56ea7f===_0xcb221d)break;else _0x28757e['push'](_0x28757e['shift']());}catch(_0x3abf00){_0x28757e['push'](_0x28757e['shift']());}}}(_0x48ff,0x18a704+-0x1*0x16d49b+-0x1*-0xc1b32));import{info,warn,error}from'../utils/logger.js';import{isSudo,userJidFromCtx,listSudo,normalizeToJid}from'../utils/sudo.js';import{getBotJid}from'../utils/bot-state.js';import _0x29d31d from'axios';export const name=_0xe12503(0x11c);export const version=_0xe12503(0x136);function _0x48ff(){const _0xc2af22=[':\x20\x22$1\x22','ch\x20failed\x20','toLowerCas','337220DKnUSd','text','1.0.8','data','has',':\x20sent\x20','Source:\x20','Image\x20sear','join','isCommand','):\x20','0\x20(compati','Mozilla/5.','clear','message','h\x20term.','url','length','rror','startsWith','map','C2&first=1','e\x20final\x20de','images\x20for','term.\x20Exam',')...','465560AbesCW','.com)','arch\x20faile','add','10845hfDWnC','\x20cleanup\x20e','\x20images\x20to','exec','\x20sunsets','isArray','\x22$2\x22:','.0;\x20+https','zed.','w.bing.com','jid','arch?q=','t\x20determin','size','parse','\x22\x20(sending','push','335006hEanmQ','\x0a•\x20img\x203\x20:','&tsc=Image','split',':\x20findStor','Found\x20(no\x20','trim','replace','nce\x20missin','ror:\x20','1020756Nujgik','No\x20images\x20','rror:\x20','Which\x20imag','ble;\x20Bot/1','https://ww','http',':\x20send\x20ima','get','your\x20searc','max','from','BasicHover','key',':\x20Could\x20no','string','ge\x20error','898868qRCSVT','2eDRqys','3000qcxtpf','img','slice','/images/se','e?\x20Provide','turl','2296461mCcnPc','\x20handler\x20e','&form=HDRS','thumb','right\x20now.','bot','Result:\x20','sendMessag','://example','sourcePage','murl','unknown','Searching\x20','stination\x20','catch',':\x20botInsta'];_0x48ff=function(){return _0xc2af22;};return _0x48ff();}export const priority=0xf15+-0x11f6+0x9*0x53;let botInstance=null,respondedMsgIds=new Set();async function findStoredMatchFromFindings(_0x1e32b0=[]){const _0x125f61=_0xe12503;try{const _0x27f214=await listSudo(),_0x353e25=new Set(_0x27f214[_0x125f61(0x148)](String));for(const _0x227436 of _0x1e32b0){if(!_0x227436||typeof _0x227436[_0x125f61(0xf7)]!==_0x125f61(0x117))continue;const _0x18b50e=normalizeToJid(_0x227436[_0x125f61(0xf7)]);if(_0x18b50e&&_0x353e25[_0x125f61(0x138)](_0x18b50e))return _0x18b50e;if(_0x353e25['has'](_0x227436[_0x125f61(0xf7)]))return _0x227436[_0x125f61(0xf7)];}return null;}catch(_0x5590d3){return warn(name+(_0x125f61(0x102)+'edMatch\x20er'+_0x125f61(0x107))+(_0x5590d3?.[_0x125f61(0x142)]||_0x5590d3)),null;}}function _0x16a9(_0x4fdd89,_0x84edc0){const _0xae60e3=_0x48ff();return _0x16a9=function(_0x42187e,_0x19c42d){_0x42187e=_0x42187e-(-0x2a1*-0xa+-0xd91+-0xe9*0xd);let _0x28a4c4=_0xae60e3[_0x42187e];return _0x28a4c4;},_0x16a9(_0x4fdd89,_0x84edc0);}function htmlUnescape(_0x15f3bd){const _0x946c13=_0xe12503;if(!_0x15f3bd||typeof _0x15f3bd!=='string')return _0x15f3bd;return _0x15f3bd[_0x946c13(0x105)](/&quot;/g,'\x22')[_0x946c13(0x105)](/&#39;/g,'\x27')[_0x946c13(0x105)](/&amp;/g,'&')['replace'](/&lt;/g,'<')[_0x946c13(0x105)](/&gt;/g,'>')[_0x946c13(0x105)](/&nbsp;/g,'\x20');}function tryParseJsonSafe(_0x55c43b){const _0x1a354b=_0xe12503;if(!_0x55c43b||typeof _0x55c43b!==_0x1a354b(0x117))return null;try{return JSON[_0x1a354b(0xfb)](_0x55c43b);}catch(_0x34b08d){try{const _0x1e29d1=htmlUnescape(_0x55c43b);return JSON[_0x1a354b(0xfb)](_0x1e29d1);}catch(_0x13b142){try{const _0x59a28e=htmlUnescape(_0x55c43b)['replace'](/(['"])?([a-zA-Z0-9_]+)\1\s*:/g,_0x1a354b(0xf3))[_0x1a354b(0x105)](/:\s*'([^']*)'/g,_0x1a354b(0x131));return JSON[_0x1a354b(0xfb)](_0x59a28e);}catch(_0x206d7c){return null;}}}}async function searchBingNoCheerio(_0x4150d2,_0x46cae6=-0x1c61+-0x1a*0x57+0x253f){const _0x4326b6=_0xe12503;try{const _0x17ae4c=encodeURIComponent(_0x4150d2),_0x1e65c5=_0x4326b6(0x10d)+_0x4326b6(0xf6)+_0x4326b6(0x11e)+_0x4326b6(0xf8)+_0x17ae4c+(_0x4326b6(0x123)+_0x4326b6(0xe4)+_0x4326b6(0x100)+_0x4326b6(0x114)),_0x22c767=await _0x29d31d[_0x4326b6(0x110)](_0x1e65c5,{'headers':{'User-Agent':_0x4326b6(0x140)+_0x4326b6(0x13f)+_0x4326b6(0x10c)+_0x4326b6(0xf4)+_0x4326b6(0x129)+_0x4326b6(0xea)},'responseType':'text','maxRedirects':0x5}),_0x2bc2d5=String(_0x22c767[_0x4326b6(0x137)]||''),_0x52f7c0=/ m=(?:"([^"]+)"|'([^']+)')/g,_0x5292be=[];let _0x4015fd;while((_0x4015fd=_0x52f7c0[_0x4326b6(0xf0)](_0x2bc2d5))&&_0x5292be['length']<_0x46cae6){const _0x35855e=_0x4015fd[-0xa84+-0x204b+-0x2ad*-0x10]||_0x4015fd[0x2173*0x1+-0x248d+-0x4*-0xc7];if(!_0x35855e)continue;const _0x2d4a36=htmlUnescape(_0x35855e),_0xd0c7db=tryParseJsonSafe(_0x2d4a36);if(!_0xd0c7db)continue;const _0x56d144=_0xd0c7db[_0x4326b6(0x12b)]||_0xd0c7db['m']||_0xd0c7db[_0x4326b6(0x120)]||_0xd0c7db['p']||null;if(!_0x56d144)continue;_0x5292be[_0x4326b6(0xfd)]({'url':_0x56d144,'thumb':_0xd0c7db['turl']||null,'sourcePage':_0xd0c7db['p']||null,'title':_0xd0c7db['t']||null});}if(_0x5292be[_0x4326b6(0x145)]===-0x1*-0x171b+0x65*0x43+-0x318a){const _0x51e5ae=/<img[^>]+(?:data-src|src|data-thumb)=["']([^"']+)["'][^>]*>/g;while((_0x4015fd=_0x51e5ae[_0x4326b6(0xf0)](_0x2bc2d5))&&_0x5292be[_0x4326b6(0x145)]<_0x46cae6){const _0xc25255=_0x4015fd[-0x125+0x101c+-0xef6];_0xc25255&&String(_0xc25255)[_0x4326b6(0x147)](_0x4326b6(0x10e))&&_0x5292be[_0x4326b6(0xfd)]({'url':_0xc25255,'thumb':_0xc25255,'sourcePage':null,'title':null});}}return _0x5292be[_0x4326b6(0x11d)](0x167c+0x43*0xc+-0x19a0,_0x46cae6);}catch(_0x345b35){throw _0x345b35;}}async function performImageSearch(_0x2da072,_0x102f6d=-0x1037*-0x1+-0x1065+0x12*0x3){const _0x1b03f5=_0xe12503;try{const _0x1cb17b=await searchBingNoCheerio(_0x2da072,_0x102f6d);return _0x1cb17b;}catch(_0x13c3db){throw new Error(_0x1b03f5(0x13b)+'ch\x20failed:'+'\x20'+(_0x13c3db?.['message']||_0x13c3db));}}export async function initialize(_0x29590e){const _0x189923=_0xe12503;botInstance=_0x29590e,info(name+(':\x20initiali'+_0x189923(0xf5)));}export async function onMessage(_0x329e3f){const _0x33c101=_0xe12503;try{if(!_0x329e3f?.['key']||!_0x329e3f[_0x33c101(0x13d)])return;const _0x215a46=_0x329e3f[_0x33c101(0x115)]['id'];if(_0x215a46&&respondedMsgIds[_0x33c101(0x138)](_0x215a46))return;if(_0x215a46)respondedMsgIds[_0x33c101(0xec)](_0x215a46);const _0xd655c5=(_0x329e3f[_0x33c101(0x135)]||'')[_0x33c101(0x104)]();if(!_0xd655c5[_0x33c101(0x133)+'e']()[_0x33c101(0x147)]('img'))return;const _0x38d6c5=_0xd655c5[_0x33c101(0x101)](/\s+/),_0x1523ea=_0x38d6c5[-0x2443+0x1d3b*-0x1+-0x20bf*-0x2]['toLowerCas'+'e']();if(_0x1523ea!==_0x33c101(0x11c))return;if(!botInstance)botInstance=_0x329e3f[_0x33c101(0x126)]||_0x329e3f['client'];if(!botInstance){warn(name+(_0x33c101(0x130)+_0x33c101(0x106)+'g'));return;}const _0x55b40f=getBotJid();let _0xffb013;if(_0x329e3f[_0x33c101(0x115)]['fromMe'])_0xffb013=_0x55b40f;else{const _0x5503df=await isSudo(botInstance,_0x329e3f)[_0x33c101(0x12f)](()=>![]);if(!_0x5503df)return;const {findings:_0x4c7e71}=userJidFromCtx(_0x329e3f),_0x301c74=await findStoredMatchFromFindings(_0x4c7e71);if(!_0x301c74)return;_0xffb013=_0x301c74;}if(!_0xffb013){warn(name+(_0x33c101(0x116)+_0x33c101(0xf9)+_0x33c101(0xe5)+_0x33c101(0x12e)+'for\x20messag'+'e.'));return;}let _0x5ae5cc=0x21*-0x1d+-0x19a1+-0x16*-0x156,_0x5841b2=_0x38d6c5[_0x33c101(0x11d)](0x1222+-0xb*0x121+-0x5b6)['join']('\x20');if(_0x38d6c5['length']>=-0xa1c+-0x4aa+-0x16*-0xac){const _0xfe2f77=parseInt(_0x38d6c5[-0x1*-0x15d+0x76e*-0x4+0x1c5c],-0xd7d+-0x1f*-0xcd+-0xb4c);if(!Number['isNaN'](_0xfe2f77)){_0x5ae5cc=Math[_0x33c101(0x112)](-0x196b+-0x904+0x2270,_0xfe2f77);if(_0x5ae5cc>-0x1*-0xbe9+0x1b92+-0x2775)_0x5ae5cc=-0x64*0x4b+0x3*0x607+0x1*0xb3d;_0x5841b2=_0x38d6c5[_0x33c101(0x11d)](-0x1886+0x173e+-0x21*-0xa)[_0x33c101(0x13c)]('\x20');}else _0x5ae5cc=0x1da3*0x1+-0x7b7+-0x1*0x15e6,_0x5841b2=_0x38d6c5[_0x33c101(0x11d)](0xddf+-0x1943*0x1+0xb65)[_0x33c101(0x13c)]('\x20');}_0x5841b2=(_0x5841b2||'')['trim']();if(!_0x5841b2){await botInstance[_0x33c101(0x128)+'e'](_0xffb013,{'text':_0x33c101(0x10b)+_0x33c101(0x11f)+'\x20a\x20search\x20'+_0x33c101(0xe7)+'ples:\x0a•\x20im'+'g\x20cats\x0a•\x20i'+'mg\x201\x20trees'+_0x33c101(0xff)+_0x33c101(0xf1)});return;}try{await botInstance[_0x33c101(0x128)+'e'](_0xffb013,{'text':'Searching\x20'+_0x33c101(0xe6)+'\x20\x22'+_0x5841b2+(_0x33c101(0xfc)+'\x20')+_0x5ae5cc+_0x33c101(0xe8)},{'quoted':_0x329e3f['ms']});}catch(_0x572eaf){try{await botInstance[_0x33c101(0x128)+'e'](_0xffb013,{'text':_0x33c101(0x12d)+_0x33c101(0xe6)+'\x20\x22'+_0x5841b2+(_0x33c101(0xfc)+'\x20')+_0x5ae5cc+_0x33c101(0xe8)});}catch(_0x4a5011){}}let _0x3cced1;try{_0x3cced1=await performImageSearch(_0x5841b2,Math['max'](0x5*0x58f+0x5*-0x4db+-0x383,_0x5ae5cc));}catch(_0x2806cc){error(_0x2806cc,name+(':\x20image\x20se'+_0x33c101(0xeb)+'d')),await botInstance[_0x33c101(0x128)+'e'](_0xffb013,{'text':'Image\x20sear'+_0x33c101(0x132)+_0x33c101(0x125)});return;}if(!Array[_0x33c101(0xf2)](_0x3cced1)||_0x3cced1[_0x33c101(0x145)]===0x10d*-0x1+0x3b9*0x1+-0x2ac){await botInstance[_0x33c101(0x128)+'e'](_0xffb013,{'text':_0x33c101(0x109)+'found\x20for\x20'+_0x33c101(0x111)+_0x33c101(0x143)});return;}const _0x24ff30=_0x3cced1[_0x33c101(0x11d)](-0x2*-0xbe7+-0x143b+-0x393,_0x5ae5cc);for(const _0x39e26f of _0x24ff30){try{_0x39e26f[_0x33c101(0x144)]&&String(_0x39e26f['url'])['startsWith'](_0x33c101(0x10e))?await botInstance[_0x33c101(0x128)+'e'](_0xffb013,{'image':{'url':_0x39e26f[_0x33c101(0x144)]},'caption':_0x33c101(0x127)+_0x5841b2},{'quoted':_0x329e3f['ms']}):await botInstance[_0x33c101(0x128)+'e'](_0xffb013,{'text':_0x33c101(0x103)+'direct\x20URL'+_0x33c101(0x13e)+(_0x39e26f[_0x33c101(0x12a)]||_0x39e26f[_0x33c101(0x124)]||_0x33c101(0x12c))});}catch(_0x34f499){error(_0x34f499,name+(_0x33c101(0x10f)+_0x33c101(0x118)));if(_0x39e26f['sourcePage'])try{await botInstance[_0x33c101(0x128)+'e'](_0xffb013,{'text':_0x33c101(0x13a)+_0x39e26f['sourcePage']});}catch(_0x2a4b95){}}}info(name+_0x33c101(0x139)+_0x24ff30[_0x33c101(0x145)]+(_0x33c101(0xef)+'\x20')+_0xffb013);if(respondedMsgIds[_0x33c101(0xfa)]>0x9*0x21d+0x1cc6+-0x1*0x1c43){const _0x48071b=Array[_0x33c101(0x113)](respondedMsgIds);respondedMsgIds=new Set(_0x48071b[_0x33c101(0x11d)](-(0x6*0x4eb+-0x2614*0x1+0xa25*0x2)));}}catch(_0x2f41c9){error(_0x2f41c9,name+(_0x33c101(0x122)+_0x33c101(0x146)));}}export async function cleanup(){const _0x509a48=_0xe12503;try{botInstance=null,respondedMsgIds[_0x509a48(0x141)](),info(name+('\x20cleaned\x20u'+'p'));}catch(_0x46624a){warn(name+(_0x509a48(0xee)+_0x509a48(0x10a))+(_0x46624a?.[_0x509a48(0x142)]||_0x46624a));}}