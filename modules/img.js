const _0x33893a=_0x5cbe;(function(_0x3d6026,_0x1173a1){const _0x466a93=_0x5cbe,_0x4112f9=_0x3d6026();while(!![]){try{const _0x5671e1=parseInt(_0x466a93(0x177))/(0x15d3*0x1+-0x7*-0x3a3+-0x2f47)+-parseInt(_0x466a93(0x1af))/(0x6bd*-0x2+0x1746+-0x9ca)+parseInt(_0x466a93(0x17b))/(0xbe7*-0x1+0x1918+-0xd2e)*(-parseInt(_0x466a93(0x1b6))/(-0xd3*-0xc+0xfe1+-0x19c1))+-parseInt(_0x466a93(0x166))/(0x39*0x8a+0x136*0x1+-0x1*0x1feb)+-parseInt(_0x466a93(0x1ba))/(-0x1*0x1feb+0x134+0xb7*0x2b)*(-parseInt(_0x466a93(0x17c))/(-0x1953+-0x1e36+0x3790))+parseInt(_0x466a93(0x189))/(0xd*0x72+-0x436*-0x8+-0x2772)*(parseInt(_0x466a93(0x183))/(-0xbc*0x2+-0xd9*0x18+0x11*0x149))+parseInt(_0x466a93(0x16b))/(0x209*0x11+-0xc46+-0xa3*0x23)*(parseInt(_0x466a93(0x179))/(-0x1dc1+0x9d*0x4+0xc8*0x23));if(_0x5671e1===_0x1173a1)break;else _0x4112f9['push'](_0x4112f9['shift']());}catch(_0x179bfb){_0x4112f9['push'](_0x4112f9['shift']());}}}(_0x42ba,-0x351ad+0x14faf8+0x2*-0x1e47f));import{info,warn,error}from'../utils/logger.js';import{isSudo,userJidFromCtx,listSudo,normalizeToJid}from'../utils/sudo.js';import{getBotJid}from'../utils/bot-state.js';import _0x175bd2 from'axios';export const name=_0x33893a(0x1bb);export const version=_0x33893a(0x17e);export const priority=-0x1487+-0x3e*0x68+0x2dc1;let botInstance=null,respondedMsgIds=new Set();async function findStoredMatchFromFindings(_0x379423=[]){const _0x792001=_0x33893a;try{const _0xe9564e=await listSudo(),_0x279a40=new Set(_0xe9564e[_0x792001(0x170)](String));for(const _0x404fde of _0x379423){if(!_0x404fde||typeof _0x404fde[_0x792001(0x164)]!==_0x792001(0x18d))continue;const _0x29995d=normalizeToJid(_0x404fde[_0x792001(0x164)]);if(_0x29995d&&_0x279a40[_0x792001(0x175)](_0x29995d))return _0x29995d;if(_0x279a40[_0x792001(0x175)](_0x404fde[_0x792001(0x164)]))return _0x404fde[_0x792001(0x164)];}return null;}catch(_0x34ab18){return warn(name+(_0x792001(0x1c0)+_0x792001(0x1a5)+'ror:\x20')+(_0x34ab18?.['message']||_0x34ab18)),null;}}function htmlUnescape(_0x5ee2d1){const _0x1ac0d4=_0x33893a;if(!_0x5ee2d1||typeof _0x5ee2d1!==_0x1ac0d4(0x18d))return _0x5ee2d1;return _0x5ee2d1['replace'](/&quot;/g,'\x22')[_0x1ac0d4(0x16d)](/&#39;/g,'\x27')[_0x1ac0d4(0x16d)](/&amp;/g,'&')[_0x1ac0d4(0x16d)](/&lt;/g,'<')[_0x1ac0d4(0x16d)](/&gt;/g,'>')['replace'](/&nbsp;/g,'\x20');}function _0x42ba(){const _0xf1940=['Found\x20(no\x20','message','size','nce\x20missin','has','bot','910588WoiqMv','.com)','3751tvNDxV','murl','231396RoHKah','100597nLBmqo','C2&first=1','1.0.8','clear','split','Source:\x20','Result:\x20','107631emoEYD','\x20sunsets','.0;\x20+https','stination\x20','zed.','length','576zzqijF','add','BasicHover',')...','string','catch','Searching\x20','images\x20for','exec','&form=HDRS','t\x20determin','from','/images/se','w.bing.com',':\x20Could\x20no','toLowerCas','Image\x20sear','\x0a•\x20img\x203\x20:','rror','g\x20cats\x0a•\x20i','\x20cleanup\x20e','key','https://ww',':\x20send\x20ima','join','http','ch\x20failed:',':\x20\x22$1\x22','edMatch\x20er','client','turl','found\x20for\x20','for\x20messag','Which\x20imag',':\x20botInsta','direct\x20URL','parse','arch?q=','3093008pNvHCx','thumb','e\x20final\x20de','arch\x20faile','ble;\x20Bot/1','ples:\x0a•\x20im','e?\x20Provide','76zuBiRV','get','\x22\x20(sending','text','534PrnOyZ','img','\x22$2\x22:','ge\x20error','max','right\x20now.',':\x20findStor','://example','url','startsWith','Mozilla/5.','jid','sourcePage','6636700kVWhvp','isArray','No\x20images\x20','slice','fromMe','64460DRRsJR','push','replace','sendMessag','\x20cleaned\x20u','map'];_0x42ba=function(){return _0xf1940;};return _0x42ba();}function tryParseJsonSafe(_0x2ec87d){const _0xd77c15=_0x33893a;if(!_0x2ec87d||typeof _0x2ec87d!==_0xd77c15(0x18d))return null;try{return JSON['parse'](_0x2ec87d);}catch(_0x583dd2){try{const _0x5a598b=htmlUnescape(_0x2ec87d);return JSON[_0xd77c15(0x1ad)](_0x5a598b);}catch(_0x5264ed){try{const _0x447a56=htmlUnescape(_0x2ec87d)[_0xd77c15(0x16d)](/(['"])?([a-zA-Z0-9_]+)\1\s*:/g,_0xd77c15(0x1bc))['replace'](/:\s*'([^']*)'/g,_0xd77c15(0x1a4));return JSON[_0xd77c15(0x1ad)](_0x447a56);}catch(_0x115b5c){return null;}}}}function _0x5cbe(_0x49186e,_0x1adbf6){_0x49186e=_0x49186e-(0xc46*0x1+-0x6b*-0x41+-0x2611);const _0x3d9bec=_0x42ba();let _0x16a23f=_0x3d9bec[_0x49186e];return _0x16a23f;}async function searchBingNoCheerio(_0x31e58e,_0xcf318e=-0x1221+0x9a9+0x110*0x8){const _0x75dd8d=_0x33893a;try{const _0x1f470d=encodeURIComponent(_0x31e58e),_0x4ff07b=_0x75dd8d(0x19f)+_0x75dd8d(0x196)+_0x75dd8d(0x195)+_0x75dd8d(0x1ae)+_0x1f470d+(_0x75dd8d(0x192)+_0x75dd8d(0x17d)+'&tsc=Image'+_0x75dd8d(0x18b)),_0x176ae0=await _0x175bd2[_0x75dd8d(0x1b7)](_0x4ff07b,{'headers':{'User-Agent':_0x75dd8d(0x163)+'0\x20(compati'+_0x75dd8d(0x1b3)+_0x75dd8d(0x185)+_0x75dd8d(0x160)+_0x75dd8d(0x178)},'responseType':_0x75dd8d(0x1b9),'maxRedirects':0x5}),_0x5b6fbb=String(_0x176ae0['data']||''),_0x400018=/ m=(?:"([^"]+)"|'([^']+)')/g,_0x50211d=[];let _0x55d047;while((_0x55d047=_0x400018[_0x75dd8d(0x191)](_0x5b6fbb))&&_0x50211d[_0x75dd8d(0x188)]<_0xcf318e){const _0x8cdd62=_0x55d047[0x3e8*-0x2+-0x2*-0xa92+-0x17b*0x9]||_0x55d047[-0xaf1*0x1+0x17f*0xb+-0x582];if(!_0x8cdd62)continue;const _0x31a7ea=htmlUnescape(_0x8cdd62),_0x28cea8=tryParseJsonSafe(_0x31a7ea);if(!_0x28cea8)continue;const _0x402538=_0x28cea8[_0x75dd8d(0x17a)]||_0x28cea8['m']||_0x28cea8[_0x75dd8d(0x1a7)]||_0x28cea8['p']||null;if(!_0x402538)continue;_0x50211d[_0x75dd8d(0x16c)]({'url':_0x402538,'thumb':_0x28cea8[_0x75dd8d(0x1a7)]||null,'sourcePage':_0x28cea8['p']||null,'title':_0x28cea8['t']||null});}if(_0x50211d['length']===0x1*-0x4c+0x206e+-0x2022){const _0x2affdb=/<img[^>]+(?:data-src|src|data-thumb)=["']([^"']+)["'][^>]*>/g;while((_0x55d047=_0x2affdb['exec'](_0x5b6fbb))&&_0x50211d[_0x75dd8d(0x188)]<_0xcf318e){const _0x41ce46=_0x55d047[-0x1b1a+0x1df*-0x2+-0x1ed9*-0x1];_0x41ce46&&String(_0x41ce46)[_0x75dd8d(0x162)](_0x75dd8d(0x1a2))&&_0x50211d[_0x75dd8d(0x16c)]({'url':_0x41ce46,'thumb':_0x41ce46,'sourcePage':null,'title':null});}}return _0x50211d['slice'](-0x1aeb+-0xd19*0x1+-0xa01*-0x4,_0xcf318e);}catch(_0x1d38e7){throw _0x1d38e7;}}async function performImageSearch(_0x52289b,_0xc8fa16=-0xce1*-0x2+-0x2*-0xf7b+-0x38b0){const _0x52bbca=_0x33893a;try{const _0xedf602=await searchBingNoCheerio(_0x52289b,_0xc8fa16);return _0xedf602;}catch(_0x327dec){throw new Error(_0x52bbca(0x199)+_0x52bbca(0x1a3)+'\x20'+(_0x327dec?.[_0x52bbca(0x172)]||_0x327dec));}}export async function initialize(_0x3111c5){const _0x31adbe=_0x33893a;botInstance=_0x3111c5,info(name+(':\x20initiali'+_0x31adbe(0x187)));}export async function onMessage(_0x189890){const _0x546c37=_0x33893a;try{if(!_0x189890?.[_0x546c37(0x19e)]||!_0x189890['isCommand'])return;const _0x4b143b=_0x189890[_0x546c37(0x19e)]['id'];if(_0x4b143b&&respondedMsgIds[_0x546c37(0x175)](_0x4b143b))return;if(_0x4b143b)respondedMsgIds[_0x546c37(0x18a)](_0x4b143b);const _0x4512ad=(_0x189890['text']||'')['trim']();if(!_0x4512ad[_0x546c37(0x198)+'e']()[_0x546c37(0x162)]('img'))return;const _0x4e22c1=_0x4512ad[_0x546c37(0x180)](/\s+/),_0x24bda6=_0x4e22c1[0x16c4+0x210a+-0x37ce][_0x546c37(0x198)+'e']();if(_0x24bda6!==_0x546c37(0x1bb))return;if(!botInstance)botInstance=_0x189890[_0x546c37(0x176)]||_0x189890[_0x546c37(0x1a6)];if(!botInstance){warn(name+(_0x546c37(0x1ab)+_0x546c37(0x174)+'g'));return;}const _0x5b2136=getBotJid();let _0x1b8e89;if(_0x189890[_0x546c37(0x19e)][_0x546c37(0x16a)])_0x1b8e89=_0x5b2136;else{const _0x59d371=await isSudo(botInstance,_0x189890)[_0x546c37(0x18e)](()=>![]);if(!_0x59d371)return;const {findings:_0x1d0246}=userJidFromCtx(_0x189890),_0x4c9f82=await findStoredMatchFromFindings(_0x1d0246);if(!_0x4c9f82)return;_0x1b8e89=_0x4c9f82;}if(!_0x1b8e89){warn(name+(_0x546c37(0x197)+_0x546c37(0x193)+_0x546c37(0x1b1)+_0x546c37(0x186)+_0x546c37(0x1a9)+'e.'));return;}let _0x3bf01b=0x1483+0x2*0xadc+-0x5*0x871,_0x5efd0d=_0x4e22c1[_0x546c37(0x169)](0x6c4+0x7e6+-0x1a1*0x9)[_0x546c37(0x1a1)]('\x20');if(_0x4e22c1[_0x546c37(0x188)]>=-0x1bd2+-0x22ff+0x1*0x3ed3){const _0x56ddb6=parseInt(_0x4e22c1[0x21b0+-0x11*-0x1d9+-0x4118],-0x10c9+0xc66+0x46d);if(!Number['isNaN'](_0x56ddb6)){_0x3bf01b=Math[_0x546c37(0x1be)](-0x1c95+-0x1223+0x2eb9,_0x56ddb6);if(_0x3bf01b>-0x2*0x3ab+0x8d5*-0x1+0x1031)_0x3bf01b=0xfb2+-0x20b3*0x1+-0x5ad*-0x3;_0x5efd0d=_0x4e22c1[_0x546c37(0x169)](0xf63+0x76d+0xe*-0x1a1)[_0x546c37(0x1a1)]('\x20');}else _0x3bf01b=0x22b+0xe*0x18a+-0x17b1,_0x5efd0d=_0x4e22c1[_0x546c37(0x169)](-0x19*0x1a+0x1*0x9c5+-0x73a)['join']('\x20');}_0x5efd0d=(_0x5efd0d||'')['trim']();if(!_0x5efd0d){await botInstance[_0x546c37(0x16e)+'e'](_0x1b8e89,{'text':_0x546c37(0x1aa)+_0x546c37(0x1b5)+'\x20a\x20search\x20'+'term.\x20Exam'+_0x546c37(0x1b4)+_0x546c37(0x19c)+'mg\x201\x20trees'+_0x546c37(0x19a)+_0x546c37(0x184)});return;}try{await botInstance['sendMessag'+'e'](_0x1b8e89,{'text':_0x546c37(0x18f)+_0x546c37(0x190)+'\x20\x22'+_0x5efd0d+(_0x546c37(0x1b8)+'\x20')+_0x3bf01b+_0x546c37(0x18c)},{'quoted':_0x189890['ms']});}catch(_0x2db30a){try{await botInstance['sendMessag'+'e'](_0x1b8e89,{'text':_0x546c37(0x18f)+'images\x20for'+'\x20\x22'+_0x5efd0d+(_0x546c37(0x1b8)+'\x20')+_0x3bf01b+_0x546c37(0x18c)});}catch(_0x5467a7){}}let _0x1091b5;try{_0x1091b5=await performImageSearch(_0x5efd0d,Math[_0x546c37(0x1be)](-0x94d+0x25af+-0x5*0x5ad,_0x3bf01b));}catch(_0x11669b){error(_0x11669b,name+(':\x20image\x20se'+_0x546c37(0x1b2)+'d')),await botInstance[_0x546c37(0x16e)+'e'](_0x1b8e89,{'text':_0x546c37(0x199)+'ch\x20failed\x20'+_0x546c37(0x1bf)});return;}if(!Array[_0x546c37(0x167)](_0x1091b5)||_0x1091b5[_0x546c37(0x188)]===0x2*0x567+-0x3*-0x8f5+0xc8f*-0x3){await botInstance[_0x546c37(0x16e)+'e'](_0x1b8e89,{'text':_0x546c37(0x168)+_0x546c37(0x1a8)+'your\x20searc'+'h\x20term.'});return;}const _0x40612b=_0x1091b5[_0x546c37(0x169)](0xc6b*-0x2+-0x24a*0x6+0x2692,_0x3bf01b);for(const _0x39fde6 of _0x40612b){try{_0x39fde6['url']&&String(_0x39fde6[_0x546c37(0x161)])[_0x546c37(0x162)](_0x546c37(0x1a2))?await botInstance[_0x546c37(0x16e)+'e'](_0x1b8e89,{'image':{'url':_0x39fde6[_0x546c37(0x161)]},'caption':_0x546c37(0x182)+_0x5efd0d},{'quoted':_0x189890['ms']}):await botInstance[_0x546c37(0x16e)+'e'](_0x1b8e89,{'text':_0x546c37(0x171)+_0x546c37(0x1ac)+'):\x20'+(_0x39fde6[_0x546c37(0x165)]||_0x39fde6[_0x546c37(0x1b0)]||'unknown')});}catch(_0x1ca56a){error(_0x1ca56a,name+(_0x546c37(0x1a0)+_0x546c37(0x1bd)));if(_0x39fde6[_0x546c37(0x165)])try{await botInstance[_0x546c37(0x16e)+'e'](_0x1b8e89,{'text':_0x546c37(0x181)+_0x39fde6['sourcePage']});}catch(_0x3576a8){}}}info(name+':\x20sent\x20'+_0x40612b['length']+('\x20images\x20to'+'\x20')+_0x1b8e89);if(respondedMsgIds[_0x546c37(0x173)]>-0x3ac*0x4+-0x20bf+-0x7*-0x991){const _0x4fc0c4=Array[_0x546c37(0x194)](respondedMsgIds);respondedMsgIds=new Set(_0x4fc0c4[_0x546c37(0x169)](-(-0x12f+0x1493+-0x7ac)));}}catch(_0xbbf5d2){error(_0xbbf5d2,name+('\x20handler\x20e'+_0x546c37(0x19b)));}}export async function cleanup(){const _0x1ddbbd=_0x33893a;try{botInstance=null,respondedMsgIds[_0x1ddbbd(0x17f)](),info(name+(_0x1ddbbd(0x16f)+'p'));}catch(_0x250170){warn(name+(_0x1ddbbd(0x19d)+'rror:\x20')+(_0x250170?.['message']||_0x250170));}}