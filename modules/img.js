const _0x34e757=_0x56d4;(function(_0x40b78f,_0x1dfd85){const _0x32026b=_0x56d4,_0x7b4ac3=_0x40b78f();while(!![]){try{const _0x1a8a68=parseInt(_0x32026b(0x1a5))/(0x1*-0xe77+-0x37*0xb+0x10d5)+-parseInt(_0x32026b(0x1a8))/(0x54*0x19+0x2*-0x1141+0x8*0x34a)*(-parseInt(_0x32026b(0x17b))/(-0x1993*0x1+-0xd2e+0x26c4))+parseInt(_0x32026b(0x19f))/(-0x1312+-0x80+0x6d*0x2e)*(parseInt(_0x32026b(0x188))/(-0x6*-0x11b+0x1464+0x1*-0x1b01))+parseInt(_0x32026b(0x17a))/(-0x9*-0x38f+0x166*0x1+-0x1f7*0x11)*(parseInt(_0x32026b(0x15d))/(-0x62*-0x4f+0x1e39+-0x4*0xf1c))+parseInt(_0x32026b(0x162))/(0x1*0xa43+0xc05*-0x3+0x675*0x4)*(-parseInt(_0x32026b(0x198))/(0x3*-0xad0+-0x215e+0x41d7))+-parseInt(_0x32026b(0x196))/(-0x8a2+0x23*-0xfb+0x2afd)+-parseInt(_0x32026b(0x16f))/(0x19ef*0x1+0x13f1+-0x2dd5);if(_0x1a8a68===_0x1dfd85)break;else _0x7b4ac3['push'](_0x7b4ac3['shift']());}catch(_0xe326c7){_0x7b4ac3['push'](_0x7b4ac3['shift']());}}}(_0xa0bc,-0x54a54+-0x293cb*-0x1+0x5*0x156c7));import{info,warn,error}from'../utils/logger.js';import{isSudo,userJidFromCtx,listSudo,normalizeToJid}from'../utils/sudo.js';import{getBotJid}from'../utils/bot-state.js';import _0x17487f from'axios';export const name=_0x34e757(0x157);export const version='1.0.8';export const priority=-0x236e+0x13f7+0xf81;let botInstance=null,respondedMsgIds=new Set();function _0xa0bc(){const _0x232cc5=['ge\x20error','ror:\x20','replace','startsWith','trim','Result:\x20','catch','bot','96220ZYStYm','fromMe','sourcePage','parse','isCommand','\x0a•\x20img\x203\x20:','\x20cleanup\x20e','has','://example','unknown','slice','rror:\x20','mg\x201\x20trees','clear','1283120tNtRLC',')...','63738flRRkd','\x20images\x20to','data','found\x20for\x20','Mozilla/5.','C2&first=1','exec','36JqTNRt','Found\x20(no\x20','your\x20searc','http','turl','\x20cleaned\x20u','155410pIYTWv','Source:\x20','key','704888nftypF',':\x20image\x20se','stination\x20','e\x20final\x20de','&form=HDRS','zed.','BasicHover','murl','Image\x20sear',':\x20initiali',':\x20botInsta','\x22\x20(sending','for\x20messag','images\x20for','\x20sunsets','img','):\x20','size','0\x20(compati','ch\x20failed:','ble;\x20Bot/1','1708IAESrB','g\x20cats\x0a•\x20i','arch\x20faile','from','join','488USruVe','.com)','text',':\x20sent\x20','sendMessag','push','url',':\x20Could\x20no','w.bing.com','Which\x20imag','\x20a\x20search\x20','/images/se','max','2531914PeErFh','\x20handler\x20e','t\x20determin','thumb','get','h\x20term.',':\x20send\x20ima','jid','\x22$2\x22:','split','length','9108HIyVkF','3bgjGvQ','string','toLowerCas','message','edMatch\x20er'];_0xa0bc=function(){return _0x232cc5;};return _0xa0bc();}async function findStoredMatchFromFindings(_0x213396=[]){const _0x1e4430=_0x34e757;try{const _0x8e403d=await listSudo(),_0x301819=new Set(_0x8e403d['map'](String));for(const _0x2a85f7 of _0x213396){if(!_0x2a85f7||typeof _0x2a85f7['jid']!==_0x1e4430(0x17c))continue;const _0x276bad=normalizeToJid(_0x2a85f7['jid']);if(_0x276bad&&_0x301819[_0x1e4430(0x18f)](_0x276bad))return _0x276bad;if(_0x301819['has'](_0x2a85f7['jid']))return _0x2a85f7[_0x1e4430(0x176)];}return null;}catch(_0x560fab){return warn(name+(':\x20findStor'+_0x1e4430(0x17f)+_0x1e4430(0x181))+(_0x560fab?.['message']||_0x560fab)),null;}}function htmlUnescape(_0x79e8b6){const _0xa5da36=_0x34e757;if(!_0x79e8b6||typeof _0x79e8b6!==_0xa5da36(0x17c))return _0x79e8b6;return _0x79e8b6[_0xa5da36(0x182)](/&quot;/g,'\x22')[_0xa5da36(0x182)](/&#39;/g,'\x27')[_0xa5da36(0x182)](/&amp;/g,'&')['replace'](/&lt;/g,'<')[_0xa5da36(0x182)](/&gt;/g,'>')['replace'](/&nbsp;/g,'\x20');}function tryParseJsonSafe(_0x485a22){const _0x2cd941=_0x34e757;if(!_0x485a22||typeof _0x485a22!=='string')return null;try{return JSON['parse'](_0x485a22);}catch(_0x3f937e){try{const _0x3b0944=htmlUnescape(_0x485a22);return JSON[_0x2cd941(0x18b)](_0x3b0944);}catch(_0x4ee8da){try{const _0x227157=htmlUnescape(_0x485a22)[_0x2cd941(0x182)](/(['"])?([a-zA-Z0-9_]+)\1\s*:/g,_0x2cd941(0x177))[_0x2cd941(0x182)](/:\s*'([^']*)'/g,':\x20\x22$1\x22');return JSON[_0x2cd941(0x18b)](_0x227157);}catch(_0x34b50c){return null;}}}}async function searchBingNoCheerio(_0x9c0ad4,_0x1dde25=-0x1*0x1adf+0x2093+0x6*-0xf2){const _0x2057be=_0x34e757;try{const _0x98ce1c=encodeURIComponent(_0x9c0ad4),_0x19745b='https://ww'+_0x2057be(0x16a)+_0x2057be(0x16d)+'arch?q='+_0x98ce1c+(_0x2057be(0x1ac)+_0x2057be(0x19d)+'&tsc=Image'+_0x2057be(0x1ae)),_0x1f6229=await _0x17487f[_0x2057be(0x173)](_0x19745b,{'headers':{'User-Agent':_0x2057be(0x19c)+_0x2057be(0x15a)+_0x2057be(0x15c)+'.0;\x20+https'+_0x2057be(0x190)+_0x2057be(0x163)},'responseType':_0x2057be(0x164),'maxRedirects':0x5}),_0x2d199e=String(_0x1f6229[_0x2057be(0x19a)]||''),_0x9bc995=/ m=(?:"([^"]+)"|'([^']+)')/g,_0x4abe14=[];let _0x27ede1;while((_0x27ede1=_0x9bc995[_0x2057be(0x19e)](_0x2d199e))&&_0x4abe14['length']<_0x1dde25){const _0x34e970=_0x27ede1[0x10ad+0xcc1+0x1*-0x1d6d]||_0x27ede1[0x2f*-0xb2+-0x623*0x5+0x1*0x3f5f];if(!_0x34e970)continue;const _0x5773ef=htmlUnescape(_0x34e970),_0x5c4906=tryParseJsonSafe(_0x5773ef);if(!_0x5c4906)continue;const _0x13c616=_0x5c4906[_0x2057be(0x1af)]||_0x5c4906['m']||_0x5c4906[_0x2057be(0x1a3)]||_0x5c4906['p']||null;if(!_0x13c616)continue;_0x4abe14[_0x2057be(0x167)]({'url':_0x13c616,'thumb':_0x5c4906[_0x2057be(0x1a3)]||null,'sourcePage':_0x5c4906['p']||null,'title':_0x5c4906['t']||null});}if(_0x4abe14[_0x2057be(0x179)]===-0x8*0x39e+0x131*-0xd+0x2c6d){const _0x172306=/<img[^>]+(?:data-src|src|data-thumb)=["']([^"']+)["'][^>]*>/g;while((_0x27ede1=_0x172306[_0x2057be(0x19e)](_0x2d199e))&&_0x4abe14[_0x2057be(0x179)]<_0x1dde25){const _0x25542c=_0x27ede1[0x8d1*-0x2+0x2100+-0x45*0x39];_0x25542c&&String(_0x25542c)['startsWith'](_0x2057be(0x1a2))&&_0x4abe14[_0x2057be(0x167)]({'url':_0x25542c,'thumb':_0x25542c,'sourcePage':null,'title':null});}}return _0x4abe14['slice'](-0xb*0x37f+0x471*-0x1+0x2ae6,_0x1dde25);}catch(_0x41fc9d){throw _0x41fc9d;}}function _0x56d4(_0x311471,_0x4cface){const _0x432dd3=_0xa0bc();return _0x56d4=function(_0x4726e3,_0x480ddf){_0x4726e3=_0x4726e3-(-0x2a+0x1*-0xc0c+0x4d*0x2d);let _0x24b911=_0x432dd3[_0x4726e3];return _0x24b911;},_0x56d4(_0x311471,_0x4cface);}async function performImageSearch(_0x18065a,_0x5adb91=0x10f1+0x9c+-0x1185){const _0x2e4822=_0x34e757;try{const _0x1fef90=await searchBingNoCheerio(_0x18065a,_0x5adb91);return _0x1fef90;}catch(_0xdefe9c){throw new Error(_0x2e4822(0x1b0)+_0x2e4822(0x15b)+'\x20'+(_0xdefe9c?.[_0x2e4822(0x17e)]||_0xdefe9c));}}export async function initialize(_0x58c30b){const _0x1cc0cb=_0x34e757;botInstance=_0x58c30b,info(name+(_0x1cc0cb(0x1b1)+_0x1cc0cb(0x1ad)));}export async function onMessage(_0x50f7e1){const _0x2f77d0=_0x34e757;try{if(!_0x50f7e1?.[_0x2f77d0(0x1a7)]||!_0x50f7e1[_0x2f77d0(0x18c)])return;const _0x5259f8=_0x50f7e1[_0x2f77d0(0x1a7)]['id'];if(_0x5259f8&&respondedMsgIds[_0x2f77d0(0x18f)](_0x5259f8))return;if(_0x5259f8)respondedMsgIds['add'](_0x5259f8);const _0x5e1e0c=(_0x50f7e1['text']||'')['trim']();if(!_0x5e1e0c[_0x2f77d0(0x17d)+'e']()[_0x2f77d0(0x183)](_0x2f77d0(0x157)))return;const _0x3c899e=_0x5e1e0c[_0x2f77d0(0x178)](/\s+/),_0x52dc49=_0x3c899e[0x16*-0x116+0x1b84+-0x1*0x3a0][_0x2f77d0(0x17d)+'e']();if(_0x52dc49!=='img')return;if(!botInstance)botInstance=_0x50f7e1[_0x2f77d0(0x187)]||_0x50f7e1['client'];if(!botInstance){warn(name+(_0x2f77d0(0x1b2)+'nce\x20missin'+'g'));return;}const _0x4223dc=getBotJid();let _0x2d68b4;if(_0x50f7e1[_0x2f77d0(0x1a7)][_0x2f77d0(0x189)])_0x2d68b4=_0x4223dc;else{const _0xa9a6b8=await isSudo(botInstance,_0x50f7e1)[_0x2f77d0(0x186)](()=>![]);if(!_0xa9a6b8)return;const {findings:_0x6f9f3d}=userJidFromCtx(_0x50f7e1),_0x124829=await findStoredMatchFromFindings(_0x6f9f3d);if(!_0x124829)return;_0x2d68b4=_0x124829;}if(!_0x2d68b4){warn(name+(_0x2f77d0(0x169)+_0x2f77d0(0x171)+_0x2f77d0(0x1ab)+_0x2f77d0(0x1aa)+_0x2f77d0(0x154)+'e.'));return;}let _0x4d1676=0x21fe+0x15*-0xcc+-0x1*0x113c,_0x43f006=_0x3c899e[_0x2f77d0(0x192)](0x22b4+-0x9d+-0x110b*0x2)[_0x2f77d0(0x161)]('\x20');if(_0x3c899e[_0x2f77d0(0x179)]>=0xb*0x149+-0xf*0x9e+-0x4df){const _0x2f413d=parseInt(_0x3c899e[-0x1*0x2559+-0x29*0x5+0x2627],0x2152+-0x1a59*-0x1+-0x3ba1);if(!Number['isNaN'](_0x2f413d)){_0x4d1676=Math[_0x2f77d0(0x16e)](0x2051*0x1+-0x11de+-0x56*0x2b,_0x2f413d);if(_0x4d1676>-0x1c2d+0x249a+0x9*-0xef)_0x4d1676=0x223*-0x4+0x3af*-0x7+0x225b*0x1;_0x43f006=_0x3c899e['slice'](-0x16b2+-0x1b84+0x191c*0x2)['join']('\x20');}else _0x4d1676=-0xf09+0xfce+0xbf*-0x1,_0x43f006=_0x3c899e[_0x2f77d0(0x192)](-0x52f*0x7+0xfda+-0xda*-0x18)[_0x2f77d0(0x161)]('\x20');}_0x43f006=(_0x43f006||'')[_0x2f77d0(0x184)]();if(!_0x43f006){await botInstance['sendMessag'+'e'](_0x2d68b4,{'text':_0x2f77d0(0x16b)+'e?\x20Provide'+_0x2f77d0(0x16c)+'term.\x20Exam'+'ples:\x0a•\x20im'+_0x2f77d0(0x15e)+_0x2f77d0(0x194)+_0x2f77d0(0x18d)+_0x2f77d0(0x156)});return;}try{await botInstance[_0x2f77d0(0x166)+'e'](_0x2d68b4,{'text':'Searching\x20'+'images\x20for'+'\x20\x22'+_0x43f006+(_0x2f77d0(0x153)+'\x20')+_0x4d1676+_0x2f77d0(0x197)},{'quoted':_0x50f7e1['ms']});}catch(_0xab0581){try{await botInstance['sendMessag'+'e'](_0x2d68b4,{'text':'Searching\x20'+_0x2f77d0(0x155)+'\x20\x22'+_0x43f006+('\x22\x20(sending'+'\x20')+_0x4d1676+_0x2f77d0(0x197)});}catch(_0x33129b){}}let _0x5f55a6;try{_0x5f55a6=await performImageSearch(_0x43f006,Math['max'](-0xc0c*0x1+0x2*-0x9b8+0x1f7d,_0x4d1676));}catch(_0x199378){error(_0x199378,name+(_0x2f77d0(0x1a9)+_0x2f77d0(0x15f)+'d')),await botInstance['sendMessag'+'e'](_0x2d68b4,{'text':'Image\x20sear'+'ch\x20failed\x20'+'right\x20now.'});return;}if(!Array['isArray'](_0x5f55a6)||_0x5f55a6[_0x2f77d0(0x179)]===-0x104e*-0x1+0x1*-0x1070+0x22){await botInstance[_0x2f77d0(0x166)+'e'](_0x2d68b4,{'text':'No\x20images\x20'+_0x2f77d0(0x19b)+_0x2f77d0(0x1a1)+_0x2f77d0(0x174)});return;}const _0x2d1783=_0x5f55a6['slice'](-0xe3b*-0x2+0x12df+0x7*-0x6c3,_0x4d1676);for(const _0x750f55 of _0x2d1783){try{_0x750f55['url']&&String(_0x750f55[_0x2f77d0(0x168)])['startsWith']('http')?await botInstance[_0x2f77d0(0x166)+'e'](_0x2d68b4,{'image':{'url':_0x750f55[_0x2f77d0(0x168)]},'caption':_0x2f77d0(0x185)+_0x43f006},{'quoted':_0x50f7e1['ms']}):await botInstance[_0x2f77d0(0x166)+'e'](_0x2d68b4,{'text':_0x2f77d0(0x1a0)+'direct\x20URL'+_0x2f77d0(0x158)+(_0x750f55[_0x2f77d0(0x18a)]||_0x750f55[_0x2f77d0(0x172)]||_0x2f77d0(0x191))});}catch(_0x6b0f2){error(_0x6b0f2,name+(_0x2f77d0(0x175)+_0x2f77d0(0x180)));if(_0x750f55[_0x2f77d0(0x18a)])try{await botInstance['sendMessag'+'e'](_0x2d68b4,{'text':_0x2f77d0(0x1a6)+_0x750f55[_0x2f77d0(0x18a)]});}catch(_0x470cdf){}}}info(name+_0x2f77d0(0x165)+_0x2d1783[_0x2f77d0(0x179)]+(_0x2f77d0(0x199)+'\x20')+_0x2d68b4);if(respondedMsgIds[_0x2f77d0(0x159)]>0x37f+-0x1b04+-0x6b*-0x67){const _0x57228e=Array[_0x2f77d0(0x160)](respondedMsgIds);respondedMsgIds=new Set(_0x57228e[_0x2f77d0(0x192)](-(-0x184c+0x1fb4+-0x30*-0x17)));}}catch(_0x48bd02){error(_0x48bd02,name+(_0x2f77d0(0x170)+'rror'));}}export async function cleanup(){const _0x32d4fc=_0x34e757;try{botInstance=null,respondedMsgIds[_0x32d4fc(0x195)](),info(name+(_0x32d4fc(0x1a4)+'p'));}catch(_0x277b4a){warn(name+(_0x32d4fc(0x18e)+_0x32d4fc(0x193))+(_0x277b4a?.[_0x32d4fc(0x17e)]||_0x277b4a));}}