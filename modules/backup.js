const _0x46ffb7=_0x5ef5;(function(_0x219046,_0x3cf5ea){const _0x5ea12d=_0x5ef5,_0xd46b5e=_0x219046();while(!![]){try{const _0x2c6bc0=-parseInt(_0x5ea12d(0x203))/(0x159f+-0x699+-0xf05)*(parseInt(_0x5ea12d(0x1ca))/(-0x38f*-0x6+0x1021+-0x2579))+parseInt(_0x5ea12d(0x18c))/(0x1992*-0x1+-0x24*-0x69+0x47*0x27)+-parseInt(_0x5ea12d(0x1f8))/(-0xa27*-0x1+-0x111c+0x6f9)*(parseInt(_0x5ea12d(0x123))/(-0x1f*-0xa1+-0x1*-0xe71+-0x13*0x1c9))+parseInt(_0x5ea12d(0x1d3))/(-0xf66+0x6b3+0x8b9*0x1)*(parseInt(_0x5ea12d(0x18b))/(0x74f+-0x22e4+0x1b9c))+-parseInt(_0x5ea12d(0x12d))/(0x17b9+-0x1b*0x3d+0x8a1*-0x2)*(-parseInt(_0x5ea12d(0x19c))/(0x5c9+0x18e2+-0x1ea2))+-parseInt(_0x5ea12d(0x16e))/(0x1a33+0x74d+-0x2176)+parseInt(_0x5ea12d(0x129))/(-0xe3*-0x3+0x112d+-0x13cb);if(_0x2c6bc0===_0x3cf5ea)break;else _0xd46b5e['push'](_0xd46b5e['shift']());}catch(_0x562ba7){_0xd46b5e['push'](_0xd46b5e['shift']());}}}(_0x1339,0x2743b*-0x6+-0x11090c+-0xe987*-0x2e));import _0x381f4c from'fs';import _0x470c63 from'path';import{downloadContentFromMessage}from'@whiskeysockets/baileys';import{info,warn,error}from'../utils/logger.js';import{getConfig,findConfigFile,PROJECT_ROOT}from'../utils/config.js';import{getBotJid}from'../utils/bot-state.js';import{userJidFromCtx,listSudo,normalizeToJid}from'../utils/sudo.js';function _0x1339(){const _0xaa6879=['existsSync','inalDestFr','destinatio','\x20and\x20re-in','✅\x20Config\x20r','\x20setdb\x20res','\x20file\x20exte','resolve','sendMessag','split','\x20media\x20has','5LQKRTN','\x20to\x20','❌\x20Invalid\x20','\x20cleanup\x20e','o\x20send\x20con','writeFileS','17336638mNIbuI','\x20removed\x20o','relative','ter\x20getdb\x20','6925928IOzTHV','d\x20for\x20','Message','slice','DB_PATH','key','der\x20mismat','audio','❌\x20Failed\x20t','valid\x20SQLi','quired\x20for','forEach','idated).','client','ck\x20up\x20new\x20','No\x20media\x20n','failed','replace','\x20sent\x20DB\x20f','bot','ptv','fileName','ile\x20','\x20remove\x20ol','y\x20for\x20getd','file\x20to\x20re','\x20sent\x20conf','t\x20validate','\x20cleaned\x20u','\x20command\x20\x27','or\x20restore','the\x20file\x20a','\x20not\x20appea','image','er\x20attempt','DB\x20backed\x20','\x27\x20authoriz',').\x20Please\x20','concat','toLowerCas','❌\x20Uploaded','\x20DB:\x20','\x20safeSend\x20','@g.us','videoMessa','text','nitialize\x20','ompleted\x20f','file\x20heade','nd\x20try\x20aga','bot.db','contextInf','SQLite\x20for','runtime-co','has','file:\x20','QLite\x20head','.yml','o\x20retrieve','push','set','mat\x203\x00','ed\x20a\x20DB,\x20r','filename\x20/','was\x20made.','11619880AaYqZK','ilable','\x20.json','\x20backup:\x20','jid','isAbsolute','\x20download\x20','❌\x20File\x20not','ill\x20be\x20val','sock','DB\x20from\x20ba','o\x20save\x20con','nsions:\x20.y','B\x20(downloa','utdown','\x20create\x20DB','n/json','er:\x20\x22SQLit','\x20no\x20send\x20s','d\x20step)','startsWith','ailure','ttach\x20or\x20r','\x20operation','sage','extendedTe','ot\x20restart','mediaMsg','in.','6290641ZDpoEh','719418FFzwKV','\x20could\x20not','requires\x20b','getdb','readFileSy','audioMessa','n\x20path.',':\x20uploaded','function','\x20DB\x20reinit','failed:\x20','nce\x20not\x20av','caption','age','d\x20config\x20f','B\x20from\x20bac','9HxlJOc','o\x20download','\x20overwritt','ode\x20found\x20','as:\x20','d\x20re-uploa','.yaml','en\x20DB\x20file','ed\x20recover','failed\x20aft','\x20getconfig','DB\x20(any\x20ex','urface\x20ava','sticker','endsWith','ync','eplaced\x20wi','\x20initializ','\x20getdb\x20fai','./data/db','❌\x20Could\x20no','DB:\x20','ot\x20instanc','fromMe','y\x20failed:\x20','setconfig','kup\x20after\x20','n/octet-st','error','itialized\x20','\x20error:\x20','rror:\x20','\x20may\x20be\x20re','\x20failed','ld\x20config\x20','B\x20replaced','\x20setconfig','d\x20media\x20ty','string','tension;\x20w','o\x20restore\x20','clear','setdb','n\x20WhatsApp','b\x20failure.','2.5.0','327474FEIsmI','nfig.json','imageMessa','documentMe','delete','video','DB_NAME','[dbbackup]','\x0aAn\x20attemp','6eORThg','\x20at\x20','config\x20fil','isCommand','xtMessage','initialize','tore\x20faile','config.yml','\x20onMessage','e\x20format\x203','etdb','trim','\x5c0\x22.\x20If\x20th','\x20quick\x20cop','ialized\x20af','fig\x20file:\x20','ailed','r\x20to\x20be\x20a\x20','\x20replaced\x20','ssage','wnload','edia\x20to\x20do','from','unlinkSync','or\x20getdb\x20o','\x0aA\x20recover','shutdown\x20c','r:\x20','b\x20at\x20','ascii','omCtx\x20erro','after\x20getd','\x20DB\x20restor','\x20failed\x20to','eDatabase\x20','document','stickerMes','5033764IVXBft','extname','ed\x20for\x20','copyFileSy','d\x20after\x20sh','mkdirSync','.bak_for_s','join','applicatio','Expected\x20S','lidation\x20f','3eERXIL','quotedMess','message','er\x20the\x20pre','status','\x20header\x20va','remoteJid','dbbackup','led','fig:\x20','config.','❌\x20Please\x20a','ml,\x20.yaml,','sep','\x20(HTTP\x20410','.json','length','place\x20the\x20','\x20existing\x20','includes','uploaded\x20D','y\x20attempt\x20','e\x20complete','eply\x20to\x20a\x20','er\x20getdb\x20f','⚠️\x20Warning:'];_0x1339=function(){return _0xaa6879;};return _0x1339();}import{shutdownDatabase,initializeDatabase}from'../utils/database.js';export const name=_0x46ffb7(0x20a);export const version=_0x46ffb7(0x1c9);export const priority=0x16c1+0x1e24*-0x1+0x7d1;export const commands=[_0x46ffb7(0x18f),_0x46ffb7(0x1c6),'getconfig',_0x46ffb7(0x1b5)];let botRef=null,sendApi=null;const DEDUPE_TTL_MS=(0x535+-0x1e6e+0x1943)*(0x1f8c+-0x22d1+0xa7*0xb),processedMessageKeys=new Map();function markProcessed(_0x129c1a){const _0x44006f=_0x46ffb7;if(!_0x129c1a)return;if(processedMessageKeys[_0x44006f(0x163)](_0x129c1a))try{clearTimeout(processedMessageKeys['get'](_0x129c1a));}catch(_0x5c990e){}const _0x35cc55=setTimeout(()=>processedMessageKeys[_0x44006f(0x1ce)](_0x129c1a),DEDUPE_TTL_MS);processedMessageKeys[_0x44006f(0x169)](_0x129c1a,_0x35cc55);}function isProcessed(_0x148f9c){const _0x31ff3d=_0x46ffb7;return _0x148f9c&&processedMessageKeys[_0x31ff3d(0x163)](_0x148f9c);}function _0x5ef5(_0x4a0009,_0x4b8854){const _0x290bf8=_0x1339();return _0x5ef5=function(_0x4b75da,_0xae667b){_0x4b75da=_0x4b75da-(0x41b+-0x178d*-0x1+0x8d7*-0x3);let _0x1e89eb=_0x290bf8[_0x4b75da];return _0x1e89eb;},_0x5ef5(_0x4a0009,_0x4b8854);}async function resolveFinalDestFromCtx(_0x1df4f8){const _0x578116=_0x46ffb7;try{if(!_0x1df4f8||!_0x1df4f8[_0x578116(0x132)])return null;const _0x560086=getBotJid(),_0x4f54da=Boolean(_0x1df4f8['key'][_0x578116(0x1b3)]);if(_0x4f54da)return _0x560086||null;const _0x41b062=String(_0x1df4f8[_0x578116(0x132)]['remoteJid']||'');if(!_0x41b062||_0x41b062[_0x578116(0x1aa)](_0x578116(0x158)))return null;const {findings:_0x1a36aa}=userJidFromCtx(_0x1df4f8);if(!Array['isArray'](_0x1a36aa)||_0x1a36aa[_0x578116(0x213)]===0x2100+0x17*0xd+-0x222b)return null;const _0x374dbd=await listSudo();if(!Array['isArray'](_0x374dbd)||_0x374dbd[_0x578116(0x213)]===-0x6e8*0x3+0x1b81+0x6c9*-0x1)return null;const _0x33236f=new Set(_0x374dbd['map'](_0x1e1c99=>String(_0x1e1c99)));for(const _0x5dc69c of _0x1a36aa){if(!_0x5dc69c?.[_0x578116(0x172)]||typeof _0x5dc69c[_0x578116(0x172)]!==_0x578116(0x1c2))continue;let _0xc4aae2=null;try{_0xc4aae2=normalizeToJid(_0x5dc69c[_0x578116(0x172)]);}catch(_0x474cbd){_0xc4aae2=null;}if(_0xc4aae2&&_0x33236f[_0x578116(0x163)](_0xc4aae2))return _0xc4aae2;const _0x1b4889=(String(_0x5dc69c['jid'])[_0x578116(0x226)]('@')[0xa*0x72+0xca1+0x1115*-0x1]||'')[_0x578116(0x226)](':')[0x3*0xb83+-0x1*0x23d1+-0x148*-0x1]||null;if(_0x1b4889)for(const _0x19a537 of _0x33236f){const _0x8ac5ff=String(_0x19a537)[_0x578116(0x226)]('@')[-0x10f*0x11+-0x1*-0x2683+-0x1484]||null;if(_0x8ac5ff&&_0x1b4889===_0x8ac5ff)return _0x19a537;}if(_0x33236f[_0x578116(0x163)](_0x5dc69c[_0x578116(0x172)]))return _0x5dc69c[_0x578116(0x172)];}return null;}catch(_0x428397){return warn('['+name+(']\x20resolveF'+_0x578116(0x21e)+_0x578116(0x1f1)+_0x578116(0x1ee))+(_0x428397?.[_0x578116(0x205)]||_0x428397)),null;}}function setupSendApi(_0x502942){const _0x34d79b=_0x46ffb7;if(!_0x502942)return;if(typeof _0x502942[_0x34d79b(0x225)+'e']===_0x34d79b(0x194))sendApi=async(_0x301181,_0x5a45f3)=>await _0x502942[_0x34d79b(0x225)+'e'](_0x301181,_0x5a45f3);else _0x502942[_0x34d79b(0x177)]&&typeof _0x502942[_0x34d79b(0x177)][_0x34d79b(0x225)+'e']===_0x34d79b(0x194)?sendApi=async(_0x3e226d,_0x56d0b3)=>await _0x502942[_0x34d79b(0x177)][_0x34d79b(0x225)+'e'](_0x3e226d,_0x56d0b3):sendApi=null;}async function safeSend(_0x3d5290,_0x426c54){const _0x5acf7c=_0x46ffb7;try{if(!_0x3d5290||!_0x426c54)return;if(sendApi)return await sendApi(_0x3d5290,_0x426c54);warn('[dbbackup]'+_0x5acf7c(0x180)+_0x5acf7c(0x1a8)+_0x5acf7c(0x16f));}catch(_0x29ef7b){error(_0x29ef7b,_0x5acf7c(0x1d1)+'\x20safeSend\x20'+_0x5acf7c(0x13d)),warn(_0x5acf7c(0x1d1)+_0x5acf7c(0x157)+_0x5acf7c(0x196)+(_0x29ef7b?.[_0x5acf7c(0x205)]||_0x29ef7b));}}function resolveDbDir(){const _0x223349=_0x46ffb7,_0xfa0e2=getConfig(),_0x878cba=_0xfa0e2&&_0xfa0e2[_0x223349(0x131)]?_0xfa0e2[_0x223349(0x131)]:_0x223349(0x1af),_0x5dfa5f=_0x470c63[_0x223349(0x173)](_0x878cba)?_0x470c63[_0x223349(0x224)](_0x878cba):_0x470c63['resolve'](PROJECT_ROOT,_0x878cba);return _0x5dfa5f;}function ensureInside(_0x4da347,_0x3569ac){const _0xf494a1=_0x46ffb7,_0xfa6bd6=_0x470c63[_0xf494a1(0x224)](_0x4da347)+_0x470c63[_0xf494a1(0x210)],_0xfbf32b=_0x470c63[_0xf494a1(0x224)](_0x3569ac);return _0xfbf32b[_0xf494a1(0x182)](_0xfa6bd6);}function getMediaFromMessage(_0x4d71e2){const _0x3dc3dc=_0x46ffb7;if(!_0x4d71e2)return null;if(_0x4d71e2[_0x3dc3dc(0x1cd)+_0x3dc3dc(0x1e6)]){const _0x2db7e6=_0x4d71e2[_0x3dc3dc(0x1cd)+_0x3dc3dc(0x1e6)];return{'type':_0x3dc3dc(0x1f6),'mediaMsg':_0x4d71e2,'fileName':_0x2db7e6[_0x3dc3dc(0x142)]||null,'caption':_0x2db7e6[_0x3dc3dc(0x198)]||null};}if(_0x4d71e2[_0x3dc3dc(0x1cc)+'ge']||_0x4d71e2['videoMessa'+'ge']||_0x4d71e2[_0x3dc3dc(0x191)+'ge']||_0x4d71e2['stickerMes'+_0x3dc3dc(0x186)]){const _0x27860f=[_0x3dc3dc(0x1cc)+'ge',_0x3dc3dc(0x159)+'ge',_0x3dc3dc(0x191)+'ge',_0x3dc3dc(0x1f7)+_0x3dc3dc(0x186)];for(const _0x4ffd03 of _0x27860f){if(_0x4d71e2[_0x4ffd03])return{'type':_0x4ffd03[_0x3dc3dc(0x13e)](_0x3dc3dc(0x12f),''),'mediaMsg':_0x4d71e2,'fileName':null,'caption':null};}}return null;}function getQuotedMedia(_0x2b1cc5){const _0x3485a4=_0x46ffb7,_0x31a3a3=_0x2b1cc5['message']&&_0x2b1cc5[_0x3485a4(0x205)][_0x3485a4(0x187)+_0x3485a4(0x1d7)];if(!_0x31a3a3||!_0x31a3a3[_0x3485a4(0x160)+'o']||!_0x31a3a3['contextInf'+'o'][_0x3485a4(0x204)+_0x3485a4(0x199)])return null;const _0x429889=_0x31a3a3['contextInf'+'o'][_0x3485a4(0x204)+_0x3485a4(0x199)];return getMediaFromMessage(_0x429889);}async function downloadMessageToBuffer(_0x54857e){const _0xabc42d=_0x46ffb7;if(!_0x54857e||!_0x54857e[_0xabc42d(0x205)]){const _0x44ac63=_0x54857e,_0x4c9a7a=getMediaFromMessage(_0x44ac63);if(!_0x4c9a7a)throw new Error(_0xabc42d(0x13c)+_0xabc42d(0x19f)+'to\x20downloa'+'d');_0x54857e={'message':_0x44ac63};}const _0x90f8f0=_0x54857e[_0xabc42d(0x205)]||{},_0x29c1d0=[_0xabc42d(0x1f6),_0xabc42d(0x14e),_0xabc42d(0x1cf),_0xabc42d(0x141),_0xabc42d(0x134),_0xabc42d(0x1a9)];for(const _0x41984f of _0x29c1d0){const _0x10a75c=_0x90f8f0[_0x41984f+_0xabc42d(0x12f)];if(!_0x10a75c)continue;const _0x5a10c5=await downloadContentFromMessage(_0x10a75c,_0x41984f),_0x3b7062=[];for await(const _0x502a5a of _0x5a10c5)_0x3b7062[_0xabc42d(0x168)](_0x502a5a);return Buffer[_0xabc42d(0x153)](_0x3b7062);}throw new Error('Unsupporte'+_0xabc42d(0x1c1)+'pe\x20or\x20no\x20m'+_0xabc42d(0x1e8)+_0xabc42d(0x1e7));}export async function initialize(_0x1a9ca8){const _0x3bc888=_0x46ffb7;if(!_0x1a9ca8)throw new Error('dbbackup.i'+_0x3bc888(0x15b)+_0x3bc888(0x18e)+_0x3bc888(0x1b2)+'e');botRef=_0x1a9ca8,setupSendApi(botRef),info(_0x3bc888(0x1d1)+'\x20initializ'+'ed');}export async function onMessage(_0x2704da){const _0x2ba01b=_0x46ffb7;try{if(!_0x2704da||!_0x2704da[_0x2ba01b(0x132)]||!_0x2704da['message'])return;const _0x184348=String(_0x2704da['key'][_0x2ba01b(0x209)]||'');if(_0x184348[_0x2ba01b(0x1aa)]('@g.us'))return;const _0x43e977=_0x184348+'::'+String(_0x2704da['key']['id']||'');if(isProcessed(_0x43e977))return;if(!_0x2704da[_0x2ba01b(0x1d6)])return;const _0x40d7e5=_0x2704da[_0x2ba01b(0x15a)]&&typeof _0x2704da[_0x2ba01b(0x15a)]===_0x2ba01b(0x1c2)?_0x2704da[_0x2ba01b(0x15a)][_0x2ba01b(0x1de)]():'';if(!_0x40d7e5)return;const _0x48c6be=_0x40d7e5['split'](/\r?\n/)[0xdd1+0xc99+0x3*-0x8ce][_0x2ba01b(0x1de)]()['split'](/\s+/),_0x3e9c7e=(_0x48c6be[0x2*0x7c3+0x1*0x23af+-0x1*0x3335]||'')['toLowerCas'+'e']();if(!commands['includes'](_0x3e9c7e))return;if(!botRef)botRef=_0x2704da[_0x2ba01b(0x140)]||_0x2704da[_0x2ba01b(0x13a)]||null;if(!sendApi)setupSendApi(botRef);if(!botRef){warn(_0x2ba01b(0x1d1)+'\x20bot\x20insta'+_0x2ba01b(0x197)+'ailable.');return;}const _0x456cc9=await resolveFinalDestFromCtx(_0x2704da);if(!_0x456cc9)return;markProcessed(_0x43e977),info(_0x2ba01b(0x1d1)+_0x2ba01b(0x14a)+_0x3e9c7e+(_0x2ba01b(0x151)+_0x2ba01b(0x1fa))+_0x456cc9);if(_0x3e9c7e===_0x2ba01b(0x18f)){const _0x24e083=getConfig(),_0x105f7e=resolveDbDir(),_0x4ee09c=_0x24e083&&_0x24e083['DB_NAME']?String(_0x24e083[_0x2ba01b(0x1d0)]):_0x2ba01b(0x15f),_0xadf8df=_0x48c6be['length']>=0x1b6e*-0x1+-0x1*-0xe5d+-0xd13*-0x1?_0x48c6be[_0x2ba01b(0x130)](-0x75b+-0x15*0x17+-0x93f*-0x1)[_0x2ba01b(0x1ff)]('\x20')[_0x2ba01b(0x1de)]():_0x4ee09c,_0x465a49=_0x470c63[_0x2ba01b(0x224)](_0x105f7e,_0xadf8df);if(!ensureInside(_0x105f7e,_0x465a49)){await safeSend(_0x456cc9,{'text':_0x2ba01b(0x125)+_0x2ba01b(0x16c)+'\x20access\x20de'+'nied.'});return;}if(!_0x381f4c[_0x2ba01b(0x21d)](_0x465a49)){await safeSend(_0x456cc9,{'text':_0x2ba01b(0x175)+'\x20found:\x20'+_0xadf8df});return;}const _0x2806b3=_0x470c63[_0x2ba01b(0x1ff)](_0x105f7e,_0x470c63['basename'](_0x465a49)+('.bak_for_g'+_0x2ba01b(0x1dd)));let _0x1180d7=![];try{await shutdownDatabase(),_0x1180d7=!![],info('[dbbackup]'+'\x20database\x20'+_0x2ba01b(0x1ed)+'ompleted\x20f'+_0x2ba01b(0x1eb)+'peration.');try{_0x381f4c[_0x2ba01b(0x1fb)+'nc'](_0x465a49,_0x2806b3),info(_0x2ba01b(0x1d1)+'\x20quick\x20cop'+_0x2ba01b(0x145)+_0x2ba01b(0x1ef)+_0x2806b3);}catch(_0xf6980b){warn(_0x2ba01b(0x1d1)+_0x2ba01b(0x1e0)+_0x2ba01b(0x1b4)+(_0xf6980b?.[_0x2ba01b(0x205)]||_0xf6980b));}const _0x5b1402=_0x381f4c[_0x2ba01b(0x190)+'nc'](_0x465a49);await safeSend(_0x456cc9,{'document':_0x5b1402,'fileName':_0x470c63['basename'](_0x465a49),'mimetype':_0x2ba01b(0x200)+_0x2ba01b(0x1b7)+'ream'}),info(_0x2ba01b(0x1d1)+_0x2ba01b(0x13f)+_0x2ba01b(0x143)+_0x465a49+'\x20to\x20'+_0x456cc9),await initializeDatabase(),info(_0x2ba01b(0x1d1)+_0x2ba01b(0x195)+_0x2ba01b(0x1e1)+_0x2ba01b(0x12c)+'operation.');}catch(_0x2af1a0){error(_0x2af1a0,'[dbbackup]'+_0x2ba01b(0x1ae)+_0x2ba01b(0x20b));try{_0x1180d7&&(await initializeDatabase(),info(_0x2ba01b(0x1d1)+_0x2ba01b(0x1ad)+_0x2ba01b(0x1f5)+'attempted\x20'+_0x2ba01b(0x1f2)+_0x2ba01b(0x1c8)));}catch(_0x5ed9e9){error(_0x5ed9e9,_0x2ba01b(0x1d1)+_0x2ba01b(0x1ad)+_0x2ba01b(0x1f5)+_0x2ba01b(0x1a5)+_0x2ba01b(0x21b)+_0x2ba01b(0x183));}await safeSend(_0x456cc9,{'text':'❌\x20Failed\x20t'+_0x2ba01b(0x167)+_0x2ba01b(0x156)+(_0x2af1a0?.['message']||_0x2af1a0)+(_0x2ba01b(0x1ec)+_0x2ba01b(0x218)+_0x2ba01b(0x16d))});}finally{try{if(_0x381f4c[_0x2ba01b(0x21d)](_0x2806b3))_0x381f4c['unlinkSync'](_0x2806b3);}catch(_0x5aa95c){}}return;}if(_0x3e9c7e===_0x2ba01b(0x1c6)){let _0x30dd67=getMediaFromMessage(_0x2704da[_0x2ba01b(0x205)])||getQuotedMedia(_0x2704da),_0xd2e4ff=!getMediaFromMessage(_0x2704da['message'])&&!!getQuotedMedia(_0x2704da);if(!_0x30dd67||!_0x30dd67[_0x2ba01b(0x189)]){await safeSend(_0x456cc9,{'text':_0x2ba01b(0x20e)+_0x2ba01b(0x184)+_0x2ba01b(0x21a)+_0x2ba01b(0x146)+_0x2ba01b(0x214)+_0x2ba01b(0x1a7)+_0x2ba01b(0x1c3)+_0x2ba01b(0x176)+_0x2ba01b(0x139)});return;}const _0x21aed3=String(_0x30dd67[_0x2ba01b(0x142)]||'')['trim'](),_0x4a2059=getConfig(),_0x116de6=resolveDbDir();let _0x36b315=_0x4a2059&&_0x4a2059[_0x2ba01b(0x1d0)]?String(_0x4a2059[_0x2ba01b(0x1d0)]):_0x2ba01b(0x15f),_0x2318cd=_0x470c63[_0x2ba01b(0x1f9)](_0x36b315)[_0x2ba01b(0x154)+'e']();if(!_0x2318cd){_0x36b315=_0x36b315||_0x2ba01b(0x15f),_0x2318cd=_0x470c63['extname'](_0x36b315)||'.db';if(!_0x470c63[_0x2ba01b(0x1f9)](_0x36b315))_0x36b315=''+_0x36b315+_0x2318cd;}const _0x4f1d10=_0x470c63[_0x2ba01b(0x224)](_0x116de6,_0x36b315);try{_0x381f4c[_0x2ba01b(0x1fd)](_0x116de6,{'recursive':!![]});}catch(_0x427f2a){}if(!ensureInside(_0x116de6,_0x4f1d10)){await safeSend(_0x456cc9,{'text':_0x2ba01b(0x125)+_0x2ba01b(0x21f)+_0x2ba01b(0x192)});return;}const _0x26e479=_0xd2e4ff?_0x2704da['message']['extendedTe'+'xtMessage'][_0x2ba01b(0x160)+'o'][_0x2ba01b(0x204)+_0x2ba01b(0x199)]:_0x2704da[_0x2ba01b(0x205)];let _0x2327a5;try{_0x2327a5=await downloadMessageToBuffer(_0x26e479);}catch(_0x3655cf){error(_0x3655cf,_0x2ba01b(0x1d1)+_0x2ba01b(0x1f4)+_0x2ba01b(0x174)+_0x2ba01b(0x217)+_0x2ba01b(0x17b)+_0x2ba01b(0x181));const _0x56eb0b=_0x3655cf?.['response']?.[_0x2ba01b(0x207)]||_0x3655cf?.[_0x2ba01b(0x207)]||null;_0x56eb0b===-0x23bb+-0x128*-0x16+0x261*0x5?await safeSend(_0x456cc9,{'text':_0x2ba01b(0x135)+_0x2ba01b(0x19d)+_0x2ba01b(0x193)+_0x2ba01b(0x227)+'\x20expired\x20o'+_0x2ba01b(0x1c7)+_0x2ba01b(0x211)+_0x2ba01b(0x152)+'re-upload\x20'+_0x2ba01b(0x14c)+_0x2ba01b(0x15e)+_0x2ba01b(0x18a)}):await safeSend(_0x456cc9,{'text':_0x2ba01b(0x135)+_0x2ba01b(0x19d)+'\x20uploaded\x20'+_0x2ba01b(0x164)+(_0x3655cf?.[_0x2ba01b(0x205)]||_0x3655cf)});return;}try{const _0x162cd3=_0x2327a5[_0x2ba01b(0x130)](-0x147a+0x1*-0x21cc+0x3646,0x1*0x2401+0xbcf*0x2+-0x3b8f),_0x5914c8=Buffer['from'](_0x2ba01b(0x161)+_0x2ba01b(0x16a),_0x2ba01b(0x1f0));if(!_0x162cd3['equals'](_0x5914c8)){await safeSend(_0x456cc9,{'text':_0x2ba01b(0x155)+'\x20file\x20does'+_0x2ba01b(0x14d)+_0x2ba01b(0x1e4)+_0x2ba01b(0x136)+'te\x20DB\x20(hea'+_0x2ba01b(0x133)+'ch).\x0a'+(_0x2ba01b(0x201)+_0x2ba01b(0x165)+_0x2ba01b(0x17f)+_0x2ba01b(0x1dc)+_0x2ba01b(0x1df)+'is\x20is\x20inde'+_0x2ba01b(0x16b)+'e-check\x20an'+_0x2ba01b(0x1a1)+'d.')});return;}}catch(_0x13cf8e){error(_0x13cf8e,_0x2ba01b(0x1d1)+_0x2ba01b(0x208)+_0x2ba01b(0x202)+_0x2ba01b(0x1e3)),await safeSend(_0x456cc9,{'text':_0x2ba01b(0x1b0)+_0x2ba01b(0x148)+'\x20uploaded\x20'+_0x2ba01b(0x15d)+_0x2ba01b(0x1ee)+(_0x13cf8e?.['message']||_0x13cf8e)});return;}const _0x12a367=_0x470c63[_0x2ba01b(0x1ff)](_0x116de6,_0x470c63['basename'](_0x4f1d10)+(_0x2ba01b(0x1fe)+_0x2ba01b(0x1dd)));let _0x4ff125=![];try{await shutdownDatabase(),_0x4ff125=!![],info('[dbbackup]'+'\x20database\x20'+_0x2ba01b(0x1ed)+_0x2ba01b(0x15c)+_0x2ba01b(0x14b)+_0x2ba01b(0x185)+'.');if(_0x381f4c['existsSync'](_0x4f1d10))try{_0x381f4c[_0x2ba01b(0x1fb)+'nc'](_0x4f1d10,_0x12a367),info(_0x2ba01b(0x1d1)+_0x2ba01b(0x215)+_0x2ba01b(0x150)+'up\x20to\x20'+_0x12a367);}catch(_0x52d958){warn(_0x2ba01b(0x1d1)+_0x2ba01b(0x1f4)+'\x20create\x20DB'+_0x2ba01b(0x171)+(_0x52d958?.[_0x2ba01b(0x205)]||_0x52d958)),await safeSend(_0x456cc9,{'text':_0x2ba01b(0x21c)+_0x2ba01b(0x18d)+_0x2ba01b(0x17d)+'\x20backup:\x20'+(_0x52d958?.[_0x2ba01b(0x205)]||_0x52d958)});}_0x381f4c[_0x2ba01b(0x128)+_0x2ba01b(0x1ab)](_0x4f1d10,_0x2327a5),info(_0x2ba01b(0x1d1)+_0x2ba01b(0x19e)+_0x2ba01b(0x1a3)+_0x2ba01b(0x1d4)+_0x4f1d10),await initializeDatabase(),await safeSend(_0x456cc9,{'text':'✅\x20Active\x20D'+_0x2ba01b(0x1bf)+_0x2ba01b(0x220)+_0x2ba01b(0x1b9)+_0x2ba01b(0x1a0)+_0x470c63[_0x2ba01b(0x12b)](PROJECT_ROOT,_0x4f1d10)}),info(_0x2ba01b(0x1d1)+_0x2ba01b(0x1f3)+_0x2ba01b(0x219)+'\x20and\x20DB\x20re'+_0x2ba01b(0x1d8)+_0x2ba01b(0x12e)+_0x456cc9);}catch(_0x156cbd){error(_0x156cbd,_0x2ba01b(0x1d1)+_0x2ba01b(0x222)+_0x2ba01b(0x1d9)+_0x2ba01b(0x1fc)+_0x2ba01b(0x17c));try{_0x381f4c[_0x2ba01b(0x21d)](_0x12a367)&&(_0x381f4c[_0x2ba01b(0x1fb)+'nc'](_0x12a367,_0x4f1d10),info(_0x2ba01b(0x1d1)+'\x20restored\x20'+_0x2ba01b(0x178)+'ckup\x20due\x20t'+'o\x20error\x20du'+'ring\x20resto'+'re'));}catch(_0x490c24){error(_0x490c24,_0x2ba01b(0x1d1)+'\x20failed\x20to'+'\x20restore\x20D'+_0x2ba01b(0x19b)+_0x2ba01b(0x1b6)+_0x2ba01b(0x1b8));}try{await initializeDatabase();}catch(_0x6e5036){error(_0x6e5036,_0x2ba01b(0x1d1)+'\x20initializ'+_0x2ba01b(0x1f5)+'failed\x20aft'+_0x2ba01b(0x14f)+_0x2ba01b(0x1a4)+'y');}await safeSend(_0x456cc9,{'text':_0x2ba01b(0x135)+_0x2ba01b(0x1c4)+_0x2ba01b(0x1b1)+(_0x156cbd?.[_0x2ba01b(0x205)]||_0x156cbd)+(_0x2ba01b(0x1d2)+'t\x20to\x20recov'+_0x2ba01b(0x206)+'vious\x20DB\x20w'+'as\x20made.')});}finally{try{if(_0x381f4c['existsSync'](_0x12a367))_0x381f4c[_0x2ba01b(0x1ea)](_0x12a367);}catch(_0x2a2593){}}return;}if(_0x3e9c7e==='getconfig'){const _0x7cc3df=findConfigFile();if(_0x7cc3df){try{const _0x8a2544=_0x381f4c[_0x2ba01b(0x190)+'nc'](_0x7cc3df),_0x4a6890=_0x7cc3df['toLowerCas'+'e']()[_0x2ba01b(0x1aa)](_0x2ba01b(0x212))?_0x2ba01b(0x200)+_0x2ba01b(0x17e):'text/x-yam'+'l';await safeSend(_0x456cc9,{'document':_0x8a2544,'fileName':_0x470c63['basename'](_0x7cc3df),'mimetype':_0x4a6890}),info('[dbbackup]'+_0x2ba01b(0x147)+'ig\x20file\x20'+_0x7cc3df+_0x2ba01b(0x124)+_0x456cc9);}catch(_0x531914){error(_0x531914,_0x2ba01b(0x1d1)+_0x2ba01b(0x1a6)+'\x20send\x20fail'+'ed'),await safeSend(_0x456cc9,{'text':_0x2ba01b(0x135)+_0x2ba01b(0x127)+_0x2ba01b(0x1e2)+(_0x531914?.[_0x2ba01b(0x205)]||_0x531914)});}return;}const _0x51480b=getConfig()||{},_0x519bb0=Buffer[_0x2ba01b(0x1e9)](JSON['stringify'](_0x51480b,null,0x53*0x51+-0x1*-0xf23+0x1*-0x2964),'utf8');await safeSend(_0x456cc9,{'document':_0x519bb0,'fileName':_0x2ba01b(0x162)+_0x2ba01b(0x1cb),'mimetype':'applicatio'+_0x2ba01b(0x17e)});return;}if(_0x3e9c7e===_0x2ba01b(0x1b5)){let _0x348f00=getMediaFromMessage(_0x2704da[_0x2ba01b(0x205)])||getQuotedMedia(_0x2704da),_0x10d3fc=!getMediaFromMessage(_0x2704da[_0x2ba01b(0x205)])&&!!getQuotedMedia(_0x2704da);if(!_0x348f00||!_0x348f00[_0x2ba01b(0x189)]){await safeSend(_0x456cc9,{'text':_0x2ba01b(0x20e)+_0x2ba01b(0x184)+_0x2ba01b(0x21a)+_0x2ba01b(0x1d5)+'e.'});return;}const _0x364ff5=String(_0x348f00[_0x2ba01b(0x142)]||'')[_0x2ba01b(0x1de)]()[_0x2ba01b(0x154)+'e'](),_0x172daf=[_0x2ba01b(0x166),_0x2ba01b(0x1a2),_0x2ba01b(0x212)],_0x4f7756=_0x470c63['extname'](_0x364ff5||'');if(!_0x172daf[_0x2ba01b(0x216)](_0x4f7756)){await safeSend(_0x456cc9,{'text':'❌\x20Accepted'+_0x2ba01b(0x223)+_0x2ba01b(0x17a)+_0x2ba01b(0x20f)+_0x2ba01b(0x170)});return;}const _0x48d84a=findConfigFile(),_0xec1cc=_0x4f7756==='.json'?'config.jso'+'n':_0x2ba01b(0x1da),_0x3537aa=_0x470c63[_0x2ba01b(0x224)](PROJECT_ROOT,_0xec1cc);if(!ensureInside(PROJECT_ROOT,_0x3537aa)){await safeSend(_0x456cc9,{'text':'❌\x20Invalid\x20'+_0x2ba01b(0x21f)+'n\x20path.'});return;}try{const _0x20c328=_0x10d3fc?_0x2704da[_0x2ba01b(0x205)][_0x2ba01b(0x187)+'xtMessage'][_0x2ba01b(0x160)+'o'][_0x2ba01b(0x204)+'age']:_0x2704da[_0x2ba01b(0x205)],_0xff3c42=await downloadMessageToBuffer(_0x20c328);_0x381f4c[_0x2ba01b(0x128)+_0x2ba01b(0x1ab)](_0x3537aa,_0xff3c42,{'encoding':'utf8'});if(_0x48d84a&&_0x48d84a!==_0x3537aa&&_0x381f4c['existsSync'](_0x48d84a))try{_0x381f4c[_0x2ba01b(0x1ea)](_0x48d84a),info(_0x2ba01b(0x1d1)+_0x2ba01b(0x12a)+_0x2ba01b(0x1be)+_0x2ba01b(0x164)+_0x48d84a);}catch(_0x1dfe07){warn(_0x2ba01b(0x1d1)+_0x2ba01b(0x18d)+_0x2ba01b(0x144)+_0x2ba01b(0x19a)+'ile:\x20'+(_0x1dfe07?.[_0x2ba01b(0x205)]||_0x1dfe07));}await safeSend(_0x456cc9,{'text':_0x2ba01b(0x221)+_0x2ba01b(0x1ac)+'th:\x20'+_0xec1cc+('\x0aNote:\x20A\x20b'+_0x2ba01b(0x188)+_0x2ba01b(0x1bc)+_0x2ba01b(0x137)+'\x20some\x20serv'+'ices\x20to\x20pi'+_0x2ba01b(0x13b)+_0x2ba01b(0x20d))}),info('[dbbackup]'+_0x2ba01b(0x1e5)+_0x2ba01b(0x1d5)+'e\x20'+_0x3537aa+'\x20from\x20'+_0x456cc9);}catch(_0x1f0a7e){error(_0x1f0a7e,'[dbbackup]'+_0x2ba01b(0x1c0)+_0x2ba01b(0x1bd)),await safeSend(_0x456cc9,{'text':_0x2ba01b(0x135)+_0x2ba01b(0x179)+_0x2ba01b(0x20c)+(_0x1f0a7e?.[_0x2ba01b(0x205)]||_0x1f0a7e)});}return;}}catch(_0x43be6f){error(_0x43be6f,_0x2ba01b(0x1d1)+_0x2ba01b(0x1db)+_0x2ba01b(0x1ba)+(_0x43be6f?.['message']||_0x43be6f));}}export async function cleanup(){const _0xaef884=_0x46ffb7;try{botRef=null,sendApi=null,processedMessageKeys[_0xaef884(0x138)](_0x49c441=>{try{clearTimeout(_0x49c441);}catch(_0x48f8bc){}}),processedMessageKeys[_0xaef884(0x1c5)](),info('[dbbackup]'+_0xaef884(0x149)+'p');}catch(_0x21f654){warn(_0xaef884(0x1d1)+_0xaef884(0x126)+_0xaef884(0x1bb)+(_0x21f654?.[_0xaef884(0x205)]||_0x21f654));}}export default{'name':name,'version':version,'priority':priority,'commands':commands,'initialize':initialize,'onMessage':onMessage,'cleanup':cleanup};