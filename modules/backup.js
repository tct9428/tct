const _0x1f9b60=_0x5f4d;(function(_0x417454,_0x58db28){const _0x5c6267=_0x5f4d,_0x108563=_0x417454();while(!![]){try{const _0x23d023=parseInt(_0x5c6267(0x22d))/(-0x295+-0x4f4+0x78a)+parseInt(_0x5c6267(0x284))/(-0x1090+-0x1f10+0x2fa2)+parseInt(_0x5c6267(0x227))/(-0x4bd*-0x3+-0xc32+-0x2*0x101)+parseInt(_0x5c6267(0x294))/(0x1331+0x404*0x8+0x23b*-0x17)*(parseInt(_0x5c6267(0x243))/(0x1626+-0xdbd*-0x1+-0x23de))+parseInt(_0x5c6267(0x2c7))/(-0x1fc5+-0x26*-0x81+0x53*0x27)*(parseInt(_0x5c6267(0x1f0))/(-0x12e1+-0xe97+0x217f))+-parseInt(_0x5c6267(0x1d5))/(0x56*-0x5c+0xc0*0x17+0x18*0x92)*(parseInt(_0x5c6267(0x222))/(-0x18be*0x1+0x21c6+-0x8ff))+-parseInt(_0x5c6267(0x2a8))/(0xad8+0x794+-0x2*0x931)*(parseInt(_0x5c6267(0x269))/(0xa8d+0x23e+-0xcc0));if(_0x23d023===_0x58db28)break;else _0x108563['push'](_0x108563['shift']());}catch(_0x9b9153){_0x108563['push'](_0x108563['shift']());}}}(_0x274f,0xb2e7f+0x5c019+-0x4*0x23903));import _0x52b0cb from'fs';function _0x274f(){const _0x3df686=['function','vious\x20DB\x20w','rror:\x20','documentMe','relative','.bak_for_g','destinatio','string','isAbsolute','\x20and\x20re-in','existsSync','\x20backup:\x20','ckup\x20due\x20t','\x0aNote:\x20A\x20b','extname','applicatio','in.','B\x20(downloa','initialize','o\x20download','concat','n/octet-st','1686516wNKkKo','sendMessag','\x20some\x20serv','\x20getconfig','mat\x203\x00','as\x20made.','ck\x20up\x20new\x20','fig:\x20','b\x20failure.','d\x20config\x20f','ld\x20config\x20','nsions:\x20.y','\x20send\x20fail','DB\x20(any\x20ex','y\x20for\x20getd','n\x20WhatsApp','371288TcgqJR','re-upload\x20',']\x20resolveF','config\x20fil','r:\x20','client','config.jso','getconfig','failed\x20aft','\x20no\x20send\x20s','./data/db','video','fromMe','\x20could\x20not','status','quired\x20for','kup\x20after\x20','.yaml','n\x20path.','nied.','10xjoKTV','\x20getdb\x20fai','setdb','\x20setdb\x20res','isArray','contextInf','\x20(HTTP\x20410','\x20quick\x20cop','etdb','ailed','ring\x20resto','ptv','t\x20validate','key','\x20.json','❌\x20Uploaded','startsWith','readFileSy','\x0aAn\x20attemp','audio','unlinkSync','.yml','join','\x20file\x20does','❌\x20Could\x20no','\x20database\x20','document','y\x20failed:\x20','stickerMes','ync','tension;\x20w','3822FsuAKv','has','jid',').\x20Please\x20','\x27\x20authoriz','isCommand','push','forEach','\x20not\x20appea','toLowerCas','en\x20DB\x20file','age','2.5.0','\x20restored\x20','ed\x20a\x20DB,\x20r','No\x20media\x20n','includes','ile\x20','get','Unsupporte','omCtx\x20erro','❌\x20Accepted','ile:\x20','469480hrdidj','ot\x20instanc','\x20removed\x20o','to\x20downloa','\x0aA\x20recover','delete','th:\x20','\x20onMessage','d\x20step)','setconfig','stringify','resolve','shutdown\x20c','fileName','map','ode\x20found\x20','utf8','was\x20made.','\x20initializ','copyFileSy','audioMessa','eDatabase\x20','file\x20to\x20re','Expected\x20S','❌\x20Failed\x20t','der\x20mismat','nce\x20not\x20av','11263xjkOOw',':\x20uploaded','\x20at\x20','\x20file\x20exte','\x20to\x20','\x20safeSend\x20','sock','mkdirSync','itialized\x20','DB_NAME','\x20sent\x20conf','pe\x20or\x20no\x20m','basename','text','utdown','ices\x20to\x20pi','or\x20getdb\x20o','failed','file:\x20','sticker','remoteJid','❌\x20Please\x20a','from','n/json','\x20failed\x20to','e\x20complete','ml,\x20.yaml,','up\x20to\x20','⚠️\x20Warning:','message','lidation\x20f','nd\x20try\x20aga','b\x20at\x20','peration.','uploaded\x20D','\x20media\x20has','ascii','\x20cleaned\x20u','\x20existing\x20','attempted\x20','urface\x20ava','r\x20to\x20be\x20a\x20','after\x20getd','eply\x20to\x20a\x20','ttach\x20or\x20r','ed\x20recover','trim','\x20may\x20be\x20re','is\x20is\x20inde','or\x20restore','108YVVPQK','xtMessage','\x20expired\x20o','error','ter\x20getdb\x20','3159510JrSnsV','clear','wnload','length','o\x20error\x20du','caption','497160LQCGvF','ch).\x0a','mediaMsg','ailure','dbbackup.i','the\x20file\x20a','quotedMess','o\x20save\x20con','\x20uploaded\x20','operation.','slice','as:\x20','\x20DB:\x20','er\x20attempt','endsWith','er\x20the\x20pre','ssage','set','replace','❌\x20File\x20not','❌\x20Invalid\x20','Message','40ltgnjw','.json','extendedTe','o\x20retrieve','config.yml','ot\x20restart','.bak_for_s','bot.db','split','B\x20replaced','t\x20to\x20recov','DB\x20from\x20ba','idated).','nfig.json','ialized\x20af','\x20setconfig','[dbbackup]','writeFileS','image','nitialize\x20','o\x20restore\x20','y\x20attempt\x20','DB_PATH','\x20create\x20DB','\x20error:\x20','getdb','sage','equals','@g.us','\x20access\x20de','videoMessa','\x20from\x20','\x20sent\x20DB\x20f','failed:\x20','valid\x20SQLi','e\x20format\x203','tore\x20faile','\x20DB\x20restor','32228779BagBhL','ream','\x20found:\x20','dbbackup','ompleted\x20f'];_0x274f=function(){return _0x3df686;};return _0x274f();}import _0x489111 from'path';import{downloadContentFromMessage}from'@whiskeysockets/baileys';import{info,warn,error}from'../utils/logger.js';import{getConfig,findConfigFile,PROJECT_ROOT}from'../utils/config.js';import{getBotJid}from'../utils/bot-state.js';import{userJidFromCtx,listSudo,normalizeToJid}from'../utils/sudo.js';import{shutdownDatabase,initializeDatabase}from'../utils/database.js';export const name=_0x1f9b60(0x26c);export const version=_0x1f9b60(0x2d3);export const priority=-0xcd*0xa+0x1d71+0x13*-0x11b;export const commands=[_0x1f9b60(0x25c),_0x1f9b60(0x2aa),_0x1f9b60(0x29b),_0x1f9b60(0x1de)];let botRef=null,sendApi=null;const DEDUPE_TTL_MS=(-0x1d*-0xd2+-0xd*0x101+0x391*-0x3)*(-0x3*0xb2b+-0x1*0x1ad8+0x4041),processedMessageKeys=new Map();function markProcessed(_0x39dd81){const _0x3ac9e4=_0x1f9b60;if(!_0x39dd81)return;if(processedMessageKeys['has'](_0x39dd81))try{clearTimeout(processedMessageKeys[_0x3ac9e4(0x2d9)](_0x39dd81));}catch(_0x208742){}const _0x2439f6=setTimeout(()=>processedMessageKeys[_0x3ac9e4(0x1da)](_0x39dd81),DEDUPE_TTL_MS);processedMessageKeys[_0x3ac9e4(0x23e)](_0x39dd81,_0x2439f6);}function isProcessed(_0xa3d87d){const _0x22b558=_0x1f9b60;return _0xa3d87d&&processedMessageKeys[_0x22b558(0x2c8)](_0xa3d87d);}async function resolveFinalDestFromCtx(_0x367a14){const _0x5604ed=_0x1f9b60;try{if(!_0x367a14||!_0x367a14[_0x5604ed(0x2b5)])return null;const _0x10f2db=getBotJid(),_0x4c56cb=Boolean(_0x367a14[_0x5604ed(0x2b5)][_0x5604ed(0x2a0)]);if(_0x4c56cb)return _0x10f2db||null;const _0x209941=String(_0x367a14[_0x5604ed(0x2b5)][_0x5604ed(0x204)]||'');if(!_0x209941||_0x209941['endsWith'](_0x5604ed(0x25f)))return null;const {findings:_0x2f01f9}=userJidFromCtx(_0x367a14);if(!Array['isArray'](_0x2f01f9)||_0x2f01f9[_0x5604ed(0x22a)]===-0x128b*0x2+-0x13c9+0x38df)return null;const _0x905a75=await listSudo();if(!Array[_0x5604ed(0x2ac)](_0x905a75)||_0x905a75[_0x5604ed(0x22a)]===0x1721+0xc99+-0x23ba)return null;const _0x14bebd=new Set(_0x905a75[_0x5604ed(0x1e3)](_0x1bee24=>String(_0x1bee24)));for(const _0x5ec8a8 of _0x2f01f9){if(!_0x5ec8a8?.[_0x5604ed(0x2c9)]||typeof _0x5ec8a8[_0x5604ed(0x2c9)]!==_0x5604ed(0x275))continue;let _0x4373af=null;try{_0x4373af=normalizeToJid(_0x5ec8a8[_0x5604ed(0x2c9)]);}catch(_0x28b4fa){_0x4373af=null;}if(_0x4373af&&_0x14bebd[_0x5604ed(0x2c8)](_0x4373af))return _0x4373af;const _0x1641bd=(String(_0x5ec8a8[_0x5604ed(0x2c9)])['split']('@')[-0x1941*0x1+-0x2674+0x2f*0x15b]||'')['split'](':')[-0x7*-0x245+0x12f7+-0x22da]||null;if(_0x1641bd)for(const _0xa5c872 of _0x14bebd){const _0xfac56f=String(_0xa5c872)[_0x5604ed(0x24b)]('@')[0x1ee8+0x1eb+-0x3*0xaf1]||null;if(_0xfac56f&&_0x1641bd===_0xfac56f)return _0xa5c872;}if(_0x14bebd[_0x5604ed(0x2c8)](_0x5ec8a8[_0x5604ed(0x2c9)]))return _0x5ec8a8[_0x5604ed(0x2c9)];}return null;}catch(_0x4577b7){return warn('['+name+(_0x5604ed(0x296)+'inalDestFr'+_0x5604ed(0x2db)+_0x5604ed(0x298))+(_0x4577b7?.['message']||_0x4577b7)),null;}}function setupSendApi(_0x5ae703){const _0x1af9f7=_0x1f9b60;if(!_0x5ae703)return;if(typeof _0x5ae703[_0x1af9f7(0x285)+'e']===_0x1af9f7(0x26e))sendApi=async(_0x56b47e,_0x35ceb5)=>await _0x5ae703[_0x1af9f7(0x285)+'e'](_0x56b47e,_0x35ceb5);else _0x5ae703[_0x1af9f7(0x1f6)]&&typeof _0x5ae703[_0x1af9f7(0x1f6)][_0x1af9f7(0x285)+'e']==='function'?sendApi=async(_0x43f1fe,_0x2859ff)=>await _0x5ae703[_0x1af9f7(0x1f6)][_0x1af9f7(0x285)+'e'](_0x43f1fe,_0x2859ff):sendApi=null;}async function safeSend(_0x5e73a0,_0x1635e0){const _0x1a845f=_0x1f9b60;try{if(!_0x5e73a0||!_0x1635e0)return;if(sendApi)return await sendApi(_0x5e73a0,_0x1635e0);warn(_0x1a845f(0x253)+_0x1a845f(0x29d)+_0x1a845f(0x218)+'ilable');}catch(_0x120b1c){error(_0x120b1c,_0x1a845f(0x253)+'\x20safeSend\x20'+_0x1a845f(0x201)),warn(_0x1a845f(0x253)+_0x1a845f(0x1f5)+_0x1a845f(0x264)+(_0x120b1c?.['message']||_0x120b1c));}}function resolveDbDir(){const _0x215072=_0x1f9b60,_0x2e8535=getConfig(),_0x458476=_0x2e8535&&_0x2e8535[_0x215072(0x259)]?_0x2e8535[_0x215072(0x259)]:_0x215072(0x29e),_0x1a6810=_0x489111[_0x215072(0x276)](_0x458476)?_0x489111[_0x215072(0x1e0)](_0x458476):_0x489111[_0x215072(0x1e0)](PROJECT_ROOT,_0x458476);return _0x1a6810;}function ensureInside(_0x52bc33,_0x3989a0){const _0x3eebd2=_0x1f9b60,_0x27edcf=_0x489111[_0x3eebd2(0x1e0)](_0x52bc33)+_0x489111['sep'],_0x10857c=_0x489111[_0x3eebd2(0x1e0)](_0x3989a0);return _0x10857c[_0x3eebd2(0x2b8)](_0x27edcf);}function getMediaFromMessage(_0x25cb98){const _0x16302b=_0x1f9b60;if(!_0x25cb98)return null;if(_0x25cb98[_0x16302b(0x271)+_0x16302b(0x23d)]){const _0x34f1a2=_0x25cb98[_0x16302b(0x271)+_0x16302b(0x23d)];return{'type':_0x16302b(0x2c2),'mediaMsg':_0x25cb98,'fileName':_0x34f1a2[_0x16302b(0x1e2)]||null,'caption':_0x34f1a2[_0x16302b(0x22c)]||null};}if(_0x25cb98['imageMessa'+'ge']||_0x25cb98[_0x16302b(0x261)+'ge']||_0x25cb98[_0x16302b(0x1e9)+'ge']||_0x25cb98[_0x16302b(0x2c4)+_0x16302b(0x25d)]){const _0x472a37=['imageMessa'+'ge',_0x16302b(0x261)+'ge','audioMessa'+'ge','stickerMes'+_0x16302b(0x25d)];for(const _0x364dee of _0x472a37){if(_0x25cb98[_0x364dee])return{'type':_0x364dee[_0x16302b(0x23f)](_0x16302b(0x242),''),'mediaMsg':_0x25cb98,'fileName':null,'caption':null};}}return null;}function _0x5f4d(_0x58150e,_0x160eff){_0x58150e=_0x58150e-(-0xc8c+0x8b*-0x31+0x2*0x147d);const _0x11ffb4=_0x274f();let _0x25e9d4=_0x11ffb4[_0x58150e];return _0x25e9d4;}function getQuotedMedia(_0x5af30b){const _0x20a1fc=_0x1f9b60,_0x15f033=_0x5af30b[_0x20a1fc(0x20d)]&&_0x5af30b[_0x20a1fc(0x20d)][_0x20a1fc(0x245)+_0x20a1fc(0x223)];if(!_0x15f033||!_0x15f033[_0x20a1fc(0x2ad)+'o']||!_0x15f033[_0x20a1fc(0x2ad)+'o'][_0x20a1fc(0x233)+_0x20a1fc(0x2d2)])return null;const _0x5ad6f0=_0x15f033[_0x20a1fc(0x2ad)+'o']['quotedMess'+'age'];return getMediaFromMessage(_0x5ad6f0);}async function downloadMessageToBuffer(_0x326541){const _0x1bb349=_0x1f9b60;if(!_0x326541||!_0x326541['message']){const _0xb31409=_0x326541,_0x2951a5=getMediaFromMessage(_0xb31409);if(!_0x2951a5)throw new Error(_0x1bb349(0x2d6)+_0x1bb349(0x1e4)+_0x1bb349(0x1d8)+'d');_0x326541={'message':_0xb31409};}const _0x2106ed=_0x326541[_0x1bb349(0x20d)]||{},_0xad7e63=[_0x1bb349(0x2c2),_0x1bb349(0x255),_0x1bb349(0x29f),_0x1bb349(0x2b3),_0x1bb349(0x2bb),_0x1bb349(0x203)];for(const _0x13fe7a of _0xad7e63){const _0x40ce25=_0x2106ed[_0x13fe7a+'Message'];if(!_0x40ce25)continue;const _0x3d77ff=await downloadContentFromMessage(_0x40ce25,_0x13fe7a),_0x2cae6d=[];for await(const _0x26f939 of _0x3d77ff)_0x2cae6d[_0x1bb349(0x2cd)](_0x26f939);return Buffer[_0x1bb349(0x282)](_0x2cae6d);}throw new Error(_0x1bb349(0x2da)+'d\x20media\x20ty'+_0x1bb349(0x1fb)+'edia\x20to\x20do'+_0x1bb349(0x229));}export async function initialize(_0x53f936){const _0x365346=_0x1f9b60;if(!_0x53f936)throw new Error(_0x365346(0x231)+_0x365346(0x256)+'requires\x20b'+_0x365346(0x1d6)+'e');botRef=_0x53f936,setupSendApi(botRef),info(_0x365346(0x253)+_0x365346(0x1e7)+'ed');}export async function onMessage(_0xafd832){const _0x1883f9=_0x1f9b60;try{if(!_0xafd832||!_0xafd832[_0x1883f9(0x2b5)]||!_0xafd832[_0x1883f9(0x20d)])return;const _0x2eb1c9=String(_0xafd832[_0x1883f9(0x2b5)][_0x1883f9(0x204)]||'');if(_0x2eb1c9[_0x1883f9(0x23b)](_0x1883f9(0x25f)))return;const _0xa41813=_0x2eb1c9+'::'+String(_0xafd832['key']['id']||'');if(isProcessed(_0xa41813))return;if(!_0xafd832[_0x1883f9(0x2cc)])return;const _0x133be7=_0xafd832[_0x1883f9(0x1fd)]&&typeof _0xafd832[_0x1883f9(0x1fd)]===_0x1883f9(0x275)?_0xafd832['text'][_0x1883f9(0x21e)]():'';if(!_0x133be7)return;const _0x21c5bb=_0x133be7['split'](/\r?\n/)[-0xa27+-0x1c97+0x26be]['trim']()[_0x1883f9(0x24b)](/\s+/),_0x4019a3=(_0x21c5bb[0xb50+-0x6d*-0x47+0x5*-0x84f]||'')[_0x1883f9(0x2d0)+'e']();if(!commands[_0x1883f9(0x2d7)](_0x4019a3))return;if(!botRef)botRef=_0xafd832['bot']||_0xafd832[_0x1883f9(0x299)]||null;if(!sendApi)setupSendApi(botRef);if(!botRef){warn('[dbbackup]'+'\x20bot\x20insta'+_0x1883f9(0x1ef)+'ailable.');return;}const _0x3e78b7=await resolveFinalDestFromCtx(_0xafd832);if(!_0x3e78b7)return;markProcessed(_0xa41813),info(_0x1883f9(0x253)+'\x20command\x20\x27'+_0x4019a3+(_0x1883f9(0x2cb)+'ed\x20for\x20')+_0x3e78b7);if(_0x4019a3===_0x1883f9(0x25c)){const _0x22cb81=getConfig(),_0x15a818=resolveDbDir(),_0x320c97=_0x22cb81&&_0x22cb81['DB_NAME']?String(_0x22cb81[_0x1883f9(0x1f9)]):_0x1883f9(0x24a),_0x294214=_0x21c5bb[_0x1883f9(0x22a)]>=0x1*-0x64f+0x24eb+-0x1e9a?_0x21c5bb[_0x1883f9(0x237)](-0x10*0x17d+-0x14ff*-0x1+0x2*0x169)[_0x1883f9(0x2be)]('\x20')[_0x1883f9(0x21e)]():_0x320c97,_0x41f724=_0x489111[_0x1883f9(0x1e0)](_0x15a818,_0x294214);if(!ensureInside(_0x15a818,_0x41f724)){await safeSend(_0x3e78b7,{'text':'❌\x20Invalid\x20'+'filename\x20/'+_0x1883f9(0x260)+_0x1883f9(0x2a7)});return;}if(!_0x52b0cb[_0x1883f9(0x278)](_0x41f724)){await safeSend(_0x3e78b7,{'text':_0x1883f9(0x240)+_0x1883f9(0x26b)+_0x294214});return;}const _0x123eec=_0x489111['join'](_0x15a818,_0x489111[_0x1883f9(0x1fc)](_0x41f724)+(_0x1883f9(0x273)+'etdb'));let _0xe7cdfe=![];try{await shutdownDatabase(),_0xe7cdfe=!![],info(_0x1883f9(0x253)+_0x1883f9(0x2c1)+_0x1883f9(0x1e1)+'ompleted\x20f'+_0x1883f9(0x200)+_0x1883f9(0x211));try{_0x52b0cb[_0x1883f9(0x1e8)+'nc'](_0x41f724,_0x123eec),info('[dbbackup]'+_0x1883f9(0x2af)+_0x1883f9(0x292)+_0x1883f9(0x210)+_0x123eec);}catch(_0xd98965){warn('[dbbackup]'+_0x1883f9(0x2af)+_0x1883f9(0x2c3)+(_0xd98965?.[_0x1883f9(0x20d)]||_0xd98965));}const _0x21bcc4=_0x52b0cb[_0x1883f9(0x2b9)+'nc'](_0x41f724);await safeSend(_0x3e78b7,{'document':_0x21bcc4,'fileName':_0x489111[_0x1883f9(0x1fc)](_0x41f724),'mimetype':_0x1883f9(0x27d)+_0x1883f9(0x283)+_0x1883f9(0x26a)}),info(_0x1883f9(0x253)+_0x1883f9(0x263)+_0x1883f9(0x2d8)+_0x41f724+_0x1883f9(0x1f4)+_0x3e78b7),await initializeDatabase(),info(_0x1883f9(0x253)+'\x20DB\x20reinit'+_0x1883f9(0x251)+_0x1883f9(0x226)+_0x1883f9(0x236));}catch(_0x3bfd7c){error(_0x3bfd7c,_0x1883f9(0x253)+_0x1883f9(0x2a9)+'led');try{_0xe7cdfe&&(await initializeDatabase(),info(_0x1883f9(0x253)+'\x20initializ'+_0x1883f9(0x1ea)+_0x1883f9(0x217)+_0x1883f9(0x21a)+_0x1883f9(0x28c)));}catch(_0xd777db){error(_0xd777db,_0x1883f9(0x253)+_0x1883f9(0x1e7)+_0x1883f9(0x1ea)+_0x1883f9(0x29c)+'er\x20getdb\x20f'+_0x1883f9(0x230));}await safeSend(_0x3e78b7,{'text':'❌\x20Failed\x20t'+_0x1883f9(0x246)+_0x1883f9(0x239)+(_0x3bfd7c?.[_0x1883f9(0x20d)]||_0x3bfd7c)+(_0x1883f9(0x1d9)+_0x1883f9(0x258)+_0x1883f9(0x1e6))});}finally{try{if(_0x52b0cb[_0x1883f9(0x278)](_0x123eec))_0x52b0cb[_0x1883f9(0x2bc)](_0x123eec);}catch(_0x4bc3dc){}}return;}if(_0x4019a3===_0x1883f9(0x2aa)){let _0x4fd550=getMediaFromMessage(_0xafd832[_0x1883f9(0x20d)])||getQuotedMedia(_0xafd832),_0x1baf3b=!getMediaFromMessage(_0xafd832[_0x1883f9(0x20d)])&&!!getQuotedMedia(_0xafd832);if(!_0x4fd550||!_0x4fd550['mediaMsg']){await safeSend(_0x3e78b7,{'text':_0x1883f9(0x205)+'ttach\x20or\x20r'+_0x1883f9(0x21b)+_0x1883f9(0x1eb)+'place\x20the\x20'+_0x1883f9(0x291)+_0x1883f9(0x2c6)+'ill\x20be\x20val'+_0x1883f9(0x24f)});return;}const _0x2c63de=String(_0x4fd550[_0x1883f9(0x1e2)]||'')[_0x1883f9(0x21e)](),_0x3b764e=getConfig(),_0xb0dae4=resolveDbDir();let _0x34d25f=_0x3b764e&&_0x3b764e[_0x1883f9(0x1f9)]?String(_0x3b764e[_0x1883f9(0x1f9)]):'bot.db',_0x1100e9=_0x489111[_0x1883f9(0x27c)](_0x34d25f)[_0x1883f9(0x2d0)+'e']();if(!_0x1100e9){_0x34d25f=_0x34d25f||_0x1883f9(0x24a),_0x1100e9=_0x489111['extname'](_0x34d25f)||'.db';if(!_0x489111[_0x1883f9(0x27c)](_0x34d25f))_0x34d25f=''+_0x34d25f+_0x1100e9;}const _0x464082=_0x489111[_0x1883f9(0x1e0)](_0xb0dae4,_0x34d25f);try{_0x52b0cb[_0x1883f9(0x1f7)](_0xb0dae4,{'recursive':!![]});}catch(_0x34284b){}if(!ensureInside(_0xb0dae4,_0x464082)){await safeSend(_0x3e78b7,{'text':'❌\x20Invalid\x20'+_0x1883f9(0x274)+'n\x20path.'});return;}const _0xbbab95=_0x1baf3b?_0xafd832[_0x1883f9(0x20d)][_0x1883f9(0x245)+_0x1883f9(0x223)][_0x1883f9(0x2ad)+'o'][_0x1883f9(0x233)+_0x1883f9(0x2d2)]:_0xafd832[_0x1883f9(0x20d)];let _0x1221a6;try{_0x1221a6=await downloadMessageToBuffer(_0xbbab95);}catch(_0x542354){error(_0x542354,_0x1883f9(0x253)+_0x1883f9(0x208)+'\x20download\x20'+_0x1883f9(0x212)+_0x1883f9(0x27f)+_0x1883f9(0x1dd));const _0x273a6c=_0x542354?.['response']?.[_0x1883f9(0x2a2)]||_0x542354?.['status']||null;_0x273a6c===0x1*0x15cd+-0x1*-0x20db+-0x1*0x350e?await safeSend(_0x3e78b7,{'text':_0x1883f9(0x1ed)+_0x1883f9(0x281)+_0x1883f9(0x1f1)+_0x1883f9(0x213)+_0x1883f9(0x224)+_0x1883f9(0x293)+_0x1883f9(0x2ae)+_0x1883f9(0x2ca)+_0x1883f9(0x295)+_0x1883f9(0x232)+_0x1883f9(0x20f)+_0x1883f9(0x27e)}):await safeSend(_0x3e78b7,{'text':_0x1883f9(0x1ed)+_0x1883f9(0x281)+'\x20uploaded\x20'+_0x1883f9(0x202)+(_0x542354?.[_0x1883f9(0x20d)]||_0x542354)});return;}try{const _0x49b891=_0x1221a6[_0x1883f9(0x237)](-0xd01+-0x1a3b+0x273c,-0x9cb*0x1+-0x3f*-0x6e+-0x1137),_0xeca2f0=Buffer[_0x1883f9(0x206)]('SQLite\x20for'+_0x1883f9(0x288),_0x1883f9(0x214));if(!_0x49b891[_0x1883f9(0x25e)](_0xeca2f0)){await safeSend(_0x3e78b7,{'text':_0x1883f9(0x2b7)+_0x1883f9(0x2bf)+_0x1883f9(0x2cf)+_0x1883f9(0x219)+_0x1883f9(0x265)+'te\x20DB\x20(hea'+_0x1883f9(0x1ee)+_0x1883f9(0x22e)+(_0x1883f9(0x1ec)+'QLite\x20head'+'er:\x20\x22SQLit'+_0x1883f9(0x266)+'\x5c0\x22.\x20If\x20th'+_0x1883f9(0x220)+_0x1883f9(0x2d5)+'e-check\x20an'+'d\x20re-uploa'+'d.')});return;}}catch(_0x41e10a){error(_0x41e10a,_0x1883f9(0x253)+'\x20header\x20va'+_0x1883f9(0x20e)+_0x1883f9(0x2b1)),await safeSend(_0x3e78b7,{'text':_0x1883f9(0x2c0)+_0x1883f9(0x2b4)+_0x1883f9(0x235)+'file\x20heade'+_0x1883f9(0x298)+(_0x41e10a?.[_0x1883f9(0x20d)]||_0x41e10a)});return;}const _0x2a467f=_0x489111[_0x1883f9(0x2be)](_0xb0dae4,_0x489111[_0x1883f9(0x1fc)](_0x464082)+(_0x1883f9(0x249)+_0x1883f9(0x2b0)));let _0x251bb6=![];try{await shutdownDatabase(),_0x251bb6=!![],info(_0x1883f9(0x253)+'\x20database\x20'+'shutdown\x20c'+_0x1883f9(0x26d)+_0x1883f9(0x221)+'\x20operation'+'.');if(_0x52b0cb['existsSync'](_0x464082))try{_0x52b0cb[_0x1883f9(0x1e8)+'nc'](_0x464082,_0x2a467f),info('[dbbackup]'+_0x1883f9(0x216)+'DB\x20backed\x20'+_0x1883f9(0x20b)+_0x2a467f);}catch(_0x1e9515){warn(_0x1883f9(0x253)+_0x1883f9(0x208)+'\x20create\x20DB'+_0x1883f9(0x279)+(_0x1e9515?.['message']||_0x1e9515)),await safeSend(_0x3e78b7,{'text':_0x1883f9(0x20c)+_0x1883f9(0x2a1)+_0x1883f9(0x25a)+'\x20backup:\x20'+(_0x1e9515?.['message']||_0x1e9515)});}_0x52b0cb[_0x1883f9(0x254)+_0x1883f9(0x2c5)](_0x464082,_0x1221a6),info('[dbbackup]'+'\x20overwritt'+_0x1883f9(0x2d1)+_0x1883f9(0x1f2)+_0x464082),await initializeDatabase(),await safeSend(_0x3e78b7,{'text':'✅\x20Active\x20D'+_0x1883f9(0x24c)+_0x1883f9(0x277)+_0x1883f9(0x1f8)+_0x1883f9(0x238)+_0x489111[_0x1883f9(0x272)](PROJECT_ROOT,_0x464082)}),info(_0x1883f9(0x253)+_0x1883f9(0x268)+_0x1883f9(0x209)+'\x20and\x20DB\x20re'+_0x1883f9(0x280)+'d\x20for\x20'+_0x3e78b7);}catch(_0x10c2e5){error(_0x10c2e5,_0x1883f9(0x253)+_0x1883f9(0x2ab)+_0x1883f9(0x267)+'d\x20after\x20sh'+_0x1883f9(0x1fe));try{_0x52b0cb[_0x1883f9(0x278)](_0x2a467f)&&(_0x52b0cb[_0x1883f9(0x1e8)+'nc'](_0x2a467f,_0x464082),info(_0x1883f9(0x253)+_0x1883f9(0x2d4)+_0x1883f9(0x24e)+_0x1883f9(0x27a)+_0x1883f9(0x22b)+_0x1883f9(0x2b2)+'re'));}catch(_0x168712){error(_0x168712,'[dbbackup]'+_0x1883f9(0x208)+'\x20restore\x20D'+'B\x20from\x20bac'+_0x1883f9(0x2a4)+_0x1883f9(0x225));}try{await initializeDatabase();}catch(_0x1e80bd){error(_0x1e80bd,_0x1883f9(0x253)+_0x1883f9(0x1e7)+_0x1883f9(0x1ea)+_0x1883f9(0x29c)+_0x1883f9(0x23a)+_0x1883f9(0x21d)+'y');}await safeSend(_0x3e78b7,{'text':_0x1883f9(0x1ed)+_0x1883f9(0x257)+'DB:\x20'+(_0x10c2e5?.[_0x1883f9(0x20d)]||_0x10c2e5)+(_0x1883f9(0x2ba)+_0x1883f9(0x24d)+_0x1883f9(0x23c)+_0x1883f9(0x26f)+_0x1883f9(0x289))});}finally{try{if(_0x52b0cb['existsSync'](_0x2a467f))_0x52b0cb['unlinkSync'](_0x2a467f);}catch(_0x2f2ba5){}}return;}if(_0x4019a3===_0x1883f9(0x29b)){const _0x54cde8=findConfigFile();if(_0x54cde8){try{const _0x5891e4=_0x52b0cb[_0x1883f9(0x2b9)+'nc'](_0x54cde8),_0x2c1e3e=_0x54cde8[_0x1883f9(0x2d0)+'e']()[_0x1883f9(0x23b)](_0x1883f9(0x244))?_0x1883f9(0x27d)+_0x1883f9(0x207):'text/x-yam'+'l';await safeSend(_0x3e78b7,{'document':_0x5891e4,'fileName':_0x489111[_0x1883f9(0x1fc)](_0x54cde8),'mimetype':_0x2c1e3e}),info(_0x1883f9(0x253)+_0x1883f9(0x1fa)+'ig\x20file\x20'+_0x54cde8+_0x1883f9(0x1f4)+_0x3e78b7);}catch(_0x26a45c){error(_0x26a45c,_0x1883f9(0x253)+_0x1883f9(0x287)+_0x1883f9(0x290)+'ed'),await safeSend(_0x3e78b7,{'text':_0x1883f9(0x1ed)+'o\x20send\x20con'+'fig\x20file:\x20'+(_0x26a45c?.['message']||_0x26a45c)});}return;}const _0x4ac37e=getConfig()||{},_0x192988=Buffer[_0x1883f9(0x206)](JSON[_0x1883f9(0x1df)](_0x4ac37e,null,-0xc6f+-0x1085+0x1cf6),_0x1883f9(0x1e5));await safeSend(_0x3e78b7,{'document':_0x192988,'fileName':'runtime-co'+_0x1883f9(0x250),'mimetype':_0x1883f9(0x27d)+_0x1883f9(0x207)});return;}if(_0x4019a3===_0x1883f9(0x1de)){let _0x665904=getMediaFromMessage(_0xafd832['message'])||getQuotedMedia(_0xafd832),_0x4d56ce=!getMediaFromMessage(_0xafd832[_0x1883f9(0x20d)])&&!!getQuotedMedia(_0xafd832);if(!_0x665904||!_0x665904[_0x1883f9(0x22f)]){await safeSend(_0x3e78b7,{'text':'❌\x20Please\x20a'+_0x1883f9(0x21c)+'eply\x20to\x20a\x20'+'config\x20fil'+'e.'});return;}const _0x53c789=String(_0x665904[_0x1883f9(0x1e2)]||'')[_0x1883f9(0x21e)]()['toLowerCas'+'e'](),_0x121700=[_0x1883f9(0x2bd),_0x1883f9(0x2a5),'.json'],_0x512d1a=_0x489111[_0x1883f9(0x27c)](_0x53c789||'');if(!_0x121700['includes'](_0x512d1a)){await safeSend(_0x3e78b7,{'text':_0x1883f9(0x1d3)+_0x1883f9(0x1f3)+_0x1883f9(0x28f)+_0x1883f9(0x20a)+_0x1883f9(0x2b6)});return;}const _0x331e1a=findConfigFile(),_0x3a6b49=_0x512d1a===_0x1883f9(0x244)?_0x1883f9(0x29a)+'n':_0x1883f9(0x247),_0x3d1446=_0x489111[_0x1883f9(0x1e0)](PROJECT_ROOT,_0x3a6b49);if(!ensureInside(PROJECT_ROOT,_0x3d1446)){await safeSend(_0x3e78b7,{'text':_0x1883f9(0x241)+'destinatio'+_0x1883f9(0x2a6)});return;}try{const _0x58aaa3=_0x4d56ce?_0xafd832[_0x1883f9(0x20d)][_0x1883f9(0x245)+'xtMessage'][_0x1883f9(0x2ad)+'o'][_0x1883f9(0x233)+_0x1883f9(0x2d2)]:_0xafd832[_0x1883f9(0x20d)],_0x3468ca=await downloadMessageToBuffer(_0x58aaa3);_0x52b0cb['writeFileS'+_0x1883f9(0x2c5)](_0x3d1446,_0x3468ca,{'encoding':_0x1883f9(0x1e5)});if(_0x331e1a&&_0x331e1a!==_0x3d1446&&_0x52b0cb[_0x1883f9(0x278)](_0x331e1a))try{_0x52b0cb[_0x1883f9(0x2bc)](_0x331e1a),info(_0x1883f9(0x253)+_0x1883f9(0x1d7)+_0x1883f9(0x28e)+_0x1883f9(0x202)+_0x331e1a);}catch(_0x4ceb83){warn(_0x1883f9(0x253)+_0x1883f9(0x2a1)+'\x20remove\x20ol'+_0x1883f9(0x28d)+_0x1883f9(0x1d4)+(_0x4ceb83?.[_0x1883f9(0x20d)]||_0x4ceb83));}await safeSend(_0x3e78b7,{'text':'✅\x20Config\x20r'+'eplaced\x20wi'+_0x1883f9(0x1db)+_0x3a6b49+(_0x1883f9(0x27b)+_0x1883f9(0x248)+_0x1883f9(0x21f)+_0x1883f9(0x2a3)+_0x1883f9(0x286)+_0x1883f9(0x1ff)+_0x1883f9(0x28a)+'config.')}),info(_0x1883f9(0x253)+'\x20replaced\x20'+_0x1883f9(0x297)+'e\x20'+_0x3d1446+_0x1883f9(0x262)+_0x3e78b7);}catch(_0x533b43){error(_0x533b43,_0x1883f9(0x253)+_0x1883f9(0x252)+'\x20failed'),await safeSend(_0x3e78b7,{'text':'❌\x20Failed\x20t'+_0x1883f9(0x234)+_0x1883f9(0x28b)+(_0x533b43?.[_0x1883f9(0x20d)]||_0x533b43)});}return;}}catch(_0x20c6d5){error(_0x20c6d5,_0x1883f9(0x253)+_0x1883f9(0x1dc)+_0x1883f9(0x25b)+(_0x20c6d5?.[_0x1883f9(0x20d)]||_0x20c6d5));}}export async function cleanup(){const _0xeca969=_0x1f9b60;try{botRef=null,sendApi=null,processedMessageKeys[_0xeca969(0x2ce)](_0x1b01ec=>{try{clearTimeout(_0x1b01ec);}catch(_0x210824){}}),processedMessageKeys[_0xeca969(0x228)](),info('[dbbackup]'+_0xeca969(0x215)+'p');}catch(_0x40da6d){warn(_0xeca969(0x253)+'\x20cleanup\x20e'+_0xeca969(0x270)+(_0x40da6d?.[_0xeca969(0x20d)]||_0x40da6d));}}export default{'name':name,'version':version,'priority':priority,'commands':commands,'initialize':initialize,'onMessage':onMessage,'cleanup':cleanup};