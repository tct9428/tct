const _0x491680=_0x21e9;(function(_0x22943f,_0x2127ad){const _0x13d0d2=_0x21e9,_0x365a6a=_0x22943f();while(!![]){try{const _0x3256f8=-parseInt(_0x13d0d2(0x208))/(0x23d6+-0x1904*0x1+-0xad1)+parseInt(_0x13d0d2(0x244))/(-0x2c6+0x14fe+-0x1236)+parseInt(_0x13d0d2(0x1fa))/(0x65*-0x53+-0x67+0x2129)+-parseInt(_0x13d0d2(0x1f1))/(-0x253d*-0x1+0x2*0x3a3+0x3*-0xed5)*(-parseInt(_0x13d0d2(0x243))/(0x102a*-0x2+0x1bbd+0x49c))+-parseInt(_0x13d0d2(0x261))/(-0x6*0x53e+0x1eb*0x1+-0x7*-0x439)+-parseInt(_0x13d0d2(0x231))/(-0x1716+0x104b+0x6d2)*(-parseInt(_0x13d0d2(0x239))/(-0x1*-0x1c81+0x1ee2+-0x1*0x3b5b))+-parseInt(_0x13d0d2(0x20a))/(-0xec*-0x6+-0x12f6+0x17f*0x9);if(_0x3256f8===_0x2127ad)break;else _0x365a6a['push'](_0x365a6a['shift']());}catch(_0x4d0f45){_0x365a6a['push'](_0x365a6a['shift']());}}}(_0x4f09,-0x3522*0x1+-0x163*-0x719+-0x2873b));import{readFileSync}from'fs';import{join}from'path';import{DateTime}from'luxon';import{info,warn,error}from'../utils/logger.js';import{getConfig,hotReloadConfig}from'../utils/config.js';import{isSudo,userJidFromCtx,listSudo,normalizeToJid}from'../utils/sudo.js';import{getBotJid,getBotJidRaw}from'../utils/bot-state.js';export const name=_0x491680(0x212);export const version='1.1.0';export const priority=0x31a+-0x175f+-0x6c5*-0x3;let botInstance=null,respondedMsgIds=new Set(),DEFAULT_TIMEZONE=_0x491680(0x1de)+'robi';const timeDataPath=join(process[_0x491680(0x25a)](),_0x491680(0x223),_0x491680(0x212),_0x491680(0x24a));let COUNTRY_TIMEZONES={},CITY_MAP={};function _0x21e9(_0x3faeb5,_0x130c9c){const _0x337945=_0x4f09();return _0x21e9=function(_0x1329c3,_0x1b6d51){_0x1329c3=_0x1329c3-(-0x2*-0x829+-0x1*-0x188b+0x5*-0x7cd);let _0xb57f4e=_0x337945[_0x1329c3];return _0xb57f4e;},_0x21e9(_0x3faeb5,_0x130c9c);}try{const timeData=JSON[_0x491680(0x1e5)](readFileSync(timeDataPath,_0x491680(0x237)));COUNTRY_TIMEZONES=timeData[_0x491680(0x25f)+_0x491680(0x1e2)]||{},CITY_MAP=timeData[_0x491680(0x236)]||{},info(name+(_0x491680(0x22a)+_0x491680(0x1df)+_0x491680(0x265)+_0x491680(0x1fe)));}catch(_0x45cccd){warn(name+(_0x491680(0x225)+_0x491680(0x264)+_0x491680(0x1f3)+'ings:\x20')+_0x45cccd[_0x491680(0x1ec)]),COUNTRY_TIMEZONES={'kenya':_0x491680(0x1de)+'robi','uk':'Europe/Lon'+_0x491680(0x245),'usa':_0x491680(0x23a)+_0x491680(0x202)},CITY_MAP={'nairobi':_0x491680(0x1de)+'robi','london':_0x491680(0x242)+'don','new\x20york':'America/Ne'+_0x491680(0x202)};}function refreshConfig(){const _0x368c7e=_0x491680;try{const _0x377c15=typeof getConfig===_0x368c7e(0x224)?getConfig()||{}:{};DEFAULT_TIMEZONE=_0x377c15[_0x368c7e(0x204)]||_0x377c15[_0x368c7e(0x215)+_0x368c7e(0x1fc)]||DEFAULT_TIMEZONE,info(name+(_0x368c7e(0x200)+_0x368c7e(0x1f0))+DEFAULT_TIMEZONE);}catch(_0x19ab38){warn(name+(':\x20refreshC'+_0x368c7e(0x248)+_0x368c7e(0x21f))+(_0x19ab38?.[_0x368c7e(0x1ec)]||_0x19ab38));}}try{typeof hotReloadConfig===_0x491680(0x224)&&hotReloadConfig(()=>{const _0x11c01f=_0x491680;try{refreshConfig();}catch(_0x1f913b){warn(name+(':\x20hotReloa'+_0x11c01f(0x1dd)+_0x11c01f(0x211)+_0x11c01f(0x21f))+(_0x1f913b?.[_0x11c01f(0x1ec)]||_0x1f913b));}});}catch(_0x4d26cf){warn(name+(':\x20hotReloa'+_0x491680(0x257)+_0x491680(0x20d)+'\x20failed:\x20')+(_0x4d26cf?.[_0x491680(0x1ec)]||_0x4d26cf));}refreshConfig();function normalizeKey(_0x135aae){const _0x324c6f=_0x491680;if(!_0x135aae||typeof _0x135aae!==_0x324c6f(0x221))return'';let _0x4ce13c=_0x135aae[_0x324c6f(0x1ea)+'e']()['trim']();return _0x4ce13c=_0x4ce13c[_0x324c6f(0x20b)](_0x324c6f(0x247))[_0x324c6f(0x1ff)](/\p{Diacritic}/gu,''),_0x4ce13c=_0x4ce13c[_0x324c6f(0x1ff)](/[._/\\-]+/g,'\x20'),_0x4ce13c=_0x4ce13c[_0x324c6f(0x1ff)](/\s+/g,'\x20')[_0x324c6f(0x1f7)](),_0x4ce13c;}function formatTimestampForZone(_0x11944d){const _0x166abe=_0x491680;try{const _0x3a391c=DateTime[_0x166abe(0x205)]()[_0x166abe(0x25e)](_0x11944d);if(!_0x3a391c[_0x166abe(0x22f)])return{'human':_0x166abe(0x214)+_0x166abe(0x206),'iso':null,'zoneName':_0x11944d};return{'human':_0x3a391c['toLocaleSt'+_0x166abe(0x1e4)](DateTime[_0x166abe(0x1f9)+_0x166abe(0x21d)+_0x166abe(0x25b)]),'iso':_0x3a391c['toISO'](),'zoneName':_0x3a391c['zoneName']};}catch(_0x590ebf){return{'human':'Error\x20form'+_0x166abe(0x22d)+'e','iso':null,'zoneName':_0x11944d};}}function buildBoxForTime(_0x3c5069,_0x354570,_0x2e435b){const _0x5d2c7c=_0x491680;return'╭─❏\x20time\x20❏'+_0x5d2c7c(0x24c)+_0x3c5069+_0x5d2c7c(0x23e)+_0x354570+(_0x5d2c7c(0x1f2)+'\x20')+_0x2e435b+(_0x5d2c7c(0x232)+_0x5d2c7c(0x240));}export async function initialize(_0x2956fb){const _0x2ce47e=_0x491680;botInstance=_0x2956fb,info(name+(_0x2ce47e(0x258)+_0x2ce47e(0x255))),refreshConfig();}function _0x4f09(){const _0x33abe1=['country_ti','(or\x20IANA\x20t','4110822hjozMA','nce\x20missin','g;\x20cannot\x20','o\x20load\x20tim','ppings\x20suc','sendMessag','length','ezone.\x0aPle','dConfig\x20ha','Africa/Nai','imezone\x20ma','name\x20of\x20th','xample:\x20`t','mezones','rror','ring','parse','_bot','(e.g.\x20\x22Nai','robi\x22),\x0a\x20•','remoteJid','toLowerCas',':\x20findStor','message','ry\x20name\x20(e','text','e\x20country\x20','\x20set\x20to\x20','795436nYzIeI','\x0a│\x20⌚\x20Zone:','ezone\x20mapp','\x20command).','client','human','trim','\x22),\x0a\x20•\x20a\x20m','DATETIME_M','2586462cBXFzX','.g.\x20\x22Kenya','AME','\x20•\x20a\x20count','cessfully','replace',':\x20timezone','isArray','w_York','has','TIMEZONE','now','mezone','add','494382bDQwTA','\x20an\x20IANA\x20t','2238804XAYMMe','normalize','findings','gistration','@g.us','don`','mFindings\x20','ndler\x20erro','time','proceed.','Invalid\x20ti','TIMEZONE_N',':\x20replied\x20','a/Nairobi\x22','clear','le;\x20cannot','major\x20city','\x20send\x20PM-s','rror:\x20','ED_WITH_SE','ck\x20failed:','r:\x20',':\x20Sudo\x20che','string','isCommand','data','function',':\x20Failed\x20t','ts\x20time\x20an','imezone\x20(e','startsWith','from',':\x20Loaded\x20t','endsWith','I\x20couldn\x27t','atting\x20tim','\x20or\x20\x22Europ','isValid','bot','4414928FdTrLQ','\x0a╰════════','fromMe','e\x20either:\x0a','error:\x20','city_map','utf8','with\x20time\x20','8JsTLCm','America/Ne','ase\x20provid','zoneName',':\x20botJid\x20n','\x0a│\x20🕒\x20',':\x20botInsta','══⊷\x0a\x0a(.)','ajor\x20city\x20','Europe/Lon','10vPVybx','6882oUkOun','don','key','NFD','onfig\x20erro','\x20in\x20group\x20','time.json','.g.\x20\x22Afric','═══⊷\x0a│\x20📍\x20','map','\x20(origin=',')\x20you\x20want','ime\x20Kenya`','imezone\x20/\x20','e/London\x22)','jid',',\x20sentTo=','zed.','g\x20(PM-only','dConfig\x20re',':\x20initiali',':\x20unknown\x20','cwd','CONDS','\x22\x20to\x20a\x20tim','\x20—\x20ignorin','setZone'];_0x4f09=function(){return _0x33abe1;};return _0x4f09();}async function findStoredMatchFromFindings(_0x314573=[]){const _0x4d9bda=_0x491680;try{if(!Array[_0x4d9bda(0x201)](_0x314573)||_0x314573[_0x4d9bda(0x267)]===-0x65b*-0x6+-0x47f+0x6d*-0x4f)return null;const _0x260701=await listSudo();if(!Array[_0x4d9bda(0x201)](_0x260701)||_0x260701[_0x4d9bda(0x267)]===0x21d*-0xf+0xc*-0x191+0x5d*0x8b)return null;const _0x36eb6c=new Set(_0x260701[_0x4d9bda(0x24d)](_0x5db901=>String(_0x5db901)));for(const _0x4e54df of _0x314573){if(!_0x4e54df||!_0x4e54df[_0x4d9bda(0x253)]||typeof _0x4e54df[_0x4d9bda(0x253)]!==_0x4d9bda(0x221))continue;try{const _0x2ece45=normalizeToJid(_0x4e54df[_0x4d9bda(0x253)]);if(_0x2ece45&&_0x36eb6c[_0x4d9bda(0x203)](_0x2ece45))return _0x2ece45;if(_0x36eb6c['has'](_0x4e54df[_0x4d9bda(0x253)]))return _0x4e54df[_0x4d9bda(0x253)];}catch(_0x2e1b02){}}return null;}catch(_0x2c8d22){return warn(name+(_0x4d9bda(0x1eb)+'edMatchFro'+_0x4d9bda(0x210)+_0x4d9bda(0x235))+(_0x2c8d22?.[_0x4d9bda(0x1ec)]||_0x2c8d22)),null;}}export async function onMessage(_0x11b038){const _0x10613d=_0x491680;try{if(!_0x11b038||!_0x11b038[_0x10613d(0x246)])return;const _0x2c28c2=_0x11b038['key']?.['id'];if(_0x2c28c2&&respondedMsgIds[_0x10613d(0x203)](_0x2c28c2))return;if(!_0x11b038[_0x10613d(0x222)])return;const _0x16e100=(_0x11b038[_0x10613d(0x1ee)]||'')[_0x10613d(0x1f7)]();if(!_0x16e100)return;const _0x238d11=_0x16e100[_0x10613d(0x1ea)+'e']();if(!_0x238d11[_0x10613d(0x228)](_0x10613d(0x212)))return;const _0x23ed6c=_0x238d11===_0x10613d(0x212)?'':_0x16e100[_0x10613d(0x1ff)](/^time\s+/i,'')[_0x10613d(0x1f7)]();if(_0x2c28c2)respondedMsgIds[_0x10613d(0x207)](_0x2c28c2);const _0x49a44f=_0x11b038[_0x10613d(0x1e9)]||_0x11b038[_0x10613d(0x246)]?.['remoteJid']||'unknown';if(_0x49a44f==='unknown'){warn(name+(_0x10613d(0x259)+'chatId;\x20sk'+'ipping.'));return;}const _0x3d5ba9=String(_0x49a44f)[_0x10613d(0x22b)](_0x10613d(0x20e));if(_0x3d5ba9){info(name+(':\x20received'+_0x10613d(0x249))+_0x49a44f+(_0x10613d(0x25d)+_0x10613d(0x256)+_0x10613d(0x1f4)));return;}if(!botInstance){botInstance=_0x11b038[_0x10613d(0x230)]||_0x11b038[_0x10613d(0x1f5)]||_0x11b038[_0x10613d(0x1e6)]||null;if(!botInstance){warn(name+(_0x10613d(0x23f)+_0x10613d(0x262)+_0x10613d(0x263)+_0x10613d(0x213)));return;}}const _0x37fecc=getBotJid(),_0x51ef74=getBotJidRaw();if(!_0x37fecc){warn(name+(_0x10613d(0x23d)+'ot\x20availab'+_0x10613d(0x219)+_0x10613d(0x21b)+'tyle\x20reply'+'.'));return;}let _0x7aae02=_0x37fecc;const _0x1e47bf=Boolean(_0x11b038[_0x10613d(0x246)]?.[_0x10613d(0x233)]);if(!_0x1e47bf)try{const _0x1e8d94=await isSudo(botInstance,_0x11b038);if(_0x1e8d94){const _0x3f6bd6=userJidFromCtx(_0x11b038),_0x521090=await findStoredMatchFromFindings(_0x3f6bd6[_0x10613d(0x20c)]);if(_0x521090)_0x7aae02=_0x521090;else return;}else return;}catch(_0x260191){warn(name+(_0x10613d(0x220)+_0x10613d(0x21e)+'\x20')+_0x260191[_0x10613d(0x1ec)]);return;}if(!_0x23ed6c){await botInstance['sendMessag'+'e'](_0x7aae02,{'text':'Enter\x20the\x20'+_0x10613d(0x1e0)+_0x10613d(0x1ef)+_0x10613d(0x260)+_0x10613d(0x251)+_0x10613d(0x21a)+_0x10613d(0x24f)+'\x20to\x20know\x20i'+_0x10613d(0x226)+'d\x20date.\x0a\x0aE'+_0x10613d(0x1e1)+_0x10613d(0x250)+'\x20or\x20`time\x20'+_0x10613d(0x242)+_0x10613d(0x20f)});return;}let _0x401d31=null;const _0x121025=normalizeKey(_0x23ed6c);if(COUNTRY_TIMEZONES[_0x121025])_0x401d31=COUNTRY_TIMEZONES[_0x121025];if(!_0x401d31){const _0x2d4caa=_0x121025[_0x10613d(0x1ff)](/\s+/g,'\x20');if(CITY_MAP[_0x2d4caa])_0x401d31=CITY_MAP[_0x2d4caa];}if(!_0x401d31)try{const _0x2081ae=_0x23ed6c[_0x10613d(0x1f7)](),_0x5ddd67=DateTime[_0x10613d(0x205)]()[_0x10613d(0x25e)](_0x2081ae);if(_0x5ddd67&&_0x5ddd67[_0x10613d(0x22f)])_0x401d31=_0x2081ae;}catch(_0x1ad298){}if(!_0x401d31){await botInstance[_0x10613d(0x266)+'e'](_0x7aae02,{'text':_0x10613d(0x22c)+'\x20confident'+'ly\x20resolve'+'\x20\x22'+_0x23ed6c+(_0x10613d(0x25c)+_0x10613d(0x1dc)+_0x10613d(0x23b)+_0x10613d(0x234)+_0x10613d(0x1fd)+_0x10613d(0x1ed)+_0x10613d(0x1fb)+_0x10613d(0x1f8)+_0x10613d(0x241)+_0x10613d(0x1e7)+_0x10613d(0x1e8)+_0x10613d(0x209)+_0x10613d(0x227)+_0x10613d(0x24b)+_0x10613d(0x217)+_0x10613d(0x22e)+_0x10613d(0x252)+'.')});return;}const _0x4da564=formatTimestampForZone(_0x401d31),_0x1610f5=_0x23ed6c+'\x20('+_0x401d31+')',_0x1fef5c=buildBoxForTime(_0x1610f5,_0x4da564[_0x10613d(0x1f6)],_0x4da564[_0x10613d(0x23c)]);await botInstance[_0x10613d(0x266)+'e'](_0x7aae02,{'text':_0x1fef5c}),info(name+(_0x10613d(0x216)+_0x10613d(0x238)+'for\x20')+_0x401d31+_0x10613d(0x24e)+_0x49a44f+_0x10613d(0x254)+_0x7aae02+(',\x20botJidRa'+'w=')+_0x51ef74+')');if(respondedMsgIds['size']>-0x1e*-0x16+0x1*0xa61+0x693){const _0x5db8a1=Array[_0x10613d(0x229)](respondedMsgIds);respondedMsgIds=new Set(_0x5db8a1['slice'](-(-0x1766+-0x257f+0x489d)));}}catch(_0x392f62){error(_0x392f62,name+('\x20handler\x20e'+_0x10613d(0x1e3)));}}export async function cleanup(){const _0x1c8ca8=_0x491680;try{botInstance=null,respondedMsgIds[_0x1c8ca8(0x218)]&&respondedMsgIds[_0x1c8ca8(0x218)](),info(name+('\x20cleaned\x20u'+'p'));}catch(_0xd45f1d){warn(name+('\x20cleanup\x20e'+_0x1c8ca8(0x21c))+(_0xd45f1d?.['message']||_0xd45f1d));}}