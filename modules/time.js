const _0x534a28=_0x2f9a;(function(_0x11b889,_0x12b58e){const _0x479d05=_0x2f9a,_0x21f11e=_0x11b889();while(!![]){try{const _0x2f85b2=-parseInt(_0x479d05(0x22d))/(0xd85+-0x645+-0x23*0x35)+parseInt(_0x479d05(0x1e2))/(-0x1c59+-0x13f2+0x304d)*(parseInt(_0x479d05(0x1ce))/(-0x146f+0xb7+-0x1*-0x13bb))+-parseInt(_0x479d05(0x219))/(-0x1f3e+0x5*-0x713+0x1*0x42a1)*(parseInt(_0x479d05(0x238))/(0x6d2+0x1cd3+-0x3c*0x98))+parseInt(_0x479d05(0x251))/(0x8b7+-0x110f+0x85e)+parseInt(_0x479d05(0x1d6))/(-0x17db+0xf88+0x85a)+parseInt(_0x479d05(0x209))/(0xee2+0x2315*0x1+-0x31ef)*(-parseInt(_0x479d05(0x1e7))/(-0x1041+-0x1*0x611+0x165b))+parseInt(_0x479d05(0x222))/(-0x1de4+0x243f+-0x651);if(_0x2f85b2===_0x12b58e)break;else _0x21f11e['push'](_0x21f11e['shift']());}catch(_0x58d439){_0x21f11e['push'](_0x21f11e['shift']());}}}(_0x2992,0x1*-0x11fbf7+0xa75*-0x6f+-0x6*-0x58185));import{readFileSync}from'fs';import{join}from'path';import{DateTime}from'luxon';import{info,warn,error}from'../utils/logger.js';function _0x2992(){const _0x5754e6=['edMatchFro','Europe/Lon','208113koIznj','data','Enter\x20the\x20','mezones','don`','America/Ne','sendMessag','with\x20time\x20','3027255KjncCE','fromMe','ppings\x20suc','e/London\x22)','toLowerCas','TIMEZONE_N',':\x20received','slice','ry\x20name\x20(e','add','\x20set\x20to\x20','length','4cqhHnN','remoteJid','imezone\x20(e','\x20cleanup\x20e','unknown','42831kBgwXd','\x20an\x20IANA\x20t',':\x20Loaded\x20t',':\x20botJid\x20n','toLocaleSt','DATETIME_M','ipping.','\x20or\x20`time\x20','CONDS','g\x20(PM-only','\x20or\x20\x22Europ','le;\x20cannot','bot','d\x20date.\x0a\x0aE','ezone.\x0aPle','\x20to\x20know\x20i','proceed.','\x20command).','string','replace','now','function',',\x20sentTo=','for\x20','don','human','r:\x20','═══⊷\x0a│\x20📍\x20','\x20cleaned\x20u','gistration','cessfully','time','w_York','ezone\x20mapp','1640KLljId','zed.','size','\x22),\x0a\x20•\x20a\x20m','xample:\x20`t','zoneName','@g.us','endsWith','from','has','atting\x20tim','1.1.0','g;\x20cannot\x20','trim','AME','imezone\x20ma','1949264PXXCpZ','utf8','text','dConfig\x20re',':\x20hotReloa','══⊷\x0a\x0a(.)','o\x20load\x20tim','normalize','key','32925890eMyPWg','nce\x20missin','tyle\x20reply','client','e\x20either:\x0a','isArray','\x0a│\x20🕒\x20','ot\x20availab','\x20—\x20ignorin','city_map','startsWith','1260156mffDwe','\x20•\x20a\x20count','mFindings\x20',':\x20replied\x20','message','robi\x22),\x0a\x20•','ings:\x20','\x22\x20to\x20a\x20tim','Africa/Nai','rror','clear','10otzZrK','\x0a╰════════','_bot','map',':\x20findStor','chatId;\x20sk','jid','(e.g.\x20\x22Nai','robi','ED_WITH_SE','\x20handler\x20e','cwd','.g.\x20\x22Kenya',':\x20Sudo\x20che','a/Nairobi\x22','\x20failed:\x20','findings','\x20in\x20group\x20','rror:\x20','imezone\x20/\x20','╭─❏\x20time\x20❏','ndler\x20erro','ring','(or\x20IANA\x20t','Invalid\x20ti','215082qAGXWf','ly\x20resolve','setZone',':\x20timezone','toISO','mezone'];_0x2992=function(){return _0x5754e6;};return _0x2992();}import{getConfig,hotReloadConfig}from'../utils/config.js';import{isSudo,userJidFromCtx,listSudo,normalizeToJid}from'../utils/sudo.js';import{getBotJid,getBotJidRaw}from'../utils/bot-state.js';export const name=_0x534a28(0x206);export const version=_0x534a28(0x214);export const priority=-0x1632+0x55*0x29+0x89f;let botInstance=null,respondedMsgIds=new Set(),DEFAULT_TIMEZONE=_0x534a28(0x235)+_0x534a28(0x240);const timeDataPath=join(process[_0x534a28(0x243)](),_0x534a28(0x1cf),_0x534a28(0x206),'time.json');let COUNTRY_TIMEZONES={},CITY_MAP={};function _0x2f9a(_0x2cab0d,_0x23ff23){const _0x2bde39=_0x2992();return _0x2f9a=function(_0x284509,_0x1499da){_0x284509=_0x284509-(-0x138a+-0xd2a+-0x323*-0xb);let _0x404e3d=_0x2bde39[_0x284509];return _0x404e3d;},_0x2f9a(_0x2cab0d,_0x23ff23);}try{const timeData=JSON['parse'](readFileSync(timeDataPath,_0x534a28(0x21a)));COUNTRY_TIMEZONES=timeData['country_ti'+_0x534a28(0x1d1)]||{},CITY_MAP=timeData[_0x534a28(0x22b)]||{},info(name+(_0x534a28(0x1e9)+_0x534a28(0x218)+_0x534a28(0x1d8)+_0x534a28(0x205)));}catch(_0x48c166){warn(name+(':\x20Failed\x20t'+_0x534a28(0x21f)+_0x534a28(0x208)+_0x534a28(0x233))+_0x48c166[_0x534a28(0x231)]),COUNTRY_TIMEZONES={'kenya':_0x534a28(0x235)+_0x534a28(0x240),'uk':_0x534a28(0x1cd)+_0x534a28(0x1ff),'usa':_0x534a28(0x1d3)+_0x534a28(0x207)},CITY_MAP={'nairobi':'Africa/Nai'+_0x534a28(0x240),'london':_0x534a28(0x1cd)+_0x534a28(0x1ff),'new\x20york':_0x534a28(0x1d3)+_0x534a28(0x207)};}function refreshConfig(){const _0x5168f1=_0x534a28;try{const _0x1a4d07=typeof getConfig===_0x5168f1(0x1fc)?getConfig()||{}:{};DEFAULT_TIMEZONE=_0x1a4d07['TIMEZONE']||_0x1a4d07[_0x5168f1(0x1db)+_0x5168f1(0x217)]||DEFAULT_TIMEZONE,info(name+(_0x5168f1(0x254)+_0x5168f1(0x1e0))+DEFAULT_TIMEZONE);}catch(_0x40fe6b){warn(name+(':\x20refreshC'+'onfig\x20erro'+_0x5168f1(0x201))+(_0x40fe6b?.['message']||_0x40fe6b));}}try{typeof hotReloadConfig===_0x534a28(0x1fc)&&hotReloadConfig(()=>{const _0x11e199=_0x534a28;try{refreshConfig();}catch(_0x186291){warn(name+(_0x11e199(0x21d)+'dConfig\x20ha'+_0x11e199(0x24d)+_0x11e199(0x201))+(_0x186291?.[_0x11e199(0x231)]||_0x186291));}});}catch(_0x4d0d80){warn(name+(_0x534a28(0x21d)+_0x534a28(0x21c)+_0x534a28(0x204)+_0x534a28(0x247))+(_0x4d0d80?.['message']||_0x4d0d80));}refreshConfig();function normalizeKey(_0x1edd7a){const _0x1eb6d6=_0x534a28;if(!_0x1edd7a||typeof _0x1edd7a!=='string')return'';let _0x59d6d9=_0x1edd7a['toLowerCas'+'e']()['trim']();return _0x59d6d9=_0x59d6d9[_0x1eb6d6(0x220)]('NFD')[_0x1eb6d6(0x1fa)](/\p{Diacritic}/gu,''),_0x59d6d9=_0x59d6d9[_0x1eb6d6(0x1fa)](/[._/\\-]+/g,'\x20'),_0x59d6d9=_0x59d6d9['replace'](/\s+/g,'\x20')[_0x1eb6d6(0x216)](),_0x59d6d9;}function formatTimestampForZone(_0x299ef2){const _0x5d2f97=_0x534a28;try{const _0x16e396=DateTime[_0x5d2f97(0x1fb)]()[_0x5d2f97(0x253)](_0x299ef2);if(!_0x16e396['isValid'])return{'human':_0x5d2f97(0x250)+_0x5d2f97(0x256),'iso':null,'zoneName':_0x299ef2};return{'human':_0x16e396[_0x5d2f97(0x1eb)+_0x5d2f97(0x24e)](DateTime[_0x5d2f97(0x1ec)+_0x5d2f97(0x241)+_0x5d2f97(0x1ef)]),'iso':_0x16e396[_0x5d2f97(0x255)](),'zoneName':_0x16e396[_0x5d2f97(0x20e)]};}catch(_0x5b7f43){return{'human':'Error\x20form'+_0x5d2f97(0x213)+'e','iso':null,'zoneName':_0x299ef2};}}function buildBoxForTime(_0x72a046,_0x2624a9,_0x5d4e35){const _0x2f7c77=_0x534a28;return _0x2f7c77(0x24c)+_0x2f7c77(0x202)+_0x72a046+_0x2f7c77(0x228)+_0x2624a9+('\x0a│\x20⌚\x20Zone:'+'\x20')+_0x5d4e35+(_0x2f7c77(0x239)+_0x2f7c77(0x21e));}export async function initialize(_0x1fd407){const _0x579cd9=_0x534a28;botInstance=_0x1fd407,info(name+(':\x20initiali'+_0x579cd9(0x20a))),refreshConfig();}async function findStoredMatchFromFindings(_0x1eedae=[]){const _0x38c78b=_0x534a28;try{if(!Array[_0x38c78b(0x227)](_0x1eedae)||_0x1eedae[_0x38c78b(0x1e1)]===-0x3df*0x3+0x3f0+-0x1*-0x7ad)return null;const _0x2d9b58=await listSudo();if(!Array[_0x38c78b(0x227)](_0x2d9b58)||_0x2d9b58[_0x38c78b(0x1e1)]===0x2b7+0xfd9*-0x1+-0x691*-0x2)return null;const _0x583d1b=new Set(_0x2d9b58[_0x38c78b(0x23b)](_0x1895c9=>String(_0x1895c9)));for(const _0x21a7d9 of _0x1eedae){if(!_0x21a7d9||!_0x21a7d9['jid']||typeof _0x21a7d9['jid']!==_0x38c78b(0x1f9))continue;try{const _0x35ca68=normalizeToJid(_0x21a7d9[_0x38c78b(0x23e)]);if(_0x35ca68&&_0x583d1b[_0x38c78b(0x212)](_0x35ca68))return _0x35ca68;if(_0x583d1b[_0x38c78b(0x212)](_0x21a7d9['jid']))return _0x21a7d9[_0x38c78b(0x23e)];}catch(_0x3ed519){}}return null;}catch(_0x52f72c){return warn(name+(_0x38c78b(0x23c)+_0x38c78b(0x257)+_0x38c78b(0x22f)+'error:\x20')+(_0x52f72c?.['message']||_0x52f72c)),null;}}export async function onMessage(_0x34c407){const _0xd078d7=_0x534a28;try{if(!_0x34c407||!_0x34c407['key'])return;const _0x139890=_0x34c407['key']?.['id'];if(_0x139890&&respondedMsgIds[_0xd078d7(0x212)](_0x139890))return;if(!_0x34c407['isCommand'])return;const _0xfc7ae5=(_0x34c407[_0xd078d7(0x21b)]||'')[_0xd078d7(0x216)]();if(!_0xfc7ae5)return;const _0x33be6f=_0xfc7ae5[_0xd078d7(0x1da)+'e']();if(!_0x33be6f[_0xd078d7(0x22c)](_0xd078d7(0x206)))return;const _0x17605c=_0x33be6f===_0xd078d7(0x206)?'':_0xfc7ae5[_0xd078d7(0x1fa)](/^time\s+/i,'')[_0xd078d7(0x216)]();if(_0x139890)respondedMsgIds[_0xd078d7(0x1df)](_0x139890);const _0x2681ed=_0x34c407[_0xd078d7(0x1e3)]||_0x34c407[_0xd078d7(0x221)]?.[_0xd078d7(0x1e3)]||'unknown';if(_0x2681ed===_0xd078d7(0x1e6)){warn(name+(':\x20unknown\x20'+_0xd078d7(0x23d)+_0xd078d7(0x1ed)));return;}const _0x2ec2b0=String(_0x2681ed)[_0xd078d7(0x210)](_0xd078d7(0x20f));if(_0x2ec2b0){info(name+(_0xd078d7(0x1dc)+_0xd078d7(0x249))+_0x2681ed+(_0xd078d7(0x22a)+_0xd078d7(0x1f0)+_0xd078d7(0x1f8)));return;}if(!botInstance){botInstance=_0x34c407[_0xd078d7(0x1f3)]||_0x34c407[_0xd078d7(0x225)]||_0x34c407[_0xd078d7(0x23a)]||null;if(!botInstance){warn(name+(':\x20botInsta'+_0xd078d7(0x223)+_0xd078d7(0x215)+_0xd078d7(0x1f7)));return;}}const _0x25edef=getBotJid(),_0x20c068=getBotJidRaw();if(!_0x25edef){warn(name+(_0xd078d7(0x1ea)+_0xd078d7(0x229)+_0xd078d7(0x1f2)+'\x20send\x20PM-s'+_0xd078d7(0x224)+'.'));return;}let _0x15664f=_0x25edef;const _0x322ede=Boolean(_0x34c407[_0xd078d7(0x221)]?.[_0xd078d7(0x1d7)]);if(!_0x322ede)try{const _0x4112c6=await isSudo(botInstance,_0x34c407);if(_0x4112c6){const _0xa15a36=userJidFromCtx(_0x34c407),_0x1832af=await findStoredMatchFromFindings(_0xa15a36[_0xd078d7(0x248)]);if(_0x1832af)_0x15664f=_0x1832af;else return;}else return;}catch(_0x2fd842){warn(name+(_0xd078d7(0x245)+'ck\x20failed:'+'\x20')+_0x2fd842[_0xd078d7(0x231)]);return;}if(!_0x17605c){await botInstance[_0xd078d7(0x1d4)+'e'](_0x15664f,{'text':_0xd078d7(0x1d0)+'name\x20of\x20th'+'e\x20country\x20'+_0xd078d7(0x24f)+_0xd078d7(0x24b)+'major\x20city'+')\x20you\x20want'+_0xd078d7(0x1f6)+'ts\x20time\x20an'+_0xd078d7(0x1f4)+_0xd078d7(0x20d)+'ime\x20Kenya`'+_0xd078d7(0x1ee)+_0xd078d7(0x1cd)+_0xd078d7(0x1d2)});return;}let _0x454bb9=null;const _0x43281e=normalizeKey(_0x17605c);if(COUNTRY_TIMEZONES[_0x43281e])_0x454bb9=COUNTRY_TIMEZONES[_0x43281e];if(!_0x454bb9){const _0x1494db=_0x43281e[_0xd078d7(0x1fa)](/\s+/g,'\x20');if(CITY_MAP[_0x1494db])_0x454bb9=CITY_MAP[_0x1494db];}if(!_0x454bb9)try{const _0x2625d1=_0x17605c[_0xd078d7(0x216)](),_0x521fe9=DateTime['now']()[_0xd078d7(0x253)](_0x2625d1);if(_0x521fe9&&_0x521fe9['isValid'])_0x454bb9=_0x2625d1;}catch(_0x15dc1a){}if(!_0x454bb9){await botInstance['sendMessag'+'e'](_0x15664f,{'text':'I\x20couldn\x27t'+'\x20confident'+_0xd078d7(0x252)+'\x20\x22'+_0x17605c+(_0xd078d7(0x234)+_0xd078d7(0x1f5)+'ase\x20provid'+_0xd078d7(0x226)+_0xd078d7(0x22e)+_0xd078d7(0x1de)+_0xd078d7(0x244)+_0xd078d7(0x20c)+'ajor\x20city\x20'+_0xd078d7(0x23f)+_0xd078d7(0x232)+_0xd078d7(0x1e8)+_0xd078d7(0x1e4)+'.g.\x20\x22Afric'+_0xd078d7(0x246)+_0xd078d7(0x1f1)+_0xd078d7(0x1d9)+'.')});return;}const _0xb1c546=formatTimestampForZone(_0x454bb9),_0x22f289=_0x17605c+'\x20('+_0x454bb9+')',_0xbe6454=buildBoxForTime(_0x22f289,_0xb1c546[_0xd078d7(0x200)],_0xb1c546[_0xd078d7(0x20e)]);await botInstance[_0xd078d7(0x1d4)+'e'](_0x15664f,{'text':_0xbe6454}),info(name+(_0xd078d7(0x230)+_0xd078d7(0x1d5)+_0xd078d7(0x1fe))+_0x454bb9+'\x20(origin='+_0x2681ed+_0xd078d7(0x1fd)+_0x15664f+(',\x20botJidRa'+'w=')+_0x20c068+')');if(respondedMsgIds[_0xd078d7(0x20b)]>-0x1e2f*-0x1+0x2047+0x9d*-0x46){const _0xcb9f5a=Array[_0xd078d7(0x211)](respondedMsgIds);respondedMsgIds=new Set(_0xcb9f5a[_0xd078d7(0x1dd)](-(-0x1*-0x905+-0x1*0xbd3+-0xd*-0x11e)));}}catch(_0x1d4bf7){error(_0x1d4bf7,name+(_0xd078d7(0x242)+_0xd078d7(0x236)));}}export async function cleanup(){const _0x36d297=_0x534a28;try{botInstance=null,respondedMsgIds[_0x36d297(0x237)]&&respondedMsgIds[_0x36d297(0x237)](),info(name+(_0x36d297(0x203)+'p'));}catch(_0x45b6bd){warn(name+(_0x36d297(0x1e5)+_0x36d297(0x24a))+(_0x45b6bd?.[_0x36d297(0x231)]||_0x45b6bd));}}