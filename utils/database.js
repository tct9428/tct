const _0x319063=_0x367e;(function(_0x2c762,_0x1c9748){const _0x2883a8=_0x367e,_0x538c9c=_0x2c762();while(!![]){try{const _0x25aedd=-parseInt(_0x2883a8(0xea))/(-0x1d2f+0x90*-0x42+0x1094*0x4)*(-parseInt(_0x2883a8(0x1a0))/(0x1343+-0xafd+-0x844))+-parseInt(_0x2883a8(0xbc))/(-0x1*0xa3b+-0x18db+-0x257*-0xf)+parseInt(_0x2883a8(0x1b1))/(-0x239*-0x1+-0x3*-0x978+-0x1e9d)+parseInt(_0x2883a8(0x16c))/(-0x12*-0x55+0x735+-0xd2a)+parseInt(_0x2883a8(0x13a))/(0xb0e*-0x2+-0x3b*-0x59+-0x19f*-0x1)+parseInt(_0x2883a8(0x13e))/(-0x1*-0x17ea+-0x10e7*-0x1+-0x28ca)+-parseInt(_0x2883a8(0x15d))/(-0x18d6+0x1b4*-0x7+0x24ca);if(_0x25aedd===_0x1c9748)break;else _0x538c9c['push'](_0x538c9c['shift']());}catch(_0x5561d5){_0x538c9c['push'](_0x538c9c['shift']());}}}(_0x27f8,0x17953*0xd+0x1c*0xc8aa+-0x1aa6ec));import _0x4afcc7 from'fs-extra';import _0x307d5f from'path';import{getConfig}from'./config.js';import{info,error,warn}from'./logger.js';export let db=null;let usingNative=![],adapter=null,setStmt=null,deleteStmt=null,dbReady=![],writeQueue=[],queueBytes=0xfe7+-0x243*0x1+0x9*-0x184,maxTotalBytes=0x23d5*-0x1+0x10*0xa6+0x1975,isFlushing=![],flushTimer=null,cache=null;function estimateQueueItemSize(_0x546c15){const _0x161c40=_0x367e,_0x5d2072=0xe3*-0xa+-0x7*-0x2f5+-0xb85;switch(_0x546c15[_0x161c40(0x19b)]){case _0x161c40(0x12c):return Buffer[_0x161c40(0x10a)](_0x546c15[_0x161c40(0xb3)],'utf8')+Buffer['byteLength'](_0x546c15['value'],'utf8')+_0x5d2072;case _0x161c40(0x125):return Buffer[_0x161c40(0x10a)](_0x546c15[_0x161c40(0xb3)],_0x161c40(0xcf))+_0x5d2072;default:return-0x206+-0x1*0x7b1+0x20b*0x5;}}function _0x27f8(){const _0x13daca=['426362aNvtvp','exec','free','ed\x20by\x20tran','SIGTERM','erializabl','r\x20commit:','\x20flush:\x20','ile\x20execut','push','Created\x20ne','red\x20by\x20set','catch','l\x20be\x20handl','L\x20error\x20(t','ache\x20for\x20o','slice','3058160Lnoymk','ile\x20runnin','get','leted\x20succ','Ignored\x20UN','\x20driver.','parse\x20stor','CONFLICT_P','tive):\x20','Rollback\x20f','pathExists','e_store\x20WH','essfully.','e...','\x20NORMAL;','Using\x20nati','dy\x20for\x20get','XT\x20PRIMARY','ed\x20flushQu','w\x20in-memor','DB_FLUSH_I','isArray','key\x20\x22','persist\x20DB','ERE\x20key\x20=\x20','stat','lizing\x20set','key','ignore)\x20in','ng\x20final\x20f','e;\x20skippin','open','adapter.',',\x20Key:\x20','head','serialized','5030655PEZsYX','maxBytes','s):\x20','Y\x20KEY,\x20mod','PROJECT_RO','all','ensureDirS','PRAGMA\x20for','LE\x20IF\x20NOT\x20','Unhandled\x20','key\x20=\x20?','dirname','olling\x20bac','ROLLBACK;','Final\x20flus','=\x20ON;','ent\x20(polic','finalize','nitializat','utf8','cwd','\x20prepared\x20','statement\x20','join','COMMIT;','nt\x20(native','ignore)\x20wh','\x20file:\x20','y_timeout\x20','bytes','PRAGMA\x20jou','ackup\x20crea','step','eue\x20item\x20t','r\x20key\x20\x22','ocess\x20init','Database\x20c','reset','now','ype\x20during','object','s.\x20Item:\x20','ing\x20(sql.j','close','Value\x20for\x20','default','6FOsEEH','Skipping\x20c','R\x20REPLACE\x20','\x20operation','INSERT\x20OR\x20','finally','qlite','Native\x20sql','(native):\x20','error\x20duri','\x20bytes\x20>\x20m','Database\x20s','g\x20INSERT\x20O','retries','(native).','prev',')\x20VALUES\x20(','k.\x20Prepari','map','next','g\x20persist.','red\x20statem','Retry\x20succ','h\x20complete','process\x20DB','for\x20prepar','ransaction','key,\x20value','closed\x20cle','\x20item,\x20wil','eue\x20trigge','_addToTail','byteLength','IZE','bind','unshift','ackup\x20fail','lback.\x20','sql.js','Database','Unknown\x20qu','reduce','able\x20alrea','isting\x20DB\x20','EXISTS\x20key','Database\x20p','e\x20memory\x20p','ing\x20(nativ','SELECT\x20val','ter\x20multip','message','has','IQUE\x20const','_removeNod','iated.\x20Flu','_PATH','REPLACE\x20IN','Error\x20duri','timestamp','delete','raint\x20erro','DB\x20init\x20er','\x22\x20(','dist','TEXT);','ed\x20stateme','set','once','function','est\x20item.\x20','shift','=\x2010000;','export','r\x20(policy=','le\x20failure','g:\x20','database.s','exit','dy\x20exists)','SQL.js','7969884wQKBCw','e):\x20','estimateSi','B\x20(no\x20file','7192381RSwEGB','get\x20key\x20\x22','mtimeMs','.tmp','_moveToTai','length','from','Database\x20b','move','getAsObjec','readFile','ersisted\x20t','DB_UNIQUE_','DB_NAME','prepare','y\x20SQL.js\x20D','g\x20shutdown','\x22\x20from\x20DB:','hutdown\x20pr','splice','ted\x20at\x20','Loaded\x20DB\x20','ignore','ed:','s\x20started.','ropped\x20old','NTERVAL','DB\x20item\x20di','Type:\x20','native\x20sql','\x20KEY,\x20valu','28409616FNRZxv','versized\x20i','lizing\x20del','BEGIN\x20TRAN','ite\x20init\x20f','ed:\x20','CRITICAL:\x20','SACTION;','ng\x20flushQu','y_value_st','CREATE\x20TAB','ax\x20','\x22\x20is\x20not\x20s','llback:\x20','size','8880455wSAecH','cy=ignore)','l.js):\x20','lush\x20attem','ailed:','\x20while\x20exe','eeded\x20usin','et()\x20(poli','DB_CACHE_M','cuting\x20(sq','TO\x20key_val','anly.','test','\x20failed,\x20r','run','onnection\x20','value','N/A','ed\x20JSON\x20fo','PRAGMA\x20bus','resolve','M\x20key_valu','eteStmt:','ose:','Write\x20queu','for\x20run()\x20','.db','lback\x20fail','eign_keys\x20','replace','AX_BYTES','Failed\x20to\x20','nitialized','Database\x20i','ry.','DB_PATH','Error\x20fina','stringify','ailed,\x20wil','SIGINT','():','ue_store\x20(','DB_BATCH_S','OLICY','tail','saction\x20ro','SQL.js\x20fal','type','chronous\x20=','Ignored\x20SQ','scarded\x20af','string'];_0x27f8=function(){return _0x13daca;};return _0x27f8();}class MemoryCache{constructor(_0x2d5a52){const _0x2dd943=_0x367e;this[_0x2dd943(0xbd)]=_0x2d5a52,this[_0x2dd943(0xd9)]=-0x176b+-0x1*-0x955+-0x1*-0xe16,this[_0x2dd943(0xfc)]=new Map(),this[_0x2dd943(0xba)]={'prev':null,'next':null},this[_0x2dd943(0x198)]={'prev':null,'next':null},this[_0x2dd943(0xba)]['next']=this[_0x2dd943(0x198)],this[_0x2dd943(0x198)]['prev']=this[_0x2dd943(0xba)];}static[_0x319063(0x13c)+'ze'](_0x2ee281,_0x17e398){const _0x3a2d13=_0x319063,_0x121a97=Buffer[_0x3a2d13(0x10a)](String(_0x2ee281),'utf8'),_0x5ee991=Buffer[_0x3a2d13(0x10a)](_0x17e398??'',_0x3a2d13(0xcf));return _0x121a97+_0x5ee991+(0x1eec+-0x2156+0x1*0x2aa);}['_removeNod'+'e'](_0x290c5d){const _0x6d4bdf=_0x319063;_0x290c5d[_0x6d4bdf(0xf9)][_0x6d4bdf(0xfd)]=_0x290c5d[_0x6d4bdf(0xfd)],_0x290c5d[_0x6d4bdf(0xfd)][_0x6d4bdf(0xf9)]=_0x290c5d['prev'];}[_0x319063(0x109)](_0x140ac5){const _0x1d0753=_0x319063;_0x140ac5[_0x1d0753(0xf9)]=this[_0x1d0753(0x198)]['prev'],_0x140ac5['next']=this['tail'],this[_0x1d0753(0x198)]['prev'][_0x1d0753(0xfd)]=_0x140ac5,this['tail'][_0x1d0753(0xf9)]=_0x140ac5;}['_moveToTai'+'l'](_0x2ef641){const _0x47978e=_0x319063;this[_0x47978e(0x11f)+'e'](_0x2ef641),this[_0x47978e(0x109)](_0x2ef641);}['has'](_0x4ba5bc){return this['map']['has'](_0x4ba5bc);}[_0x319063(0x1b3)](_0x2e2080){const _0x66ef2=_0x319063,_0x177d94=this[_0x66ef2(0xfc)][_0x66ef2(0x1b3)](_0x2e2080);if(!_0x177d94)return undefined;return this[_0x66ef2(0x142)+'l'](_0x177d94),_0x177d94[_0x66ef2(0x17c)];}[_0x319063(0x12c)](_0x536236,_0x5c3001,_0x4ac55f){const _0x1745f0=_0x319063,_0x86ded5=this['map'][_0x1745f0(0x1b3)](_0x536236),_0x36fed8=MemoryCache['estimateSi'+'ze'](_0x536236,_0x4ac55f);if(_0x36fed8>this[_0x1745f0(0xbd)]){warn(_0x1745f0(0xeb)+_0x1745f0(0x1af)+_0x1745f0(0x15e)+'tem\x20\x22'+_0x536236+_0x1745f0(0x128)+_0x36fed8+(_0x1745f0(0xf4)+_0x1745f0(0x168))+this['maxBytes']+')');if(_0x86ded5)this['delete'](_0x536236);return;}if(_0x86ded5)this['bytes']-=_0x86ded5[_0x1745f0(0x16b)],_0x86ded5[_0x1745f0(0x17c)]=_0x5c3001,_0x86ded5[_0x1745f0(0xbb)]=_0x4ac55f,_0x86ded5[_0x1745f0(0x16b)]=_0x36fed8,this[_0x1745f0(0xd9)]+=_0x36fed8,this[_0x1745f0(0x142)+'l'](_0x86ded5);else{const _0x42fea2={'key':_0x536236,'value':_0x5c3001,'serialized':_0x4ac55f,'size':_0x36fed8,'prev':null,'next':null};this['map'][_0x1745f0(0x12c)](_0x536236,_0x42fea2),this[_0x1745f0(0x109)](_0x42fea2),this['bytes']+=_0x36fed8;}while(this[_0x1745f0(0xd9)]>this[_0x1745f0(0xbd)]){const _0x239dcc=this[_0x1745f0(0xba)][_0x1745f0(0xfd)];if(_0x239dcc===this[_0x1745f0(0x198)])break;this[_0x1745f0(0x125)](_0x239dcc['key']);}}[_0x319063(0x125)](_0x21e4a1){const _0x4b663e=_0x319063,_0x51dfcc=this['map']['get'](_0x21e4a1);if(!_0x51dfcc)return;this[_0x4b663e(0x11f)+'e'](_0x51dfcc),this[_0x4b663e(0xfc)][_0x4b663e(0x125)](_0x21e4a1),this[_0x4b663e(0xd9)]-=_0x51dfcc['size'];}}function enforceMemoryLimit(){const _0xa31c50=_0x319063;while(cache[_0xa31c50(0xd9)]+queueBytes>maxTotalBytes&&writeQueue['length']>-0x1189+-0x7*-0x4ae+-0xf39){const _0x4a997d=writeQueue[_0xa31c50(0x130)]();if(_0x4a997d[_0xa31c50(0x16b)])queueBytes-=_0x4a997d[_0xa31c50(0x16b)];warn(_0xa31c50(0x184)+_0xa31c50(0x118)+'ressure:\x20D'+_0xa31c50(0x157)+_0xa31c50(0x12f)+_0xa31c50(0x15a)+_0x4a997d[_0xa31c50(0x19b)]+_0xa31c50(0xb9)+(_0x4a997d[_0xa31c50(0xb3)]||_0xa31c50(0x17d)));}}function normalizeBindParams(_0x3bcb4f){const _0xb01677=_0x319063;if(!_0x3bcb4f||_0x3bcb4f[_0xb01677(0x143)]===-0x1f1c+-0x15c6+0x34e2)return undefined;if(_0x3bcb4f[_0xb01677(0x143)]===0x1a3*-0xa+0xee2+-0x7f*-0x3&&Array[_0xb01677(0xad)](_0x3bcb4f[0x773*-0x2+-0x599*0x5+0x2ae3*0x1]))return _0x3bcb4f[0xc9a*0x1+0x22*-0xfe+0x1522];if(_0x3bcb4f[_0xb01677(0x143)]===-0x23c3*0x1+-0x2*0x1134+0x118b*0x4&&typeof _0x3bcb4f[-0x1*0x733+0x1*0x2672+-0x1*0x1f3f]===_0xb01677(0xe4)&&_0x3bcb4f[-0x3e8*-0x7+0xda0+0x13*-0x228]!==null&&!Array['isArray'](_0x3bcb4f[0xb*-0x3f+0x4e9+0x5e*-0x6]))return _0x3bcb4f[0x215b+0x3*-0x4e+-0x2f3*0xb];return _0x3bcb4f;}function isTableAlreadyExistsError(_0x104b9a){const _0xa37574=_0x319063;try{const _0x577128=_0x104b9a&&(_0x104b9a[_0xa37574(0x11c)]||String(_0x104b9a))||'';return/table .* already exists/i[_0xa37574(0x178)](_0x577128)||/\balready exists\b/i['test'](_0x577128);}catch(_0x793e40){return![];}}function isUniqueConstraintError(_0x276552){const _0x2f02b7=_0x319063;try{const _0xa669c0=_0x276552&&(_0x276552[_0x2f02b7(0x11c)]||String(_0x276552))||'';return/UNIQUE constraint failed/i['test'](_0xa669c0);}catch(_0x3aa46c){return![];}}function looksLikeSimpleInsert(_0x53d889){const _0xb00123=_0x319063;if(!_0x53d889||typeof _0x53d889!==_0xb00123(0x19f))return![];return/^\s*INSERT\s+INTO\s+/i[_0xb00123(0x178)](_0x53d889)&&!/INSERT\s+OR\s+(REPLACE|IGNORE)/i['test'](_0x53d889);}function getUniquePolicy(){const _0x3ada42=_0x319063;try{const _0x541f64=getConfig();return _0x541f64&&_0x541f64[_0x3ada42(0x14a)+_0x3ada42(0x1b8)+_0x3ada42(0x197)]||'ignore';}catch(_0x5dad2b){return'ignore';}}function createNativeAdapter(_0x5a206f){return{'_underlying':_0x5a206f,async 'exec'(_0x50db79){const _0x3201cd=_0x367e;try{await _0x5a206f[_0x3201cd(0x1a1)](_0x50db79);return;}catch(_0xdadd53){if(isTableAlreadyExistsError(_0xdadd53)){warn(_0x3201cd(0x19d)+_0x3201cd(0x1ae)+_0x3201cd(0x114)+'dy\x20exists)'+_0x3201cd(0x171)+'cuting\x20(na'+_0x3201cd(0x1b9)+String(_0x50db79)['slice'](-0x200e+-0x686+0x2694,-0x205f+0x245c+-0x26d));return;}if(isUniqueConstraintError(_0xdadd53)){const _0x455709=getUniquePolicy();if(_0x455709==='ignore'){warn(_0x3201cd(0x1b5)+_0x3201cd(0x11e)+_0x3201cd(0x126)+_0x3201cd(0x133)+_0x3201cd(0xd6)+'ile\x20execut'+_0x3201cd(0x119)+_0x3201cd(0x13b)+String(_0x50db79)['slice'](-0x7d*0xe+0xd3a+-0x664,-0x5*0x34f+-0x1a86+0x19*0x1c9));return;}if(_0x455709===_0x3201cd(0x189)&&looksLikeSimpleInsert(_0x50db79)){const _0xdcc02f=_0x50db79['replace'](/^\s*INSERT\s+INTO/i,_0x3201cd(0xee)+'REPLACE\x20IN'+'TO');try{await _0x5a206f[_0x3201cd(0x1a1)](_0xdcc02f);return;}catch(_0x34fc1e){throw _0x34fc1e;}}}throw _0xdadd53;}},async 'get'(_0x3d8ad8,..._0x328929){const _0x4ced52=_0x367e;try{const _0x49ee4b=normalizeBindParams(_0x328929);if(_0x49ee4b===undefined)return await _0x5a206f['get'](_0x3d8ad8);return await _0x5a206f[_0x4ced52(0x1b3)](_0x3d8ad8,_0x49ee4b);}catch(_0xcf0297){throw _0xcf0297;}},async 'all'(_0x5934b3,..._0x5c92e0){const _0x22f2ca=_0x367e;try{const _0x5cf60c=normalizeBindParams(_0x5c92e0);if(_0x5cf60c===undefined)return await _0x5a206f[_0x22f2ca(0xc1)](_0x5934b3);return await _0x5a206f[_0x22f2ca(0xc1)](_0x5934b3,_0x5cf60c);}catch(_0x2a1485){throw _0x2a1485;}},async 'run'(_0x26ad24,..._0x245ae1){const _0x2a4bcc=_0x367e;try{const _0x266106=normalizeBindParams(_0x245ae1);_0x266106===undefined?await _0x5a206f[_0x2a4bcc(0x17a)](_0x26ad24):await _0x5a206f['run'](_0x26ad24,_0x266106);return;}catch(_0x3898d1){if(isUniqueConstraintError(_0x3898d1)){const _0x4b4f9c=getUniquePolicy();if(_0x4b4f9c===_0x2a4bcc(0x154)){warn(_0x2a4bcc(0x1b5)+_0x2a4bcc(0x11e)+_0x2a4bcc(0x126)+_0x2a4bcc(0x133)+_0x2a4bcc(0xd6)+_0x2a4bcc(0x1b2)+'g\x20(native)'+':\x20'+String(_0x26ad24)[_0x2a4bcc(0x1b0)](-0x108d+0x2416+-0x3*0x683,-0x1*-0x1e56+-0x5*-0x77b+-0x422d*0x1));return;}if(_0x4b4f9c===_0x2a4bcc(0x189)&&looksLikeSimpleInsert(_0x26ad24)){const _0x2fe1bb=_0x26ad24[_0x2a4bcc(0x189)](/^\s*INSERT\s+INTO/i,_0x2a4bcc(0xee)+_0x2a4bcc(0x122)+'TO'),_0x37da5d=normalizeBindParams(_0x245ae1);try{if(_0x37da5d===undefined)await _0x5a206f[_0x2a4bcc(0x17a)](_0x2fe1bb);else await _0x5a206f[_0x2a4bcc(0x17a)](_0x2fe1bb,_0x37da5d);info(_0x2a4bcc(0x100)+_0x2a4bcc(0x172)+_0x2a4bcc(0xf6)+'R\x20REPLACE\x20'+_0x2a4bcc(0xf8));return;}catch(_0x4dca16){throw _0x4dca16;}}}throw _0x3898d1;}},async 'prepare'(_0x241ef2){const _0x5916cf=await _0x5a206f['prepare'](_0x241ef2);return{async 'run'(..._0x3c9d4f){const _0x5423e5=_0x367e,_0x15d34f=normalizeBindParams(_0x3c9d4f);try{if(_0x15d34f===undefined)await _0x5916cf[_0x5423e5(0x17a)]();else await _0x5916cf[_0x5423e5(0x17a)](_0x15d34f);return;}catch(_0x63d13b){if(isUniqueConstraintError(_0x63d13b)){const _0xb283e=getUniquePolicy();if(_0xb283e===_0x5423e5(0x154)){warn(_0x5423e5(0x1b5)+'IQUE\x20const'+'raint\x20erro'+_0x5423e5(0x133)+_0x5423e5(0xb4)+_0x5423e5(0xd1)+_0x5423e5(0xd2)+_0x5423e5(0xf2)+_0x241ef2);return;}if(_0xb283e===_0x5423e5(0x189)&&looksLikeSimpleInsert(_0x241ef2)){const _0x47e33e=_0x241ef2[_0x5423e5(0x189)](/^\s*INSERT\s+INTO/i,_0x5423e5(0xee)+_0x5423e5(0x122)+'TO'),_0x46b866=await _0x5a206f[_0x5423e5(0x14c)](_0x47e33e);try{if(_0x15d34f===undefined)await _0x46b866[_0x5423e5(0x17a)]();else await _0x46b866[_0x5423e5(0x17a)](_0x15d34f);await _0x46b866[_0x5423e5(0xcd)](),info(_0x5423e5(0x100)+_0x5423e5(0x172)+_0x5423e5(0xf6)+'R\x20REPLACE\x20'+_0x5423e5(0x103)+_0x5423e5(0x12b)+_0x5423e5(0xd5)+').');return;}catch(_0x109354){try{await _0x46b866[_0x5423e5(0xcd)]();}catch(_0x871b01){}throw _0x109354;}}}throw _0x63d13b;}},async 'finalize'(){const _0x15bdef=_0x367e;try{await _0x5916cf[_0x15bdef(0xcd)]();}catch(_0x35b11b){}}};},async 'close'(){const _0x5acde1=_0x367e;try{await _0x5a206f[_0x5acde1(0xe7)]();}catch(_0x35ed21){}},'export'(){return undefined;}};}function createSQLjsAdapter(_0x472948){const _0x32c80b=_0x472948;return{'_underlying':_0x32c80b,async 'exec'(_0x574999){const _0x4502d9=_0x367e;try{_0x32c80b[_0x4502d9(0x17a)](_0x574999);return;}catch(_0x16b226){if(isTableAlreadyExistsError(_0x16b226)){warn(_0x4502d9(0x19d)+_0x4502d9(0x1ae)+_0x4502d9(0x114)+_0x4502d9(0x138)+_0x4502d9(0x171)+_0x4502d9(0x175)+_0x4502d9(0x16e)+String(_0x574999)[_0x4502d9(0x1b0)](0x23ba+-0xe+-0x23ac,-0x7f1+-0x12d2+0x1c53));return;}if(isUniqueConstraintError(_0x16b226)){const _0x4b9d36=getUniquePolicy();if(_0x4b9d36===_0x4502d9(0x154)){warn(_0x4502d9(0x1b5)+_0x4502d9(0x11e)+_0x4502d9(0x126)+_0x4502d9(0x133)+_0x4502d9(0xd6)+_0x4502d9(0x1a8)+_0x4502d9(0xe6)+_0x4502d9(0xbe)+String(_0x574999)[_0x4502d9(0x1b0)](0x12b0+-0x2a4*0xb+0xa5c,0x16d5+-0x1*-0x2369+-0x38ae));return;}if(_0x4b9d36===_0x4502d9(0x189)&&looksLikeSimpleInsert(_0x574999)){const _0x3695f8=_0x574999['replace'](/^\s*INSERT\s+INTO/i,_0x4502d9(0xee)+_0x4502d9(0x122)+'TO');try{_0x32c80b['run'](_0x3695f8);return;}catch(_0x4091d7){throw _0x4091d7;}}}throw _0x16b226;}},async 'get'(_0x23d90f,..._0x2e0eaf){const _0x37a285=_0x367e;try{const _0x44f940=_0x32c80b['prepare'](_0x23d90f);try{const _0x32d652=normalizeBindParams(_0x2e0eaf);if(_0x32d652!==undefined)_0x44f940[_0x37a285(0x10c)](_0x32d652);if(_0x44f940[_0x37a285(0xdc)]()){const _0x3ac4b4=_0x44f940[_0x37a285(0x147)+'t']();return _0x44f940[_0x37a285(0x1a2)](),_0x3ac4b4;}else return _0x44f940[_0x37a285(0x1a2)](),undefined;}catch(_0x13382c){try{_0x44f940[_0x37a285(0x1a2)]();}catch(_0x5e06ec){}if(isUniqueConstraintError(_0x13382c)){const _0x29d77a=getUniquePolicy();if(_0x29d77a===_0x37a285(0x154))return warn('Ignored\x20UN'+_0x37a285(0x11e)+'raint\x20erro'+'r\x20during\x20g'+_0x37a285(0x173)+_0x37a285(0x16d)+':\x20'+_0x23d90f),undefined;}throw _0x13382c;}}catch(_0x32ac34){throw _0x32ac34;}},async 'all'(_0x46a028,..._0x2be423){const _0x29064c=_0x367e;try{const _0x44d99c=_0x32c80b[_0x29064c(0x14c)](_0x46a028),_0x2ebe6c=[];try{const _0x512058=normalizeBindParams(_0x2be423);if(_0x512058!==undefined)_0x44d99c['bind'](_0x512058);while(_0x44d99c[_0x29064c(0xdc)]())_0x2ebe6c[_0x29064c(0x1a9)](_0x44d99c[_0x29064c(0x147)+'t']());return _0x44d99c[_0x29064c(0x1a2)](),_0x2ebe6c;}catch(_0x4b058c){try{_0x44d99c['free']();}catch(_0x196a45){}if(isUniqueConstraintError(_0x4b058c)){const _0x3af61a=getUniquePolicy();if(_0x3af61a===_0x29064c(0x154))return warn('Ignored\x20UN'+_0x29064c(0x11e)+_0x29064c(0x126)+'r\x20during\x20a'+'ll()\x20(poli'+_0x29064c(0x16d)+':\x20'+_0x46a028),_0x2ebe6c;}throw _0x4b058c;}}catch(_0x4edd92){throw _0x4edd92;}},async 'run'(_0x3ecad6,..._0x5106d3){const _0x559320=_0x367e;try{const _0x196cef=normalizeBindParams(_0x5106d3);if(_0x196cef===undefined){_0x32c80b[_0x559320(0x17a)](_0x3ecad6);return;}else{const _0x1ff26c=_0x32c80b[_0x559320(0x14c)](_0x3ecad6);try{_0x1ff26c['bind'](_0x196cef),_0x1ff26c[_0x559320(0x17a)](),_0x1ff26c[_0x559320(0x1a2)]();return;}catch(_0x31aea3){try{_0x1ff26c[_0x559320(0x1a2)]();}catch(_0x13dba2){}if(isUniqueConstraintError(_0x31aea3)){const _0x4fa40c=getUniquePolicy();if(_0x4fa40c===_0x559320(0x154)){warn(_0x559320(0x1b5)+_0x559320(0x11e)+_0x559320(0x126)+_0x559320(0x133)+_0x559320(0xd6)+_0x559320(0x1b2)+_0x559320(0x135)+String(_0x3ecad6)[_0x559320(0x1b0)](0x874+0x3*-0x13+-0x83b,0x1830+-0x1fde+0x93e));return;}if(_0x4fa40c===_0x559320(0x189)&&looksLikeSimpleInsert(_0x3ecad6)){const _0x3841db=_0x3ecad6['replace'](/^\s*INSERT\s+INTO/i,'INSERT\x20OR\x20'+_0x559320(0x122)+'TO'),_0x27bda2=_0x32c80b[_0x559320(0x14c)](_0x3841db);try{_0x27bda2[_0x559320(0x10c)](_0x196cef),_0x27bda2['run'](),_0x27bda2[_0x559320(0x1a2)](),info(_0x559320(0x100)+_0x559320(0x172)+_0x559320(0xf6)+_0x559320(0xec)+_0x559320(0x185)+'(sql.js).');return;}catch(_0x9a8f13){try{_0x27bda2[_0x559320(0x1a2)]();}catch(_0x5691c2){}throw _0x9a8f13;}}}throw _0x31aea3;}}}catch(_0x839798){throw _0x839798;}},async 'prepare'(_0x2adfe5){const _0x4640b1=_0x367e;try{const _0x54f84f=_0x32c80b[_0x4640b1(0x14c)](_0x2adfe5);return{async 'run'(..._0x561855){const _0x4b3d6a=_0x4640b1;try{const _0x2ac70f=normalizeBindParams(_0x561855);if(_0x2ac70f!==undefined)_0x54f84f[_0x4b3d6a(0x10c)](_0x2ac70f);_0x54f84f[_0x4b3d6a(0x17a)]();try{_0x54f84f[_0x4b3d6a(0xe1)]();}catch(_0x1c305e){}return;}catch(_0x5a6943){if(isUniqueConstraintError(_0x5a6943)){const _0x3e2567=getUniquePolicy();if(_0x3e2567===_0x4b3d6a(0x154)){warn(_0x4b3d6a(0x1b5)+_0x4b3d6a(0x11e)+'raint\x20erro'+'r\x20in\x20prepa'+_0x4b3d6a(0xff)+_0x4b3d6a(0xcc)+'y=ignore):'+'\x20'+_0x2adfe5);return;}if(_0x3e2567===_0x4b3d6a(0x189)&&looksLikeSimpleInsert(_0x2adfe5)){const _0x9f936c=_0x2adfe5[_0x4b3d6a(0x189)](/^\s*INSERT\s+INTO/i,'INSERT\x20OR\x20'+'REPLACE\x20IN'+'TO'),_0x3576c0=_0x32c80b['prepare'](_0x9f936c);try{const _0x5d448d=normalizeBindParams(_0x561855);if(_0x5d448d!==undefined)_0x3576c0[_0x4b3d6a(0x10c)](_0x5d448d);_0x3576c0[_0x4b3d6a(0x17a)](),_0x3576c0[_0x4b3d6a(0x1a2)](),info(_0x4b3d6a(0x100)+_0x4b3d6a(0x172)+_0x4b3d6a(0xf6)+'R\x20REPLACE\x20'+_0x4b3d6a(0x103)+'ed\x20stateme'+'nt\x20(sql.js'+').');return;}catch(_0x1a7576){try{_0x3576c0[_0x4b3d6a(0x1a2)]();}catch(_0x415871){}throw _0x1a7576;}}}throw _0x5a6943;}},async 'finalize'(){const _0x4793d6=_0x4640b1;try{_0x54f84f[_0x4793d6(0x1a2)]();}catch(_0x3e3a5e){}}};}catch(_0x2356d9){throw _0x2356d9;}},'export'(){const _0x11e516=_0x367e;try{return _0x32c80b[_0x11e516(0x132)]();}catch(_0x55b692){throw _0x55b692;}},async 'close'(){const _0x26b2ef=_0x367e;try{if(typeof _0x32c80b[_0x26b2ef(0xe7)]==='function')_0x32c80b[_0x26b2ef(0xe7)]();else{if(typeof _0x32c80b[_0x26b2ef(0x1a2)]===_0x26b2ef(0x12e))_0x32c80b[_0x26b2ef(0x1a2)]();}}catch(_0x2fd5ab){}}};}export async function initializeDatabase(){const _0xb918ce=_0x319063;info(_0xb918ce(0x18d)+_0xb918ce(0xce)+'ion\x20proces'+_0xb918ce(0x156)+'..');try{flushTimer&&(clearInterval(flushTimer),flushTimer=null);const _0x1c55ef=getConfig();maxTotalBytes=_0x1c55ef[_0xb918ce(0x174)+_0xb918ce(0x18a)]||(0x65b+-0x16e+0xad*-0x7)*(0xad5+0x1*0x1115+-0x17ea)*(-0x831+-0x5*-0x419+-0x84c),cache=new MemoryCache(maxTotalBytes);const _0x23d67a=_0x1c55ef['PROJECT_RO'+'OT']||process[_0xb918ce(0xd0)](),_0x4d78c0=_0x307d5f[_0xb918ce(0x180)](_0x23d67a,_0x1c55ef[_0xb918ce(0x18f)]||'.db');_0x4afcc7[_0xb918ce(0xc2)+'ync'](_0x4d78c0);const _0x3ce097=_0x1c55ef[_0xb918ce(0x14b)]||_0xb918ce(0x136)+'qlite',_0x32c118=_0x307d5f[_0xb918ce(0xd3)](_0x4d78c0,_0x3ce097);let _0x16d1e8=![];try{let _0x344a35=null,_0x3291a0=null;try{_0x344a35=await import('sqlite3'),_0x3291a0=(await import('sqlite'))[_0xb918ce(0xb7)];}catch(_0x4abde8){_0x344a35=null,_0x3291a0=null;}if(_0x344a35&&_0x3291a0){await backupDB(_0x32c118);const _0x41ca69=_0x344a35[_0xb918ce(0xe9)]||_0x344a35,_0x2881bb=await _0x3291a0({'filename':_0x32c118,'driver':_0x41ca69[_0xb918ce(0x111)]});try{await _0x2881bb['exec'](_0xb918ce(0xda)+'rnal_mode\x20'+'=\x20WAL;');}catch(_0xa49e3d){}try{await _0x2881bb[_0xb918ce(0x1a1)]('PRAGMA\x20syn'+_0xb918ce(0x19c)+_0xb918ce(0xa6));}catch(_0x639ff0){}try{await _0x2881bb[_0xb918ce(0x1a1)](_0xb918ce(0x17f)+_0xb918ce(0xd8)+_0xb918ce(0x131));}catch(_0x1fe900){}try{await _0x2881bb[_0xb918ce(0x1a1)](_0xb918ce(0xc3)+'eign_keys\x20'+_0xb918ce(0xcb));}catch(_0x40f193){}adapter=createNativeAdapter(_0x2881bb),db=adapter,usingNative=!![],_0x16d1e8=!![],info(_0xb918ce(0xa7)+'ve\x20sqlite3'+_0xb918ce(0x1b6));}}catch(_0x113aed){warn(_0xb918ce(0xf1)+_0xb918ce(0x161)+_0xb918ce(0x192)+'l\x20attempt\x20'+_0xb918ce(0x19a)+_0xb918ce(0x10f)+(_0x113aed?.[_0xb918ce(0x11c)]||_0x113aed)),_0x16d1e8=![],adapter=null,db=null,usingNative=![];}if(!_0x16d1e8)try{const _0x15640d=await import('sql.js'),_0x55c722=_0x15640d[_0xb918ce(0xe9)]||_0x15640d,_0xd83202=await _0x55c722({'locateFile':_0x1823d0=>{const _0x5a72aa=_0xb918ce,_0x6eafcc=_0x1c55ef['SQLJS_WASM'+_0x5a72aa(0x121)];if(_0x6eafcc)return _0x6eafcc;return _0x307d5f[_0x5a72aa(0xd3)](process['cwd'](),'node_modul'+'es',_0x5a72aa(0x110),_0x5a72aa(0x129),_0x1823d0);}});let _0x3a072b;if(await _0x4afcc7['pathExists'](_0x32c118)){const _0x4b6920=await _0x4afcc7[_0xb918ce(0x148)](_0x32c118),_0x27ea90=new Uint8Array(_0x4b6920);_0x3a072b=new _0xd83202[(_0xb918ce(0x111))](_0x27ea90),info(_0xb918ce(0x153)+'file\x20into\x20'+'SQL.js\x20fro'+'m\x20'+_0x32c118);}else _0x3a072b=new _0xd83202['Database'](),info(_0xb918ce(0x1aa)+_0xb918ce(0xab)+_0xb918ce(0x14d)+_0xb918ce(0x13d)+'\x20present)');adapter=createSQLjsAdapter(_0x3a072b),db=adapter,usingNative=![],info('Using\x20SQL.'+'js\x20(WASM)\x20'+_0xb918ce(0xb8));}catch(_0x4168b9){error(_0xb918ce(0x19a)+_0xb918ce(0x187)+_0xb918ce(0x155),_0x4168b9);throw _0x4168b9;}try{await adapter[_0xb918ce(0x1a1)](_0xb918ce(0xc3)+_0xb918ce(0x188)+_0xb918ce(0xcb));}catch(_0x35015b){}try{await adapter['exec']('PRAGMA\x20bus'+_0xb918ce(0xd8)+_0xb918ce(0x131));}catch(_0x3566f0){}await applyMigrations(),await prepareStatements(),dbReady=!![],writeQueue=[],queueBytes=0x157f+-0x27b*-0x5+-0x10f3*0x2;const _0x18d207=_0x1c55ef[_0xb918ce(0xac)+_0xb918ce(0x158)]||-0x1052+0x1*-0x1ded+-0x1205*-0x3;flushTimer=setInterval(()=>{const _0x52635c=_0xb918ce;flushQueue()[_0x52635c(0x1ac)](_0x2fcea2=>error(_0x52635c(0xc5)+_0x52635c(0xf3)+'ng\x20schedul'+_0x52635c(0xaa)+'eue:',_0x2fcea2));},_0x18d207),info(_0xb918ce(0x18d)+_0xb918ce(0x18c)+'\x20('+(usingNative?_0xb918ce(0x15b)+'ite3':_0xb918ce(0x139))+(').\x20Backing'+_0xb918ce(0xd7))+_0x32c118);}catch(_0x48c80b){error(_0xb918ce(0x127)+'ror:\x20'+(_0x48c80b?.[_0xb918ce(0x11c)]||_0x48c80b),_0x48c80b);throw _0x48c80b;}}async function prepareStatements(){const _0x5d3803=_0x319063;setStmt=await adapter[_0x5d3803(0x14c)](_0x5d3803(0xee)+'REPLACE\x20IN'+_0x5d3803(0x176)+_0x5d3803(0x195)+_0x5d3803(0x105)+_0x5d3803(0xfa)+'?,\x20?)'),deleteStmt=await adapter[_0x5d3803(0x14c)]('DELETE\x20FRO'+_0x5d3803(0x181)+_0x5d3803(0xa3)+_0x5d3803(0xb0)+'?');}async function applyMigrations(){const _0x19130f=_0x319063;await adapter[_0x19130f(0x1a1)](_0x19130f(0x167)+_0x19130f(0xc4)+_0x19130f(0x116)+'_value_sto'+'re\x20(key\x20TE'+_0x19130f(0xa9)+_0x19130f(0x15c)+'e\x20TEXT);'),await adapter['exec'](_0x19130f(0x167)+_0x19130f(0xc4)+'EXISTS\x20log'+'s\x20(ts\x20INTE'+'GER\x20PRIMAR'+_0x19130f(0xbf)+'ule\x20TEXT,\x20'+'level\x20TEXT'+',\x20message\x20'+_0x19130f(0x12a));}async function flushQueue(){const _0x3d0926=_0x319063;if(!dbReady||isFlushing||writeQueue[_0x3d0926(0x143)]===0x1*-0x14ff+0x3af+0x454*0x4)return;const _0xd7d310=writeQueue[0x5e7+-0x64*-0x1+-0x64b];if(_0xd7d310&&_0xd7d310[_0x3d0926(0xf7)]>-0x5*-0x458+-0x684+-0xf34&&Date[_0x3d0926(0xe2)]()-_0xd7d310[_0x3d0926(0x124)]<-0x1745+-0x1*0x2157+0x4454)return;isFlushing=!![];const _0x4c4232=getConfig(),_0x3b3525=_0x4c4232[_0x3d0926(0x196)+_0x3d0926(0x10b)]||-0x421*0x8+0x846+0x18f4,_0x211774=writeQueue[_0x3d0926(0x151)](-0xb1b+0x1c*0x7f+-0x2c9,_0x3b3525),_0x3f187f=_0x211774[_0x3d0926(0x113)]((_0x30e2e2,_0x5638b5)=>_0x30e2e2+(_0x5638b5[_0x3d0926(0x16b)]||0xaef+0x9*-0x31b+-0x16*-0xc6),-0xa26+0x47*0x7a+-0x17b0);try{await adapter[_0x3d0926(0x1a1)](_0x3d0926(0x160)+_0x3d0926(0x164));for(const _0x38d692 of _0x211774){try{switch(_0x38d692[_0x3d0926(0x19b)]){case'set':await setStmt[_0x3d0926(0x17a)](_0x38d692[_0x3d0926(0xb3)],_0x38d692[_0x3d0926(0x17c)]);break;case'delete':await deleteStmt[_0x3d0926(0x17a)](_0x38d692[_0x3d0926(0xb3)]);break;default:warn(_0x3d0926(0x112)+_0x3d0926(0xdd)+_0x3d0926(0xe3)+_0x3d0926(0x1a7)+_0x38d692[_0x3d0926(0x19b)]);}}catch(_0x4dc468){error(_0x3d0926(0x18b)+_0x3d0926(0x102)+_0x3d0926(0x107)+_0x3d0926(0x1ad)+_0x3d0926(0x1a3)+_0x3d0926(0x199)+_0x3d0926(0x16a)+JSON[_0x3d0926(0x191)](_0x38d692)+(',\x20itemErr:'+'\x20')+(_0x4dc468?.[_0x3d0926(0x11c)]||_0x4dc468));throw _0x4dc468;}}await adapter['exec'](_0x3d0926(0xd4));if(!usingNative)try{await persistDatabaseToFile();}catch(_0x3df10d){error('Failed\x20to\x20'+_0x3d0926(0xaf)+'\x20file\x20afte'+_0x3d0926(0x1a6),_0x3df10d);}queueBytes-=_0x3f187f;}catch(_0x99f6b1){error('DB\x20flush\x20t'+_0x3d0926(0x104)+_0x3d0926(0x179)+_0x3d0926(0xc8)+_0x3d0926(0xfb)+'ng\x20for\x20ret'+_0x3d0926(0x18e),_0x99f6b1);try{await adapter[_0x3d0926(0x1a1)](_0x3d0926(0xc9));}catch(_0xed4739){error(_0x3d0926(0x1ba)+_0x3d0926(0x170),_0xed4739);}const _0x5d7848=Date[_0x3d0926(0xe2)](),_0x149205=[];for(const _0x581b34 of _0x211774){_0x581b34[_0x3d0926(0xf7)]=(_0x581b34['retries']||0x2627*0x1+0x4*-0x599+-0xfc3)+(-0x53*0x4f+-0x266b+-0xd*-0x4ed),_0x581b34[_0x3d0926(0x124)]=_0x5d7848;if(_0x581b34['retries']<-0x20b7+0x1a87*0x1+0x632*0x1)_0x149205[_0x3d0926(0x1a9)](_0x581b34);else error(_0x3d0926(0x163)+_0x3d0926(0x159)+_0x3d0926(0x19e)+_0x3d0926(0x11b)+_0x3d0926(0x134)+_0x3d0926(0xe5)+JSON[_0x3d0926(0x191)](_0x581b34));}if(_0x149205[_0x3d0926(0x143)]>-0xb27+0x4c7+0x66*0x10)writeQueue[_0x3d0926(0x10d)](..._0x149205);}finally{isFlushing=![];}}async function persistDatabaseToFile(){const _0x1b0f24=_0x319063,_0xd75ad3=getConfig(),_0x3355e5=_0xd75ad3[_0x1b0f24(0xc0)+'OT']||process[_0x1b0f24(0xd0)](),_0x2321aa=_0x307d5f[_0x1b0f24(0x180)](_0x3355e5,_0xd75ad3[_0x1b0f24(0x18f)]||_0x1b0f24(0x186)),_0xa4fbde=_0xd75ad3['DB_NAME']||_0x1b0f24(0x136)+_0x1b0f24(0xf0),_0x6c8cde=_0x307d5f[_0x1b0f24(0xd3)](_0x2321aa,_0xa4fbde);if(usingNative)return;try{const _0x40088a=adapter[_0x1b0f24(0x132)]();if(!_0x40088a)return;const _0x2b83d2=_0x6c8cde+_0x1b0f24(0x141);await _0x4afcc7['writeFile'](_0x2b83d2,Buffer[_0x1b0f24(0x144)](_0x40088a)),await _0x4afcc7[_0x1b0f24(0x146)](_0x2b83d2,_0x6c8cde,{'overwrite':!![]}),info(_0x1b0f24(0x117)+_0x1b0f24(0x149)+'o\x20'+_0x6c8cde);}catch(_0x9ad90d){throw _0x9ad90d;}}export async function get(_0x1f1552){const _0x14818f=_0x319063;if(cache[_0x14818f(0x11d)](_0x1f1552))return cache[_0x14818f(0x1b3)](_0x1f1552);if(!dbReady)return warn('DB\x20not\x20rea'+_0x14818f(0xa8)+_0x14818f(0xed)+'.'),undefined;try{const _0x26e341=await adapter[_0x14818f(0x1b3)](_0x14818f(0x11a)+'ue\x20FROM\x20ke'+_0x14818f(0x166)+'ore\x20WHERE\x20'+_0x14818f(0xc6),_0x1f1552);if(_0x26e341&&_0x26e341[_0x14818f(0x17c)]!=null)try{const _0xe8c3ee=JSON['parse'](_0x26e341[_0x14818f(0x17c)]);return cache[_0x14818f(0x12c)](_0x1f1552,_0xe8c3ee,_0x26e341[_0x14818f(0x17c)]),_0xe8c3ee;}catch(_0x297a9f){return error('Failed\x20to\x20'+_0x14818f(0x1b7)+_0x14818f(0x17e)+_0x14818f(0xde)+_0x1f1552+'\x22:\x20'+(_0x297a9f?.[_0x14818f(0x11c)]||_0x297a9f)),undefined;}}catch(_0x1126c3){error(_0x14818f(0x18b)+_0x14818f(0x13f)+_0x1f1552+(_0x14818f(0x14f)+'\x20')+(_0x1126c3?.['message']||_0x1126c3),_0x1126c3);}return undefined;}export function set(_0x1476f2,_0x1272a7){const _0x830eac=_0x319063;if(_0x1272a7===undefined){del(_0x1476f2);return;}let _0x37172d;try{_0x37172d=JSON[_0x830eac(0x191)](_0x1272a7);}catch(_0x569890){error(_0x830eac(0xe8)+_0x830eac(0xae)+_0x1476f2+(_0x830eac(0x169)+_0x830eac(0x1a5)+_0x830eac(0xb6)+_0x830eac(0xfe)),_0x569890);return;}cache['set'](_0x1476f2,_0x1272a7,_0x37172d);const _0xbf8816={'type':_0x830eac(0x12c),'key':_0x1476f2,'value':_0x37172d,'retries':0x0,'timestamp':Date[_0x830eac(0xe2)]()};_0xbf8816[_0x830eac(0x16b)]=estimateQueueItemSize(_0xbf8816),queueBytes+=_0xbf8816['size'],writeQueue['push'](_0xbf8816),enforceMemoryLimit(),writeQueue[_0x830eac(0x143)]>=getConfig()[_0x830eac(0x196)+'IZE']&&flushQueue()[_0x830eac(0x1ac)](_0x5f0e0a=>error(_0x830eac(0x123)+_0x830eac(0x165)+_0x830eac(0x108)+_0x830eac(0x1ab)+_0x830eac(0x194),_0x5f0e0a));}export function del(_0x1938bf){const _0x3e79b7=_0x319063;cache[_0x3e79b7(0x125)](_0x1938bf);const _0x57d6c5={'type':_0x3e79b7(0x125),'key':_0x1938bf,'retries':0x0,'timestamp':Date['now']()};_0x57d6c5[_0x3e79b7(0x16b)]=estimateQueueItemSize(_0x57d6c5),queueBytes+=_0x57d6c5[_0x3e79b7(0x16b)],writeQueue['push'](_0x57d6c5),enforceMemoryLimit(),writeQueue[_0x3e79b7(0x143)]>=getConfig()['DB_BATCH_S'+_0x3e79b7(0x10b)]&&flushQueue()[_0x3e79b7(0x1ac)](_0x37388c=>error(_0x3e79b7(0x123)+_0x3e79b7(0x165)+'eue\x20trigge'+'red\x20by\x20del'+_0x3e79b7(0x194),_0x37388c));}export async function shutdownDatabase(){const _0x29a3ef=_0x319063;info('Database\x20s'+_0x29a3ef(0x150)+_0x29a3ef(0xdf)+_0x29a3ef(0x120)+'shing\x20queu'+_0x29a3ef(0xa5)),dbReady=![];flushTimer&&(clearInterval(flushTimer),flushTimer=null);try{await flushQueue(),await flushQueue(),info(_0x29a3ef(0xca)+_0x29a3ef(0x101)+'d.');}catch(_0x2451f2){error(_0x29a3ef(0x123)+_0x29a3ef(0xb5)+_0x29a3ef(0x16f)+'pts:',_0x2451f2);}if(setStmt){try{await setStmt['finalize']();}catch(_0x8bd3ba){warn(_0x29a3ef(0x190)+_0x29a3ef(0xb2)+'Stmt:',_0x8bd3ba);}setStmt=null;}if(deleteStmt){try{await deleteStmt['finalize']();}catch(_0x20f01c){warn(_0x29a3ef(0x190)+_0x29a3ef(0x15f)+_0x29a3ef(0x182),_0x20f01c);}deleteStmt=null;}try{await persistDatabaseToFile();}catch(_0x98a6a6){error('Error\x20pers'+_0x29a3ef(0x115)+'file\x20durin'+_0x29a3ef(0x14e)+':',_0x98a6a6);}if(adapter){try{await adapter[_0x29a3ef(0xe7)](),info(_0x29a3ef(0xe0)+_0x29a3ef(0x17b)+_0x29a3ef(0x106)+_0x29a3ef(0x177));}catch(_0x14681d){error(_0x29a3ef(0x123)+'ng\x20final\x20d'+'atabase\x20cl'+_0x29a3ef(0x183),_0x14681d);}adapter=null,db=null;}info(_0x29a3ef(0xf5)+'hutdown\x20pr'+'ocess\x20comp'+_0x29a3ef(0x1b4)+_0x29a3ef(0xa4));}async function backupDB(_0x211c7f){const _0x9949c0=_0x319063;try{if(!await _0x4afcc7[_0x9949c0(0xa2)](_0x211c7f))return;const _0x12080e=_0x307d5f[_0x9949c0(0xc7)](_0x211c7f),_0x3c9163=_0x307d5f['basename'](_0x211c7f,_0x307d5f['extname'](_0x211c7f)),_0x133414=_0x307d5f[_0x9949c0(0xd3)](_0x12080e,_0x3c9163+'.bak'),_0x594b6f=await _0x4afcc7[_0x9949c0(0xa2)](_0x133414)?await _0x4afcc7[_0x9949c0(0xb1)](_0x133414):null,_0xed754c=_0x594b6f?Date[_0x9949c0(0xe2)]()-_0x594b6f[_0x9949c0(0x140)]:Infinity;_0xed754c>(-0x7*-0x254+0x1f18+0x17a6*-0x2)*(0x841*0x2+0x26ab+-0x5*0xafd)*(0x56c+0x7ac+-0x1*0xcdc)*(0x1689+0xb05+0x1*-0x1da6)&&(await _0x4afcc7['copy'](_0x211c7f,_0x133414,{'overwrite':!![]}),info(_0x9949c0(0x145)+_0x9949c0(0xdb)+_0x9949c0(0x152)+_0x133414));}catch(_0x4bc63a){error(_0x9949c0(0x145)+_0x9949c0(0x10e)+_0x9949c0(0x162)+(_0x4bc63a?.['message']||_0x4bc63a),_0x4bc63a);}}function _0x367e(_0x50eea7,_0x1c3d26){const _0x2c0bff=_0x27f8();return _0x367e=function(_0x4318be,_0x2ced71){_0x4318be=_0x4318be-(0x2388+-0x1*0x19ae+-0xa*0xec);let _0x2d31d4=_0x2c0bff[_0x4318be];return _0x2d31d4;},_0x367e(_0x50eea7,_0x1c3d26);}process[_0x319063(0x12d)](_0x319063(0x193),()=>{const _0x96a427=_0x319063;shutdownDatabase()[_0x96a427(0xef)](()=>process[_0x96a427(0x137)](-0x1ec6+-0x65*-0xb+0x65*0x43));}),process['once'](_0x319063(0x1a4),()=>{const _0x91f07c=_0x319063;shutdownDatabase()[_0x91f07c(0xef)](()=>process[_0x91f07c(0x137)](-0x13dc+0xfd9*0x1+0x403));});export{adapter as _adapter};