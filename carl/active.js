const _0x506208=_0x1aa6;(function(_0x4d2803,_0x478130){const _0x5f52e=_0x1aa6,_0x3bde3f=_0x4d2803();while(!![]){try{const _0x211ea7=parseInt(_0x5f52e(0xfc))/(-0x4c*0x7e+-0x182f+0x3d98)+-parseInt(_0x5f52e(0x167))/(0x85*0x1+-0xf*-0x1d9+-0x1c3a)+parseInt(_0x5f52e(0x91))/(0x1cd2+-0x18b7+-0x418)+parseInt(_0x5f52e(0xd6))/(-0x85*0x39+-0x960+0x1*0x2701)+-parseInt(_0x5f52e(0xb3))/(0x4b1*-0x2+0x1*0x72e+0x239)*(-parseInt(_0x5f52e(0x123))/(-0x1*-0x5fd+0x1183+-0xbbd*0x2))+parseInt(_0x5f52e(0x189))/(-0x7b7+-0x1b5f+0x1*0x231d)+parseInt(_0x5f52e(0x14b))/(-0x2082*-0x1+0x53b*-0x3+-0x10c9)*(-parseInt(_0x5f52e(0xe6))/(-0x3fa+-0x1d7f+-0x1*-0x2182));if(_0x211ea7===_0x478130)break;else _0x3bde3f['push'](_0x3bde3f['shift']());}catch(_0x302584){_0x3bde3f['push'](_0x3bde3f['shift']());}}}(_0x2ea7,-0x29*-0x172f+-0x49*-0x15e1+-0x45c02));import{DateTime}from'luxon';import{db}from'../utils/database.js';function _0x2ea7(){const _0x4d2be2=['EXISTS\x20idx','yyyy-LL-dd','\x20\x20\x20\x20WHERE\x20','IMARY\x20KEY\x20','744CydGKJ','get','failed\x20for','push','_leaderboa','sage_count','EXISTS\x20act','toLowerCas','e_count\x20=\x20','_jid,\x20user','user_jid','OT\x20NULL,\x0a\x20','amount','\x20\x20\x20\x20\x20\x20\x20id\x20','STS\x20active','nMessage\x20f','determine\x20','es:\x20active','\x20\x27daily\x27\x20A',',\x20\x20\x20\x20\x20\x20\x20\x20-','\x20\x20\x20\x20\x20user_','\x20=\x20?\x20AND\x20t','ay_name,\x20l','e_stats(ch','Found\x20','ctive\x20<amo','MIT\x201','rackMessag','173046fNqUif','\x20messages\x0a','pdated\x20=\x20?','weekly','chat_jid','No\x20inactiv',',\x20\x20\x20\x20\x20\x20--\x20','t_jid,\x20use','ACTIVE','sage_id\x20TE','leaned\x20up','ollups\x20com','\x20\x20\x20\x20\x20UNIQU','frame,\x20buc','?,\x20?,\x20\x27mon','ge_count\x20I',':\x20YYYY\x0a\x20\x20\x20','ily\x27,\x20?,\x201','CREATE\x20TAB','\x20\x20\x20\x20\x20\x20\x20SET','jid\x20=\x20?\x20AN','chat_jid,\x20','ucket_key)','ily\x27\x20AND\x20b','1.1.1','has','<=\x20?','ive_migrat','delete','O_WEEK_DAY','ðŸ‘¤\x20@','[active]\x20c','KEY,\x20migra','SELECT\x20id,','4150496NeDxMo','\x20\x20\x20\x20last_u','.ACTIVE:\x20','user_jid);','SELECT\x20use','\x20\x20\x20\x20\x20\x20disp','tats\x20WHERE','ATE\x20TABLE\x20','ount\x20=\x20mes','he\x20last\x20','TIME_ZONE','SELECT\x20id\x20','senderName','imeframe\x20=','meframe\x20=\x20','CREATE\x20IND','lay_name\x20=','plete','unt><d|w|m','ups\x20failed','f\x20ON\x20activ','setZone','id\x20=\x20?','ats_chat_u',';\x0a\x20\x20\x20\x20','ow\x27)));','\x20?\x20AND\x20tim','\x0a\x20\x20\x20\x20\x20\x20SEL',',\x20user_jid','last_ts','object','\x20+\x201,\x20disp','\x20\x20\x20\x20\x20messa','rly\x27,\x20?,\x20?','_key\x20=\x20?\x20L','rune\x20daily',')\x20VALUES\x20(','=\x20?\x20AND\x20ti','erformRoll','Y-WW,\x20mont','T\x20NOT\x20NULL','clear','stats\x20WHER','\x20message_c','ser\x20ON\x20act','toFormat','cnt,\x20MAX(l','cket_key,\x20','month','unt','id\x20=\x20?\x20AND','\x20inactive\x20','bucket_key','_active_st','\x0a\x20\x20\x20\x20\x20\x20\x20\x20U','\x20INSERT\x20IN','sendMessag','ve_stats\x20W','EXT\x20DEFAUL','inactive','\x201d,\x20activ','?,\x20?,\x20\x27yea','\x20\x20\x20\x20\x20\x20','ive_stats\x20',',\x20timefram','No\x20active\x20','MAX_DAILY_','\x20\x20\x20chat_ji','eframe,\x20bu','s\x20(\x0a\x20\x20\x20\x20\x20\x20','rame\x20=\x20\x27mo','isCommand','_jid,\x20time','nthly\x27','key\x20=\x20?\x0a\x20\x20','\x20\x20\x20\x20\x20\x20\x20mes','eekly:\x20YYY','function','map','LT\x20(strfti',':\x0a\x0a','thly\x27,\x20?,\x20','count','\x20user_jid\x20','\x20id\x20IN\x20(',',\x20?,\x20?)','\x20the\x20last\x20','rame\x20=\x20\x27we','ion\x20INTEGE','1021929vldoES','catch','\x20user_jid,','ARY\x20KEY,\x0a\x20','key\x20=\x20?\x20LI','e\x20=\x20?,\x20las','values','ket_key,\x20m','N\x20(\x27weekly','\x0a\x20\x20\x20\x20','lay_name\x20T','nitialized','all','e\x20unexpect','\x20failed:\x20','y_name,\x20la','board\x20erro','st_updated','slice','ed:\x20','r_jid,\x20tim','ND\x20bucket_','ive\x20<amoun','participan','||yearly||','found\x20in\x20t','join','key','HERE\x20chat_','floor','meframe,\x20b','_MS','AND\x20bucket','padStart','8435gGJrJC','count)\x20AS\x20','\x20FROM\x20acti','[active]\x20p','now','end\x20usage\x20','\x20AND\x20bucke','\x20timeframe','ve_stats\x0a\x20','||weekly||','\x20?,\x20last_u','\x27weekly\x27\x20A','trim','EX\x20IF\x20NOT\x20','\x27yearly\x27\x20A','FROM\x20activ','HERE\x20timef','minus','\x20chat_jid,','uildLeader','[active]\x20d','t_key\x20<=\x20?','nsureSchem','pdated\x20INT','UPDATE\x20act','O_YEAR_DAY','INSERT\x20INT','isplay_nam','stats\x20(cha','MM,\x20yearly','match','unit','weekYear','O_MONTH_DA','me(\x27%s\x27,\x27n','1967880miXDVA','e_stats\x0a\x20\x20','TO\x20active_','changes','jid\x20TEXT\x20N','length','OM\x20active_','e,\x20bucket_','\x0a\x20\x20\x20\x20\x20\x20CRE','DELETE\x20FRO','eframe\x20TEX','from','ROLLOVER_T',',\x20?,\x20?)\x0a\x20\x20','filter','\x20\x20\x20VALUES\x20','156294fPJsJv','ted_at\x20INT','day','[active]\x20s','?,\x20?,\x20\x27wee','active','ENT,\x0a\x20\x20\x20\x20\x20','string','e\x20DB\x20error','fromSecond','KEEP_DAYS','IMIT\x201','[active]\x20f','T_RETURN','M\x20active_s','e\x20members\x20','set','-\x20\x27daily\x27|','e_stats\x20WH','etGroupPar','E(chat_jid','es\x0a\x0a','316939Nobgtq','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20','message_co','ers\x20in\x20the','monthly','run','\x20\x20\x20GROUP\x20B','splay_name','d)\x20AS\x20last','\x20\x20\x20\x20','\x20);\x0a\x20\x20\x20\x20','rd_message','[active]\x20o','\x20NULL,\x0a\x20\x20\x20','isArray','[active]\x20e','y\x20>=\x20?\x0a\x20\x20\x20','\x20bucket_ke','Usage:\x20act','essage_cou','sort','\x20TEXT\x20PRIM','remoteJid','t><d|w|m|y','timeframe','toSeconds','[active]\x20b','nt,\x20displa','sourceIds','sock','unt\x20+\x20?,\x20d','startOf','\x20active\x20us','d)\x0a\x20\x20\x20\x20\x20\x20\x20','a\x20failed','group\x20part','ow\x27)),\x0a\x20\x20\x20','ekly\x27','[active]\x20t','1158ZEUGct','Y\x20user_jid','t_updated\x20','display_na','USERS_LIMI','text','yearly','unt,\x20displ','SET\x20messag','imeframe\x20I','ay_name\x20FR','chema\x20ensu','message','>\x20\x20OR\x20\x20ina','tats\x20(chat','=\x20?\x20WHERE\x20','_count,\x20di','ions\x20(vers','O\x20active_s','eframe\x20=\x20\x27','hly:\x20YYYY-','ERE\x20chat_j','tive\x207d','pushName','cnt','EGER\x20DEFAU','||monthly|','exec','endsWith','INTEGER\x20PR','\x20last\x20','kly\x27,\x20?,\x20?','\x20=\x20\x27daily\x27','ata','split','fromObject'];_0x2ea7=function(){return _0x4d2be2;};return _0x2ea7();}import{info,warn,error}from'../utils/logger.js';import{isadmin}from'../utils/isadmin.js';import{getConfig}from'../utils/config.js';import{getBotJid}from'../utils/bot-state.js';export const name=_0x506208(0xeb);export const version=_0x506208(0x17f);export const priority=-0x20e3*-0x1+0xbac+-0x2c35;export const commands=[_0x506208(0xeb),_0x506208(0x1c4)];let botRef=null,sendApi=null;const DEFAULTS={'TIME_ZONE':'UTC','MAX_DAILY_KEEP_DAYS':0x5a,'ROLLOVER_TO_WEEK_DAYS':0x7,'ROLLOVER_TO_MONTH_DAYS':0x1e,'ROLLOVER_TO_YEAR_DAYS':0x16d,'USERS_LIMIT_RETURN':0xc8,'DEDUPE_TTL_MS':(0x214a+0xe4d+-0x3*0xfd3)*(-0x15*0xe2+0x1c5b+-0x5e9)};let CONFIG={...DEFAULTS};function _0x1aa6(_0x577011,_0x33205c){const _0x21e465=_0x2ea7();return _0x1aa6=function(_0x2ecdbe,_0x363dbc){_0x2ecdbe=_0x2ecdbe-(-0x19c5+-0xc1+0x1b15);let _0x57d467=_0x21e465[_0x2ecdbe];return _0x57d467;},_0x1aa6(_0x577011,_0x33205c);}function normalizeJid(_0x5ba4f4){const _0x636c88=_0x506208;return _0x5ba4f4?String(_0x5ba4f4)[_0x636c88(0xbf)]():'';}function sleep(_0x127a31){return new Promise(_0x4be0b7=>setTimeout(_0x4be0b7,_0x127a31));}function toLowerRoman(_0x9c180d){const _0x4326b9=_0x506208,_0x10f4c6=[[0x77b*-0x4+-0x25e3+0x47b7,'M'],[0x14*0x11b+-0x2*-0x10ea+0xf4*-0x37,'CM'],[-0x3e8+0x10ff+-0xb23,'D'],[-0x59*-0xa+-0xbc9+0x169*0x7,'CD'],[-0x1*0x1ade+-0x4c1+0x37*0x95,'C'],[-0x26f4+0x1*0x8ef+0x1e5f,'XC'],[0x21*0x21+0x2be+-0x1*0x6cd,'L'],[0x13c2+0xcb5*0x1+0x204f*-0x1,'XL'],[0x95*-0x20+0xe24*0x2+0x2*-0x4cf,'X'],[0x1311*0x1+-0x3*-0xad+-0x150f,'IX'],[-0xe78+-0x602*0x3+0x2083,'V'],[-0x8*0x295+0x1*-0x1145+-0x373*-0xb,'IV'],[0x1931+0x885+-0x21b5,'I']];let _0x59fbe4=_0x9c180d,_0x105b80='';for(const [_0x1ab1ee,_0x3642e0]of _0x10f4c6)while(_0x59fbe4>=_0x1ab1ee){_0x105b80+=_0x3642e0,_0x59fbe4-=_0x1ab1ee;}return _0x105b80[_0x4326b9(0x152)+'e']();}function romanParen(_0x3516ca){return'('+toLowerRoman(_0x3516ca)+')';}const processedMessageKeys=new Map();function makeDedupeKey(_0x3e0e03){const _0x2dd624=_0x506208,_0x551358=_0x3e0e03?.['key'];if(!_0x551358)return null;const _0x5a9fe1=_0x551358['id']||_0x551358[_0x2dd624(0xa8)+'t']||'',_0x366d1b=_0x551358[_0x2dd624(0x112)]||'';return _0x366d1b+'::'+_0x5a9fe1;}function isMsgProcessed(_0x544e9c){const _0x5ce7f0=_0x506208;return _0x544e9c&&processedMessageKeys[_0x5ce7f0(0x180)](_0x544e9c);}function markMsgProcessed(_0x5c9524){const _0x33719a=_0x506208;if(!_0x5c9524)return;if(processedMessageKeys['has'](_0x5c9524))clearTimeout(processedMessageKeys[_0x33719a(0x14c)](_0x5c9524));const _0x136a0e=setTimeout(()=>processedMessageKeys[_0x33719a(0x183)](_0x5c9524),CONFIG['DEDUPE_TTL'+_0x33719a(0xb0)]);processedMessageKeys[_0x33719a(0xf6)](_0x5c9524,_0x136a0e);}async function ensureSchema(){const _0x2a6aee=_0x506208;try{await db[_0x2a6aee(0x13e)](_0x2a6aee(0x179)+'LE\x20IF\x20NOT\x20'+_0x2a6aee(0x151)+_0x2a6aee(0x182)+_0x2a6aee(0x134)+_0x2a6aee(0x90)+'R\x20PRIMARY\x20'+_0x2a6aee(0x187)+_0x2a6aee(0xe7)+'EGER\x20DEFAU'+_0x2a6aee(0x1d8)+_0x2a6aee(0xd5)+_0x2a6aee(0x1a2)),await db[_0x2a6aee(0x13e)](_0x2a6aee(0xde)+_0x2a6aee(0x190)+'IF\x20NOT\x20EXI'+_0x2a6aee(0x159)+'_stats\x20(\x0a\x20'+_0x2a6aee(0x158)+_0x2a6aee(0x140)+_0x2a6aee(0x14a)+'AUTOINCREM'+_0x2a6aee(0xec)+_0x2a6aee(0x1cc)+'d\x20TEXT\x20NOT'+_0x2a6aee(0x109)+_0x2a6aee(0x15f)+_0x2a6aee(0xda)+_0x2a6aee(0x156)+'\x20\x20\x20\x20\x20\x20\x20tim'+_0x2a6aee(0xe0)+'T\x20NOT\x20NULL'+_0x2a6aee(0x15e)+_0x2a6aee(0xf7)+'\x27weekly\x27|\x27'+'monthly\x27|\x27'+'yearly\x27\x0a\x20\x20'+'\x20\x20\x20\x20\x20\x20buck'+'et_key\x20TEX'+_0x2a6aee(0x1b1)+_0x2a6aee(0x16d)+'daily:\x20YYY'+'Y-MM-DD,\x20w'+_0x2a6aee(0x1d5)+_0x2a6aee(0x1b0)+_0x2a6aee(0x137)+_0x2a6aee(0xd0)+_0x2a6aee(0x177)+_0x2a6aee(0x1a9)+_0x2a6aee(0x176)+'NTEGER\x20DEF'+'AULT\x200,\x0a\x20\x20'+_0x2a6aee(0x18e)+_0x2a6aee(0x9b)+_0x2a6aee(0x1c3)+'T\x20\x27\x27,\x0a\x20\x20\x20\x20'+_0x2a6aee(0x18a)+_0x2a6aee(0xca)+_0x2a6aee(0x13c)+'LT\x20(strfti'+'me(\x27%s\x27,\x27n'+_0x2a6aee(0x120)+_0x2a6aee(0x173)+_0x2a6aee(0xfa)+_0x2a6aee(0x1a5)+_0x2a6aee(0x1c9)+_0x2a6aee(0xdd)+'key)\x0a\x20\x20\x20\x20\x20'+_0x2a6aee(0x106)),await db['exec'](_0x2a6aee(0x198)+_0x2a6aee(0xc0)+_0x2a6aee(0x147)+_0x2a6aee(0x1be)+'ats_chat_t'+_0x2a6aee(0x19d)+_0x2a6aee(0x162)+'at_jid,\x20ti'+_0x2a6aee(0xaf)+_0x2a6aee(0x17d)+';'),await db[_0x2a6aee(0x13e)](_0x2a6aee(0x198)+_0x2a6aee(0xc0)+_0x2a6aee(0x147)+_0x2a6aee(0x1be)+_0x2a6aee(0x1a0)+_0x2a6aee(0x1b5)+'ive_stats('+_0x2a6aee(0x17c)+_0x2a6aee(0x18c)),await db[_0x2a6aee(0x13e)]('\x0a\x20\x20\x20\x20\x20\x20CRE'+'ATE\x20TABLE\x20'+'IF\x20NOT\x20EXI'+'STS\x20active'+_0x2a6aee(0x14f)+_0x2a6aee(0x107)+_0x2a6aee(0x1ce)+'\x20\x20chat_jid'+_0x2a6aee(0x111)+_0x2a6aee(0x94)+_0x2a6aee(0x1d4)+_0x2a6aee(0x170)+'XT\x0a\x20\x20\x20\x20\x20\x20)'+_0x2a6aee(0x1a1)),info(_0x2a6aee(0xe9)+_0x2a6aee(0x12e)+'red');}catch(_0x48d12d){error(_0x48d12d,_0x2a6aee(0x10b)+_0x2a6aee(0xc9)+_0x2a6aee(0x11e));throw _0x48d12d;}}export async function trackMessage(_0x5a2c5c){const _0x284c8b=_0x506208;try{if(!_0x5a2c5c||!_0x5a2c5c[_0x284c8b(0xac)]||!_0x5a2c5c[_0x284c8b(0x12f)])return;const _0x49cd02=makeDedupeKey(_0x5a2c5c);if(!_0x49cd02)return;if(isMsgProcessed(_0x49cd02))return;markMsgProcessed(_0x49cd02);if(_0x5a2c5c[_0x284c8b(0xac)]['fromMe'])return;const _0x1c71fd=_0x5a2c5c[_0x284c8b(0xac)][_0x284c8b(0x112)];if(!_0x1c71fd||!_0x1c71fd[_0x284c8b(0x13f)]('@g.us'))return;const _0x1e26ef=_0x5a2c5c['key'][_0x284c8b(0xa8)+'t']||_0x5a2c5c[_0x284c8b(0xac)][_0x284c8b(0xe1)]||'';if(!_0x1e26ef)return;const _0x3bb2d4=normalizeJid(_0x1e26ef),_0x545eef=DateTime['now']()['setZone'](CONFIG['TIME_ZONE']),_0x27a77d=_0x545eef[_0x284c8b(0x1b6)]('yyyy-LL-dd');try{const _0x274ecf=await db['run'](_0x284c8b(0x1bf)+'PDATE\x20acti'+_0x284c8b(0xbb)+_0x284c8b(0x17a)+_0x284c8b(0x1b4)+_0x284c8b(0x191)+_0x284c8b(0x150)+_0x284c8b(0x1a8)+_0x284c8b(0x199)+_0x284c8b(0xbd)+_0x284c8b(0x169)+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20W'+_0x284c8b(0xad)+_0x284c8b(0x17b)+'D\x20user_jid'+_0x284c8b(0x160)+_0x284c8b(0x196)+_0x284c8b(0x15d)+_0x284c8b(0xa6)+_0x284c8b(0x1d3)+_0x284c8b(0x105),[_0x5a2c5c[_0x284c8b(0x13a)]||_0x5a2c5c['senderName']||'',Math[_0x284c8b(0xae)](_0x545eef[_0x284c8b(0x115)]()),_0x1c71fd,_0x3bb2d4,_0x27a77d]);(!_0x274ecf||!_0x274ecf[_0x284c8b(0xd9)])&&await db[_0x284c8b(0x101)](_0x284c8b(0xfd)+_0x284c8b(0x1c0)+_0x284c8b(0xd8)+_0x284c8b(0xcf)+_0x284c8b(0x16e)+_0x284c8b(0xa5)+_0x284c8b(0x1cd)+_0x284c8b(0x1b8)+'message_co'+_0x284c8b(0x12a)+_0x284c8b(0x161)+'ast_update'+_0x284c8b(0x11d)+_0x284c8b(0xe5)+'(?,\x20?,\x20\x27da'+_0x284c8b(0x178)+_0x284c8b(0xe3)+_0x284c8b(0x1c7),[_0x1c71fd,_0x3bb2d4,_0x27a77d,_0x5a2c5c[_0x284c8b(0x13a)]||_0x5a2c5c[_0x284c8b(0x195)]||'',Math[_0x284c8b(0xae)](_0x545eef[_0x284c8b(0x115)]())]);}catch(_0x37598e){warn(_0x284c8b(0x122)+_0x284c8b(0x166)+_0x284c8b(0xee)+':\x20'+(_0x37598e?.[_0x284c8b(0x12f)]||_0x37598e));}}catch(_0x19e801){warn(_0x284c8b(0x122)+'rackMessag'+_0x284c8b(0x9e)+_0x284c8b(0xa4)+(_0x19e801?.[_0x284c8b(0x12f)]||_0x19e801));}}async function performRollups(){const _0xe7ae65=_0x506208;try{const _0x5480af=DateTime[_0xe7ae65(0xb7)]()[_0xe7ae65(0x19e)](CONFIG[_0xe7ae65(0x193)]),_0xe4806d=_0x5480af['minus']({'days':CONFIG['ROLLOVER_T'+_0xe7ae65(0x184)+'S']})[_0xe7ae65(0x11b)](_0xe7ae65(0xe8)),_0x553fc3=_0xe4806d[_0xe7ae65(0x1b6)]('yyyy-LL-dd'),_0x454e61=await db['all'](_0xe7ae65(0x188)+_0xe7ae65(0xc5)+'\x20user_jid,'+'\x20bucket_ke'+'y,\x20message'+_0xe7ae65(0x133)+_0xe7ae65(0x103)+_0xe7ae65(0xb5)+_0xe7ae65(0x1c2)+'HERE\x20timef'+'rame\x20=\x20\x27da'+_0xe7ae65(0x17e)+'ucket_key\x20'+_0xe7ae65(0x181),[_0x553fc3]);if(_0x454e61&&_0x454e61[_0xe7ae65(0xdb)]){const _0x50ccd0=new Map();for(const _0x4a93e2 of _0x454e61){const _0x1b0f0a=DateTime['fromFormat'](_0x4a93e2[_0xe7ae65(0x1bd)],_0xe7ae65(0x148),{'zone':CONFIG['TIME_ZONE']}),_0xf9c7ba=_0x1b0f0a[_0xe7ae65(0xd3)]+'-'+String(_0x1b0f0a['weekNumber'])[_0xe7ae65(0xb2)](0x6b*0x4f+-0x1f37+-0x1cc,'0'),_0x4f68c1=_0x4a93e2[_0xe7ae65(0x16b)]+'||'+_0x4a93e2['user_jid']+_0xe7ae65(0xbc)+_0xf9c7ba;if(!_0x50ccd0[_0xe7ae65(0x180)](_0x4f68c1))_0x50ccd0[_0xe7ae65(0xf6)](_0x4f68c1,{'chat_jid':_0x4a93e2[_0xe7ae65(0x16b)],'user_jid':_0x4a93e2[_0xe7ae65(0x155)],'timeframe':'weekly','bucket_key':_0xf9c7ba,'message_count':0x0,'display_name':_0x4a93e2[_0xe7ae65(0x126)+'me']||''});const _0x36cbf5=_0x50ccd0[_0xe7ae65(0x14c)](_0x4f68c1);_0x36cbf5[_0xe7ae65(0xfe)+_0xe7ae65(0x1ba)]+=Number(_0x4a93e2['message_co'+'unt']||-0x29*0x3f+0x3*0x268+0x15*0x23);}for(const _0x2f5634 of _0x50ccd0[_0xe7ae65(0x97)]()){const _0x3be6b6=await db[_0xe7ae65(0x14c)](_0xe7ae65(0x194)+_0xe7ae65(0xc2)+'e_stats\x20WH'+_0xe7ae65(0x138)+_0xe7ae65(0x1bb)+_0xe7ae65(0x1dc)+'=\x20?\x20AND\x20ti'+_0xe7ae65(0x197)+_0xe7ae65(0xbe)+_0xe7ae65(0xa6)+_0xe7ae65(0x95)+'MIT\x201',[_0x2f5634[_0xe7ae65(0x16b)],_0x2f5634[_0xe7ae65(0x155)],_0x2f5634[_0xe7ae65(0x1bd)]]);!_0x3be6b6?await db['run'](_0xe7ae65(0xcd)+_0xe7ae65(0x135)+_0xe7ae65(0x131)+_0xe7ae65(0x154)+_0xe7ae65(0x1d1)+_0xe7ae65(0x174)+'ket_key,\x20m'+_0xe7ae65(0x10f)+'nt,\x20displa'+_0xe7ae65(0xa0)+_0xe7ae65(0xa2)+_0xe7ae65(0x1ad)+_0xe7ae65(0xea)+_0xe7ae65(0x142)+_0xe7ae65(0x1de),[_0x2f5634['chat_jid'],_0x2f5634[_0xe7ae65(0x155)],_0x2f5634[_0xe7ae65(0x1bd)],_0x2f5634[_0xe7ae65(0xfe)+_0xe7ae65(0x1ba)],_0x2f5634[_0xe7ae65(0x126)+'me']||'',Math[_0xe7ae65(0xae)](_0x5480af[_0xe7ae65(0x115)]())]):await db[_0xe7ae65(0x101)](_0xe7ae65(0xcb)+_0xe7ae65(0x1c8)+'SET\x20messag'+_0xe7ae65(0x153)+_0xe7ae65(0xfe)+_0xe7ae65(0x11a)+_0xe7ae65(0xce)+'e\x20=\x20?,\x20las'+_0xe7ae65(0x125)+_0xe7ae65(0x132)+_0xe7ae65(0x19f),[_0x2f5634[_0xe7ae65(0xfe)+_0xe7ae65(0x1ba)],_0x2f5634[_0xe7ae65(0x126)+'me']||'',Math[_0xe7ae65(0xae)](_0x5480af['toSeconds']()),_0x3be6b6['id']]);}try{const _0x280b84=_0x454e61[_0xe7ae65(0x1d7)](_0x1c909a=>_0x1c909a['id']);for(let _0x901486=-0x442+-0x1b6b+0x35*0x99;_0x901486<_0x280b84['length'];_0x901486+=-0x4*0x301+-0xd66+-0x3e*-0x71){const _0x257e86=_0x280b84['slice'](_0x901486,_0x901486+(-0x1a27+0x5e9+0x1632)),_0x5b6e6b=_0xe7ae65(0xdf)+'M\x20active_s'+_0xe7ae65(0x18f)+_0xe7ae65(0x1dd)+_0x257e86[_0xe7ae65(0x1d7)](()=>'?')['join'](',')+')';await db[_0xe7ae65(0x101)](_0x5b6e6b,_0x257e86);}}catch(_0x3b901f){warn(_0xe7ae65(0xc7)+'elete\x20old\x20'+'daily\x20rows'+_0xe7ae65(0x9f)+(_0x3b901f?.[_0xe7ae65(0x12f)]||_0x3b901f));}}const _0x124a55=_0x5480af[_0xe7ae65(0xc4)]({'days':CONFIG[_0xe7ae65(0xe2)+_0xe7ae65(0xd4)+'YS']})[_0xe7ae65(0x115)](),_0x258751=await db[_0xe7ae65(0x9d)](_0xe7ae65(0x188)+_0xe7ae65(0xc5)+_0xe7ae65(0x93)+_0xe7ae65(0x10d)+'y,\x20message'+_0xe7ae65(0x133)+_0xe7ae65(0x103)+_0xe7ae65(0xb5)+_0xe7ae65(0x1c2)+'HERE\x20timef'+_0xe7ae65(0x8f)+_0xe7ae65(0x121));if(_0x258751&&_0x258751[_0xe7ae65(0xdb)]){const _0x39ae7e=new Map();for(const _0x21cf17 of _0x258751){const _0x1735fd=String(_0x21cf17['bucket_key']||'')[_0xe7ae65(0x145)]('-'),_0x4fb0b4=Number(_0x1735fd[0xb06+-0xc65*-0x3+0x7*-0x6e3])||0x162*0xc+-0x25cf+0x1ce9,_0x28bc21=Number(_0x1735fd[-0x1bca+0xf41*0x2+-0x2b7])||0xd64+0x1b2e+-0x2891,_0xd2d027=DateTime[_0xe7ae65(0x146)]({'weekYear':_0x4fb0b4,'weekNumber':_0x28bc21,'weekday':0x1},{'zone':CONFIG[_0xe7ae65(0x193)]});if(_0xd2d027[_0xe7ae65(0x115)]()>_0x124a55)continue;const _0x11b5cf=_0xd2d027['year']+'-'+String(_0xd2d027[_0xe7ae65(0x1b9)])['padStart'](0x18ca+0x24b2+-0x3d7a,'0'),_0x5108f2=_0x21cf17[_0xe7ae65(0x16b)]+'||'+_0x21cf17[_0xe7ae65(0x155)]+(_0xe7ae65(0x13d)+'|')+_0x11b5cf;if(!_0x39ae7e[_0xe7ae65(0x180)](_0x5108f2))_0x39ae7e[_0xe7ae65(0xf6)](_0x5108f2,{'chat_jid':_0x21cf17[_0xe7ae65(0x16b)],'user_jid':_0x21cf17[_0xe7ae65(0x155)],'timeframe':_0xe7ae65(0x100),'bucket_key':_0x11b5cf,'message_count':0x0,'display_name':_0x21cf17[_0xe7ae65(0x126)+'me']||'','sourceIds':[]});const _0x44dd66=_0x39ae7e[_0xe7ae65(0x14c)](_0x5108f2);_0x44dd66[_0xe7ae65(0xfe)+_0xe7ae65(0x1ba)]+=Number(_0x21cf17[_0xe7ae65(0xfe)+_0xe7ae65(0x1ba)]||0xa60+0x3b*0x2+-0x13*0x92),_0x44dd66[_0xe7ae65(0x118)]['push'](_0x21cf17['id']);}for(const _0x6948d2 of _0x39ae7e[_0xe7ae65(0x97)]()){const _0x701c2a=await db[_0xe7ae65(0x14c)](_0xe7ae65(0x194)+'FROM\x20activ'+_0xe7ae65(0xf8)+_0xe7ae65(0x138)+'id\x20=\x20?\x20AND'+'\x20user_jid\x20'+'=\x20?\x20AND\x20ti'+_0xe7ae65(0x197)+'\x27monthly\x27\x20'+_0xe7ae65(0xb1)+_0xe7ae65(0x1ab)+_0xe7ae65(0xf1),[_0x6948d2[_0xe7ae65(0x16b)],_0x6948d2[_0xe7ae65(0x155)],_0x6948d2[_0xe7ae65(0x1bd)]]);!_0x701c2a?await db['run'](_0xe7ae65(0xcd)+_0xe7ae65(0x135)+_0xe7ae65(0x131)+_0xe7ae65(0x154)+_0xe7ae65(0x1d1)+_0xe7ae65(0x174)+_0xe7ae65(0x98)+_0xe7ae65(0x10f)+'nt,\x20displa'+'y_name,\x20la'+_0xe7ae65(0xa2)+')\x20VALUES\x20('+_0xe7ae65(0x175)+_0xe7ae65(0x1da)+'?,\x20?,\x20?)',[_0x6948d2[_0xe7ae65(0x16b)],_0x6948d2['user_jid'],_0x6948d2[_0xe7ae65(0x1bd)],_0x6948d2['message_co'+_0xe7ae65(0x1ba)],_0x6948d2[_0xe7ae65(0x126)+'me']||'',Math[_0xe7ae65(0xae)](_0x5480af[_0xe7ae65(0x115)]())]):await db[_0xe7ae65(0x101)](_0xe7ae65(0xcb)+_0xe7ae65(0x1c8)+_0xe7ae65(0x12b)+'e_count\x20=\x20'+_0xe7ae65(0xfe)+'unt\x20+\x20?,\x20d'+'isplay_nam'+_0xe7ae65(0x96)+_0xe7ae65(0x125)+_0xe7ae65(0x132)+'id\x20=\x20?',[_0x6948d2[_0xe7ae65(0xfe)+_0xe7ae65(0x1ba)],_0x6948d2[_0xe7ae65(0x126)+'me']||'',Math[_0xe7ae65(0xae)](_0x5480af[_0xe7ae65(0x115)]()),_0x701c2a['id']]);if(Array[_0xe7ae65(0x10a)](_0x6948d2['sourceIds'])&&_0x6948d2[_0xe7ae65(0x118)][_0xe7ae65(0xdb)])for(let _0x5e0339=0x1*-0x9fd+-0x2a2*0x8+0x1f0d;_0x5e0339<_0x6948d2[_0xe7ae65(0x118)]['length'];_0x5e0339+=0xcbd*0x1+0x1578+-0x2041){const _0x5a9e0b=_0x6948d2[_0xe7ae65(0x118)][_0xe7ae65(0xa3)](_0x5e0339,_0x5e0339+(-0x1*-0x17e2+-0x2560+0x293*0x6)),_0x4d3dad=_0xe7ae65(0xdf)+_0xe7ae65(0xf4)+_0xe7ae65(0x18f)+_0xe7ae65(0x1dd)+_0x5a9e0b[_0xe7ae65(0x1d7)](()=>'?')[_0xe7ae65(0xab)](',')+')';await db['run'](_0x4d3dad,_0x5a9e0b);}}}const _0x29f9f8=_0x5480af[_0xe7ae65(0xc4)]({'days':CONFIG[_0xe7ae65(0xe2)+_0xe7ae65(0xcc)+'S']})[_0xe7ae65(0x115)](),_0x3d0dbe=await db[_0xe7ae65(0x9d)](_0xe7ae65(0x188)+'\x20chat_jid,'+_0xe7ae65(0x93)+_0xe7ae65(0x10d)+'y,\x20message'+_0xe7ae65(0x133)+_0xe7ae65(0x103)+_0xe7ae65(0xb5)+_0xe7ae65(0x1c2)+_0xe7ae65(0xc3)+_0xe7ae65(0x1cf)+_0xe7ae65(0x1d2));if(_0x3d0dbe&&_0x3d0dbe['length']){const _0x395ae5=new Map();for(const _0x1ca947 of _0x3d0dbe){const _0x3fca85=String(_0x1ca947[_0xe7ae65(0x1bd)]||'')[_0xe7ae65(0x145)]('-'),_0x64bd5e=Number(_0x3fca85[0xd69+0x18b6+0xcb5*-0x3])||-0x209*0x1+-0x1fe1+0x4*0xa67,_0xd25294=DateTime[_0xe7ae65(0x146)]({'year':_0x64bd5e,'month':0x1,'day':0x1},{'zone':CONFIG[_0xe7ae65(0x193)]});if(_0xd25294['toSeconds']()>_0x29f9f8)continue;const _0x1f64b4=''+_0x64bd5e,_0xe526ff=_0x1ca947['chat_jid']+'||'+_0x1ca947[_0xe7ae65(0x155)]+_0xe7ae65(0xa9)+_0x1f64b4;if(!_0x395ae5[_0xe7ae65(0x180)](_0xe526ff))_0x395ae5[_0xe7ae65(0xf6)](_0xe526ff,{'chat_jid':_0x1ca947['chat_jid'],'user_jid':_0x1ca947[_0xe7ae65(0x155)],'timeframe':_0xe7ae65(0x129),'bucket_key':_0x1f64b4,'message_count':0x0,'display_name':_0x1ca947[_0xe7ae65(0x126)+'me']||'','sourceIds':[]});const _0x3172be=_0x395ae5[_0xe7ae65(0x14c)](_0xe526ff);_0x3172be[_0xe7ae65(0xfe)+'unt']+=Number(_0x1ca947['message_co'+'unt']||0xf56+0x6f3+0xa3*-0x23),_0x3172be[_0xe7ae65(0x118)][_0xe7ae65(0x14e)](_0x1ca947['id']);}for(const _0x2fda4e of _0x395ae5[_0xe7ae65(0x97)]()){const _0x319d07=await db['get'](_0xe7ae65(0x194)+_0xe7ae65(0xc2)+'e_stats\x20WH'+_0xe7ae65(0x138)+_0xe7ae65(0x1bb)+'\x20user_jid\x20'+_0xe7ae65(0x1ae)+_0xe7ae65(0x197)+_0xe7ae65(0xc1)+'ND\x20bucket_'+'key\x20=\x20?\x20LI'+_0xe7ae65(0x165),[_0x2fda4e[_0xe7ae65(0x16b)],_0x2fda4e['user_jid'],_0x2fda4e[_0xe7ae65(0x1bd)]]);!_0x319d07?await db[_0xe7ae65(0x101)](_0xe7ae65(0xcd)+_0xe7ae65(0x135)+_0xe7ae65(0x131)+_0xe7ae65(0x154)+_0xe7ae65(0x1d1)+_0xe7ae65(0x174)+'ket_key,\x20m'+'essage_cou'+_0xe7ae65(0x117)+_0xe7ae65(0xa0)+_0xe7ae65(0xa2)+_0xe7ae65(0x1ad)+_0xe7ae65(0x1c6)+_0xe7ae65(0x1aa)+_0xe7ae65(0x1de),[_0x2fda4e[_0xe7ae65(0x16b)],_0x2fda4e[_0xe7ae65(0x155)],_0x2fda4e[_0xe7ae65(0x1bd)],_0x2fda4e['message_co'+_0xe7ae65(0x1ba)],_0x2fda4e[_0xe7ae65(0x126)+'me']||'',Math[_0xe7ae65(0xae)](_0x5480af[_0xe7ae65(0x115)]())]):await db['run'](_0xe7ae65(0xcb)+_0xe7ae65(0x1c8)+_0xe7ae65(0x12b)+_0xe7ae65(0x153)+'message_co'+_0xe7ae65(0x11a)+_0xe7ae65(0xce)+'e\x20=\x20?,\x20las'+_0xe7ae65(0x125)+'=\x20?\x20WHERE\x20'+_0xe7ae65(0x19f),[_0x2fda4e[_0xe7ae65(0xfe)+_0xe7ae65(0x1ba)],_0x2fda4e['display_na'+'me']||'',Math['floor'](_0x5480af[_0xe7ae65(0x115)]()),_0x319d07['id']]);if(Array['isArray'](_0x2fda4e[_0xe7ae65(0x118)])&&_0x2fda4e['sourceIds'][_0xe7ae65(0xdb)])for(let _0x35537b=-0x3*0xaf6+-0x272*0x2+0x25c6;_0x35537b<_0x2fda4e[_0xe7ae65(0x118)][_0xe7ae65(0xdb)];_0x35537b+=0xba6+0x16ab+-0x205d){const _0x2113bd=_0x2fda4e[_0xe7ae65(0x118)][_0xe7ae65(0xa3)](_0x35537b,_0x35537b+(0x49e+0x1*0x2483+-0x272d)),_0x52be4d=_0xe7ae65(0xdf)+_0xe7ae65(0xf4)+'tats\x20WHERE'+_0xe7ae65(0x1dd)+_0x2113bd[_0xe7ae65(0x1d7)](()=>'?')[_0xe7ae65(0xab)](',')+')';await db[_0xe7ae65(0x101)](_0x52be4d,_0x2113bd);}}}try{const _0x3acbcd=DateTime[_0xe7ae65(0xb7)]()[_0xe7ae65(0x19e)](CONFIG[_0xe7ae65(0x193)])[_0xe7ae65(0xc4)]({'days':CONFIG[_0xe7ae65(0x1cb)+_0xe7ae65(0xf0)]})[_0xe7ae65(0x1b6)](_0xe7ae65(0x148));await db[_0xe7ae65(0x101)](_0xe7ae65(0xdf)+'M\x20active_s'+_0xe7ae65(0x18f)+_0xe7ae65(0xba)+_0xe7ae65(0x143)+_0xe7ae65(0xb9)+_0xe7ae65(0xc8),[_0x3acbcd]);}catch(_0xdd873e){warn(_0xe7ae65(0xb6)+_0xe7ae65(0x1ac)+_0xe7ae65(0x9f)+(_0xdd873e?.[_0xe7ae65(0x12f)]||_0xdd873e));}info('[active]\x20r'+_0xe7ae65(0x172)+_0xe7ae65(0x19a));}catch(_0x5f0e0f){error(_0x5f0e0f,_0xe7ae65(0xb6)+_0xe7ae65(0x1af)+_0xe7ae65(0x19c)+':\x20'+(_0x5f0e0f?.[_0xe7ae65(0x12f)]||_0x5f0e0f));}}function parsePeriodArg(_0x10cfc1){const _0x26c8d1=_0x506208;if(!_0x10cfc1)return null;const _0x8bbc67=String(_0x10cfc1)[_0x26c8d1(0xbf)]()[_0x26c8d1(0x152)+'e']()[_0x26c8d1(0xd1)](/^(\d+)\s*([dwmy])$/);if(!_0x8bbc67)return null;return{'amount':Number(_0x8bbc67[0x1*-0x19a1+0x8*0x4b8+-0x42*0x2f]),'unit':_0x8bbc67[-0x1*-0x241+0xf86*-0x1+0xd47*0x1]};}function computeCutoffSeconds(_0x44ea32,_0x51fd56){const _0x37d8be=_0x506208,_0xd29da2=DateTime[_0x37d8be(0xb7)]()['setZone'](CONFIG[_0x37d8be(0x193)]);let _0x1e35f3;if(_0x51fd56==='d')_0x1e35f3=_0xd29da2[_0x37d8be(0xc4)]({'days':_0x44ea32});else{if(_0x51fd56==='w')_0x1e35f3=_0xd29da2['minus']({'weeks':_0x44ea32});else{if(_0x51fd56==='m')_0x1e35f3=_0xd29da2[_0x37d8be(0xc4)]({'months':_0x44ea32});else{if(_0x51fd56==='y')_0x1e35f3=_0xd29da2['minus']({'years':_0x44ea32});else _0x1e35f3=_0xd29da2['minus']({'days':_0x44ea32});}}}return Math[_0x37d8be(0xae)](_0x1e35f3[_0x37d8be(0x115)]());}async function buildLeaderboardForChat(_0x386a4c,_0x54cbd0,_0x4925bd=CONFIG[_0x506208(0x127)+_0x506208(0xf3)]){const _0x685708=_0x506208;try{const _0xfcfca4=DateTime[_0x685708(0xef)+'s'](_0x54cbd0)[_0x685708(0x19e)](CONFIG[_0x685708(0x193)]),_0x3dc80e=_0xfcfca4['toFormat'](_0x685708(0x148)),_0x10acb0=await db[_0x685708(0x9d)](_0x685708(0x1a4)+'ECT\x20user_j'+'id,\x20displa'+'y_name,\x20SU'+'M(message_'+_0x685708(0xb4)+_0x685708(0x1b7)+'ast_update'+_0x685708(0x104)+'_ts\x0a\x20\x20\x20\x20\x20\x20'+_0x685708(0xc2)+_0x685708(0xd7)+_0x685708(0x149)+'chat_jid\x20='+_0x685708(0x1a3)+_0x685708(0x136)+'daily\x27\x20AND'+'\x20bucket_ke'+_0x685708(0x10c)+_0x685708(0x102)+_0x685708(0x124)+_0x685708(0x9a),[_0x386a4c,_0x3dc80e]),_0x576d37=new Map();for(const _0x1c1c43 of _0x10acb0||[]){const _0x533339=normalizeJid(_0x1c1c43[_0x685708(0x155)]);_0x576d37[_0x685708(0xf6)](_0x533339,{'user_jid':_0x533339,'display_name':_0x1c1c43[_0x685708(0x126)+'me']||_0x533339['split']('@')[0x3*0x4f7+0x22bd+0x31a2*-0x1],'count':Number(_0x1c1c43[_0x685708(0x13b)]||-0x1945*0x1+0x24ef+0x2*-0x5d5),'last_ts':Number(_0x1c1c43['last_ts']||0x3e*0x58+0xa21+-0xa7b*0x3)});}const _0x240657=await db['all'](_0x685708(0x18d)+_0x685708(0xa5)+_0x685708(0x1cd)+_0x685708(0x1b8)+_0x685708(0xfe)+'unt,\x20displ'+_0x685708(0x12d)+_0x685708(0xdc)+_0x685708(0x1b3)+'E\x20chat_jid'+_0x685708(0x160)+_0x685708(0x12c)+_0x685708(0x99)+'\x27,\x27monthly'+'\x27,\x27yearly\x27'+')',[_0x386a4c]);for(const _0x1d7fbc of _0x240657||[]){let _0x24f2ca=![];try{if(_0x1d7fbc[_0x685708(0x114)]===_0x685708(0x16a)){const _0x49774c=String(_0x1d7fbc[_0x685708(0x1bd)]||'')[_0x685708(0x145)]('-'),_0x455464=Number(_0x49774c[-0xa57+-0x1f86*-0x1+0x1*-0x152f])||0x2282+0xead+-0x297d,_0x4938a6=Number(_0x49774c[0x29*0x9f+-0x240d+0xa97])||-0x1a4a+0xb*0x317+0x2*-0x3d9,_0x1c4792=DateTime[_0x685708(0x146)]({'weekYear':_0x455464,'weekNumber':_0x4938a6,'weekday':0x1},{'zone':CONFIG[_0x685708(0x193)]});if(_0x1c4792[_0x685708(0x115)]()>=_0x54cbd0)_0x24f2ca=!![];}else{if(_0x1d7fbc[_0x685708(0x114)]===_0x685708(0x100)){const _0x58b08a=String(_0x1d7fbc[_0x685708(0x1bd)]||'')['split']('-'),_0x28478f=Number(_0x58b08a[-0xe*-0x6f+-0x244d+0x1e3b])||-0xf68+0xf8a*-0x2+0x362e,_0x524b68=Number(_0x58b08a[0x1*0xdff+-0x99*0xa+-0x804])||0x13b6+-0x16ae+0x2f9,_0x39b021=DateTime['fromObject']({'year':_0x28478f,'month':_0x524b68,'day':0x1},{'zone':CONFIG['TIME_ZONE']});if(_0x39b021['toSeconds']()>=_0x54cbd0)_0x24f2ca=!![];}else{if(_0x1d7fbc[_0x685708(0x114)]===_0x685708(0x129)){const _0x5809aa=Number(String(_0x1d7fbc[_0x685708(0x1bd)]||'')[_0x685708(0x145)]('-')[-0x1f8b+0x25c8+-0x63d])||0x1737+0x203*0x10+-0x3b*0xcf,_0x3e9df5=DateTime['fromObject']({'year':_0x5809aa,'month':0x1,'day':0x1},{'zone':CONFIG[_0x685708(0x193)]});if(_0x3e9df5[_0x685708(0x115)]()>=_0x54cbd0)_0x24f2ca=!![];}else _0x24f2ca=!![];}}}catch(_0x210b09){_0x24f2ca=!![];}if(!_0x24f2ca)continue;const _0x2f3b5f=normalizeJid(_0x1d7fbc[_0x685708(0x155)]);if(!_0x576d37['has'](_0x2f3b5f))_0x576d37[_0x685708(0xf6)](_0x2f3b5f,{'user_jid':_0x2f3b5f,'display_name':_0x1d7fbc[_0x685708(0x126)+'me']||_0x2f3b5f['split']('@')[-0xf1d*-0x1+0x1e81+0x2*-0x16cf],'count':0x0,'last_ts':0x0});_0x576d37[_0x685708(0x14c)](_0x2f3b5f)[_0x685708(0x1db)]+=Number(_0x1d7fbc[_0x685708(0xfe)+_0x685708(0x1ba)]||-0x26e0+0x2442+0x29e);}const _0x4ae747=Array['from'](_0x576d37['values']())[_0x685708(0x110)]((_0x36cac1,_0x472d00)=>_0x472d00[_0x685708(0x1db)]-_0x36cac1[_0x685708(0x1db)]||_0x472d00[_0x685708(0x1a6)]-_0x36cac1[_0x685708(0x1a6)]);return _0x4ae747[_0x685708(0xa3)](-0xeaf+0x27*-0x5b+0x24*0xcb,_0x4925bd);}catch(_0x2628cc){return warn(_0x685708(0x116)+_0x685708(0xc6)+_0x685708(0xa1)+'r:\x20'+(_0x2628cc?.['message']||_0x2628cc)),[];}}async function getGroupParticipants(_0x10a44d,_0x1de3e8){const _0x335998=_0x506208;try{if(!_0x10a44d||typeof _0x10a44d['groupMetad'+_0x335998(0x144)]!==_0x335998(0x1d6))return[];const _0x41eb5d=await _0x10a44d['groupMetad'+_0x335998(0x144)](_0x1de3e8),_0x33ca6d=Array[_0x335998(0x10a)](_0x41eb5d?.['participan'+'ts'])?_0x41eb5d[_0x335998(0xa8)+'ts']:Object[_0x335998(0x97)](_0x41eb5d?.[_0x335998(0xa8)+'ts']||{}),_0x1aef55=_0x33ca6d[_0x335998(0x1d7)](_0x92cdca=>_0x92cdca['id'])[_0x335998(0xe4)](Boolean)[_0x335998(0x1d7)](normalizeJid);return _0x1aef55;}catch(_0x3fa7c0){return warn('[active]\x20g'+_0x335998(0xf9)+'ticipants\x20'+_0x335998(0x14d)+'\x20'+_0x1de3e8+':\x20'+(_0x3fa7c0?.['message']||_0x3fa7c0)),[];}}export async function initialize(_0x43c829){const _0xc6c40e=_0x506208;try{botRef=_0x43c829;if(botRef){if(typeof botRef['sendMessag'+'e']==='function')sendApi=(_0x1736e2,_0x531d51)=>botRef[_0xc6c40e(0x1c1)+'e'](_0x1736e2,_0x531d51);else{if(botRef[_0xc6c40e(0x119)]&&typeof botRef[_0xc6c40e(0x119)]['sendMessag'+'e']===_0xc6c40e(0x1d6))sendApi=(_0x5ef285,_0x5e7fa5)=>botRef[_0xc6c40e(0x119)][_0xc6c40e(0x1c1)+'e'](_0x5ef285,_0x5e7fa5);else sendApi=null;}}try{const _0xdc60b7=getConfig()||{};if(_0xdc60b7[_0xc6c40e(0x16f)]&&typeof _0xdc60b7[_0xc6c40e(0x16f)]===_0xc6c40e(0x1a7))CONFIG={...CONFIG,..._0xdc60b7[_0xc6c40e(0x16f)]};}catch(_0x555e57){warn(_0xc6c40e(0xf2)+'ailed\x20to\x20r'+'ead\x20config'+_0xc6c40e(0x18b)+(_0x555e57?.['message']||_0x555e57));}await ensureSchema(),await performRollups(),info('[active]\x20i'+_0xc6c40e(0x9c));}catch(_0x4e27c8){error(_0x4e27c8,'[active]\x20i'+'nitialize\x20'+'failed:\x20'+(_0x4e27c8?.[_0xc6c40e(0x12f)]||_0x4e27c8));throw _0x4e27c8;}}export async function onMessage(_0x49c7fb){const _0x1c1f63=_0x506208;try{await trackMessage(_0x49c7fb);if(!_0x49c7fb?.[_0x1c1f63(0x1d0)])return;const _0x41aee7=_0x49c7fb[_0x1c1f63(0xac)]?.[_0x1c1f63(0x112)];if(!_0x41aee7||!_0x41aee7[_0x1c1f63(0x13f)]('@g.us'))return;const _0x475f68=await isadmin(botRef,_0x49c7fb)[_0x1c1f63(0x92)](()=>![]);if(!_0x475f68)return;const _0x10efe3=typeof _0x49c7fb[_0x1c1f63(0x128)]===_0x1c1f63(0xed)&&_0x49c7fb[_0x1c1f63(0x128)][_0x1c1f63(0xbf)]()?_0x49c7fb[_0x1c1f63(0x128)]['trim']():'';if(!_0x10efe3)return;const _0x253334=_0x10efe3['split'](/\s+/)[_0x1c1f63(0xe4)](Boolean),_0x177224=_0x253334[0x2694+0xbe4+-0xa*0x50c][_0x1c1f63(0x152)+'e']();if(_0x177224!=='active'&&_0x177224!=='inactive')return;const _0x5ae884=_0x253334[-0xc52+-0x1b1*-0xf+-0xd0c]||'1w';let _0x5b4264=parsePeriodArg(_0x5ae884);if(!_0x5b4264){const _0x378877=parseInt(_0x5ae884,-0x18a3+-0x1*0x6cd+0x33*0x9e);if(!isNaN(_0x378877))_0x5b4264={'amount':_0x378877,'unit':'d'};else{const _0x142f12=_0x1c1f63(0x10e)+_0x1c1f63(0xa7)+_0x1c1f63(0x113)+_0x1c1f63(0x130)+_0x1c1f63(0x164)+_0x1c1f63(0x19b)+'|y>\x0aExampl'+_0x1c1f63(0x15c)+_0x1c1f63(0x1c5)+'e\x201w,\x20inac'+_0x1c1f63(0x139);try{await sendApi(_0x41aee7,{'text':_0x142f12});}catch(_0x39b8e6){warn(_0x1c1f63(0xe9)+_0x1c1f63(0xb8)+'failed:\x20'+(_0x39b8e6?.[_0x1c1f63(0x12f)]||_0x39b8e6));}return;}}try{await performRollups();}catch(_0x15ab50){}const _0x49d347=computeCutoffSeconds(_0x5b4264['amount'],_0x5b4264[_0x1c1f63(0xd2)]);if(_0x177224===_0x1c1f63(0xeb)){const _0x4be008=await buildLeaderboardForChat(_0x41aee7,_0x49d347,CONFIG[_0x1c1f63(0x127)+_0x1c1f63(0xf3)]);if(!_0x4be008||_0x4be008[_0x1c1f63(0xdb)]===0x1002+0xb53+-0x1b55){await sendApi(_0x41aee7,{'text':_0x1c1f63(0x1ca)+'members\x20fo'+'und\x20in\x20the'+_0x1c1f63(0x141)+_0x5b4264[_0x1c1f63(0x157)]+_0x5b4264[_0x1c1f63(0xd2)]+'.'});return;}let _0x369e25='Found\x20'+_0x4be008[_0x1c1f63(0xdb)]+(_0x1c1f63(0x11c)+_0x1c1f63(0xff)+_0x1c1f63(0x141))+_0x5b4264['amount']+_0x5b4264[_0x1c1f63(0xd2)]+_0x1c1f63(0x1d9);const _0x2643ac=[];let _0x448f80=0xf6e+0x145b+-0x1*0x23c9;for(const _0x583bba of _0x4be008){_0x448f80++;const _0x4fa190=_0x583bba['user_jid'][_0x1c1f63(0x145)]('@')[0x1*-0xd86+-0x1*0x192c+0x26b2];_0x369e25+=_0x1c1f63(0x185)+_0x4fa190+'\x20('+(_0x583bba[_0x1c1f63(0x126)+'me']||_0x4fa190)+')\x0a',_0x369e25+=romanParen(_0x448f80)+'\x20'+_0x583bba[_0x1c1f63(0x1db)]+(_0x1c1f63(0x168)+'\x0a'),_0x2643ac[_0x1c1f63(0x14e)](_0x583bba[_0x1c1f63(0x155)]);}const _0x4d3033=0x19b4+0x1*-0x1933+-0x4f*-0x31;if(_0x369e25[_0x1c1f63(0xdb)]<=_0x4d3033)await sendApi(_0x41aee7,{'text':_0x369e25,'mentions':_0x2643ac});else{const _0x3ec442=_0x369e25[_0x1c1f63(0x145)]('\x0a\x0a');let _0x118902='';for(const _0x59ba6e of _0x3ec442){if((_0x118902+'\x0a\x0a'+_0x59ba6e)[_0x1c1f63(0xdb)]>_0x4d3033)await sendApi(_0x41aee7,{'text':_0x118902,'mentions':_0x2643ac}),_0x118902=_0x59ba6e+'\x0a\x0a';else _0x118902+=(_0x118902?'\x0a\x0a':'')+_0x59ba6e;}if(_0x118902[_0x1c1f63(0xbf)]())await sendApi(_0x41aee7,{'text':_0x118902,'mentions':_0x2643ac});}return;}if(_0x177224==='inactive'){const _0x1c9fe8=botRef?.[_0x1c1f63(0x119)]||botRef,_0x28ff82=await getGroupParticipants(_0x1c9fe8,_0x41aee7);if(!_0x28ff82||_0x28ff82[_0x1c1f63(0xdb)]===0x3*0xf7+0x2558+-0x283d*0x1){await sendApi(_0x41aee7,{'text':'Could\x20not\x20'+_0x1c1f63(0x15b)+_0x1c1f63(0x11f)+'icipants.'});return;}const _0x38d529=await buildLeaderboardForChat(_0x41aee7,_0x49d347,0x15e5aa+-0x1*0x1acd53+0x1429e9),_0x24c1eb=new Set((_0x38d529||[])[_0x1c1f63(0x1d7)](_0x571612=>normalizeJid(_0x571612[_0x1c1f63(0x155)]))),_0xaacc13=_0x28ff82[_0x1c1f63(0xe4)](_0x565711=>!_0x24c1eb[_0x1c1f63(0x180)](normalizeJid(_0x565711)));if(!_0xaacc13['length']){await sendApi(_0x41aee7,{'text':_0x1c1f63(0x16c)+_0x1c1f63(0xf5)+_0x1c1f63(0xaa)+_0x1c1f63(0x192)+_0x5b4264[_0x1c1f63(0x157)]+_0x5b4264['unit']+'.'});return;}let _0x2f97d9=_0x1c1f63(0x163)+_0xaacc13[_0x1c1f63(0xdb)]+(_0x1c1f63(0x1bc)+'members\x20in'+_0x1c1f63(0x1df))+_0x5b4264[_0x1c1f63(0x157)]+_0x5b4264['unit']+_0x1c1f63(0x1d9);const _0x207414=[];let _0xcafc28=0x105*-0x11+-0x2*-0x6ee+0x379;for(const _0x418841 of _0xaacc13){_0xcafc28++;const _0x1fc6b1=_0x418841[_0x1c1f63(0x145)]('@')[-0x14eb+0x19*-0x167+0x37fa];_0x2f97d9+=_0x1c1f63(0x185)+_0x1fc6b1+'\x20('+_0x1fc6b1+')\x0a',_0x2f97d9+=romanParen(_0xcafc28)+('\x20no\x20messag'+_0x1c1f63(0xfb)),_0x207414[_0x1c1f63(0x14e)](_0x418841);}await sendApi(_0x41aee7,{'text':_0x2f97d9,'mentions':_0x207414});return;}}catch(_0x4f5e37){error(_0x4f5e37,_0x1c1f63(0x108)+_0x1c1f63(0x15a)+'ailed:\x20'+(_0x4f5e37?.[_0x1c1f63(0x12f)]||_0x4f5e37));}}export async function cleanup(){const _0x2f13f2=_0x506208;try{for(const _0x895f05 of processedMessageKeys[_0x2f13f2(0x97)]())try{clearTimeout(_0x895f05);}catch(_0x321703){}processedMessageKeys[_0x2f13f2(0x1b2)]();}catch(_0x2ee747){}botRef=null,sendApi=null,info(_0x2f13f2(0x186)+_0x2f13f2(0x171));}export default{'name':name,'version':version,'initialize':initialize,'onMessage':onMessage,'cleanup':cleanup};