const _0x915f7e=_0x3cb5;(function(_0x39f2e5,_0x4719fc){const _0x31748=_0x3cb5,_0x2ec6d2=_0x39f2e5();while(!![]){try{const _0x1a7f0b=-parseInt(_0x31748(0x1de))/(0x1*0x1f51+0x16bd*0x1+0x1*-0x360d)+parseInt(_0x31748(0x23a))/(-0x154+-0x17a8+0x2*0xc7f)*(-parseInt(_0x31748(0x19d))/(-0x4ef+0x266c+-0x2*0x10bd))+parseInt(_0x31748(0x16e))/(-0x2*0x47d+0xe4*0x7+0x2c2)*(-parseInt(_0x31748(0x229))/(-0xec*-0x9+0x41+-0x888))+parseInt(_0x31748(0x244))/(-0x181+0x1089*-0x1+0x1210)*(parseInt(_0x31748(0x218))/(0x8*-0x11b+-0x137*0x1+0x50b*0x2))+parseInt(_0x31748(0x212))/(0x246b*-0x1+-0x5fd+0x2a70)+parseInt(_0x31748(0x1a1))/(0x1a40+-0xec1+0xb76*-0x1)*(-parseInt(_0x31748(0x192))/(0x60e*0x5+0xf+-0x1*0x1e4b))+parseInt(_0x31748(0x20b))/(0x68a*0x5+0x2e*0xd7+-0x4749)*(parseInt(_0x31748(0x1db))/(-0x839+0x1b2d*0x1+-0x12e8));if(_0x1a7f0b===_0x4719fc)break;else _0x2ec6d2['push'](_0x2ec6d2['shift']());}catch(_0x4d7611){_0x2ec6d2['push'](_0x2ec6d2['shift']());}}}(_0x2f88,0x71349+-0x5*0x22b83+0xcd488));import{info,warn,error}from'../utils/logger.js';function _0x3cb5(_0x1dcc7f,_0x12250c){const _0x4dcdf4=_0x2f88();return _0x3cb5=function(_0x181944,_0x3164db){_0x181944=_0x181944-(-0xabd+0xa2a*0x1+0x1ff);let _0x1e7dda=_0x4dcdf4[_0x181944];return _0x1e7dda;},_0x3cb5(_0x1dcc7f,_0x12250c);}import{db}from'../utils/database.js';import{isadmin}from'../utils/isadmin.js';import{startManagedListener,stopManagedListener}from'../utils/listenerManager.js';import{getConfig,hotReloadConfig}from'../utils/config.js';export const name=_0x915f7e(0x1b7);export const version=_0x915f7e(0x21e)+_0x915f7e(0x225);export const priority=0x166+-0xe17+0x9*0x173;export const commands=[_0x915f7e(0x1b7),_0x915f7e(0x1af)];export const configKeys=[_0x915f7e(0x18b)];let botRef=null,sendApi=null;const chatUserMap=new Map(),processedMessageKeys=new Map(),DEDUPE_TTL_MS=(0x777+0x2f4+-0xa4d)*(0x1949*0x1+0x1*-0xdf5+-0x76c),CFG={'SPAM_THRESHOLD':0x6,'SPAM_WINDOW_MS':(-0x13*0x6b+-0x24cd*0x1+0x2cc8)*(0xe59+0xb69+-0x15da),'SPAM_COOLDOWN_MS':0x3e8,'MAX_WARNINGS':0x3,'WARN_EXPIRY_MS':(-0x6*0x131+-0x25*-0xa3+-0x1062)*(-0xa77+0x11eb+0x274*-0x3)*(0x13*0x1d3+-0x4*-0x62f+-0x3b29)*(-0x94d*0x1+-0x5f3*0x1+0xf7c)*(-0x67e+-0x62*-0x2+0x19b*0x6),'KICK_ON_SPAM':!![],'WARNING_MESSAGE':_0x915f7e(0x217)+_0x915f7e(0x23e)+_0x915f7e(0x179)+_0x915f7e(0x243)+_0x915f7e(0x20d)+_0x915f7e(0x22b),'WARNING_TTL_MS':0xc350};function refreshConfig(){const _0x15e08d=_0x915f7e;try{const _0x26ed0a=getConfig?.()?.[_0x15e08d(0x18b)]||{};Object[_0x15e08d(0x20a)](CFG)['forEach'](_0x1a6aa5=>{if(_0x26ed0a[_0x1a6aa5]!==undefined)CFG[_0x1a6aa5]=_0x26ed0a[_0x1a6aa5];}),CFG['SPAM_THRES'+_0x15e08d(0x1e8)]=Math[_0x15e08d(0x1c8)](0x492*0x2+0x2214+0x25*-0x12b,Number(CFG[_0x15e08d(0x22f)+'HOLD'])||-0x25d+0xe89+0xc26*-0x1),CFG['SPAM_WINDO'+_0x15e08d(0x176)]=Math['max'](-0x1854+-0x1414+-0xb1a*-0x4,Number(CFG['SPAM_WINDO'+_0x15e08d(0x176)])||(-0x1*0x1925+-0xb73+0x24a2)*(0x1e14+0xdb4+-0x2*0x13f0)),CFG['SPAM_COOLD'+_0x15e08d(0x22e)]=Math['max'](-0x1*-0x1a2+-0x20ea*0x1+-0x9a*-0x34,Number(CFG[_0x15e08d(0x1a7)+_0x15e08d(0x22e)])||0x53*-0x6b+-0x2*0xc75+0x3f83),CFG['MAX_WARNIN'+'GS']=Math[_0x15e08d(0x1c8)](-0xc51*0x3+-0x1754+-0x1418*-0x3,Number(CFG[_0x15e08d(0x1cb)+'GS'])||0x263*0xb+-0x1b52+0x114),CFG[_0x15e08d(0x1b4)+'Y_MS']=Math[_0x15e08d(0x1c8)](0x18ad+-0x127*-0x2+-0x1*0x1afb,Number(CFG[_0x15e08d(0x1b4)+_0x15e08d(0x223)])||(0x1f62+0x126c*-0x2+0x57d)*(0x2*0x925+-0x24f2+0x12c0)*(-0x5ee+0x3*-0x39+0x6d5)*(0x1ef7+-0x16c6+-0x7f5)*(-0x1*0x23bf+-0x1c3b+0x43e2)),CFG[_0x15e08d(0x1ea)+_0x15e08d(0x1a9)]=Math[_0x15e08d(0x1c8)](0x75a+0x10f1*-0x1+0x997,Number(CFG[_0x15e08d(0x1ea)+_0x15e08d(0x1a9)])||-0xe487+0xb71+0x19c66),CFG[_0x15e08d(0x1e4)+'AM']=!!CFG[_0x15e08d(0x1e4)+'AM'];}catch(_0x4e7868){warn('['+name+(']\x20refreshC'+'onfig\x20erro'+_0x15e08d(0x1bc))+(_0x4e7868?.[_0x15e08d(0x24a)]||_0x4e7868));}}const TABLE_SETTINGS='spam_setti'+_0x915f7e(0x1cc);async function tableExists(_0x4302a8){const _0x52e2d2=_0x915f7e;try{const _0x5c3e92=await db[_0x52e2d2(0x200)](_0x52e2d2(0x1d2)+_0x52e2d2(0x1fc)+_0x52e2d2(0x1e2)+_0x52e2d2(0x1c0)+_0x52e2d2(0x1b1)+_0x52e2d2(0x1eb),[_0x4302a8]);return!!_0x5c3e92;}catch(_0x3b5271){return warn('['+name+(_0x52e2d2(0x175)+_0x52e2d2(0x206))+_0x4302a8+_0x52e2d2(0x241)+(_0x3b5271?.['message']||_0x3b5271)),![];}}async function getTableColumns(_0x1ce01d){const _0x2cba1b=_0x915f7e;try{const _0x1cb2c6=await db[_0x2cba1b(0x190)](_0x2cba1b(0x18f)+'le_info('+_0x1ce01d+');'),_0x399e8d=Array[_0x2cba1b(0x173)](_0x1cb2c6)?_0x1cb2c6:_0x1cb2c6&&_0x1cb2c6[_0x2cba1b(0x182)]?_0x1cb2c6[_0x2cba1b(0x182)]:[];return _0x399e8d[_0x2cba1b(0x1c5)](_0x41777c=>_0x41777c['name']||_0x41777c[_0x2cba1b(0x1df)+'e']||_0x41777c[_0x2cba1b(0x193)]);}catch(_0x3a9c9a){try{const _0x3c66a7=await db['get'](_0x2cba1b(0x202)+'ROM\x20'+_0x1ce01d+_0x2cba1b(0x197));return _0x3c66a7?Object[_0x2cba1b(0x20a)](_0x3c66a7):[];}catch(_0xfb2212){return[];}}}async function migrateSpamSettingsIfNeeded(){const _0x5b5a23=_0x915f7e,_0x2cf4a0=await tableExists(TABLE_SETTINGS);if(!_0x2cf4a0)try{await db['exec']('CREATE\x20TAB'+_0x5b5a23(0x234)+_0x5b5a23(0x23f)+TABLE_SETTINGS+(_0x5b5a23(0x236)+_0x5b5a23(0x1bd)+'ARY\x20KEY,\x20e'+_0x5b5a23(0x19c)+_0x5b5a23(0x1b5))),info('['+name+(_0x5b5a23(0x181)+_0x5b5a23(0x174))+TABLE_SETTINGS);return;}catch(_0x52d6c8){warn('['+name+(_0x5b5a23(0x18c)+_0x5b5a23(0x1d9))+TABLE_SETTINGS+':\x20'+(_0x52d6c8?.[_0x5b5a23(0x24a)]||_0x52d6c8));return;}try{const _0x44c681=await db[_0x5b5a23(0x190)](_0x5b5a23(0x18f)+_0x5b5a23(0x180)+TABLE_SETTINGS+');');let _0x3fcaff=[];if(Array[_0x5b5a23(0x173)](_0x44c681))_0x3fcaff=_0x44c681['map'](_0x52c980=>_0x52c980[_0x5b5a23(0x1c6)]||_0x52c980[-0x2*0xbd9+-0x738+-0x1eeb*-0x1])['filter'](Boolean);else{if(_0x44c681&&Array['isArray'](_0x44c681['rows']))_0x3fcaff=_0x44c681[_0x5b5a23(0x182)][_0x5b5a23(0x1c5)](_0x580e26=>_0x580e26[_0x5b5a23(0x1c6)])[_0x5b5a23(0x231)](Boolean);else try{const _0x372c48=await db[_0x5b5a23(0x200)](_0x5b5a23(0x202)+_0x5b5a23(0x1ac)+TABLE_SETTINGS+_0x5b5a23(0x197));_0x3fcaff=_0x372c48?Object['keys'](_0x372c48):[];}catch(_0x56da1c){_0x3fcaff=[];}}const _0x47af26=_0x3fcaff['map'](_0x3e3d0b=>String(_0x3e3d0b)['toLowerCas'+'e']()),_0x3111d5=_0x47af26[_0x5b5a23(0x1f1)]('chat_jid'),_0x28645c=_0x47af26['includes'](_0x5b5a23(0x1f0)),_0xb273b2=_0x47af26[_0x5b5a23(0x1f1)](_0x5b5a23(0x1ff));if(_0x3111d5&&_0x28645c)return;if(!_0x3111d5&&_0xb273b2)try{await db['exec'](_0x5b5a23(0x237)+_0x5b5a23(0x1aa)),await db[_0x5b5a23(0x190)](_0x5b5a23(0x208)+_0x5b5a23(0x234)+'EXISTS\x20'+TABLE_SETTINGS+(_0x5b5a23(0x249)+'_jid\x20TEXT\x20'+'PRIMARY\x20KE'+_0x5b5a23(0x178)+_0x5b5a23(0x214)));const _0x24a3f7=_0x28645c;_0x24a3f7?await db[_0x5b5a23(0x190)](_0x5b5a23(0x216)+_0x5b5a23(0x1e7)+_0x5b5a23(0x1d1)+TABLE_SETTINGS+(_0x5b5a23(0x249)+_0x5b5a23(0x1d3)+_0x5b5a23(0x233)+_0x5b5a23(0x1dc)+_0x5b5a23(0x196)+_0x5b5a23(0x1ac))+TABLE_SETTINGS+';'):await db[_0x5b5a23(0x190)](_0x5b5a23(0x216)+_0x5b5a23(0x1e7)+_0x5b5a23(0x1d1)+TABLE_SETTINGS+(_0x5b5a23(0x249)+'_jid,\x20enab'+_0x5b5a23(0x233)+_0x5b5a23(0x1dc)+'\x200\x20FROM\x20')+TABLE_SETTINGS+';');await db['exec'](_0x5b5a23(0x1c3)+'\x20'+TABLE_SETTINGS+';'),await db[_0x5b5a23(0x190)](_0x5b5a23(0x1e0)+'E\x20'+TABLE_SETTINGS+(_0x5b5a23(0x1b8)+_0x5b5a23(0x20c))+TABLE_SETTINGS+';'),await db[_0x5b5a23(0x190)](_0x5b5a23(0x19a)),info('['+name+(_0x5b5a23(0x201)+'\x20')+TABLE_SETTINGS+(_0x5b5a23(0x23b)+_0x5b5a23(0x184)+'d)'));return;}catch(_0x43e7f7){try{await db['exec'](_0x5b5a23(0x189));}catch(_0x5320f7){}warn('['+name+(_0x5b5a23(0x21a)+_0x5b5a23(0x1c2))+TABLE_SETTINGS+_0x5b5a23(0x1be)+(_0x43e7f7?.[_0x5b5a23(0x24a)]||_0x43e7f7));return;}if(!_0x3111d5||!_0x28645c)try{await db[_0x5b5a23(0x190)](_0x5b5a23(0x208)+_0x5b5a23(0x234)+_0x5b5a23(0x23f)+TABLE_SETTINGS+(_0x5b5a23(0x236)+_0x5b5a23(0x1bd)+_0x5b5a23(0x1f9)+_0x5b5a23(0x19c)+_0x5b5a23(0x1b5))),info('['+name+_0x5b5a23(0x1f8)+TABLE_SETTINGS+('\x20exists\x20wi'+_0x5b5a23(0x1d8)+_0x5b5a23(0x1bf)));}catch(_0x79214d){warn('['+name+(_0x5b5a23(0x1e1)+'\x20')+TABLE_SETTINGS+(_0x5b5a23(0x1b9)+_0x5b5a23(0x21c))+(_0x79214d?.['message']||_0x79214d));}}catch(_0x598207){warn('['+name+(']\x20migrateS'+'pamSetting'+'sIfNeeded\x20'+_0x5b5a23(0x1fb))+(_0x598207?.['message']||_0x598207));}}async function ensureTables(){await migrateSpamSettingsIfNeeded();}function setupSendApi(){const _0x2872d3=_0x915f7e;if(!botRef)return;if(typeof botRef[_0x2872d3(0x1ce)+'e']===_0x2872d3(0x19e))sendApi=async(_0x35ee4e,_0x19e445)=>await botRef['sendMessag'+'e'](_0x35ee4e,_0x19e445);else{if(botRef[_0x2872d3(0x1fd)]&&typeof botRef['sock']['sendMessag'+'e']===_0x2872d3(0x19e))sendApi=async(_0x7126e8,_0x5c75cf)=>await botRef['sock'][_0x2872d3(0x1ce)+'e'](_0x7126e8,_0x5c75cf);else sendApi=null;}}async function sendText(_0x4a003f,_0xa93bfc,_0x2925ff=[]){const _0x27a65b=_0x915f7e;if(!_0xa93bfc||!_0x4a003f)return null;if(!sendApi)return warn('['+name+(_0x27a65b(0x1d5)+':\x20sendApi\x20'+'not\x20availa'+'ble')),null;try{const _0x23097a=typeof _0xa93bfc==='string'?{'text':_0xa93bfc}:_0xa93bfc;if(Array['isArray'](_0x2925ff)&&_0x2925ff['length'])_0x23097a['mentions']=_0x2925ff;return await sendApi(_0x4a003f,_0x23097a);}catch(_0x56a87c){return warn('['+name+(_0x27a65b(0x1d5)+_0x27a65b(0x1f7)+'\x20')+_0x4a003f+':\x20'+(_0x56a87c?.[_0x27a65b(0x24a)]||_0x56a87c)),null;}}async function kickUser(_0x35381e,_0x5d8023){const _0xdf0d72=_0x915f7e;try{const _0x2adde6=botRef[_0xdf0d72(0x1fd)]?.[_0xdf0d72(0x1ab)+_0xdf0d72(0x246)+_0xdf0d72(0x1bb)]||botRef[_0xdf0d72(0x1ab)+_0xdf0d72(0x246)+_0xdf0d72(0x1bb)];if(_0x2adde6)return await _0x2adde6(_0x35381e,[_0x5d8023],'remove'),info('['+name+_0xdf0d72(0x245)+_0x5d8023+_0xdf0d72(0x1ec)+_0x35381e),!![];return![];}catch(_0x43b8cd){return warn('['+name+(_0xdf0d72(0x17a)+_0xdf0d72(0x1be))+(_0x43b8cd?.[_0xdf0d72(0x24a)]||_0x43b8cd)),![];}}async function getChatEnabled(_0x56555d){const _0x55ba3a=_0x915f7e;try{const _0x266e18=await db['get']('SELECT\x20ena'+_0x55ba3a(0x235)+TABLE_SETTINGS+('\x20WHERE\x20cha'+_0x55ba3a(0x1c9)),[_0x56555d]);return _0x266e18?Number(_0x266e18[_0x55ba3a(0x1f0)])===0x25dc+0x1*-0x1de1+-0x7fa:![];}catch(_0x2fe656){return warn('['+name+(_0x55ba3a(0x1b3)+'nabled\x20DB\x20'+_0x55ba3a(0x239))+_0x56555d+':\x20'+(_0x2fe656?.['message']||_0x2fe656)),![];}}async function setChatEnabled(_0x593e19,_0x2139f9){const _0x5daf70=_0x915f7e;try{return await db[_0x5daf70(0x1d7)](_0x5daf70(0x17e)+'O\x20'+TABLE_SETTINGS+(_0x5daf70(0x236)+_0x5daf70(0x22d)+_0x5daf70(0x238)+_0x5daf70(0x221)+_0x5daf70(0x1a3)+_0x5daf70(0x211)+_0x5daf70(0x187)+_0x5daf70(0x1a0)+_0x5daf70(0x1ef)+_0x5daf70(0x17f)+_0x5daf70(0x219)),[_0x593e19,_0x2139f9?0x16e9+-0x1*0x1567+0x7*-0x37:0x211a+0x1607+-0x503*0xb]),!![];}catch(_0x3b48d9){return warn('['+name+(']\x20setChatE'+'nabled\x20DB\x20'+'error\x20for\x20')+_0x593e19+':\x20'+(_0x3b48d9?.[_0x5daf70(0x24a)]||_0x3b48d9)),![];}}function ensureChatMap(_0x543047){const _0x5e83ef=_0x915f7e;if(!chatUserMap[_0x5e83ef(0x1f4)](_0x543047))chatUserMap[_0x5e83ef(0x1a6)](_0x543047,new Map());return chatUserMap['get'](_0x543047);}function clearChatMemory(_0x67110b){const _0x209c0f=_0x915f7e;if(chatUserMap[_0x209c0f(0x1f4)](_0x67110b))chatUserMap[_0x209c0f(0x1ca)](_0x67110b);}async function handleMessageForSpam(_0x45a57e){const _0x3e5487=_0x915f7e;try{const _0x7b772=String(_0x45a57e['key']?.[_0x3e5487(0x230)]||'');if(!_0x7b772||!_0x7b772[_0x3e5487(0x1a5)](_0x3e5487(0x203)))return;if(_0x45a57e[_0x3e5487(0x1ad)]?.[_0x3e5487(0x177)])return;const _0x4af0e8=await getChatEnabled(_0x7b772);if(!_0x4af0e8)return;const _0xd27a4c=String(_0x45a57e[_0x3e5487(0x1ad)]?.[_0x3e5487(0x204)+'t']||_0x45a57e[_0x3e5487(0x1ad)]?.[_0x3e5487(0x1ba)]||'');if(!_0xd27a4c)return;try{if(await isadmin(botRef,{'key':{'remoteJid':_0x7b772,'participant':_0xd27a4c},'message':_0x45a57e[_0x3e5487(0x24a)]}))return;}catch(_0x1d71f3){}const _0xcdf885=Date[_0x3e5487(0x185)](),_0x26abbc=ensureChatMap(_0x7b772);!_0x26abbc[_0x3e5487(0x1f4)](_0xd27a4c)&&_0x26abbc[_0x3e5487(0x1a6)](_0xd27a4c,{'timestamps':[],'lastWarnAt':0x0,'warnCount':0x0,'warnExpiresAt':0x0});const _0x3eb1fa=_0x26abbc[_0x3e5487(0x200)](_0xd27a4c);_0x3eb1fa['timestamps']=(_0x3eb1fa['timestamps']||[])['filter'](_0x43693b=>_0xcdf885-_0x43693b<=CFG[_0x3e5487(0x186)+_0x3e5487(0x176)]),_0x3eb1fa[_0x3e5487(0x16d)][_0x3e5487(0x207)](_0xcdf885);if(_0x3eb1fa[_0x3e5487(0x17d)]&&_0xcdf885-_0x3eb1fa[_0x3e5487(0x17d)]<CFG[_0x3e5487(0x1a7)+'OWN_MS'])return;if((_0x3eb1fa[_0x3e5487(0x16d)]||[])[_0x3e5487(0x1b6)]>=CFG['SPAM_THRES'+'HOLD']){_0x3eb1fa[_0x3e5487(0x17d)]=_0xcdf885;(!_0x3eb1fa['warnExpire'+_0x3e5487(0x183)]||_0x3eb1fa[_0x3e5487(0x1f6)+_0x3e5487(0x183)]<=_0xcdf885)&&(_0x3eb1fa[_0x3e5487(0x215)]=0x2*0x269+-0x2164+0x6*0x4c3);_0x3eb1fa[_0x3e5487(0x215)]=(_0x3eb1fa[_0x3e5487(0x215)]||-0xeef+-0x15dc+0x1*0x24cb)+(-0x4f*-0x1c+0xbdf+-0x96*0x23),_0x3eb1fa[_0x3e5487(0x1f6)+_0x3e5487(0x183)]=_0xcdf885+CFG[_0x3e5487(0x1b4)+_0x3e5487(0x223)];const _0x1632e2=Math[_0x3e5487(0x1c8)](0x10d4+0x21ed*0x1+-0x1*0x32c1,CFG['MAX_WARNIN'+'GS']-_0x3eb1fa['warnCount']),_0x4bdcec='@'+_0xd27a4c['split']('@')[-0x1061*-0x1+0x18f2+-0x2953],_0x2915f9=String(CFG[_0x3e5487(0x1ed)+_0x3e5487(0x1ae)]||'')['replace'](_0x3e5487(0x188),_0x4bdcec)['replace'](_0x3e5487(0x1fa),String(_0x1632e2)),_0x43ad3c=await sendText(_0x7b772,{'text':_0x2915f9,'mentions':[_0xd27a4c]});_0x43ad3c?.['key']&&CFG[_0x3e5487(0x1ea)+_0x3e5487(0x1a9)]>-0x1*0x952+0x63*0x65+-0x1*0x1dbd&&setTimeout(async()=>{const _0x42df7c=_0x3e5487;try{await sendText(_0x7b772,{'delete':_0x43ad3c[_0x42df7c(0x1ad)]});}catch(_0x2a966c){}},CFG['WARNING_TT'+_0x3e5487(0x1a9)]);if(CFG[_0x3e5487(0x1e4)+'AM']&&_0x3eb1fa[_0x3e5487(0x215)]>=CFG['MAX_WARNIN'+'GS']){const _0x2258c6=await kickUser(_0x7b772,_0xd27a4c);_0x2258c6?(_0x26abbc['delete'](_0xd27a4c),await sendText(_0x7b772,{'text':_0x4bdcec+(_0x3e5487(0x213)+_0x3e5487(0x171)+_0x3e5487(0x1fe)),'mentions':[_0xd27a4c]})[_0x3e5487(0x198)](()=>{})):warn('['+name+(']\x20failed\x20t'+_0x3e5487(0x1e9))+_0xd27a4c+'\x20from\x20'+_0x7b772);}}}catch(_0x1967ff){warn('['+name+(_0x3e5487(0x191)+'ssageForSp'+_0x3e5487(0x18a))+(_0x1967ff?.[_0x3e5487(0x24a)]||_0x1967ff));}}function _0x2f88(){const _0x25e814=['\x20reset\x20for','sendMessag','find','DISABLED','TO\x20','SELECT\x20nam','_jid,\x20enab','up.',']\x20sendText','r\x20failed:\x20','run','th\x20expecte','o\x20create\x20','nti-spam\x20(','48pBGVQL','T\x20chat_id,','er\x20error:\x20','218409RTkvbl','column_nam','ALTER\x20TABL',']\x20Ensuring','ite_master','mory\x20enfor','KICK_ON_SP','\x0aConfig:\x20','values','REPLACE\x20IN','HOLD','o\x20kick\x20','WARNING_TT','AND\x20name=?','\x20from\x20','WARNING_ME','toLowerCas','abled\x20=\x20ex','enabled','includes','clear','zed.\x20In-me','has','requires\x20b','warnExpire','\x20failed\x20to',']\x20Ensured\x20','ARY\x20KEY,\x20e','{warnings}','error:\x20','e\x20FROM\x20sql','sock','d\x20spam.','chat_id','get',']\x20Migrated','SELECT\x20*\x20F','@g.us','participan','\x20within\x20','sts(','push','CREATE\x20TAB','split','keys','3885068TQCPBN','E\x20TO\x20','ngs:\x20{warn','psert','gesUpsertH','m\x20ENABLED\x20','ICT(chat_j','3643112WFNkJF','\x20removed\x20f','\x20INTEGER);','warnCount','INSERT\x20OR\x20','⚠️\x20{user},\x20','7BURXYE','bled;',']\x20Migratio','⚠️\x20Failed\x20t','ailed:\x20','ms,\x20maxWar','2.0.0-inme','DB\x20error).','show',',\x20?)\x20\x0a\x20\x20\x20\x20','\x20user(s).','Y_MS','off','mory','andler\x20inn','mentionedJ','slice','5JpsqsX','messages.u','ings}','(DB\x20error)',',\x20enabled)','OWN_MS','SPAM_THRES','remoteJid','filter','\x20warnings.','led)\x20SELEC','LE\x20IF\x20NOT\x20','bled\x20FROM\x20','\x20(chat_jid','BEGIN\x20TRAN','\x20VALUES\x20(?','error\x20for\x20','112tGUnhc','\x20(chat_id\x20','eset\x20their',']\x20rawMessa','stop\x20spamm','EXISTS\x20','m\x20warnings',')\x20error:\x20','ze\x20fatal:\x20','ning\x20warni','6703326wmLCcw',']\x20kicked\x20','cipantsUpd','isCommand','nitialize\x20','_new\x20(chat','message','anti-spam\x20','timestamps','168628KVFRSa','cement.\x20DB','\x20anti-spam','or\x20repeate','\x20group:\x20','isArray','table\x20',']\x20tableExi','W_MS','fromMe','Y,\x20enabled','ing.\x20Remai',']\x20kickUser','o\x20disable\x20','\x20for\x20this\x20','lastWarnAt','INSERT\x20INT','cluded.ena','le_info(',']\x20Created\x20','rows','sAt','->\x20chat_ji','now','SPAM_WINDO','id)\x20DO\x20UPD','{user}','ROLLBACK;','am\x20error:\x20','SPAM',']\x20Failed\x20t','text','o\x20enable\x20a','PRAGMA\x20tab','exec',']\x20handleMe','60xbygsf','cid',']\x20onMessag','stringify','\x20enabled\x20F','\x20LIMIT\x201','catch','users\x20to\x20r','COMMIT;','e\x20error:\x20','nabled\x20INT','62778eEIfaz','function','trim','ATE\x20SET\x20en','1439199YGmBsg','gedListene','\x20\x20ON\x20CONFL','for\x20this\x20g','endsWith','set','SPAM_COOLD',']\x20initiali','L_MS','SACTION;','groupParti','ROM\x20','key','SSAGE','resetspam','✔️\x20Anti-spa','e=\x27table\x27\x20','ENABLED',']\x20getChatE','WARN_EXPIR','EGER);','length','antispam','_new\x20RENAM','\x20columns\x20f','from','ate','r:\x20','\x20TEXT\x20PRIM','\x20failed:\x20','d\x20columns.','\x20WHERE\x20typ','ot\x20instanc','n\x20of\x20','DROP\x20TABLE','string','map','name','roup.','max','t_jid\x20=\x20?','delete','MAX_WARNIN','ngs'];_0x2f88=function(){return _0x25e814;};return _0x2f88();}async function rawMessagesUpsertHandler({messages:_0x1f677}){const _0x355fec=_0x915f7e;if(!Array[_0x355fec(0x173)](_0x1f677))return;for(const _0x558cc6 of _0x1f677){try{const _0x21272c=String(_0x558cc6[_0x355fec(0x1ad)]?.[_0x355fec(0x230)]||'');if(!_0x21272c||!_0x21272c[_0x355fec(0x1a5)](_0x355fec(0x203)))continue;if(!_0x558cc6['message'])continue;if(_0x558cc6[_0x355fec(0x1ad)]?.['fromMe'])continue;const _0x4c54ca=_0x21272c+'::'+String(_0x558cc6[_0x355fec(0x1ad)]?.['id']||'')+'::'+String(_0x558cc6['key']?.['participan'+'t']||'');if(processedMessageKeys[_0x355fec(0x1f4)](_0x4c54ca))continue;const _0x8830e5=setTimeout(()=>processedMessageKeys['delete'](_0x4c54ca),DEDUPE_TTL_MS);processedMessageKeys['set'](_0x4c54ca,_0x8830e5),await handleMessageForSpam(_0x558cc6);}catch(_0x5c0f50){warn('['+name+(_0x355fec(0x23d)+_0x355fec(0x20f)+_0x355fec(0x226)+_0x355fec(0x1dd))+(_0x5c0f50?.[_0x355fec(0x24a)]||_0x5c0f50));}}}export async function onMessage(_0x26132c){const _0x2720b6=_0x915f7e;try{if(!_0x26132c||!_0x26132c[_0x2720b6(0x1ad)]||!_0x26132c[_0x2720b6(0x24a)]||!_0x26132c[_0x2720b6(0x247)])return;const _0x5f26c0=String(_0x26132c[_0x2720b6(0x1ad)]['remoteJid']||'');if(!_0x5f26c0['endsWith'](_0x2720b6(0x203)))return;if(!await isadmin(botRef,_0x26132c))return;const _0x29856e=typeof _0x26132c[_0x2720b6(0x18d)]===_0x2720b6(0x1c4)&&_0x26132c['text'][_0x2720b6(0x19f)]()['length']?_0x26132c[_0x2720b6(0x18d)][_0x2720b6(0x19f)]():'';if(!_0x29856e)return;const _0x3016b8=_0x29856e[_0x2720b6(0x209)](/\s+/)[_0x2720b6(0x231)](Boolean);if(!_0x3016b8[_0x2720b6(0x1b6)])return;const _0xa2c574=String(_0x3016b8[0xb*-0xbe+-0x57e+0xda8]||'')[_0x2720b6(0x1ee)+'e'](),_0x354c6d=_0x3016b8[_0x2720b6(0x228)](0x1*-0x25ca+0x1a8*0x10+0xb4b);if(!commands[_0x2720b6(0x1f1)](_0xa2c574))return;if(_0xa2c574===_0x2720b6(0x1b7)){const _0x2e2ba6=(_0x354c6d[_0x2720b6(0x1cf)](_0x23cde1=>['on',_0x2720b6(0x224),_0x2720b6(0x220)][_0x2720b6(0x1f1)](String(_0x23cde1)['toLowerCas'+'e']()))||_0x2720b6(0x220))['toLowerCas'+'e']();if(_0x2e2ba6==='on'){const _0x515d0e=await setChatEnabled(_0x5f26c0,!![]);return _0x515d0e?(clearChatMemory(_0x5f26c0),sendText(_0x5f26c0,'✔️\x20Anti-spa'+_0x2720b6(0x210)+_0x2720b6(0x1a4)+_0x2720b6(0x1c7))):sendText(_0x5f26c0,'⚠️\x20Failed\x20t'+_0x2720b6(0x18e)+_0x2720b6(0x1da)+_0x2720b6(0x21f));}else{if(_0x2e2ba6===_0x2720b6(0x224)){const _0x9a4c0f=await setChatEnabled(_0x5f26c0,![]);return _0x9a4c0f?(clearChatMemory(_0x5f26c0),sendText(_0x5f26c0,'✔️\x20Anti-spa'+'m\x20DISABLED'+_0x2720b6(0x17c)+'group.')):sendText(_0x5f26c0,_0x2720b6(0x21b)+_0x2720b6(0x17b)+_0x2720b6(0x16c)+_0x2720b6(0x22c)+'.');}else{const _0x369f00=await getChatEnabled(_0x5f26c0),_0x415f0d={'SPAM_THRESHOLD':CFG[_0x2720b6(0x22f)+_0x2720b6(0x1e8)],'SPAM_WINDOW_MS':CFG[_0x2720b6(0x186)+'W_MS'],'SPAM_COOLDOWN_MS':CFG[_0x2720b6(0x1a7)+_0x2720b6(0x22e)],'MAX_WARNINGS':CFG[_0x2720b6(0x1cb)+'GS'],'KICK_ON_SPAM':CFG[_0x2720b6(0x1e4)+'AM']};return sendText(_0x5f26c0,'✔️\x20Anti-spa'+'m\x20for\x20this'+_0x2720b6(0x172)+(_0x369f00?_0x2720b6(0x1b2):_0x2720b6(0x1d0))+_0x2720b6(0x1e5)+JSON[_0x2720b6(0x195)](_0x415f0d));}}}if(_0xa2c574===_0x2720b6(0x1af)){const _0x1684ed=_0x26132c[_0x2720b6(0x24a)]?.['extendedTe'+'xtMessage']?.['contextInf'+'o']?.[_0x2720b6(0x227)+'id']||[];if(!_0x1684ed||_0x1684ed[_0x2720b6(0x1b6)]===0x1940+-0x1060+-0x8e0)return sendText(_0x5f26c0,'✔️\x20Please\x20@'+'mention\x20on'+'e\x20or\x20more\x20'+_0x2720b6(0x199)+_0x2720b6(0x23c)+_0x2720b6(0x170)+_0x2720b6(0x232));const _0x441a38=chatUserMap[_0x2720b6(0x200)](_0x5f26c0);for(const _0x4c465b of _0x1684ed){if(_0x441a38&&_0x441a38[_0x2720b6(0x1f4)](_0x4c465b))_0x441a38['delete'](_0x4c465b);}return sendText(_0x5f26c0,_0x2720b6(0x1b0)+_0x2720b6(0x240)+_0x2720b6(0x1cd)+'\x20mentioned'+_0x2720b6(0x222));}}catch(_0x51b8){error(_0x51b8,'['+name+(_0x2720b6(0x194)+_0x2720b6(0x19b))+(_0x51b8?.[_0x2720b6(0x24a)]||_0x51b8));}}export async function initialize(_0x426fdc){const _0x201bcf=_0x915f7e;try{if(!_0x426fdc)throw new Error('antispam.i'+_0x201bcf(0x248)+_0x201bcf(0x1f5)+_0x201bcf(0x1c1)+'e');botRef=_0x426fdc,setupSendApi(),refreshConfig(),hotReloadConfig?.(refreshConfig),await ensureTables(),startManagedListener({'botRef':botRef,'eventName':'messages.u'+_0x201bcf(0x20e),'handler':rawMessagesUpsertHandler,'moduleName':name}),info('['+name+(_0x201bcf(0x1a8)+_0x201bcf(0x1f3)+_0x201bcf(0x1e3)+_0x201bcf(0x16f)+'\x20holds\x20onl'+'y\x20')+TABLE_SETTINGS+('.\x20Threshol'+'d=')+CFG[_0x201bcf(0x22f)+_0x201bcf(0x1e8)]+_0x201bcf(0x205)+CFG[_0x201bcf(0x186)+_0x201bcf(0x176)]+(_0x201bcf(0x21d)+'ns=')+CFG[_0x201bcf(0x1cb)+'GS']);}catch(_0x399b85){error(_0x399b85,'['+name+(_0x201bcf(0x1a8)+_0x201bcf(0x242))+(_0x399b85?.[_0x201bcf(0x24a)]||_0x399b85));throw _0x399b85;}}export async function cleanup(){const _0x34850d=_0x915f7e;try{stopManagedListener(name,_0x34850d(0x22a)+_0x34850d(0x20e));}catch(_0x28fa45){warn('['+name+(']\x20stopMana'+_0x34850d(0x1a2)+_0x34850d(0x1d6))+(_0x28fa45?.[_0x34850d(0x24a)]||_0x28fa45));}for(const _0x39734f of processedMessageKeys[_0x34850d(0x1e6)]())try{clearTimeout(_0x39734f);}catch(_0x4778f4){}processedMessageKeys[_0x34850d(0x1f2)](),chatUserMap[_0x34850d(0x1f2)](),botRef=null,sendApi=null,info('['+name+(']\x20cleaned\x20'+_0x34850d(0x1d4)));}export default{'name':name,'version':version,'priority':priority,'commands':commands,'configKeys':configKeys,'initialize':initialize,'onMessage':onMessage,'cleanup':cleanup};