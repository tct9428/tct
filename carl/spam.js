const _0x324834=_0x1838;(function(_0x36db41,_0x4c9b25){const _0x11275f=_0x1838,_0x5310f7=_0x36db41();while(!![]){try{const _0x135a3a=-parseInt(_0x11275f(0x243))/(0x4d9+0x95*-0x39+-0x1c55*-0x1)+parseInt(_0x11275f(0x290))/(0x22e1+0x15*-0xd3+-0x1190)*(-parseInt(_0x11275f(0x204))/(0x2653*-0x1+0x121+0x2535))+-parseInt(_0x11275f(0x1ff))/(-0x507+-0x2*-0xf0b+-0x190b)+parseInt(_0x11275f(0x22e))/(-0x139d+0xae0+0x8c2)*(parseInt(_0x11275f(0x1e1))/(0x24a*-0x2+-0x7*-0x3ad+-0x1521))+parseInt(_0x11275f(0x260))/(0x11ce+0x2182+-0x3349)+parseInt(_0x11275f(0x20d))/(0x1a*-0x7+-0x21bb+0x5*0x6e5)+parseInt(_0x11275f(0x244))/(0x1d26+-0x311*-0x1+-0x202e);if(_0x135a3a===_0x4c9b25)break;else _0x5310f7['push'](_0x5310f7['shift']());}catch(_0x478f0e){_0x5310f7['push'](_0x5310f7['shift']());}}}(_0x7ffe,0xc4450+-0xb08*-0x241+-0x1*0x171ab1));import{info,warn,error}from'../utils/logger.js';import{db}from'../utils/database.js';import{isadmin}from'../utils/isadmin.js';import{startManagedListener,stopManagedListener}from'../utils/listenerManager.js';import{getConfig,hotReloadConfig}from'../utils/config.js';export const name=_0x324834(0x29a);export const version='2.0.0-inme'+_0x324834(0x29b);export const priority=-0xd48+0x1*0x124f+-0x85*0x9;export const commands=[_0x324834(0x29a),'resetspam'];function _0x1838(_0xaa1519,_0x4dde26){const _0x2e5f34=_0x7ffe();return _0x1838=function(_0x5ed9d3,_0x2e6864){_0x5ed9d3=_0x5ed9d3-(0x248f+-0x126f+-0x1050);let _0x1f79f8=_0x2e5f34[_0x5ed9d3];return _0x1f79f8;},_0x1838(_0xaa1519,_0x4dde26);}export const configKeys=[_0x324834(0x242)];let botRef=null,sendApi=null;const chatUserMap=new Map(),processedMessageKeys=new Map(),DEDUPE_TTL_MS=(-0xa4*-0x6+0x50*-0x58+0x17c6)*(-0x7ef*0x3+0x1c26+-0x71),CFG={'SPAM_THRESHOLD':0x6,'SPAM_WINDOW_MS':(0x1b1*-0x17+-0x4*0x2c5+-0x5*-0xa01)*(0x1*0x48f+-0x8a8+0x3*0x2ab),'SPAM_COOLDOWN_MS':0x3e8,'MAX_WARNINGS':0x3,'WARN_EXPIRY_MS':(-0x27c+-0x24dd*-0x1+-0x225a)*(0x11f5+0x318+-0x1*0x14f5)*(0x9ab*0x4+0x18fa+0x1fb5*-0x2)*(-0x19fd+-0xda*0x9+-0x21e3*-0x1)*(-0x1*0x11de+0x1*-0x1ed7+0x349d),'KICK_ON_SPAM':!![],'WARNING_MESSAGE':'⚠️\x20{user},\x20'+_0x324834(0x25f)+'ing.\x20Remai'+_0x324834(0x27f)+'ngs:\x20{warn'+_0x324834(0x250),'WARNING_TTL_MS':0xc350};function refreshConfig(){const _0x1e00cd=_0x324834;try{const _0x3ae6a7=getConfig?.()?.['SPAM']||{};Object[_0x1e00cd(0x285)](CFG)['forEach'](_0x527ad8=>{if(_0x3ae6a7[_0x527ad8]!==undefined)CFG[_0x527ad8]=_0x3ae6a7[_0x527ad8];}),CFG['SPAM_THRES'+'HOLD']=Math[_0x1e00cd(0x222)](-0x1655*0x1+-0x25fc+-0x2*-0x1e29,Number(CFG[_0x1e00cd(0x20a)+_0x1e00cd(0x28f)])||0x174e+0x230d+-0x3a55),CFG['SPAM_WINDO'+_0x1e00cd(0x1d2)]=Math['max'](-0x1*0x739+-0xc1*0x2f+0x2aa8,Number(CFG[_0x1e00cd(0x287)+_0x1e00cd(0x1d2)])||(-0x53*0x5e+-0x1f*-0x29+0x198d)*(0x9a5+-0x18d3*-0x1+0x28c*-0xc)),CFG[_0x1e00cd(0x230)+_0x1e00cd(0x1fd)]=Math['max'](-0x1e90+0x5*-0x2c7+-0x2c73*-0x1,Number(CFG[_0x1e00cd(0x230)+_0x1e00cd(0x1fd)])||0x19e7+0x1*0x76d+0x434*-0x7),CFG[_0x1e00cd(0x208)+'GS']=Math[_0x1e00cd(0x222)](0x1*-0x1367+-0x2b1*0x9+0x291*0x11,Number(CFG[_0x1e00cd(0x208)+'GS'])||0xbc7+-0xaaf*0x2+0x99a),CFG[_0x1e00cd(0x24f)+_0x1e00cd(0x1f5)]=Math[_0x1e00cd(0x222)](0x20af+-0x1e40*0x1+-0x26f,Number(CFG['WARN_EXPIR'+_0x1e00cd(0x1f5)])||(-0x2fe+0x1d86+-0x73*0x3b)*(-0xc2e+0x2*0xcca+-0x1*0xd4e)*(-0x216d*0x1+0x14a9+0x2*0x680)*(0x3*0x10c+-0x2624+-0x19a*-0x16)*(0x219+0x17a6+0x15d7*-0x1)),CFG[_0x1e00cd(0x249)+_0x1e00cd(0x293)]=Math['max'](-0x1d64+0x472*0x1+0xce*0x1f,Number(CFG['WARNING_TT'+_0x1e00cd(0x293)])||0x26d7*-0x5+-0x6810+0x1ed93),CFG[_0x1e00cd(0x2a6)+'AM']=!!CFG['KICK_ON_SP'+'AM'];}catch(_0x583d84){warn('['+name+(']\x20refreshC'+_0x1e00cd(0x278)+_0x1e00cd(0x22f))+(_0x583d84?.[_0x1e00cd(0x277)]||_0x583d84));}}const TABLE_SETTINGS='spam_setti'+_0x324834(0x283);async function tableExists(_0x301eeb){const _0x266282=_0x324834;try{const _0x32fcfa=await db[_0x266282(0x1e3)](_0x266282(0x272)+'e\x20FROM\x20sql'+_0x266282(0x219)+_0x266282(0x1e5)+_0x266282(0x24b)+_0x266282(0x236),[_0x301eeb]);return!!_0x32fcfa;}catch(_0x513182){return warn('['+name+(_0x266282(0x20e)+_0x266282(0x1e0))+_0x301eeb+_0x266282(0x216)+(_0x513182?.[_0x266282(0x277)]||_0x513182)),![];}}async function getTableColumns(_0x41f1c9){const _0xb6650d=_0x324834;try{const _0x1f07a5=await db[_0xb6650d(0x276)](_0xb6650d(0x284)+_0xb6650d(0x256)+_0x41f1c9+');'),_0x1beaf0=Array['isArray'](_0x1f07a5)?_0x1f07a5:_0x1f07a5&&_0x1f07a5[_0xb6650d(0x25c)]?_0x1f07a5['rows']:[];return _0x1beaf0['map'](_0x232442=>_0x232442['name']||_0x232442[_0xb6650d(0x21c)+'e']||_0x232442[_0xb6650d(0x1e9)]);}catch(_0x462c54){try{const _0x3f311e=await db['get'](_0xb6650d(0x1dc)+_0xb6650d(0x215)+_0x41f1c9+'\x20LIMIT\x201');return _0x3f311e?Object['keys'](_0x3f311e):[];}catch(_0x45b4d1){return[];}}}async function migrateSpamSettingsIfNeeded(){const _0x557602=_0x324834,_0x12a0ca=await tableExists(TABLE_SETTINGS);if(!_0x12a0ca)try{await db[_0x557602(0x276)](_0x557602(0x26e)+'LE\x20IF\x20NOT\x20'+_0x557602(0x29c)+TABLE_SETTINGS+(_0x557602(0x26f)+'\x20TEXT\x20PRIM'+'ARY\x20KEY,\x20e'+_0x557602(0x27d)+_0x557602(0x234))),info('['+name+(_0x557602(0x24c)+'table\x20')+TABLE_SETTINGS);return;}catch(_0x33ef69){warn('['+name+(_0x557602(0x289)+_0x557602(0x23a))+TABLE_SETTINGS+':\x20'+(_0x33ef69?.[_0x557602(0x277)]||_0x33ef69));return;}try{const _0x5d906c=await db['exec']('PRAGMA\x20tab'+_0x557602(0x256)+TABLE_SETTINGS+');');let _0x4f436f=[];if(Array[_0x557602(0x22a)](_0x5d906c))_0x4f436f=_0x5d906c['map'](_0x541cb0=>_0x541cb0[_0x557602(0x205)]||_0x541cb0[0xf6*0x1b+0x1*0x1322+-0x2d13])[_0x557602(0x27e)](Boolean);else{if(_0x5d906c&&Array[_0x557602(0x22a)](_0x5d906c[_0x557602(0x25c)]))_0x4f436f=_0x5d906c[_0x557602(0x25c)][_0x557602(0x23c)](_0x3884ae=>_0x3884ae[_0x557602(0x205)])['filter'](Boolean);else try{const _0x1d0ed8=await db[_0x557602(0x1e3)](_0x557602(0x1dc)+_0x557602(0x215)+TABLE_SETTINGS+'\x20LIMIT\x201');_0x4f436f=_0x1d0ed8?Object[_0x557602(0x285)](_0x1d0ed8):[];}catch(_0x5056fe){_0x4f436f=[];}}const _0x4efb8f=_0x4f436f['map'](_0x26dbb3=>String(_0x26dbb3)[_0x557602(0x1d0)+'e']()),_0x1293c0=_0x4efb8f[_0x557602(0x298)](_0x557602(0x1f8)),_0x39d9b1=_0x4efb8f[_0x557602(0x298)](_0x557602(0x266)),_0x3bc36e=_0x4efb8f[_0x557602(0x298)](_0x557602(0x1d6));if(_0x1293c0&&_0x39d9b1)return;if(!_0x1293c0&&_0x3bc36e)try{await db[_0x557602(0x276)]('BEGIN\x20TRAN'+_0x557602(0x2a5)),await db[_0x557602(0x276)](_0x557602(0x26e)+_0x557602(0x2a7)+'EXISTS\x20'+TABLE_SETTINGS+(_0x557602(0x21a)+_0x557602(0x265)+_0x557602(0x20f)+_0x557602(0x29e)+_0x557602(0x2a1)));const _0x2bd933=_0x39d9b1;_0x2bd933?await db['exec']('INSERT\x20OR\x20'+_0x557602(0x220)+_0x557602(0x1fa)+TABLE_SETTINGS+('_new\x20(chat'+'_jid,\x20enab'+'led)\x20SELEC'+'T\x20chat_id,'+_0x557602(0x1e7)+_0x557602(0x215))+TABLE_SETTINGS+';'):await db['exec'](_0x557602(0x25a)+_0x557602(0x220)+_0x557602(0x1fa)+TABLE_SETTINGS+(_0x557602(0x21a)+_0x557602(0x1ec)+_0x557602(0x207)+_0x557602(0x224)+'\x200\x20FROM\x20')+TABLE_SETTINGS+';');await db[_0x557602(0x276)](_0x557602(0x291)+'\x20'+TABLE_SETTINGS+';'),await db[_0x557602(0x276)](_0x557602(0x25b)+'E\x20'+TABLE_SETTINGS+(_0x557602(0x27a)+_0x557602(0x267))+TABLE_SETTINGS+';'),await db[_0x557602(0x276)](_0x557602(0x279)),info('['+name+(_0x557602(0x2a2)+'\x20')+TABLE_SETTINGS+(_0x557602(0x21b)+_0x557602(0x1df)+'d)'));return;}catch(_0x2235de){try{await db[_0x557602(0x276)](_0x557602(0x218));}catch(_0x495471){}warn('['+name+(_0x557602(0x1f9)+'n\x20of\x20')+TABLE_SETTINGS+'\x20failed:\x20'+(_0x2235de?.['message']||_0x2235de));return;}if(!_0x1293c0||!_0x39d9b1)try{await db[_0x557602(0x276)](_0x557602(0x26e)+'LE\x20IF\x20NOT\x20'+'EXISTS\x20'+TABLE_SETTINGS+(_0x557602(0x26f)+_0x557602(0x28a)+_0x557602(0x262)+_0x557602(0x27d)+_0x557602(0x234))),info('['+name+_0x557602(0x261)+TABLE_SETTINGS+(_0x557602(0x286)+_0x557602(0x252)+'d\x20columns.'));}catch(_0x4cef10){warn('['+name+(_0x557602(0x288)+'\x20')+TABLE_SETTINGS+('\x20columns\x20f'+_0x557602(0x206))+(_0x4cef10?.[_0x557602(0x277)]||_0x4cef10));}}catch(_0x42913c){warn('['+name+(_0x557602(0x26c)+_0x557602(0x21f)+'sIfNeeded\x20'+_0x557602(0x270))+(_0x42913c?.[_0x557602(0x277)]||_0x42913c));}}function _0x7ffe(){const _0x4920da=['r:\x20','SPAM_COOLD',']\x20onMessag','mentionedJ','DB\x20error).','EGER);','INSERT\x20INT','AND\x20name=?','@g.us','nitialize\x20','r\x20failed:\x20','o\x20create\x20','\x20group:\x20','map','\x20reset\x20for','\x20mentioned','\x20for\x20this\x20','DISABLED',']\x20rawMessa','SPAM','419768tUKfgo','8568261EFShxt','catch','clear','sock',']\x20cleaned\x20','WARNING_TT','show','e=\x27table\x27\x20',']\x20Created\x20','psert','id)\x20DO\x20UPD','WARN_EXPIR','ings}','ble','th\x20expecte','\x20removed\x20f','off','m\x20DISABLED','le_info(','up.','xtMessage','m\x20warnings','INSERT\x20OR\x20','ALTER\x20TABL','rows','or\x20repeate',']\x20handleMe','stop\x20spamm','3760190ZLtfew',']\x20Ensured\x20','ARY\x20KEY,\x20e',',\x20?)\x20\x0a\x20\x20\x20\x20','o\x20disable\x20','_jid\x20TEXT\x20','enabled','E\x20TO\x20','split','fromMe','length','er\x20error:\x20',']\x20migrateS','.\x20Threshol','CREATE\x20TAB','\x20(chat_jid','error:\x20',']\x20initiali','SELECT\x20nam','e\x20error:\x20','key','ze\x20fatal:\x20','exec','message','onfig\x20erro','COMMIT;','_new\x20RENAM','resetspam','nti-spam\x20(','nabled\x20INT','filter','ning\x20warni','groupParti','group.','lastWarnAt','ngs','PRAGMA\x20tab','keys','\x20exists\x20wi','SPAM_WINDO',']\x20Ensuring',']\x20Failed\x20t','\x20TEXT\x20PRIM','remove','anti-spam\x20','from','\x20warnings.','HOLD','87038CFHQBY','DROP\x20TABLE','not\x20availa','L_MS','eset\x20their','antispam.i','now','run','includes','\x0aConfig:\x20','antispam','mory','EXISTS\x20',']\x20stopMana','Y,\x20enabled','stringify','{user}','\x20INTEGER);',']\x20Migrated','roup.','mory\x20enfor','SACTION;','KICK_ON_SP','LE\x20IF\x20NOT\x20','timestamps','toLowerCas',']\x20setChatE','W_MS','\x20anti-spam','t_jid\x20=\x20?','endsWith','chat_id','gesUpsertH','isCommand','cluded.ena','error\x20for\x20','for\x20this\x20g','SELECT\x20*\x20F','users\x20to\x20r','bled\x20FROM\x20','->\x20chat_ji','sts(','69030nNmiGu','trim','get','✔️\x20Please\x20@','\x20WHERE\x20typ','ICT(chat_j','\x20enabled\x20F',']\x20failed\x20t','cid','ssageForSp','ns=','_jid,\x20enab','e\x20or\x20more\x20','ATE\x20SET\x20en','\x20within\x20','nabled\x20DB\x20','WARNING_ME','\x20\x20ON\x20CONFL','remoteJid','replace','Y_MS','⚠️\x20Failed\x20t','ENABLED','chat_jid',']\x20Migratio','TO\x20','mentions','\x20holds\x20onl','OWN_MS','\x20failed:\x20','6464000LpOBFL',':\x20sendApi\x20','has','m\x20for\x20this','ot\x20instanc','42XwsnAC','name','ailed:\x20','led)\x20SELEC','MAX_WARNIN','cipantsUpd','SPAM_THRES','warnCount','(DB\x20error)','13194856fLywaS',']\x20tableExi','PRIMARY\x20KE','set','participan','o\x20kick\x20','zed.\x20In-me','o\x20enable\x20a','ROM\x20',')\x20error:\x20','delete','ROLLBACK;','ite_master','_new\x20(chat','\x20(chat_id\x20','column_nam','warnExpire','{warnings}','pamSetting','REPLACE\x20IN','messages.u','max','ate','T\x20chat_id,','✔️\x20Anti-spa','text','sAt','slice',']\x20sendText','isArray','\x20from\x20','sendMessag','function','185aRhYCh'];_0x7ffe=function(){return _0x4920da;};return _0x7ffe();}async function ensureTables(){await migrateSpamSettingsIfNeeded();}function setupSendApi(){const _0x49acd4=_0x324834;if(!botRef)return;if(typeof botRef[_0x49acd4(0x22c)+'e']===_0x49acd4(0x22d))sendApi=async(_0x19d064,_0x1b4831)=>await botRef['sendMessag'+'e'](_0x19d064,_0x1b4831);else{if(botRef[_0x49acd4(0x247)]&&typeof botRef[_0x49acd4(0x247)][_0x49acd4(0x22c)+'e']===_0x49acd4(0x22d))sendApi=async(_0x3fccec,_0x4f3645)=>await botRef[_0x49acd4(0x247)][_0x49acd4(0x22c)+'e'](_0x3fccec,_0x4f3645);else sendApi=null;}}async function sendText(_0x3b9445,_0xa719bc,_0x58c85f=[]){const _0x39939b=_0x324834;if(!_0xa719bc||!_0x3b9445)return null;if(!sendApi)return warn('['+name+(_0x39939b(0x229)+_0x39939b(0x200)+_0x39939b(0x292)+_0x39939b(0x251))),null;try{const _0x412a62=typeof _0xa719bc==='string'?{'text':_0xa719bc}:_0xa719bc;if(Array['isArray'](_0x58c85f)&&_0x58c85f[_0x39939b(0x26a)])_0x412a62[_0x39939b(0x1fb)]=_0x58c85f;return await sendApi(_0x3b9445,_0x412a62);}catch(_0x1643ad){return warn('['+name+(_0x39939b(0x229)+'\x20failed\x20to'+'\x20')+_0x3b9445+':\x20'+(_0x1643ad?.[_0x39939b(0x277)]||_0x1643ad)),null;}}async function kickUser(_0x3dbe76,_0x5d8b41){const _0xda8c04=_0x324834;try{const _0x32ddb0=botRef[_0xda8c04(0x247)]?.[_0xda8c04(0x280)+_0xda8c04(0x209)+_0xda8c04(0x223)]||botRef[_0xda8c04(0x280)+_0xda8c04(0x209)+_0xda8c04(0x223)];if(_0x32ddb0)return await _0x32ddb0(_0x3dbe76,[_0x5d8b41],_0xda8c04(0x28b)),info('['+name+']\x20kicked\x20'+_0x5d8b41+_0xda8c04(0x22b)+_0x3dbe76),!![];return![];}catch(_0x2eb3e6){return warn('['+name+(']\x20kickUser'+_0xda8c04(0x1fe))+(_0x2eb3e6?.[_0xda8c04(0x277)]||_0x2eb3e6)),![];}}async function getChatEnabled(_0xaa40af){const _0xe188bd=_0x324834;try{const _0x57dd9c=await db[_0xe188bd(0x1e3)]('SELECT\x20ena'+_0xe188bd(0x1de)+TABLE_SETTINGS+('\x20WHERE\x20cha'+_0xe188bd(0x1d4)),[_0xaa40af]);return _0x57dd9c?Number(_0x57dd9c[_0xe188bd(0x266)])===0x5*0xbd+0xe01*-0x1+0x1*0xa51:![];}catch(_0x443f2d){return warn('['+name+(']\x20getChatE'+_0xe188bd(0x1f0)+_0xe188bd(0x1da))+_0xaa40af+':\x20'+(_0x443f2d?.[_0xe188bd(0x277)]||_0x443f2d)),![];}}async function setChatEnabled(_0x4f34e5,_0x22a8e0){const _0x3bc32e=_0x324834;try{return await db[_0x3bc32e(0x297)](_0x3bc32e(0x235)+'O\x20'+TABLE_SETTINGS+(_0x3bc32e(0x26f)+',\x20enabled)'+'\x20VALUES\x20(?'+_0x3bc32e(0x263)+_0x3bc32e(0x1f2)+_0x3bc32e(0x1e6)+_0x3bc32e(0x24e)+_0x3bc32e(0x1ee)+'abled\x20=\x20ex'+_0x3bc32e(0x1d9)+'bled;'),[_0x4f34e5,_0x22a8e0?-0x2*0xe18+0x154c+0x6e5:0x7f*-0x19+-0xa8d+-0x71*-0x34]),!![];}catch(_0x466c02){return warn('['+name+(_0x3bc32e(0x1d1)+'nabled\x20DB\x20'+'error\x20for\x20')+_0x4f34e5+':\x20'+(_0x466c02?.[_0x3bc32e(0x277)]||_0x466c02)),![];}}function ensureChatMap(_0x44c02d){const _0x80aeae=_0x324834;if(!chatUserMap[_0x80aeae(0x201)](_0x44c02d))chatUserMap[_0x80aeae(0x210)](_0x44c02d,new Map());return chatUserMap['get'](_0x44c02d);}function clearChatMemory(_0x1878e2){const _0x3cc1ad=_0x324834;if(chatUserMap['has'](_0x1878e2))chatUserMap[_0x3cc1ad(0x217)](_0x1878e2);}async function handleMessageForSpam(_0x143fb9){const _0x6c1d2d=_0x324834;try{const _0x123cd8=String(_0x143fb9[_0x6c1d2d(0x274)]?.['remoteJid']||'');if(!_0x123cd8||!_0x123cd8['endsWith'](_0x6c1d2d(0x237)))return;if(_0x143fb9[_0x6c1d2d(0x274)]?.['fromMe'])return;const _0x22f123=await getChatEnabled(_0x123cd8);if(!_0x22f123)return;const _0x1d2d36=String(_0x143fb9[_0x6c1d2d(0x274)]?.[_0x6c1d2d(0x211)+'t']||_0x143fb9[_0x6c1d2d(0x274)]?.[_0x6c1d2d(0x28d)]||'');if(!_0x1d2d36)return;try{if(await isadmin(botRef,{'key':{'remoteJid':_0x123cd8,'participant':_0x1d2d36},'message':_0x143fb9[_0x6c1d2d(0x277)]}))return;}catch(_0x56d174){}const _0x27dcca=Date[_0x6c1d2d(0x296)](),_0x135d90=ensureChatMap(_0x123cd8);!_0x135d90[_0x6c1d2d(0x201)](_0x1d2d36)&&_0x135d90['set'](_0x1d2d36,{'timestamps':[],'lastWarnAt':0x0,'warnCount':0x0,'warnExpiresAt':0x0});const _0x128aee=_0x135d90[_0x6c1d2d(0x1e3)](_0x1d2d36);_0x128aee[_0x6c1d2d(0x2a8)]=(_0x128aee['timestamps']||[])['filter'](_0x5da68d=>_0x27dcca-_0x5da68d<=CFG[_0x6c1d2d(0x287)+_0x6c1d2d(0x1d2)]),_0x128aee[_0x6c1d2d(0x2a8)]['push'](_0x27dcca);if(_0x128aee['lastWarnAt']&&_0x27dcca-_0x128aee['lastWarnAt']<CFG[_0x6c1d2d(0x230)+_0x6c1d2d(0x1fd)])return;if((_0x128aee[_0x6c1d2d(0x2a8)]||[])[_0x6c1d2d(0x26a)]>=CFG[_0x6c1d2d(0x20a)+_0x6c1d2d(0x28f)]){_0x128aee[_0x6c1d2d(0x282)]=_0x27dcca;(!_0x128aee[_0x6c1d2d(0x21d)+'sAt']||_0x128aee[_0x6c1d2d(0x21d)+_0x6c1d2d(0x227)]<=_0x27dcca)&&(_0x128aee[_0x6c1d2d(0x20b)]=-0xe*0x1c1+-0x2234*0x1+0x3ac2);_0x128aee[_0x6c1d2d(0x20b)]=(_0x128aee['warnCount']||0x162e+-0x21eb+0xbbd)+(-0x7c6+-0x1d33+-0x1*-0x24fa),_0x128aee[_0x6c1d2d(0x21d)+_0x6c1d2d(0x227)]=_0x27dcca+CFG[_0x6c1d2d(0x24f)+_0x6c1d2d(0x1f5)];const _0x58b77a=Math[_0x6c1d2d(0x222)](0xcc1*-0x1+-0x13ff+0x20c0,CFG[_0x6c1d2d(0x208)+'GS']-_0x128aee[_0x6c1d2d(0x20b)]),_0x2bf442='@'+_0x1d2d36[_0x6c1d2d(0x268)]('@')[-0x9c*-0x3b+0x1da6+-0x419a*0x1],_0x48338d=String(CFG[_0x6c1d2d(0x1f1)+'SSAGE']||'')[_0x6c1d2d(0x1f4)](_0x6c1d2d(0x2a0),_0x2bf442)['replace'](_0x6c1d2d(0x21e),String(_0x58b77a)),_0x78239a=await sendText(_0x123cd8,{'text':_0x48338d,'mentions':[_0x1d2d36]});_0x78239a?.['key']&&CFG[_0x6c1d2d(0x249)+_0x6c1d2d(0x293)]>-0x742*-0x1+0x1f06+-0x2648&&setTimeout(async()=>{const _0x5d9d7d=_0x6c1d2d;try{await sendText(_0x123cd8,{'delete':_0x78239a[_0x5d9d7d(0x274)]});}catch(_0x19488c){}},CFG['WARNING_TT'+_0x6c1d2d(0x293)]);if(CFG[_0x6c1d2d(0x2a6)+'AM']&&_0x128aee[_0x6c1d2d(0x20b)]>=CFG[_0x6c1d2d(0x208)+'GS']){const _0x3dcbba=await kickUser(_0x123cd8,_0x1d2d36);_0x3dcbba?(_0x135d90[_0x6c1d2d(0x217)](_0x1d2d36),await sendText(_0x123cd8,{'text':_0x2bf442+(_0x6c1d2d(0x253)+_0x6c1d2d(0x25d)+'d\x20spam.'),'mentions':[_0x1d2d36]})[_0x6c1d2d(0x245)](()=>{})):warn('['+name+(_0x6c1d2d(0x1e8)+_0x6c1d2d(0x212))+_0x1d2d36+'\x20from\x20'+_0x123cd8);}}}catch(_0xc5d8d7){warn('['+name+(_0x6c1d2d(0x25e)+_0x6c1d2d(0x1ea)+'am\x20error:\x20')+(_0xc5d8d7?.['message']||_0xc5d8d7));}}async function rawMessagesUpsertHandler({messages:_0x2f1334}){const _0x139666=_0x324834;if(!Array[_0x139666(0x22a)](_0x2f1334))return;for(const _0x1cbae9 of _0x2f1334){try{const _0x3b6089=String(_0x1cbae9[_0x139666(0x274)]?.[_0x139666(0x1f3)]||'');if(!_0x3b6089||!_0x3b6089[_0x139666(0x1d5)](_0x139666(0x237)))continue;if(!_0x1cbae9[_0x139666(0x277)])continue;if(_0x1cbae9[_0x139666(0x274)]?.[_0x139666(0x269)])continue;const _0x445556=_0x3b6089+'::'+String(_0x1cbae9[_0x139666(0x274)]?.['id']||'')+'::'+String(_0x1cbae9[_0x139666(0x274)]?.[_0x139666(0x211)+'t']||'');if(processedMessageKeys[_0x139666(0x201)](_0x445556))continue;const _0x362608=setTimeout(()=>processedMessageKeys['delete'](_0x445556),DEDUPE_TTL_MS);processedMessageKeys[_0x139666(0x210)](_0x445556,_0x362608),await handleMessageForSpam(_0x1cbae9);}catch(_0x316818){warn('['+name+(_0x139666(0x241)+_0x139666(0x1d7)+'andler\x20inn'+_0x139666(0x26b))+(_0x316818?.[_0x139666(0x277)]||_0x316818));}}}export async function onMessage(_0x3b790c){const _0x198315=_0x324834;try{if(!_0x3b790c||!_0x3b790c[_0x198315(0x274)]||!_0x3b790c[_0x198315(0x277)]||!_0x3b790c[_0x198315(0x1d8)])return;const _0x5297ca=String(_0x3b790c[_0x198315(0x274)][_0x198315(0x1f3)]||'');if(!_0x5297ca['endsWith'](_0x198315(0x237)))return;if(!await isadmin(botRef,_0x3b790c))return;const _0x4ae882=typeof _0x3b790c['text']==='string'&&_0x3b790c['text']['trim']()[_0x198315(0x26a)]?_0x3b790c[_0x198315(0x226)][_0x198315(0x1e2)]():'';if(!_0x4ae882)return;const _0x45a078=_0x4ae882[_0x198315(0x268)](/\s+/)['filter'](Boolean);if(!_0x45a078['length'])return;const _0x4b30b2=String(_0x45a078[-0x1c95+0x103d*0x1+0xc58]||'')[_0x198315(0x1d0)+'e'](),_0x291815=_0x45a078[_0x198315(0x228)](0x23a3+-0x35*0x4a+-0x1a*0xc8);if(!commands[_0x198315(0x298)](_0x4b30b2))return;if(_0x4b30b2===_0x198315(0x29a)){const _0xea5527=(_0x291815['find'](_0x2cd428=>['on',_0x198315(0x254),_0x198315(0x24a)]['includes'](String(_0x2cd428)[_0x198315(0x1d0)+'e']()))||'show')[_0x198315(0x1d0)+'e']();if(_0xea5527==='on'){const _0x1bdf86=await setChatEnabled(_0x5297ca,!![]);return _0x1bdf86?(clearChatMemory(_0x5297ca),sendText(_0x5297ca,'✔️\x20Anti-spa'+'m\x20ENABLED\x20'+_0x198315(0x1db)+_0x198315(0x2a3))):sendText(_0x5297ca,_0x198315(0x1f6)+_0x198315(0x214)+_0x198315(0x27c)+_0x198315(0x233));}else{if(_0xea5527===_0x198315(0x254)){const _0x2fa62b=await setChatEnabled(_0x5297ca,![]);return _0x2fa62b?(clearChatMemory(_0x5297ca),sendText(_0x5297ca,_0x198315(0x225)+_0x198315(0x255)+_0x198315(0x23f)+_0x198315(0x281))):sendText(_0x5297ca,_0x198315(0x1f6)+_0x198315(0x264)+_0x198315(0x28c)+_0x198315(0x20c)+'.');}else{const _0x2d4721=await getChatEnabled(_0x5297ca),_0x50c9fa={'SPAM_THRESHOLD':CFG[_0x198315(0x20a)+_0x198315(0x28f)],'SPAM_WINDOW_MS':CFG['SPAM_WINDO'+_0x198315(0x1d2)],'SPAM_COOLDOWN_MS':CFG[_0x198315(0x230)+_0x198315(0x1fd)],'MAX_WARNINGS':CFG['MAX_WARNIN'+'GS'],'KICK_ON_SPAM':CFG[_0x198315(0x2a6)+'AM']};return sendText(_0x5297ca,_0x198315(0x225)+_0x198315(0x202)+_0x198315(0x23b)+(_0x2d4721?_0x198315(0x1f7):_0x198315(0x240))+_0x198315(0x299)+JSON[_0x198315(0x29f)](_0x50c9fa));}}}if(_0x4b30b2===_0x198315(0x27b)){const _0x47c727=_0x3b790c[_0x198315(0x277)]?.['extendedTe'+_0x198315(0x258)]?.['contextInf'+'o']?.[_0x198315(0x232)+'id']||[];if(!_0x47c727||_0x47c727[_0x198315(0x26a)]===0x1*0x1e6d+0x1d01+-0x3b6e)return sendText(_0x5297ca,_0x198315(0x1e4)+'mention\x20on'+_0x198315(0x1ed)+_0x198315(0x1dd)+_0x198315(0x294)+_0x198315(0x1d3)+_0x198315(0x28e));const _0x27ee8d=chatUserMap[_0x198315(0x1e3)](_0x5297ca);for(const _0xe61f79 of _0x47c727){if(_0x27ee8d&&_0x27ee8d[_0x198315(0x201)](_0xe61f79))_0x27ee8d[_0x198315(0x217)](_0xe61f79);}return sendText(_0x5297ca,_0x198315(0x225)+_0x198315(0x259)+_0x198315(0x23d)+_0x198315(0x23e)+'\x20user(s).');}}catch(_0xabaa14){error(_0xabaa14,'['+name+(_0x198315(0x231)+_0x198315(0x273))+(_0xabaa14?.['message']||_0xabaa14));}}export async function initialize(_0x2f77cc){const _0x11fe9a=_0x324834;try{if(!_0x2f77cc)throw new Error(_0x11fe9a(0x295)+_0x11fe9a(0x238)+'requires\x20b'+_0x11fe9a(0x203)+'e');botRef=_0x2f77cc,setupSendApi(),refreshConfig(),hotReloadConfig?.(refreshConfig),await ensureTables(),startManagedListener({'botRef':botRef,'eventName':_0x11fe9a(0x221)+_0x11fe9a(0x24d),'handler':rawMessagesUpsertHandler,'moduleName':name}),info('['+name+(_0x11fe9a(0x271)+_0x11fe9a(0x213)+_0x11fe9a(0x2a4)+'cement.\x20DB'+_0x11fe9a(0x1fc)+'y\x20')+TABLE_SETTINGS+(_0x11fe9a(0x26d)+'d=')+CFG[_0x11fe9a(0x20a)+_0x11fe9a(0x28f)]+_0x11fe9a(0x1ef)+CFG[_0x11fe9a(0x287)+_0x11fe9a(0x1d2)]+('ms,\x20maxWar'+_0x11fe9a(0x1eb))+CFG[_0x11fe9a(0x208)+'GS']);}catch(_0x15a210){error(_0x15a210,'['+name+(']\x20initiali'+_0x11fe9a(0x275))+(_0x15a210?.[_0x11fe9a(0x277)]||_0x15a210));throw _0x15a210;}}export async function cleanup(){const _0x2234eb=_0x324834;try{stopManagedListener(name,'messages.u'+_0x2234eb(0x24d));}catch(_0x87440c){warn('['+name+(_0x2234eb(0x29d)+'gedListene'+_0x2234eb(0x239))+(_0x87440c?.[_0x2234eb(0x277)]||_0x87440c));}for(const _0x3a7025 of processedMessageKeys['values']())try{clearTimeout(_0x3a7025);}catch(_0x1cd438){}processedMessageKeys[_0x2234eb(0x246)](),chatUserMap[_0x2234eb(0x246)](),botRef=null,sendApi=null,info('['+name+(_0x2234eb(0x248)+_0x2234eb(0x257)));}export default{'name':name,'version':version,'priority':priority,'commands':commands,'configKeys':configKeys,'initialize':initialize,'onMessage':onMessage,'cleanup':cleanup};