const _0x35821f=_0x98ac;(function(_0x188500,_0x4050be){const _0xb446f4=_0x98ac,_0x29e416=_0x188500();while(!![]){try{const _0x5d0b31=-parseInt(_0xb446f4(0x22a))/(-0x8a3+0x2d0+0x5d4)*(-parseInt(_0xb446f4(0x1ef))/(0x132*-0x1+0x37a+0x123*-0x2))+-parseInt(_0xb446f4(0x26c))/(0x44*0x13+0x2009*-0x1+-0x900*-0x3)+-parseInt(_0xb446f4(0x226))/(-0x5f*0x13+0x458+0x1*0x2b9)+-parseInt(_0xb446f4(0x1e9))/(0x4*-0x526+0x1f92+-0xaf5)*(parseInt(_0xb446f4(0x265))/(-0x11af+-0x1dae+-0x2f63*-0x1))+parseInt(_0xb446f4(0x253))/(0x2*-0xd22+-0x2*-0xce3+0x85*0x1)+parseInt(_0xb446f4(0x219))/(0xffd*0x1+-0x2*0x959+0x2bd)*(parseInt(_0xb446f4(0x21c))/(0x1*-0xd01+0x2401+0x1*-0x16f7))+-parseInt(_0xb446f4(0x256))/(0x69*0x2+-0x1762+-0x1*-0x169a)*(-parseInt(_0xb446f4(0x266))/(-0x7a+-0x160b+0x1690));if(_0x5d0b31===_0x4050be)break;else _0x29e416['push'](_0x29e416['shift']());}catch(_0x1d3d62){_0x29e416['push'](_0x29e416['shift']());}}}(_0x43a2,-0x1a663*-0x2+-0x1a*0x64e0+0xf489a));import{info,warn,error}from'../utils/logger.js';import{db}from'../utils/database.js';import{isadmin}from'../utils/isadmin.js';import{getConfig,hotReloadConfig}from'../utils/config.js';function _0x98ac(_0x237d6a,_0x4d27f7){_0x237d6a=_0x237d6a-(-0xc4f*-0x1+-0x1*0xea2+-0x57*-0xc);const _0x56e66f=_0x43a2();let _0x1a57fd=_0x56e66f[_0x237d6a];return _0x1a57fd;}export const name='antispam';export const version=_0x35821f(0x26a);export const priority=0x2021+-0x117d+-0xe4a;export const commands=[_0x35821f(0x24e),'resetspam'];export const configKeys=[_0x35821f(0x267)];let botRef=null,sendApi=null;const chatUserMap=new Map(),processedMessageKeys=new Map(),DEDUPE_TTL_MS=(-0x126+0x100a+-0xec6)*(-0xa1f*0x2+0x49*0x25+-0x3b*-0x3b),CFG={'SPAM_THRESHOLD':0x6,'SPAM_WINDOW_MS':(-0xdc0+0xf24+0xad*-0x2)*(0x1*-0x3ab+-0x7cd*0x5+0x2e94),'SPAM_COOLDOWN_MS':0x3e8,'MAX_WARNINGS':0x3,'WARN_EXPIRY_MS':(0x14fe+-0x17*0xb+-0x13fa*0x1)*(0x39*0x8b+-0x2148+0x26d)*(0x4bb+0xd71+0x38*-0x52)*(0x2f5*-0xa+-0x1f67+-0x1467*-0x3)*(-0x55b+0x8bd+0x43*0x2),'KICK_ON_SPAM':!![],'WARNING_MESSAGE':_0x35821f(0x220)+_0x35821f(0x247)+'ing.\x20Remai'+_0x35821f(0x22d)+_0x35821f(0x233)+'ings}','WARNING_TTL_MS':0xc350};function refreshConfig(){const _0x8a253d=_0x35821f;try{const _0x34aa66=getConfig?.()?.[_0x8a253d(0x267)]||{};Object[_0x8a253d(0x210)](CFG)['forEach'](_0x40470f=>{if(_0x34aa66[_0x40470f]!==undefined)CFG[_0x40470f]=_0x34aa66[_0x40470f];}),CFG[_0x8a253d(0x1de)+_0x8a253d(0x1cf)]=Math[_0x8a253d(0x21e)](-0x198b*0x1+0x997*-0x3+0x3651,Number(CFG[_0x8a253d(0x1de)+'HOLD'])||0x12d9+-0x1f77+-0x652*-0x2),CFG[_0x8a253d(0x250)+_0x8a253d(0x236)]=Math['max'](-0x1314*0x1+-0x4*-0x2a3+-0x6*-0x16c,Number(CFG[_0x8a253d(0x250)+_0x8a253d(0x236)])||(0x861*0x1+0x1f*0x12e+-0x2ce9)*(-0x1*-0x15d+0x1*-0x1576+-0x5*-0x4cd)),CFG[_0x8a253d(0x228)+'OWN_MS']=Math[_0x8a253d(0x21e)](-0x1*-0x18f7+0x1db1+-0x36a8,Number(CFG[_0x8a253d(0x228)+_0x8a253d(0x229)])||-0x2579+0x2*0x763+0x1a9b),CFG[_0x8a253d(0x20c)+'GS']=Math['max'](0x106a+0xcfa+-0x1d63,Number(CFG[_0x8a253d(0x20c)+'GS'])||-0x4*-0x5d5+-0x1fb7*-0x1+-0x3708),CFG[_0x8a253d(0x234)+_0x8a253d(0x232)]=Math[_0x8a253d(0x21e)](-0x2686+0x12e9+0x139d*0x1,Number(CFG[_0x8a253d(0x234)+_0x8a253d(0x232)])||(-0x11f4*0x1+-0xa7*-0x1+0x1154)*(0x8d2+-0x1f5b+0x16a1*0x1)*(-0x1744+0x1796*0x1+-0x16*0x1)*(0xd26+-0x239*0xb+0x1*0xb89)*(-0x10d6+0x3*-0xfb+0x17af)),CFG[_0x8a253d(0x22b)+_0x8a253d(0x22f)]=Math[_0x8a253d(0x21e)](-0xb*0x1bc+-0x1*0xa0c+0x1d20,Number(CFG['WARNING_TT'+'L_MS'])||-0x9d5a+-0x472f+-0x54c5*-0x5),CFG[_0x8a253d(0x254)+'AM']=!!CFG[_0x8a253d(0x254)+'AM'];}catch(_0x17eae8){}}const TABLE_SETTINGS=_0x35821f(0x1c9)+'ngs';async function tableExists(_0x26786a){const _0x5c3620=_0x35821f;try{const _0xfc2ed0=await db[_0x5c3620(0x212)](_0x5c3620(0x26f)+_0x5c3620(0x248)+_0x5c3620(0x246)+_0x5c3620(0x24d)+_0x5c3620(0x1c1)+_0x5c3620(0x23d),[_0x26786a]);return!!_0xfc2ed0;}catch(_0x44b15f){return![];}}async function migrateSpamSettingsIfNeeded(){const _0x50481d=_0x35821f,_0x46f115=await tableExists(TABLE_SETTINGS);if(!_0x46f115)try{await db['exec'](_0x50481d(0x224)+'LE\x20IF\x20NOT\x20'+_0x50481d(0x241)+TABLE_SETTINGS+('\x20(chat_jid'+_0x50481d(0x238)+'ARY\x20KEY,\x20e'+'nabled\x20INT'+_0x50481d(0x23a)));return;}catch(_0x10ea35){return;}try{const _0x430e35=await db[_0x50481d(0x1f8)](_0x50481d(0x214)+_0x50481d(0x1da)+TABLE_SETTINGS+');');let _0x5df52a=[];if(Array['isArray'](_0x430e35))_0x5df52a=_0x430e35['map'](_0x27d7ea=>_0x27d7ea[_0x50481d(0x24b)]||_0x27d7ea[-0x422+0x952+-0x1*0x52f])[_0x50481d(0x1d7)](Boolean);else{if(_0x430e35&&Array[_0x50481d(0x235)](_0x430e35[_0x50481d(0x263)]))_0x5df52a=_0x430e35['rows'][_0x50481d(0x230)](_0x53af5a=>_0x53af5a[_0x50481d(0x24b)])[_0x50481d(0x1d7)](Boolean);else try{const _0x531e4d=await db[_0x50481d(0x212)](_0x50481d(0x209)+_0x50481d(0x227)+TABLE_SETTINGS+_0x50481d(0x26b));_0x5df52a=_0x531e4d?Object[_0x50481d(0x210)](_0x531e4d):[];}catch(_0x242269){_0x5df52a=[];}}const _0x36f58a=_0x5df52a[_0x50481d(0x230)](_0x32f02f=>String(_0x32f02f)[_0x50481d(0x217)+'e']()),_0x4309d0=_0x36f58a[_0x50481d(0x1cb)](_0x50481d(0x20d)),_0xb2876=_0x36f58a[_0x50481d(0x1cb)](_0x50481d(0x23b)),_0x240722=_0x36f58a[_0x50481d(0x1cb)](_0x50481d(0x1d1));if(_0x4309d0&&_0xb2876)return;if(!_0x4309d0&&_0x240722)try{await db[_0x50481d(0x1f8)](_0x50481d(0x1fd)+_0x50481d(0x1db)),await db[_0x50481d(0x1f8)](_0x50481d(0x224)+_0x50481d(0x200)+_0x50481d(0x241)+TABLE_SETTINGS+('_new\x20(chat'+_0x50481d(0x26e)+_0x50481d(0x223)+'Y,\x20enabled'+_0x50481d(0x222)));const _0x1d89eb=_0xb2876;_0x1d89eb?await db[_0x50481d(0x1f8)]('INSERT\x20OR\x20'+_0x50481d(0x1c4)+'TO\x20'+TABLE_SETTINGS+(_0x50481d(0x21f)+'_jid,\x20enab'+_0x50481d(0x25c)+'T\x20chat_id,'+_0x50481d(0x1fb)+'ROM\x20')+TABLE_SETTINGS+';'):await db[_0x50481d(0x1f8)](_0x50481d(0x23f)+_0x50481d(0x1c4)+_0x50481d(0x23c)+TABLE_SETTINGS+('_new\x20(chat'+_0x50481d(0x1d5)+_0x50481d(0x25c)+_0x50481d(0x1fe)+'\x200\x20FROM\x20')+TABLE_SETTINGS+';');await db[_0x50481d(0x1f8)]('DROP\x20TABLE'+'\x20'+TABLE_SETTINGS+';'),await db[_0x50481d(0x1f8)]('ALTER\x20TABL'+'E\x20'+TABLE_SETTINGS+(_0x50481d(0x1d4)+_0x50481d(0x1c2))+TABLE_SETTINGS+';'),await db['exec'](_0x50481d(0x1e1));return;}catch(_0x148f69){try{await db[_0x50481d(0x1f8)]('ROLLBACK;');}catch(_0x33e8c1){}return;}if(!_0x4309d0||!_0xb2876)try{await db[_0x50481d(0x1f8)](_0x50481d(0x224)+_0x50481d(0x200)+'EXISTS\x20'+TABLE_SETTINGS+(_0x50481d(0x25b)+'\x20TEXT\x20PRIM'+_0x50481d(0x1dd)+_0x50481d(0x206)+'EGER);'));}catch(_0x50fe72){}}catch(_0x335cc5){}}async function ensureTables(){await migrateSpamSettingsIfNeeded();}function setupSendApi(){const _0x269b76=_0x35821f;if(!botRef)return;if(typeof botRef[_0x269b76(0x1fc)+'e']===_0x269b76(0x1ee))sendApi=async(_0x4cf10b,_0x56a349)=>await botRef['sendMessag'+'e'](_0x4cf10b,_0x56a349);else{if(botRef[_0x269b76(0x268)]&&typeof botRef['sock']['sendMessag'+'e']===_0x269b76(0x1ee))sendApi=async(_0x5e9864,_0x283c2a)=>await botRef[_0x269b76(0x268)]['sendMessag'+'e'](_0x5e9864,_0x283c2a);else sendApi=null;}}async function sendText(_0x30b2a7,_0x4997af,_0x5e85c3=[]){const _0x4f6942=_0x35821f;if(!_0x4997af||!_0x30b2a7)return null;if(!sendApi)return null;try{const _0x160e34=typeof _0x4997af===_0x4f6942(0x23e)?{'text':_0x4997af}:_0x4997af;if(Array[_0x4f6942(0x235)](_0x5e85c3)&&_0x5e85c3['length'])_0x160e34[_0x4f6942(0x274)]=_0x5e85c3;return await sendApi(_0x30b2a7,_0x160e34);}catch(_0x167dbd){return null;}}async function deleteMessage(_0x498ed3){const _0x4f8f76=_0x35821f;if(!_0x498ed3||!_0x498ed3[_0x4f8f76(0x24f)]||!_0x498ed3['id'])return;try{await sendApi(_0x498ed3[_0x4f8f76(0x24f)],{'delete':_0x498ed3});}catch(_0x4210b6){}}function _0x43a2(){const _0x56a7ab=['delete','has','\x20user(s).','exec','ate','slice','\x20enabled\x20F','sendMessag','BEGIN\x20TRAN','T\x20chat_id,','key','LE\x20IF\x20NOT\x20','\x20VALUES\x20(?','\x20holds\x20onl','\x20reset\x20for','resetspam','or\x20repeate','nabled\x20INT','anti-spam\x20','e\x20error:\x20','SELECT\x20*\x20F','nti-spam\x20(','✔️\x20Please\x20@','MAX_WARNIN','chat_jid','cipantsUpd','\x20for\x20this\x20','keys',']\x20handleMe','get','up.','PRAGMA\x20tab','{user}','mentionedJ','toLowerCas','catch','5701568QeqMok','t_jid\x20=\x20?','ssageForSp','9EQRHbA','replace','max','_new\x20(chat','⚠️\x20{user},\x20','led:\x20','\x20INTEGER);','PRIMARY\x20KE','CREATE\x20TAB','requires\x20b','205304HkQJQx','ROM\x20','SPAM_COOLD','OWN_MS','29CfewWR','WARNING_TT','SSAGE','ning\x20warni','sAt','L_MS','map','messages','Y_MS','ngs:\x20{warn','WARN_EXPIR','isArray','W_MS','show','\x20TEXT\x20PRIM','contextInf','EGER);','enabled','TO\x20','AND\x20name=?','string','INSERT\x20OR\x20','ns=','EXISTS\x20','find','eset\x20their','am\x20error:\x20','abled\x20=\x20ex','ite_master','stop\x20spamm','e\x20FROM\x20sql','nitialize\x20','warnCount','name','roup.','\x20WHERE\x20typ','antispam','remoteJid','SPAM_WINDO','ENABLED','groupParti','167237fXcMIH','KICK_ON_SP','from','442220InwAxm','m\x20DISABLED','INSERT\x20INT','id)\x20DO\x20UPD','values','\x20(chat_jid','led)\x20SELEC','isCommand','mory\x20enfor','group.','message',',\x20enabled)','\x20\x20ON\x20CONFL','rows','ATE\x20SET\x20en','19974VbUbTe','308VqVKcH','SPAM','sock','endsWith','2.2.1','\x20LIMIT\x201','2824602JanuLH','✔️\x20Anti-spa','_jid\x20TEXT\x20','SELECT\x20nam','fromMe','unbind\x20fai','⚠️\x20Failed\x20t','remove','mentions',']\x20cleanup\x20','e=\x27table\x27\x20','E\x20TO\x20','off','REPLACE\x20IN','d\x20spam.','messages.u','warnExpire','participan','spam_setti','length','includes','trim','@g.us','\x20mentioned','HOLD','\x20group:\x20','chat_id','text','bled;','_new\x20RENAM','_jid,\x20enab','o\x20enable\x20a','filter','extendedTe','{warnings}','le_info(','SACTION;','lastWarnAt','ARY\x20KEY,\x20e','SPAM_THRES','clear','\x0aConfig:\x20','COMMIT;','\x20WHERE\x20cha',']\x20onMessag','m\x20ENABLED\x20','WARNING_ME','ot\x20instanc','set',']\x20cleaned\x20','930LeJHVa','\x20from\x20','DISABLED','split','for\x20this\x20g','function','12670MSNuEr','psert','DB\x20error).','e\x20or\x20more\x20',']\x20kicked\x20','\x20anti-spam'];_0x43a2=function(){return _0x56a7ab;};return _0x43a2();}async function kickUser(_0x355429,_0x45c561){const _0x66ca57=_0x35821f;try{const _0x265fcb=botRef[_0x66ca57(0x268)]?.[_0x66ca57(0x252)+'cipantsUpd'+_0x66ca57(0x1f9)]||botRef[_0x66ca57(0x252)+_0x66ca57(0x20e)+_0x66ca57(0x1f9)];if(_0x265fcb)return await _0x265fcb(_0x355429,[_0x45c561],_0x66ca57(0x273)),info('['+name+_0x66ca57(0x1f3)+_0x45c561+_0x66ca57(0x1ea)+_0x355429),!![];return![];}catch(_0x16e8c8){return![];}}async function getChatEnabled(_0x1965be){const _0x464d61=_0x35821f;try{const _0x381db4=await db['get']('SELECT\x20ena'+'bled\x20FROM\x20'+TABLE_SETTINGS+(_0x464d61(0x1e2)+_0x464d61(0x21a)),[_0x1965be]);return _0x381db4?Number(_0x381db4[_0x464d61(0x23b)])===-0x18c3*0x1+-0x10*-0xa+0x26a*0xa:![];}catch(_0x437ba1){return![];}}async function setChatEnabled(_0x3f87f6,_0x1f1f8e){const _0x5dd111=_0x35821f;try{return await db['run'](_0x5dd111(0x258)+'O\x20'+TABLE_SETTINGS+('\x20(chat_jid'+_0x5dd111(0x261)+_0x5dd111(0x201)+',\x20?)\x20\x0a\x20\x20\x20\x20'+_0x5dd111(0x262)+'ICT(chat_j'+_0x5dd111(0x259)+_0x5dd111(0x264)+_0x5dd111(0x245)+'cluded.ena'+_0x5dd111(0x1d3)),[_0x3f87f6,_0x1f1f8e?0x10d5*-0x2+-0xf9e*-0x1+0x1*0x120d:-0x11c6+-0xab*0x11+0x1d21]),!![];}catch(_0x42db87){return![];}}function ensureChatMap(_0x5decb1){const _0x159880=_0x35821f;if(!chatUserMap[_0x159880(0x1f6)](_0x5decb1))chatUserMap[_0x159880(0x1e7)](_0x5decb1,new Map());return chatUserMap[_0x159880(0x212)](_0x5decb1);}function clearChatMemory(_0x5065b8){const _0x2dfb33=_0x35821f;if(chatUserMap[_0x2dfb33(0x1f6)](_0x5065b8))chatUserMap[_0x2dfb33(0x1f5)](_0x5065b8);}async function handleMessageForSpam(_0x1f036b){const _0x5e415a=_0x35821f;try{const _0x510eaa=String(_0x1f036b[_0x5e415a(0x1ff)]?.[_0x5e415a(0x24f)]||'');if(!_0x510eaa||!_0x510eaa[_0x5e415a(0x269)](_0x5e415a(0x1cd)))return;if(_0x1f036b[_0x5e415a(0x1ff)]?.['fromMe'])return;const _0x2d4c8e=await getChatEnabled(_0x510eaa);if(!_0x2d4c8e)return;const _0x4f4c3b=String(_0x1f036b[_0x5e415a(0x1ff)]?.[_0x5e415a(0x1c8)+'t']||_0x1f036b[_0x5e415a(0x1ff)]?.[_0x5e415a(0x255)]||'');if(!_0x4f4c3b)return;try{if(await isadmin(botRef,{'key':{'remoteJid':_0x510eaa,'participant':_0x4f4c3b},'message':_0x1f036b[_0x5e415a(0x260)]}))return;}catch(_0x1e706c){}const _0xc3343c=Date['now'](),_0x56a137=ensureChatMap(_0x510eaa);!_0x56a137['has'](_0x4f4c3b)&&_0x56a137[_0x5e415a(0x1e7)](_0x4f4c3b,{'messages':[],'lastWarnAt':0x0,'warnCount':0x0,'warnExpiresAt':0x0});const _0x3535c2=_0x56a137['get'](_0x4f4c3b);_0x3535c2['messages']['push']({'timestamp':_0xc3343c,'key':_0x1f036b[_0x5e415a(0x1ff)]}),_0x3535c2[_0x5e415a(0x231)]=_0x3535c2[_0x5e415a(0x231)][_0x5e415a(0x1d7)](_0x1d0d92=>_0xc3343c-_0x1d0d92['timestamp']<=CFG['SPAM_WINDO'+_0x5e415a(0x236)]);if(_0x3535c2[_0x5e415a(0x1dc)]&&_0xc3343c-_0x3535c2[_0x5e415a(0x1dc)]<CFG[_0x5e415a(0x228)+_0x5e415a(0x229)])return;if(_0x3535c2[_0x5e415a(0x231)]['length']>=CFG[_0x5e415a(0x1de)+_0x5e415a(0x1cf)]){_0x3535c2['lastWarnAt']=_0xc3343c;const _0x4c56bd=_0x3535c2[_0x5e415a(0x231)][_0x5e415a(0x230)](_0x424159=>_0x424159['key']);_0x3535c2['messages']=[];(!_0x3535c2[_0x5e415a(0x1c7)+_0x5e415a(0x22e)]||_0x3535c2[_0x5e415a(0x1c7)+'sAt']<=_0xc3343c)&&(_0x3535c2[_0x5e415a(0x24a)]=0x1935+-0x3*0x172+0x27*-0x89);_0x3535c2[_0x5e415a(0x24a)]=(_0x3535c2[_0x5e415a(0x24a)]||-0xf33+0x9e5+-0x61*-0xe)+(0xc9b+-0x1d*0x128+0x72*0x2f),_0x3535c2[_0x5e415a(0x1c7)+_0x5e415a(0x22e)]=_0xc3343c+CFG['WARN_EXPIR'+'Y_MS'];const _0x1e8911=Math[_0x5e415a(0x21e)](0x60e*-0x3+-0x19c*-0x10+0x1*-0x796,CFG['MAX_WARNIN'+'GS']-_0x3535c2[_0x5e415a(0x24a)]),_0x4716a5='@'+_0x4f4c3b[_0x5e415a(0x1ec)]('@')[0x23f2+0x2135+-0x4527],_0x20ad4f=String(CFG[_0x5e415a(0x1e5)+_0x5e415a(0x22c)]||'')[_0x5e415a(0x21d)](_0x5e415a(0x215),_0x4716a5)[_0x5e415a(0x21d)](_0x5e415a(0x1d9),String(_0x1e8911));for(const _0x5ee847 of _0x4c56bd){await deleteMessage(_0x5ee847);}await new Promise(_0x25b88d=>setTimeout(_0x25b88d,0x16*0x103+0xdd*0xf+0x223b*-0x1));const _0x1876fa=await sendText(_0x510eaa,{'text':_0x20ad4f,'mentions':[_0x4f4c3b]});_0x1876fa?.[_0x5e415a(0x1ff)]&&CFG[_0x5e415a(0x22b)+_0x5e415a(0x22f)]>0x1*0xc31+0x8e1+-0x1512&&setTimeout(async()=>{try{await sendText(_0x510eaa,{'delete':_0x1876fa['key']});}catch(_0x1f5048){}},CFG[_0x5e415a(0x22b)+_0x5e415a(0x22f)]);if(CFG[_0x5e415a(0x254)+'AM']&&_0x3535c2[_0x5e415a(0x24a)]>=CFG[_0x5e415a(0x20c)+'GS']){const _0x5ea511=await kickUser(_0x510eaa,_0x4f4c3b);_0x5ea511?(_0x56a137[_0x5e415a(0x1f5)](_0x4f4c3b),await sendText(_0x510eaa,{'text':_0x4716a5+('\x20removed\x20f'+_0x5e415a(0x205)+_0x5e415a(0x1c5)),'mentions':[_0x4f4c3b]})[_0x5e415a(0x218)](()=>{})):warn('['+name+(']\x20failed\x20t'+'o\x20kick\x20')+_0x4f4c3b+_0x5e415a(0x1ea)+_0x510eaa);}}}catch(_0x451d1f){warn('['+name+(_0x5e415a(0x211)+_0x5e415a(0x21b)+_0x5e415a(0x244))+(_0x451d1f?.['message']||_0x451d1f));}}async function rawMessagesUpsertHandler({messages:_0x542b7b}){const _0x5a53c6=_0x35821f;if(!Array['isArray'](_0x542b7b))return;for(const _0x2cca10 of _0x542b7b){try{const _0x186548=String(_0x2cca10[_0x5a53c6(0x1ff)]?.['remoteJid']||'');if(!_0x186548||!_0x186548[_0x5a53c6(0x269)](_0x5a53c6(0x1cd)))continue;if(!_0x2cca10['message'])continue;if(_0x2cca10[_0x5a53c6(0x1ff)]?.[_0x5a53c6(0x270)])continue;const _0x152dbe=_0x186548+'::'+String(_0x2cca10['key']?.['id']||'')+'::'+String(_0x2cca10['key']?.[_0x5a53c6(0x1c8)+'t']||'');if(processedMessageKeys[_0x5a53c6(0x1f6)](_0x152dbe))continue;const _0x5d6325=setTimeout(()=>processedMessageKeys[_0x5a53c6(0x1f5)](_0x152dbe),DEDUPE_TTL_MS);processedMessageKeys[_0x5a53c6(0x1e7)](_0x152dbe,_0x5d6325),await handleMessageForSpam(_0x2cca10);}catch(_0x5218ba){}}}export async function onMessage(_0x545fc4,_0x3f7d01){const _0xc50c39=_0x35821f;try{if(!_0x545fc4||!_0x545fc4[_0xc50c39(0x1ff)]||!_0x545fc4['message']||!_0x545fc4[_0xc50c39(0x25d)]||!_0x3f7d01)return;const _0x32ccc3=String(_0x545fc4[_0xc50c39(0x1ff)][_0xc50c39(0x24f)]||'');if(!_0x32ccc3[_0xc50c39(0x269)]('@g.us'))return;const _0x3f20d9=await isadmin(botRef,_0x545fc4);if(!_0x3f20d9)return;const _0x1f8e54=typeof _0x545fc4[_0xc50c39(0x1d2)]===_0xc50c39(0x23e)&&_0x545fc4[_0xc50c39(0x1d2)]['trim']()[_0xc50c39(0x1ca)]?_0x545fc4[_0xc50c39(0x1d2)][_0xc50c39(0x1cc)]():'';if(!_0x1f8e54)return;const _0x1e062e=_0x1f8e54[_0xc50c39(0x1ec)](/\s+/)[_0xc50c39(0x1d7)](Boolean);if(!_0x1e062e[_0xc50c39(0x1ca)])return;const _0x389098=String(_0x1e062e[0x165d+-0x1275+-0x3e8]||'')[_0xc50c39(0x217)+'e'](),_0x298b58=_0x1e062e[_0xc50c39(0x1fa)](0x1e29+0x1af*-0x1+0xc5*-0x25);if(!commands[_0xc50c39(0x1cb)](_0x389098))return;if(_0x389098===_0xc50c39(0x24e)){const _0x54f297=(_0x298b58[_0xc50c39(0x242)](_0x14bcee=>['on','off',_0xc50c39(0x237)]['includes'](String(_0x14bcee)[_0xc50c39(0x217)+'e']()))||_0xc50c39(0x237))[_0xc50c39(0x217)+'e']();if(_0x54f297==='on'){const _0x38cdfe=await setChatEnabled(_0x32ccc3,!![]);return _0x38cdfe?(clearChatMemory(_0x32ccc3),sendText(_0x32ccc3,_0xc50c39(0x26d)+_0xc50c39(0x1e4)+_0xc50c39(0x1ed)+_0xc50c39(0x24c))):sendText(_0x32ccc3,_0xc50c39(0x272)+_0xc50c39(0x1d6)+_0xc50c39(0x20a)+_0xc50c39(0x1f1));}else{if(_0x54f297===_0xc50c39(0x1c3)){const _0x4a6db6=await setChatEnabled(_0x32ccc3,![]);return _0x4a6db6?(clearChatMemory(_0x32ccc3),sendText(_0x32ccc3,_0xc50c39(0x26d)+_0xc50c39(0x257)+_0xc50c39(0x20f)+_0xc50c39(0x25f))):sendText(_0x32ccc3,_0xc50c39(0x272)+'o\x20disable\x20'+_0xc50c39(0x207)+'(DB\x20error)'+'.');}else{const _0x40a7c6=await getChatEnabled(_0x32ccc3),_0x1fc663={'SPAM_THRESHOLD':CFG[_0xc50c39(0x1de)+'HOLD'],'SPAM_WINDOW_MS':CFG['SPAM_WINDO'+_0xc50c39(0x236)],'SPAM_COOLDOWN_MS':CFG[_0xc50c39(0x228)+'OWN_MS'],'MAX_WARNINGS':CFG['MAX_WARNIN'+'GS'],'KICK_ON_SPAM':CFG[_0xc50c39(0x254)+'AM']};return sendText(_0x32ccc3,_0xc50c39(0x26d)+'m\x20for\x20this'+_0xc50c39(0x1d0)+(_0x40a7c6?_0xc50c39(0x251):_0xc50c39(0x1eb))+_0xc50c39(0x1e0)+JSON['stringify'](_0x1fc663));}}}if(_0x389098===_0xc50c39(0x204)){const _0xdac634=_0x545fc4[_0xc50c39(0x260)]?.[_0xc50c39(0x1d8)+'xtMessage']?.[_0xc50c39(0x239)+'o']?.[_0xc50c39(0x216)+'id']||[];if(!_0xdac634||_0xdac634[_0xc50c39(0x1ca)]===-0x250b+0xf27*-0x1+0x3*0x1166)return sendText(_0x32ccc3,_0xc50c39(0x20b)+'mention\x20on'+_0xc50c39(0x1f2)+'users\x20to\x20r'+_0xc50c39(0x243)+_0xc50c39(0x1f4)+'\x20warnings.');const _0x269155=chatUserMap['get'](_0x32ccc3);for(const _0x584e8d of _0xdac634){if(_0x269155&&_0x269155[_0xc50c39(0x1f6)](_0x584e8d))_0x269155[_0xc50c39(0x1f5)](_0x584e8d);}return sendText(_0x32ccc3,_0xc50c39(0x26d)+'m\x20warnings'+_0xc50c39(0x203)+_0xc50c39(0x1ce)+_0xc50c39(0x1f7));}}catch(_0x14e37e){error(_0x14e37e,'['+name+(_0xc50c39(0x1e3)+_0xc50c39(0x208))+(_0x14e37e?.[_0xc50c39(0x260)]||_0x14e37e));}}export async function initialize(_0x229fa9){const _0x291689=_0x35821f;try{if(!_0x229fa9)throw new Error('antispam.i'+_0x291689(0x249)+_0x291689(0x225)+_0x291689(0x1e6)+'e');botRef=_0x229fa9,setupSendApi(),refreshConfig(),hotReloadConfig?.(refreshConfig),await ensureTables(),_0x229fa9['on']('messages.u'+'psert',rawMessagesUpsertHandler),info('['+name+(']\x20initiali'+'zed.\x20In-me'+_0x291689(0x25e)+'cement.\x20DB'+_0x291689(0x202)+'y\x20')+TABLE_SETTINGS+('.\x20Threshol'+'d=')+CFG['SPAM_THRES'+_0x291689(0x1cf)]+'\x20within\x20'+CFG[_0x291689(0x250)+_0x291689(0x236)]+('ms,\x20maxWar'+_0x291689(0x240))+CFG['MAX_WARNIN'+'GS']);}catch(_0x3d20cb){throw _0x3d20cb;}}export async function cleanup(){const _0x28d74b=_0x35821f;try{botRef&&typeof botRef[_0x28d74b(0x1c3)]==='function'&&botRef[_0x28d74b(0x1c3)](_0x28d74b(0x1c6)+_0x28d74b(0x1f0),rawMessagesUpsertHandler);}catch(_0x24f0df){warn('['+name+(_0x28d74b(0x275)+_0x28d74b(0x271)+_0x28d74b(0x221))+(_0x24f0df?.[_0x28d74b(0x260)]||_0x24f0df));}for(const _0x37aeed of processedMessageKeys[_0x28d74b(0x25a)]())try{clearTimeout(_0x37aeed);}catch(_0x1ceafa){}processedMessageKeys['clear'](),chatUserMap[_0x28d74b(0x1df)](),botRef=null,sendApi=null,info('['+name+(_0x28d74b(0x1e8)+_0x28d74b(0x213)));}export default{'name':name,'version':version,'priority':priority,'commands':commands,'configKeys':configKeys,'initialize':initialize,'onMessage':onMessage,'cleanup':cleanup};