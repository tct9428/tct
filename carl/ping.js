const _0x4203e0=_0x326b;(function(_0x338564,_0x3ea467){const _0x3aa1e4=_0x326b,_0x506d38=_0x338564();while(!![]){try{const _0x38c3d5=parseInt(_0x3aa1e4(0x1c9))/(0x1a*0x14f+-0x216d+-0x4c*0x2)+parseInt(_0x3aa1e4(0x1fe))/(0x10e7*-0x2+0x23fd+-0x22d)*(-parseInt(_0x3aa1e4(0x1fb))/(0x1949*-0x1+0x1dd4+0x1*-0x488))+-parseInt(_0x3aa1e4(0x1c4))/(0x1446+-0x173e+0x2fc*0x1)*(-parseInt(_0x3aa1e4(0x1b4))/(-0x3*-0x6ba+-0x49*0x4+-0x1305))+parseInt(_0x3aa1e4(0x1c2))/(-0x7d5*0x2+-0x1*0x110f+0x20bf)*(-parseInt(_0x3aa1e4(0x217))/(0x784+0x5f*-0x53+-0x2*-0xba8))+parseInt(_0x3aa1e4(0x20f))/(-0x59*-0x6d+0x186c+-0x1*0x3e49)*(parseInt(_0x3aa1e4(0x21c))/(0x1c7f+0x20fd*-0x1+0x487))+-parseInt(_0x3aa1e4(0x1cf))/(0x333*0x2+0x8b*-0x1f+0xa79)+parseInt(_0x3aa1e4(0x1e7))/(-0x1*0x1439+-0x4a2*-0x4+0x1bc)*(parseInt(_0x3aa1e4(0x1dd))/(0x473+-0x1cd4+-0x25*-0xa9));if(_0x38c3d5===_0x3ea467)break;else _0x506d38['push'](_0x506d38['shift']());}catch(_0x494e0b){_0x506d38['push'](_0x506d38['shift']());}}}(_0x38db,-0xd4207+0x1*-0xb8149+0x216d9d));import{performance}from'perf_hooks';import{DateTime}from'luxon';import{info,warn,error}from'../utils/logger.js';import{getConfig,hotReloadConfig}from'../utils/config.js';import{isSudo,listSudo,normalizeToJid,userJidFromCtx}from'../utils/sudo.js';import{getBotJid}from'../utils/bot-state.js';export const name='ping';export const version='1.3.6-fixe'+'d';export const priority=0xd37*-0x2+0x22bb*-0x1+0x3d33;let botInstance=null;const lastPingAt=new Map(),PING_COOLDOWN_MS=0x14a2+-0x2531*0x1+0x13*0x17d,PING_HISTORY_MAX=0x22c9*-0x1+-0x58d*0x7+0xce*0x5c,pingHistory=[];let respondedMsgIds=new Set(),DEFAULT_TIMEZONE='Africa/Nai'+'robi';function refreshConfig(){const _0x5dfa10=_0x326b;try{const _0x980a80=typeof getConfig===_0x5dfa10(0x1e6)?getConfig()||{}:{};DEFAULT_TIMEZONE=_0x980a80['TIMEZONE']||_0x980a80[_0x5dfa10(0x1b9)+_0x5dfa10(0x1af)]||DEFAULT_TIMEZONE,info(name+(_0x5dfa10(0x203)+_0x5dfa10(0x1eb))+DEFAULT_TIMEZONE);}catch(_0x46864f){warn(name+(':\x20refreshC'+'onfig\x20erro'+_0x5dfa10(0x21b))+(_0x46864f?.[_0x5dfa10(0x1c7)]||_0x46864f));}}try{typeof hotReloadConfig===_0x4203e0(0x1e6)&&hotReloadConfig(()=>{const _0x3fbcb2=_0x4203e0;try{refreshConfig();}catch(_0x1e5c15){warn(name+(':\x20hotReloa'+_0x3fbcb2(0x1d7)+_0x3fbcb2(0x1f5)+'r:\x20')+(_0x1e5c15?.[_0x3fbcb2(0x1c7)]||_0x1e5c15));}});}catch(_0x1b588b){warn(name+(_0x4203e0(0x212)+'dConfig\x20re'+'gistration'+_0x4203e0(0x229))+(_0x1b588b?.['message']||_0x1b588b));}refreshConfig();function pushHistory(_0xb9369e){const _0x1141ba=_0x4203e0;pingHistory[_0x1141ba(0x1f9)](_0xb9369e);if(pingHistory[_0x1141ba(0x1ee)]>PING_HISTORY_MAX)pingHistory['shift']();}function formatTimestamp(_0x3b458e=Date[_0x4203e0(0x220)](),_0x4345bb=DEFAULT_TIMEZONE){const _0x2e3d0c=_0x4203e0;try{const _0xc36c4f=DateTime[_0x2e3d0c(0x1bb)](_0x3b458e)[_0x2e3d0c(0x1c0)](_0x4345bb);if(!_0xc36c4f['isValid'])return new Date(_0x3b458e)[_0x2e3d0c(0x1d9)+_0x2e3d0c(0x1f1)]();return _0xc36c4f['toLocaleSt'+_0x2e3d0c(0x1f1)](DateTime['DATETIME_M'+_0x2e3d0c(0x1be)+'CONDS'])+'\x20('+_0xc36c4f[_0x2e3d0c(0x1d1)]+')';}catch(_0x4652b3){return new Date(_0x3b458e)[_0x2e3d0c(0x1d9)+_0x2e3d0c(0x1f1)]();}}function _0x326b(_0x542895,_0x35c0e5){const _0x2ca8db=_0x38db();return _0x326b=function(_0xf6e02a,_0x54ce46){_0xf6e02a=_0xf6e02a-(0x1*0xdaa+0x39*0x35+-0x17cb);let _0x5287a5=_0x2ca8db[_0xf6e02a];return _0x5287a5;},_0x326b(_0x542895,_0x35c0e5);}function buildBox(_0x14ccff,_0x10cc1f,_0x428ef0=null){const _0x6cda43=_0x4203e0;if(!_0x428ef0)_0x428ef0=formatTimestamp(Date[_0x6cda43(0x220)](),DEFAULT_TIMEZONE);return'╭─❏\x20pong\x20❏'+'═══⊷\x0a│\x20⏱\x20P'+_0x6cda43(0x1f3)+_0x14ccff+_0x6cda43(0x1ac)+_0x10cc1f+_0x6cda43(0x1ca)+_0x428ef0+(_0x6cda43(0x1ec)+_0x6cda43(0x21e));}export async function initialize(_0x83cc22){const _0x4a2f0b=_0x4203e0;try{botInstance=_0x83cc22,refreshConfig(),info(name+(_0x4a2f0b(0x1f2)+_0x4a2f0b(0x230)));}catch(_0x3bcb22){warn(name+('\x20initializ'+_0x4a2f0b(0x1fc))+(_0x3bcb22?.[_0x4a2f0b(0x1c7)]||_0x3bcb22));}}async function findStoredMatchFromFindings(_0x5c3642=[]){const _0x1a5567=_0x4203e0;try{if(!Array[_0x1a5567(0x228)](_0x5c3642)||_0x5c3642['length']===0x1*-0xb03+0x97*-0x21+0xf3d*0x2)return null;const _0x1d85fe=await listSudo();if(!Array[_0x1a5567(0x228)](_0x1d85fe)||_0x1d85fe[_0x1a5567(0x1ee)]===-0x180e+0xe60+0x162*0x7)return null;const _0x2fb38c=new Set(_0x1d85fe[_0x1a5567(0x1b7)](_0x5e1855=>String(_0x5e1855)));for(const _0x400689 of _0x5c3642){if(!_0x400689||!_0x400689[_0x1a5567(0x205)]||typeof _0x400689[_0x1a5567(0x205)]!==_0x1a5567(0x1bd))continue;try{const _0x1bfd3d=normalizeToJid(_0x400689[_0x1a5567(0x205)]);if(_0x1bfd3d&&_0x2fb38c[_0x1a5567(0x1cc)](_0x1bfd3d))return _0x1bfd3d;const _0x58a2ed=(String(_0x400689[_0x1a5567(0x205)])[_0x1a5567(0x1ae)]('@')[-0x1e8e*0x1+-0x1*-0x493+-0x19fb*-0x1]||'')['split'](':')[-0x1*0x139d+-0x7*0x296+-0x25b7*-0x1]||null;if(_0x58a2ed)for(const _0x28b758 of _0x2fb38c){const _0x4e3441=String(_0x28b758)[_0x1a5567(0x1ae)]('@')[-0x1cc0+0xb24+0x467*0x4]||null;if(_0x4e3441&&_0x58a2ed===_0x4e3441)return _0x28b758;}if(_0x2fb38c[_0x1a5567(0x1cc)](_0x400689['jid']))return _0x400689[_0x1a5567(0x205)];}catch(_0x4e51e4){}}return null;}catch(_0x4be81e){return warn(name+(':\x20findStor'+_0x1a5567(0x231)+_0x1a5567(0x1fa)+_0x1a5567(0x1e2))+(_0x4be81e?.[_0x1a5567(0x1c7)]||_0x4be81e)),null;}}export async function onMessage(_0x11562b){const _0x23a01d=_0x4203e0;try{if(!_0x11562b||!_0x11562b[_0x23a01d(0x208)])return;const _0x52310b=_0x11562b[_0x23a01d(0x208)]?.['id'];if(_0x52310b){if(respondedMsgIds[_0x23a01d(0x1cc)](_0x52310b))return;respondedMsgIds['add'](_0x52310b),setTimeout(()=>{respondedMsgIds['delete'](_0x52310b);},-0x84f4*-0x1+-0x3b15+0xa081);}const _0x469139=_0x11562b['remoteJid']||_0x11562b['key']?.[_0x23a01d(0x21a)]||'unknown';if(_0x469139===_0x23a01d(0x1ce)){warn(name+(_0x23a01d(0x1df)+'t\x20determin'+_0x23a01d(0x1c8)+'skipping.'));return;}if(!_0x11562b['isCommand'])return;const _0x3660bd=(_0x11562b[_0x23a01d(0x222)]||'')[_0x23a01d(0x213)]();if(!_0x3660bd)return;const _0x20f36b=_0x3660bd[_0x23a01d(0x214)+'e'](),_0x4661e5=_0x20f36b===_0x23a01d(0x1b0)+'ry'||_0x20f36b===_0x23a01d(0x1fd),_0x474ca9=_0x20f36b==='ping'||_0x20f36b[_0x23a01d(0x21d)](_0x23a01d(0x1bc));if(!_0x4661e5&&!_0x474ca9)return;!botInstance&&(botInstance=_0x11562b[_0x23a01d(0x1ef)]||_0x11562b[_0x23a01d(0x22b)]||_0x11562b[_0x23a01d(0x1f7)]||null,!botInstance&&warn(name+(_0x23a01d(0x1dc)+_0x23a01d(0x1d3)+_0x23a01d(0x201)+_0x23a01d(0x1b3)+_0x23a01d(0x206)+_0x23a01d(0x1c5)+'do\x20checks\x20'+_0x23a01d(0x1e5)+_0x23a01d(0x1de))));const _0x35c148=Boolean(_0x11562b['key'][_0x23a01d(0x1d2)]);let _0x108f32=![];try{_0x108f32=Boolean(await isSudo(botInstance,_0x11562b));}catch(_0x342fd1){warn(name+(_0x23a01d(0x1c3)+_0x23a01d(0x204)+':\x20')+(_0x342fd1?.[_0x23a01d(0x1c7)]||_0x342fd1)),_0x108f32=![];}if(!_0x35c148&&!_0x108f32)return;const _0x31d179=String(_0x469139)[_0x23a01d(0x1ba)](_0x23a01d(0x1f6)),_0x2295aa=getBotJid();if(_0x4661e5){const _0x5084a7=_0x31d179?_0x469139:_0x2295aa||_0x469139;if(pingHistory[_0x23a01d(0x1ee)]===-0x11a+0x1d8d+0x1c73*-0x1){if(botInstance)await botInstance['sendMessag'+'e'](_0x5084a7,{'text':_0x23a01d(0x227)+_0x23a01d(0x1f0)});return;}const _0x53c102=pingHistory['slice']()[_0x23a01d(0x209)]()[_0x23a01d(0x1f8)](0x1*-0xe75+-0x7e*-0x33+0x5*-0x221,-0x25f6*-0x1+-0xe*-0x184+-0x3b1a)[_0x23a01d(0x1b7)]((_0x34369c,_0x539727)=>{const _0x38a7c6=_0x23a01d,_0x173522=formatTimestamp(_0x34369c['ts'],DEFAULT_TIMEZONE),_0x49ea93=typeof _0x34369c[_0x38a7c6(0x20e)+_0x38a7c6(0x226)]===_0x38a7c6(0x1d5)?_0x34369c[_0x38a7c6(0x20e)+_0x38a7c6(0x226)][_0x38a7c6(0x1d8)](0x8d7+-0x1fed*0x1+0x1718)+'ms':_0x38a7c6(0x1e0),_0x21e8eb=typeof _0x34369c['networkLat'+_0x38a7c6(0x226)]===_0x38a7c6(0x1d5)?_0x34369c[_0x38a7c6(0x1e4)+_0x38a7c6(0x226)][_0x38a7c6(0x1d8)](-0x1d8a+-0x17c5+0x3551*0x1)+'ms':_0x38a7c6(0x1e0);return _0x539727+(0xda6*0x2+0xfdd*0x1+-0x2*0x1594)+'.\x20'+_0x173522+'\x20—\x20Proc:\x20'+_0x49ea93+_0x38a7c6(0x1ac)+_0x21e8eb+_0x38a7c6(0x1bf)+_0x34369c[_0x38a7c6(0x1ad)]+')';})[_0x23a01d(0x219)]('\x0a');if(botInstance)await botInstance['sendMessag'+'e'](_0x5084a7,{'text':_0x23a01d(0x21f)+Math['min'](0xa34*-0x1+0x5*0x10f+-0x1*-0x4fd,pingHistory[_0x23a01d(0x1ee)])+'\x20pings:\x0a'+_0x53c102});return;}if(!_0x474ca9)return;const _0x4cbc9c=lastPingAt[_0x23a01d(0x22d)](_0x469139)||-0x898*-0x4+0x2048+-0x42a8,_0x3a226d=Date[_0x23a01d(0x220)]();if(_0x3a226d-_0x4cbc9c<PING_COOLDOWN_MS)return;lastPingAt[_0x23a01d(0x1f4)](_0x469139,_0x3a226d),setTimeout(()=>lastPingAt[_0x23a01d(0x216)](_0x469139),PING_COOLDOWN_MS+(-0x2131+0x175e+0xa37));let _0x3cc01c=null;if(_0x31d179)_0x3cc01c=_0x469139;else{if(_0x35c148)_0x3cc01c=_0x2295aa||_0x469139;else{if(_0x108f32){const _0xeb8a77=userJidFromCtx(_0x11562b),_0x37f06e=await findStoredMatchFromFindings(_0xeb8a77[_0x23a01d(0x22f)]);if(!_0x37f06e)return;_0x3cc01c=_0x37f06e;}else return;}}if(!_0x3cc01c){warn(name+(_0x23a01d(0x1b6)+_0x23a01d(0x1e1)+_0x23a01d(0x1d6)+_0x23a01d(0x207)+_0x23a01d(0x221)));return;}const _0x391564=String(_0x3cc01c);try{_0x3cc01c=String(_0x3cc01c);}catch(_0x3d8868){warn(name+(_0x23a01d(0x20a)+'finalDest\x20'+_0x23a01d(0x215)+_0x23a01d(0x1ff)));return;}const _0x87d471=performance[_0x23a01d(0x220)](),_0x3ecaa1=formatTimestamp(Date['now'](),DEFAULT_TIMEZONE),_0xc9b34d=buildBox('tmp',_0x23a01d(0x1e8),_0x3ecaa1),_0x509aa7=performance[_0x23a01d(0x220)](),_0x1432b5=Number((_0x509aa7-_0x87d471)[_0x23a01d(0x1d8)](-0x1*0x797+-0xb*-0x44+0x4ad*0x1));let _0x413c73=null;try{const _0x76bbb=_0x23a01d(0x1b2)+_0x23a01d(0x20d)+_0x23a01d(0x1d0),_0x42027a=performance[_0x23a01d(0x220)](),_0x2f93c6=await botInstance['sendMessag'+'e'](_0x3cc01c,{'text':_0x76bbb}),_0xd50840=performance[_0x23a01d(0x220)]();_0x413c73=Number((_0xd50840-_0x42027a)[_0x23a01d(0x1d8)](0x1ed6+0x1f5e+-0x3e32));const _0x300bcb=_0x2f93c6?.[_0x23a01d(0x208)]?.['id']||_0x2f93c6?.['id'];_0x300bcb&&(respondedMsgIds[_0x23a01d(0x20c)](_0x300bcb),setTimeout(()=>respondedMsgIds[_0x23a01d(0x216)](_0x300bcb),0x24b*0x4b+0x6530+-0x26c9*0x1));}catch(_0x174ec5){warn(name+(_0x23a01d(0x1ed)+'latency\x20me'+_0x23a01d(0x225)+_0x23a01d(0x22c))+_0x3cc01c+':\x20'+(_0x174ec5?.[_0x23a01d(0x1c7)]||_0x174ec5)),_0x413c73=null;}const _0x3cdde2=_0x1432b5[_0x23a01d(0x1d8)](-0x1*-0x1aab+0x878*0x4+-0x3c89)+'ms',_0x341695=typeof _0x413c73===_0x23a01d(0x1d5)?_0x413c73[_0x23a01d(0x1d8)](0x1100+-0x502+-0xbfc)+'ms':_0x23a01d(0x1e0),_0x11c572=buildBox(_0x3cdde2,_0x341695,_0x3ecaa1);try{const _0x2e9818=await botInstance[_0x23a01d(0x232)+'e'](_0x3cc01c,{'text':_0x11c572}),_0x2553be=_0x2e9818?.[_0x23a01d(0x208)]?.['id']||_0x2e9818?.['id'];_0x2553be&&(respondedMsgIds[_0x23a01d(0x20c)](_0x2553be),setTimeout(()=>respondedMsgIds['delete'](_0x2553be),(-0x1ce0+0x1*-0xa7b+0xd20*0x3)*(-0x5d*-0x2da+-0x1*-0x95f+-0x1*0x2831))),info(name+(_0x23a01d(0x1e3)+_0x23a01d(0x211))+_0x3cc01c+'\x20(proc='+_0x3cdde2+_0x23a01d(0x202)+_0x341695+',\x20origin='+_0x469139+')'),pushHistory({'ts':Date['now'](),'chat':_0x469139,'processLatency':_0x1432b5,'networkLatency':_0x413c73});}catch(_0x2d3764){error(_0x2d3764,name+(_0x23a01d(0x1db)+_0x23a01d(0x1da)+_0x23a01d(0x211))+_0x3cc01c);if(_0x3cc01c!==_0x469139)try{warn(name+(_0x23a01d(0x1b5)+_0x23a01d(0x1b8)+_0x23a01d(0x1ea)+_0x23a01d(0x22e)+_0x23a01d(0x1cb))+_0x469139+(_0x23a01d(0x20b)+_0x23a01d(0x1e9)));const _0x63e6b5=await botInstance['sendMessag'+'e'](_0x469139,{'text':_0x11c572}),_0x5ba4a8=_0x63e6b5?.[_0x23a01d(0x208)]?.['id']||_0x63e6b5?.['id'];if(_0x5ba4a8)respondedMsgIds[_0x23a01d(0x20c)](_0x5ba4a8);pushHistory({'ts':Date[_0x23a01d(0x220)](),'chat':_0x469139,'processLatency':_0x1432b5,'networkLatency':_0x413c73});}catch(_0x5ad0c7){error(_0x5ad0c7,name+(':\x20fallback'+_0x23a01d(0x1c1)+_0x23a01d(0x1b1)+_0x23a01d(0x22a))+_0x469139);}}if(respondedMsgIds[_0x23a01d(0x218)]>0x22a6+-0x5*0x289+-0x7d*0x5){const _0x2164e7=Array[_0x23a01d(0x210)](respondedMsgIds),_0x1c4721=new Set(_0x2164e7[_0x23a01d(0x1f8)](-(0xbf*0x2+0x14d4+-0xa9a)));respondedMsgIds=_0x1c4721;}}catch(_0x2e196d){error(_0x2e196d,name+(_0x23a01d(0x224)+_0x23a01d(0x200)));}}function _0x38db(){const _0x31e6bd=['Last\x20','now','\x20send.','text','rror:\x20','\x20handler\x20e','asurement\x20','ency','No\x20ping\x20hi','isArray','\x20failed:\x20','or\x20origin\x20','client','failed\x20to\x20','get','\x20origin\x20ch','findings','zed.','edMatchFro','sendMessag','\x20•\x20Net:\x20','chat','split','AME','ping\x20histo','o\x20failed\x20f','Measuring\x20','\x20attemptin','3183095aHiiLt',':\x20retrying',':\x20final\x20de','map','\x20to\x20send\x20p','TIMEZONE_N','endsWith','fromMillis','ping\x20','string','ED_WITH_SE','\x20(origin:\x20','setZone','\x20retry\x20als','2601204ORJjmY',':\x20isSudo\x20c','4PTqozg','nue\x20but\x20su','clear','message','e\x20chatId;\x20','474282yWOzZS','\x0a│\x20','at\x20','has','\x20cleanup\x20e','unknown','125460QsHOOx','tency...','zoneName','fromMe','nce\x20not\x20in','\x20cleaned\x20u','number','unresolved','dConfig\x20ha','toFixed','toLocaleSt','o\x20send\x20pin',':\x20failed\x20t',':\x20botInsta','6339336wvonbI','ited.',':\x20could\x20no','N/A','stination\x20','error:\x20',':\x20sent\x20pin','networkLat','may\x20be\x20lim','function','11VLOODk','tmp','back.','ing\x20box\x20to','\x20set\x20to\x20','\x0a╰════════',':\x20network\x20','length','bot','story\x20yet.','ring',':\x20initiali','roc:\x20','set','ndler\x20erro','@g.us','_bot','slice','push','mFindings\x20','3oipJZW','e\x20error:\x20','ping\x20stats','698122ukweBq','ping\x20send.','rror','itialized;',',\x20net=',':\x20timezone','heck\x20threw','jid','g\x20to\x20conti',';\x20skipping','key','reverse',':\x20invalid\x20','\x20as\x20a\x20fall','add','network\x20la','processLat','179864ZOimjf','from','g\x20box\x20to\x20',':\x20hotReloa','trim','toLowerCas','type;\x20skip','delete','14CKSEgS','size','join','remoteJid','r:\x20','63dnfQZG','startsWith','══⊷'];_0x38db=function(){return _0x31e6bd;};return _0x38db();}export async function cleanup(){const _0x565644=_0x4203e0;try{botInstance=null,lastPingAt[_0x565644(0x1c6)](),pingHistory[_0x565644(0x1ee)]=0x6*-0x4eb+0x6*-0x155+0x2580*0x1,respondedMsgIds['clear']&&respondedMsgIds['clear'](),info(name+(_0x565644(0x1d4)+'p'));}catch(_0x22b31f){warn(name+(_0x565644(0x1cd)+_0x565644(0x223))+(_0x22b31f?.[_0x565644(0x1c7)]||_0x22b31f));}}