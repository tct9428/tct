const _0x22877a=_0x1898;(function(_0x1da4ad,_0x187622){const _0x482d72=_0x1898,_0x2588dc=_0x1da4ad();while(!![]){try{const _0x180cc2=parseInt(_0x482d72(0x251))/(-0x1670+-0x146f*-0x1+0x202)+-parseInt(_0x482d72(0x219))/(-0x19b6+0x3a4*-0x8+-0x208*-0x1b)+parseInt(_0x482d72(0x26d))/(0x9ba+0x1*-0x799+-0x10f*0x2)+-parseInt(_0x482d72(0x296))/(0x401+0x1322*0x1+-0x171f)*(parseInt(_0x482d72(0x272))/(0x25f3+-0x1ea1+-0x74d))+-parseInt(_0x482d72(0x236))/(-0x2646+-0x18fd+0x3f49)*(parseInt(_0x482d72(0x22e))/(0x201d+0x13ed+0x3403*-0x1))+parseInt(_0x482d72(0x207))/(-0x2700+0xd0*-0x1+0x4b*0x88)*(-parseInt(_0x482d72(0x216))/(0x1b51+0x7*-0xd+-0x1aed))+parseInt(_0x482d72(0x1e7))/(-0x1*0x5fc+-0x3d6+-0x277*-0x4)*(parseInt(_0x482d72(0x237))/(0xd56+0xfb*0x10+-0x9a9*0x3));if(_0x180cc2===_0x187622)break;else _0x2588dc['push'](_0x2588dc['shift']());}catch(_0x256df2){_0x2588dc['push'](_0x2588dc['shift']());}}}(_0x4502,0x12ad3+0x4d03c+0x378fd*-0x1));import{info,warn,error}from'../utils/logger.js';import{db}from'../utils/database.js';import{getConfig}from'../utils/config.js';import{isadmin}from'../utils/isadmin.js';import{getDefault,getConnection}from'../utils/connection.js';import*as _0x4fb2ae from'../utils/groups.js';import{isSudo,userJidFromCtx,listSudo,normalizeToJid}from'../utils/sudo.js';import{getBotJid}from'../utils/bot-state.js';import _0x4e9b02 from'linkify-it';import{createRequire}from'module';const require=createRequire(import.meta[_0x22877a(0x201)]),tlds=require('tlds');export const name=_0x22877a(0x284);export const version='3.6.4';export const priority=-0x16f3+-0x759+0x1eb0*0x1;export const commands=['antilink',_0x22877a(0x275)];function _0x1898(_0x51ccd0,_0x10151b){const _0x4e0c95=_0x4502();return _0x1898=function(_0x13ae38,_0x26b7f5){_0x13ae38=_0x13ae38-(-0x1*0x187d+-0x2*-0x11f6+-0x9a4);let _0x15f354=_0x4e0c95[_0x13ae38];return _0x15f354;},_0x1898(_0x51ccd0,_0x10151b);}const TABLE_SETTINGS=_0x22877a(0x1f1)+_0x22877a(0x24c);let botRef=null,shuttingDown=![],config={};const linkify=_0x4e9b02();linkify[_0x22877a(0x1cf)](tlds);const processedMessageIds=new Map(),perUserWarnings=new Map();function refreshConfig(){const _0x301f2a=_0x22877a,_0x4b4c21=getConfig()||{};config={'MAX_WARNS':0x3,'REMOVE_ON_MAX':!![],'SEND_WARNING':!![],'WARNING_MESSAGE':_0x301f2a(0x206)+_0x301f2a(0x299)+_0x301f2a(0x232)+'d\x20here.\x20Re'+_0x301f2a(0x298)+_0x301f2a(0x20a)+'rnings}','VALIDATION_TIMEOUT_MS':0xfa0,'LOG_DELETED_LINKS':!![],'GLOBAL_CONCURRENCY':0x2,'DELETE_RETRY_COUNT':0x2,'DEDUPE_TTL_MS':0x1388,..._0x4b4c21[_0x301f2a(0x1e8)]||{}};}function setupApi(_0x3cfd11){botRef=_0x3cfd11;}async function ensureSchema(){const _0xf1afd2=_0x22877a;try{await db['exec'](_0xf1afd2(0x25d)+_0xf1afd2(0x1ed)+'TABLE\x20IF\x20N'+_0xf1afd2(0x222)+TABLE_SETTINGS+('\x20(\x0a\x20\x20\x20\x20\x20\x20\x20'+_0xf1afd2(0x288)+_0xf1afd2(0x1fd)+_0xf1afd2(0x1fe)+_0xf1afd2(0x269)+_0xf1afd2(0x244)+_0xf1afd2(0x255)+_0xf1afd2(0x1eb)+_0xf1afd2(0x25e)+_0xf1afd2(0x244)+_0xf1afd2(0x1fa)+_0xf1afd2(0x286)+_0xf1afd2(0x1e5)+_0xf1afd2(0x294)+_0xf1afd2(0x247)+_0xf1afd2(0x287))),info('[antilink]'+_0xf1afd2(0x274)+_0xf1afd2(0x23c)+_0xf1afd2(0x229));}catch(_0x99fdf3){error(_0x99fdf3,'[antilink]'+_0xf1afd2(0x265)+_0xf1afd2(0x234)+_0xf1afd2(0x28f));throw _0x99fdf3;}}async function getGroupSetting(_0x51a003){const _0x24bc32=_0x22877a;try{const _0xf80c08=await db[_0x24bc32(0x205)]('SELECT\x20ena'+_0x24bc32(0x1f2)+'elist\x20FROM'+'\x20'+TABLE_SETTINGS+('\x20WHERE\x20cha'+'t_jid\x20=\x20?'),[_0x51a003]);return{'enabled':!!_0xf80c08?.[_0x24bc32(0x280)],'whitelist':_0xf80c08?JSON[_0x24bc32(0x27b)](_0xf80c08[_0x24bc32(0x259)]||'[]'):[]};}catch(_0x3f76e5){return warn(_0x24bc32(0x235)+_0x24bc32(0x26b)+_0x24bc32(0x213)+_0x24bc32(0x249)+_0x51a003+':\x20'+(_0x3f76e5?.[_0x24bc32(0x25f)]||_0x3f76e5)),{'enabled':![],'whitelist':[]};}}async function setGroupEnabled(_0x26f000,_0x5dfd8d){const _0x5b3425=_0x22877a;try{return await db[_0x5b3425(0x1de)](_0x5b3425(0x233)+'O\x20'+TABLE_SETTINGS+(_0x5b3425(0x290)+',\x20enabled)'+'\x20VALUES\x20(?'+_0x5b3425(0x239)+_0x5b3425(0x27f)+'\x20CONFLICT('+'chat_jid)\x20'+'DO\x20UPDATE\x20'+'SET\x20enable'+_0x5b3425(0x1fb)+_0x5b3425(0x28e)+';'),[_0x26f000,_0x5dfd8d?-0x209e+0xb6f+0x1530:0x127*0x5+0x1baf+-0x2172]),!![];}catch(_0x19ef68){return error(_0x19ef68,'[antilink]'+_0x5b3425(0x21c)+_0x5b3425(0x256)+_0x5b3425(0x267)+_0x26f000),![];}}async function setGroupWhitelist(_0x1f45d8,_0x47b023){const _0x145e80=_0x22877a;try{const _0x588940=Array['from'](new Set((_0x47b023||[])['map'](String)[_0x145e80(0x1d9)](Boolean)));return await db[_0x145e80(0x1de)](_0x145e80(0x233)+'O\x20'+TABLE_SETTINGS+(_0x145e80(0x290)+_0x145e80(0x200)+_0x145e80(0x1e0)+_0x145e80(0x1fc)+_0x145e80(0x244)+'ON\x20CONFLIC'+_0x145e80(0x228)+')\x20DO\x20UPDAT'+_0x145e80(0x1f4)+_0x145e80(0x1f5)+_0x145e80(0x1ea)+'telist;'),[_0x1f45d8,JSON[_0x145e80(0x20f)](_0x588940)]),!![];}catch(_0x1d11e6){return error(_0x1d11e6,'[antilink]'+_0x145e80(0x212)+_0x145e80(0x22b)+'ailed\x20for\x20'+_0x1f45d8),![];}}function extractTextFromMessage(_0x2395a7){const _0x18751e=_0x22877a;if(!_0x2395a7||!_0x2395a7[_0x18751e(0x25f)])return'';const _0x95739d=_0x2395a7['message'];return _0x95739d[_0x18751e(0x22c)+'on']||_0x95739d[_0x18751e(0x21e)+_0x18751e(0x223)]?.[_0x18751e(0x241)]||_0x95739d[_0x18751e(0x26c)+'ge']?.['caption']||_0x95739d[_0x18751e(0x28d)+'ge']?.[_0x18751e(0x1ec)]||'';}function messageContainsLinkLocal(_0x3916e5){const _0x597529=_0x22877a,_0x4f38e4=extractTextFromMessage(_0x3916e5);if(!_0x4f38e4)return![];const _0x4c35e2=linkify[_0x597529(0x25a)](_0x4f38e4);if(_0x4c35e2&&_0x4c35e2[_0x597529(0x242)]>0xc27+0x29d+0x2f4*-0x5)return!![];const _0x3c9a1a=/(?:https?:\/\/)?(?:www\.)?[a-z0-9\-]{1,63}\.(?:[a-z]{2,63})(?:[\/:\?\#\s]|$)/i;if(_0x3c9a1a[_0x597529(0x220)](_0x4f38e4))return!![];return![];}function getMessageKey(_0x118abc){const _0x155aee=_0x22877a;if(!_0x118abc?.[_0x155aee(0x240)]?.['id'])return null;return _0x118abc[_0x155aee(0x240)][_0x155aee(0x218)]+':'+_0x118abc['key']['id'];}async function isCtxFromAdmin(_0x56ac70){const _0x4c5509=_0x22877a;try{if(!_0x56ac70)return![];if(_0x56ac70[_0x4c5509(0x240)]?.[_0x4c5509(0x293)])return!![];return!!await isadmin(botRef,_0x56ac70);}catch(_0x238cad){return warn('[antilink]'+'\x20isCtxFrom'+'Admin\x20chec'+_0x4c5509(0x268)+(_0x238cad?.['message']||_0x238cad)),!![];}}async function deleteWithRetry(_0x38e187){const _0x319446=_0x22877a,_0x5889b0=Math['max'](-0xc8*-0x2e+-0x161d+-0xdd2,config[_0x319446(0x278)+_0x319446(0x1f7)]||-0x1*-0x18d+0x3fa*0x1+-0x586),_0x23fc6e=_0x38e187[_0x319446(0x240)]?.[_0x319446(0x218)];if(!_0x23fc6e)return![];for(let _0x2834f0=0x119*-0x1+0x1933+0x1*-0x1819;_0x2834f0<=_0x5889b0;_0x2834f0++){try{const _0x2548d8=botRef?.[_0x319446(0x1cd)]||botRef;return await _0x2548d8['sendMessag'+'e'](_0x23fc6e,{'delete':_0x38e187['key']}),!![];}catch(_0x36e7d5){if(_0x2834f0<_0x5889b0){await new Promise(_0x11c5d0=>setTimeout(_0x11c5d0,(0x2b6*-0xd+0x1*0x100f+-0x3*-0x6c9)*_0x2834f0));continue;}return warn(_0x319446(0x235)+'\x20deleteWit'+'hRetry\x20fai'+_0x319446(0x1da)+(_0x36e7d5?.[_0x319446(0x25f)]||_0x36e7d5)),![];}}return![];}async function getLogTargetJid(){const _0x32b594=_0x22877a;try{const _0x44e0ad=await db[_0x32b594(0x205)](_0x32b594(0x257)+'ue\x20FROM\x20de'+_0x32b594(0x29a)+_0x32b594(0x1f6)+'\x20=\x20\x27target'+_0x32b594(0x273));return _0x44e0ad?.['value']||getBotJid();}catch(_0x39b836){return getBotJid();}}async function forwardDeletedLink(_0x414095){const _0x910a80=_0x22877a;if(!config['LOG_DELETE'+_0x910a80(0x224)])return;try{if(await isCtxFromAdmin(_0x414095))return;const _0x5bb045=await getLogTargetJid();if(!_0x5bb045)return;const _0x5e9cd9=_0x414095[_0x910a80(0x240)]?.[_0x910a80(0x1e6)+'t']||_0x414095[_0x910a80(0x240)]?.[_0x910a80(0x218)]||'Unknown',_0x22314c=_0x414095[_0x910a80(0x240)]?.[_0x910a80(0x218)],_0x1ad447=extractTextFromMessage(_0x414095);let _0x55730b='PM';try{if(_0x22314c&&_0x22314c[_0x910a80(0x1f9)]('@g.us')){const _0x353f66=await(botRef?.[_0x910a80(0x1cd)]||botRef)['groupMetad'+_0x910a80(0x21b)](_0x22314c);_0x55730b=_0x353f66['subject'];}}catch(_0x344f29){_0x55730b='Unknown\x20Gr'+'oup';}const _0x7a5184='🚫\x20*Antilin'+'k\x20Deletion'+_0x910a80(0x211)+('👤\x20*User:*\x20'+'@'+String(_0x5e9cd9)[_0x910a80(0x27c)]('@')[0x49*-0x83+0x1*0x1bf7+0x964]+'\x0a')+(_0x910a80(0x238)+_0x55730b+'\x20('+_0x22314c+')\x0a')+(_0x910a80(0x1ee)+_0x910a80(0x258)+_0x910a80(0x22f)+_0x1ad447+'```');await(botRef?.['sock']||botRef)[_0x910a80(0x1df)+'e'](_0x5bb045,{'text':_0x7a5184,'mentions':[_0x5e9cd9]});}catch(_0x435fab){warn('[antilink]'+_0x910a80(0x26f)+_0x910a80(0x1dc)+_0x910a80(0x297)+_0x910a80(0x221)+_0x435fab[_0x910a80(0x25f)]);}}function userKey(_0x43f573,_0x281895){return _0x43f573+'::'+_0x281895;}function _0x4502(){const _0x136752=['FAULT\x200,\x0a\x20','message','e\x20failed','\x20initializ','on|off|sta','SEND_WARNI','delete','\x20schema\x20cr','\x20Early\x20adm','led\x20for\x20','k\x20failed:\x20','\x20KEY,\x0a\x20\x20\x20\x20','replace','\x20getGroupS','imageMessa','145860godNfW','rticipant\x20','\x20Failed\x20to','\x20remove\x20pa','jid','5sWhoNT','_jid\x27','\x20Database\x20','antilinkwl','n/bot\x20mess','heck\x20faile','DELETE_RET','count','age.','parse','split','sendWarnin','forEach','\x20\x20\x20\x20\x20\x20\x20\x20ON','enabled','catch','{user}',':\x20.antilin','antilink','\x20increment','list\x20TEXT\x20','\x20\x20\x20\x20\x20\x20','\x20\x20\x20\x20\x20\x20\x20\x20\x20c','t\x20message\x20','ailed:\x20','🔗\x20*Antilin','cing\x20on\x20ad','videoMessa','ed.enabled','led','\x20(chat_jid','\x20Could\x20not','ENABLED','fromMe',']\x27\x0a\x20\x20\x20\x20\x20\x20\x20','🔗\x20Could\x20no','992976UapGXK','eleted\x20lin','maining\x20wa','links\x20are\x20','lete_prefs','n\x20PM).',':<alias|ji','sock','\x20groups\x20fo','tlds','ror:\x20','\x20sendWarni','from','cipantsUpd','clear','d:\x20','has','t\x20resolve\x20','🔗\x20Antilink','filter','led:\x20','nt\x20group\x20o','\x20forward\x20d','status>\x20gp','run','sendMessag','t)\x20VALUES\x20','status','trim','🔗\x20Usage:\x20.','isCommand','DEFAULT\x20\x27[','participan','767290ObKnmB','ANTILINK','\x20Skipping\x20','cluded.whi','INTEGER\x20DE','caption','\x20\x20\x20CREATE\x20','🔗\x20*Origina','isArray','\x20module\x20in','antilink_s','bled,\x20whit','(immediate','E\x20SET\x20whit','elist\x20=\x20ex','\x20WHERE\x20key','RY_COUNT','DEDUPE_TTL','endsWith','\x20\x20\x20\x20\x20white','d\x20=\x20exclud','(?,\x20?)\x0a\x20\x20\x20','hat_jid\x20TE','XT\x20PRIMARY','includes',',\x20whitelis','url','gp:<alias|','WARNING_ME','oUserJid','get','🔗\x20{user},\x20','24qDBowv','set','tus>\x20(use\x20','rnings\x20{wa','off','REMOVE_ON_','warning\x20in','DISABLED','stringify','(defensive','*\x0a\x0a','\x20setGroupW','etting\x20err','jid|all>\x20i','command\x20to','94230iQxSIn','🔗\x20PM\x20Usage','remoteJid','484654IzVHqr','❌\x20OFF','ata','\x20setGroupE','mediate\x20er','extendedTe','lt\x20connect','test','k:\x20','OT\x20EXISTS\x20','xtMessage','D_LINKS','ion\x20found.','ensive).','d|all>','T(chat_jid','ured.','g\x20for\x20admi','hitelist\x20f','conversati','nt).','198534khFYhB','*\x0a```','\x20the\x20curre','remove','not\x20allowe','INSERT\x20INT','eation\x20fai','[antilink]','12JJawZs','66jRvuZz','💬\x20*Chat:*\x20',',\x20?)\x0a\x20\x20\x20\x20\x20','MAX_WARNS','antilink\x20<','schema\x20ens','✅\x20ON','normalizeT','itialized\x20','key','text','length','toLowerCas','\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','groupParti','getUniqueJ','\x20\x20\x20\x20\x20);\x0a\x20\x20','\x20for\x20','or\x20for\x20','findings','in\x20check\x20f','ettings','r\x20\x27','push','@g.us','_MS','234081SiINha','nly.','k\x20<on|off|','\x20cleaned\x20u','\x20\x20enabled\x20','nabled\x20fai','SELECT\x20val','l\x20Message:','whitelist','match','ate','SSAGE','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20'];_0x4502=function(){return _0x136752;};return _0x4502();}async function incrementWarningAndMaybeRemove(_0x1c3a7a){const _0x4ef263=_0x22877a;try{if(await isCtxFromAdmin(_0x1c3a7a))return info(_0x4ef263(0x235)+_0x4ef263(0x1e9)+_0x4ef263(0x20d)+'crement\x20fo'+'r\x20admin/bo'+_0x4ef263(0x289)+_0x4ef263(0x210)+').'),{'count':0x0,'removed':![]};const _0x42e44e=_0x1c3a7a['key']?.[_0x4ef263(0x218)],_0x4ffd36=_0x1c3a7a[_0x4ef263(0x240)]?.[_0x4ef263(0x1e6)+'t']||_0x1c3a7a['key']?.[_0x4ef263(0x218)]||'';if(!_0x42e44e||!_0x4ffd36)return{'count':0x0,'removed':![]};const _0x11663b=userKey(_0x42e44e,_0x4ffd36),_0x3bc907=perUserWarnings[_0x4ef263(0x205)](_0x11663b)||{'count':0x0};_0x3bc907[_0x4ef263(0x279)]++,perUserWarnings['set'](_0x11663b,_0x3bc907);if(config[_0x4ef263(0x20c)+'MAX']&&_0x3bc907[_0x4ef263(0x279)]>=config['MAX_WARNS']){const _0x489edc=botRef?.[_0x4ef263(0x1cd)]||botRef;try{await _0x489edc[_0x4ef263(0x245)+_0x4ef263(0x1d3)+_0x4ef263(0x25b)](_0x42e44e,[_0x4ffd36],_0x4ef263(0x231));}catch(_0x7e9ace){warn(_0x4ef263(0x235)+_0x4ef263(0x291)+_0x4ef263(0x270)+_0x4ef263(0x26e)+_0x4ffd36+':\x20'+(_0x7e9ace?.[_0x4ef263(0x25f)]||_0x7e9ace));}return perUserWarnings['delete'](_0x11663b),{'count':_0x3bc907[_0x4ef263(0x279)],'removed':!![]};}return{'count':_0x3bc907[_0x4ef263(0x279)],'removed':![]};}catch(_0x3cd1c2){return warn('[antilink]'+_0x4ef263(0x285)+'Warning\x20er'+_0x4ef263(0x1d0)+(_0x3cd1c2?.[_0x4ef263(0x25f)]||_0x3cd1c2)),{'count':0x0,'removed':![]};}}async function sendWarning(_0x291498,_0x4913b3){const _0x312401=_0x22877a;try{if(await isCtxFromAdmin(_0x291498)){info(_0x312401(0x235)+_0x312401(0x1e9)+_0x312401(0x27d)+_0x312401(0x22a)+_0x312401(0x276)+_0x312401(0x27a));return;}}catch(_0x24970e){warn('[antilink]'+_0x312401(0x1d1)+'ng\x20admin-c'+_0x312401(0x277)+_0x312401(0x1d5)+(_0x24970e?.[_0x312401(0x25f)]||_0x24970e));return;}if(!config[_0x312401(0x263)+'NG'])return;try{const _0x3a47a8=_0x291498['key']?.[_0x312401(0x1e6)+'t']||_0x291498[_0x312401(0x240)]?.['remoteJid']||'',_0x1c83a2=Math['max'](0x26d1+-0x3*0x9dc+-0x93d,config[_0x312401(0x23a)]-_0x4913b3),_0x444727=config[_0x312401(0x203)+_0x312401(0x25c)][_0x312401(0x26a)](_0x312401(0x282),'@'+_0x3a47a8['split']('@')[-0x1032+0x11*-0x207+0x32a9])[_0x312401(0x26a)]('{warnings}',String(_0x1c83a2)),_0x3b4563=_0x291498['key'][_0x312401(0x218)],_0x30c983=botRef?.[_0x312401(0x1cd)]||botRef;await _0x30c983[_0x312401(0x1df)+'e'](_0x3b4563,{'text':_0x444727,'mentions':[_0x3a47a8]});}catch(_0x49ffd3){warn(_0x312401(0x235)+'\x20sendWarni'+'ng\x20failed:'+'\x20'+(_0x49ffd3?.[_0x312401(0x25f)]||_0x49ffd3));}}async function enforceImmediate(_0x3cbe54){const _0x182a1e=_0x22877a;try{const _0x1779b2=getMessageKey(_0x3cbe54);if(!_0x1779b2)return;if(processedMessageIds['has'](_0x1779b2))return;processedMessageIds[_0x182a1e(0x208)](_0x1779b2,setTimeout(()=>processedMessageIds[_0x182a1e(0x264)](_0x1779b2),config[_0x182a1e(0x1f8)+_0x182a1e(0x250)]||0x1*-0xa43+0x5d*-0x1+0x1e28));if(await isCtxFromAdmin(_0x3cbe54)){info(_0x182a1e(0x235)+'\x20Not\x20enfor'+_0x182a1e(0x28c)+'min/bot\x20me'+'ssage\x20(def'+_0x182a1e(0x226));return;}const _0xf2e660=await deleteWithRetry(_0x3cbe54);if(!_0xf2e660)return;await forwardDeletedLink(_0x3cbe54);const {count:_0x448e22,removed:_0xd52766}=await incrementWarningAndMaybeRemove(_0x3cbe54);!_0xd52766&&await sendWarning(_0x3cbe54,_0x448e22);}catch(_0x95eef){warn(_0x182a1e(0x235)+'\x20enforceIm'+_0x182a1e(0x21d)+'ror:\x20'+(_0x95eef?.[_0x182a1e(0x25f)]||_0x95eef));}}function splitRestForGp(_0x44e308){const _0x1949cf=_0x22877a;if(!_0x44e308)return{'left':'','gp':null};const _0x1eb6b6=_0x44e308['match'](/\bgp[:\s]+(.+)$/i);if(_0x1eb6b6)return{'left':_0x44e308['slice'](0xc*0xd9+-0x17*-0x6d+0x13f7*-0x1,_0x1eb6b6['index'])['trim'](),'gp':_0x1eb6b6[0x1b0b+0x1921+-0x342b]['trim']()};return{'left':_0x44e308[_0x1949cf(0x1e2)](),'gp':null};}async function resolveTargetsForGroupAdmin(_0x369b82){const _0x19d5a8=_0x22877a,_0x508f53=await getDefault(_0x369b82)[_0x19d5a8(0x281)](()=>null);if(!_0x508f53)return[];const _0x211043=Array[_0x19d5a8(0x1ef)](_0x508f53)?_0x508f53:[_0x508f53];let _0x1d9b09=[];for(const _0x2453b9 of _0x211043){const _0x3e7037=await getConnection(_0x2453b9)[_0x19d5a8(0x281)](()=>null);if(Array[_0x19d5a8(0x1ef)](_0x3e7037))_0x1d9b09[_0x19d5a8(0x24e)](..._0x3e7037);else{if(_0x3e7037)_0x1d9b09[_0x19d5a8(0x24e)](String(_0x3e7037));}}return Array[_0x19d5a8(0x1d2)](new Set(_0x1d9b09));}async function resolveTargetsForSudo(_0x5c1240){const _0x2ef6fe=_0x22877a;if(!_0x5c1240)return[];if(_0x5c1240[_0x2ef6fe(0x243)+'e']()==='all')return await _0x4fb2ae[_0x2ef6fe(0x246)+'ids']();const _0x542ae4=await _0x4fb2ae['resolveNam'+'e'](_0x5c1240);if(_0x542ae4)return[_0x542ae4];if(_0x5c1240[_0x2ef6fe(0x1ff)]('@'))return[_0x4fb2ae[_0x2ef6fe(0x23e)+_0x2ef6fe(0x204)](_0x5c1240)];return[];}async function findStoredMatchFromFindings(_0x4491b7=[]){const _0x2fbd69=_0x22877a;try{const _0x3b9cab=await listSudo();if(!_0x3b9cab?.[_0x2fbd69(0x242)])return null;const _0x44b022=new Set(_0x3b9cab['map'](String));for(const _0x220259 of _0x4491b7||[]){if(_0x220259?.['jid']&&_0x44b022[_0x2fbd69(0x1d6)](normalizeToJid(_0x220259['jid'])))return normalizeToJid(_0x220259[_0x2fbd69(0x271)]);}return null;}catch(_0x1bd3cb){return null;}}export async function initialize(_0x9a27b8){const _0x2b7c6f=_0x22877a;try{setupApi(_0x9a27b8),await ensureSchema(),refreshConfig(),shuttingDown=![],info(_0x2b7c6f(0x235)+_0x2b7c6f(0x1f0)+_0x2b7c6f(0x23f)+_0x2b7c6f(0x1f3)+'\x20enforceme'+_0x2b7c6f(0x22d));}catch(_0x3dbeb1){error(_0x3dbeb1,_0x2b7c6f(0x235)+_0x2b7c6f(0x261)+_0x2b7c6f(0x260));throw _0x3dbeb1;}}export async function onMessage(_0x5700d7){const _0x2dc1e6=_0x22877a;if(!_0x5700d7?.['key']?.[_0x2dc1e6(0x218)]||!_0x5700d7['message']||shuttingDown)return;const _0x30ac31=_0x5700d7[_0x2dc1e6(0x240)][_0x2dc1e6(0x218)],_0x5eba16=_0x30ac31[_0x2dc1e6(0x1f9)](_0x2dc1e6(0x24f)),_0x43ed82=_0x5700d7[_0x2dc1e6(0x240)]['participan'+'t']||_0x5700d7[_0x2dc1e6(0x240)][_0x2dc1e6(0x218)],_0x29dd39=extractTextFromMessage(_0x5700d7),_0x381ee6=(_0x5700d7[_0x2dc1e6(0x241)]||_0x29dd39)[_0x2dc1e6(0x1e2)](),_0x3f5801=_0x5700d7[_0x2dc1e6(0x1e4)]&&_0x381ee6?_0x381ee6['split'](/\s+/)[-0x1d21+0x12f4*-0x1+-0x3*-0x1007][_0x2dc1e6(0x243)+'e']()[_0x2dc1e6(0x26a)]('/',''):null;if(_0x5700d7['isCommand']&&commands['includes'](_0x3f5801)){let _0x14d5ab=_0x30ac31,_0x1ac60d=![],_0x3193ab=![];if(_0x5eba16){if(await isadmin(botRef,_0x5700d7))_0x1ac60d=!![];}else{if(_0x5700d7['key'][_0x2dc1e6(0x293)])_0x1ac60d=!![],_0x3193ab=!![],_0x14d5ab=getBotJid()||_0x30ac31;else{if(await isSudo(botRef,_0x5700d7)){_0x1ac60d=!![],_0x3193ab=!![];const _0x20b2e=await userJidFromCtx(_0x5700d7)||{'findings':[]};_0x14d5ab=await findStoredMatchFromFindings(_0x20b2e[_0x2dc1e6(0x24a)])||_0x30ac31;}}}if(!_0x1ac60d)return;if(_0x3f5801===_0x2dc1e6(0x284)){const _0x932ba1=_0x381ee6[_0x2dc1e6(0x26a)](new RegExp('^/?'+_0x3f5801+'\x5cb','i'),'')[_0x2dc1e6(0x1e2)](),{left:_0x16e237,gp:_0x4ed3b5}=splitRestForGp(_0x932ba1),_0x214a78=_0x16e237['split'](/[, ]+/)[-0x1*0x5dd+-0x2000+-0x25dd*-0x1]?.[_0x2dc1e6(0x243)+'e']();if(!_0x214a78||!['on','off',_0x2dc1e6(0x1e1)]['includes'](_0x214a78))return(botRef?.[_0x2dc1e6(0x1cd)]||botRef)[_0x2dc1e6(0x1df)+'e'](_0x14d5ab,{'text':_0x2dc1e6(0x1e3)+_0x2dc1e6(0x23b)+_0x2dc1e6(0x262)+_0x2dc1e6(0x209)+_0x2dc1e6(0x202)+_0x2dc1e6(0x214)+_0x2dc1e6(0x1cb)});let _0x5b483f=[];const _0x4b0b9e=(_0x43ed82||'')['split']('@')[-0x2*-0x1069+-0xf7*-0x13+-0x3327];if(_0x3193ab){if(!_0x4ed3b5)return(botRef?.['sock']||botRef)['sendMessag'+'e'](_0x14d5ab,{'text':_0x2dc1e6(0x217)+_0x2dc1e6(0x283)+_0x2dc1e6(0x253)+_0x2dc1e6(0x1dd)+_0x2dc1e6(0x1cc)+_0x2dc1e6(0x227)});_0x5b483f=await resolveTargetsForSudo(_0x4ed3b5);if(!_0x5b483f['length'])return(botRef?.['sock']||botRef)[_0x2dc1e6(0x1df)+'e'](_0x14d5ab,{'text':_0x2dc1e6(0x295)+_0x2dc1e6(0x1d7)+'any\x20target'+_0x2dc1e6(0x1ce)+_0x2dc1e6(0x24d)+_0x4ed3b5+'\x27.'});}else _0x5b483f=await resolveTargetsForGroupAdmin(_0x4b0b9e),!_0x5b483f[_0x2dc1e6(0x242)]&&(_0x5b483f=[_0x30ac31],await(botRef?.['sock']||botRef)[_0x2dc1e6(0x1df)+'e'](_0x14d5ab,{'text':'🔗\x20No\x20defau'+_0x2dc1e6(0x21f)+_0x2dc1e6(0x225)+'\x20Applying\x20'+_0x2dc1e6(0x215)+_0x2dc1e6(0x230)+_0x2dc1e6(0x1db)+_0x2dc1e6(0x252)}));if(_0x214a78==='on'||_0x214a78===_0x2dc1e6(0x20b)){const _0x198ed4=_0x214a78==='on';let _0x27c480=0x688+-0x22f9+0x1c71;for(const _0x4c480a of _0x5b483f){await setGroupEnabled(_0x4c480a,_0x198ed4)&&_0x27c480++;}await(botRef?.[_0x2dc1e6(0x1cd)]||botRef)[_0x2dc1e6(0x1df)+'e'](_0x14d5ab,{'text':_0x2dc1e6(0x1d8)+'\x20'+(_0x198ed4?_0x2dc1e6(0x292):_0x2dc1e6(0x20e))+_0x2dc1e6(0x248)+_0x27c480+'/'+_0x5b483f[_0x2dc1e6(0x242)]+'\x20group(s).'});}else{if(_0x214a78===_0x2dc1e6(0x1e1)){let _0x4742da=_0x2dc1e6(0x28b)+'k\x20Status*\x0a'+'\x0a';for(const _0x341fbf of _0x5b483f){const {enabled:_0x27d9f8}=await getGroupSetting(_0x341fbf);_0x4742da+=_0x341fbf+':\x20'+(_0x27d9f8?_0x2dc1e6(0x23d):_0x2dc1e6(0x21a))+'\x0a';}await(botRef?.[_0x2dc1e6(0x1cd)]||botRef)[_0x2dc1e6(0x1df)+'e'](_0x14d5ab,{'text':_0x4742da});}}}return;}try{if(_0x5eba16){if(_0x5700d7[_0x2dc1e6(0x240)]['fromMe'])return;if(await isadmin(botRef,_0x5700d7))return;}else{if(_0x5700d7[_0x2dc1e6(0x240)]['fromMe'])return;}}catch(_0x1666a3){warn(_0x2dc1e6(0x235)+_0x2dc1e6(0x266)+_0x2dc1e6(0x24b)+_0x2dc1e6(0x28a)+(_0x1666a3?.[_0x2dc1e6(0x25f)]||_0x1666a3));return;}if(_0x5eba16){const _0x379065=await getGroupSetting(_0x30ac31);if(!_0x379065['enabled'])return;const _0x588e43=extractTextFromMessage(_0x5700d7);let _0x4dc501=![];for(const _0x9a2c74 of _0x379065[_0x2dc1e6(0x259)]){if(_0x9a2c74[_0x2dc1e6(0x1ff)]('@')&&_0x9a2c74===_0x43ed82){_0x4dc501=!![];break;}if(!_0x9a2c74['includes']('@')&&_0x588e43[_0x2dc1e6(0x1ff)](_0x9a2c74)){_0x4dc501=!![];break;}}if(_0x4dc501)return;messageContainsLinkLocal(_0x5700d7)&&await enforceImmediate(_0x5700d7);}}export async function cleanup(){const _0xf8741f=_0x22877a;shuttingDown=!![],processedMessageIds[_0xf8741f(0x27e)](_0x7795e9=>clearTimeout(_0x7795e9)),processedMessageIds['clear'](),perUserWarnings[_0xf8741f(0x1d4)](),botRef=null,info(_0xf8741f(0x235)+_0xf8741f(0x254)+'p.');}export default{'name':name,'version':version,'priority':priority,'commands':commands,'initialize':initialize,'onMessage':onMessage,'cleanup':cleanup};