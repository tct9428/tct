const _0x9a1b34=_0x5c79;(function(_0x500c9c,_0x92e45c){const _0x3838e=_0x5c79,_0x4b4120=_0x500c9c();while(!![]){try{const _0x58323e=-parseInt(_0x3838e(0x1c8))/(-0x7f7*0x3+0x2202+-0x50e*0x2)*(parseInt(_0x3838e(0x157))/(0x875+-0x2*-0x265+-0xd3d))+parseInt(_0x3838e(0x229))/(-0xc0e+0x1f*0x2f+0x660)*(-parseInt(_0x3838e(0x185))/(0x13c9+-0x2*-0xbe1+-0x1*0x2b87))+-parseInt(_0x3838e(0x25d))/(-0x23c1+0x1*0x18b6+-0x2*-0x588)+parseInt(_0x3838e(0x206))/(0x12e3+-0x16d0+-0x3f3*-0x1)*(parseInt(_0x3838e(0x153))/(-0x11f7+-0x566+0x1764))+parseInt(_0x3838e(0x300))/(0x26c6+-0x35d*0x6+-0x1290)*(-parseInt(_0x3838e(0x259))/(0x1d87+0x188d+0x5*-0xacf))+parseInt(_0x3838e(0x2d4))/(0x1*0x1d0+-0x5*0x2df+-0x1*-0xc95)*(-parseInt(_0x3838e(0x2b5))/(0x49*0x29+-0x18d9*-0x1+-0x247f))+parseInt(_0x3838e(0x166))/(-0x1a3*-0x11+-0xaf7+0x10*-0x10d);if(_0x58323e===_0x92e45c)break;else _0x4b4120['push'](_0x4b4120['shift']());}catch(_0x883f65){_0x4b4120['push'](_0x4b4120['shift']());}}}(_0x217c,0x9ebe8+0xc4*-0x680+0x1fc*0xf1));import _0x5cd9d5 from'path';import _0x596c57 from'fs/promises';function _0x5c79(_0x44eaac,_0x4d9b40){const _0x282cc5=_0x217c();return _0x5c79=function(_0x510911,_0x1967fb){_0x510911=_0x510911-(0xdd3+0x1*0x2107+0x1*-0x2d88);let _0x28bd0b=_0x282cc5[_0x510911];return _0x28bd0b;},_0x5c79(_0x44eaac,_0x4d9b40);}import{createWriteStream}from'fs';import{pipeline}from'stream/promises';import{downloadContentFromMessage,isJidGroup}from'@whiskeysockets/baileys';import{info,warn,error}from'../utils/logger.js';import{getConfig,hotReloadConfig}from'../utils/config.js';import{db}from'../utils/database.js';import _0x48d663 from'node-cache';import{isSudo}from'../utils/sudo.js';import{getBotJid,getBotJidRaw}from'../utils/bot-state.js';import{startManagedListener,stopManagedListener}from'../utils/listenerManager.js';export const name=_0x9a1b34(0x1b0)+_0x9a1b34(0x220);export const version=_0x9a1b34(0x17a);export const priority=0x1b52+-0x1242+-0x8de;export const commands=[_0x9a1b34(0x26d)];export const configKeys=[_0x9a1b34(0x1b8)+_0x9a1b34(0x248),_0x9a1b34(0x2b4)+_0x9a1b34(0x23f),_0x9a1b34(0x28b)+_0x9a1b34(0x1bf),'DEFAULT_SE'+_0x9a1b34(0x2a0),_0x9a1b34(0x2da)+_0x9a1b34(0x26b),_0x9a1b34(0x2da)+'ANUP_INTER'+_0x9a1b34(0x28c),'DELETE_QUE'+_0x9a1b34(0x2b3)+'E'];const FALLBACKS={'DEBOUNCE_MS':0xbb8,'MEDIA_DIRNAME':_0x9a1b34(0x24b),'DEFAULT_CONCURRENCY':0x2,'CLEANUP_INTERVAL_MS':(0x1b30+0x1b7c+-0x1b53*0x2)*(-0x1db*0x1+-0x145c+0x1673)*(0x1b*0xd8+-0xe41+-0x84b)*(-0x5*-0x330+-0x3*0x603+0x601),'MEDIA_SEND_DELAY_MS':0x12c,'MAX_SEND_RETRIES':0x3,'INITIAL_BACKOFF_MS':0x1f4,'CLEANUP_DAYS':0x3,'QUEUE_MAX_SIZE':0x1f4};let botRef=null,cleanupInterval=null;const messageQueue=[],deletionQueue=[];let activeMessageTasks=0xd9e+-0x23cd+0x162f,activeDeletionTasks=0x211e+0x39*0x5a+0x798*-0x7,MEDIA_DIR=null,DEBOUNCE_DELAY_MS=FALLBACKS[_0x9a1b34(0x1d7)+'S'],CONCURRENCY=FALLBACKS['DEFAULT_CO'+_0x9a1b34(0x2a6)],MEDIA_SEND_DELAY_MS=FALLBACKS[_0x9a1b34(0x238)+'_DELAY_MS'],CLEANUP_INTERVAL=FALLBACKS[_0x9a1b34(0x307)+_0x9a1b34(0x1ef)],MAX_SEND_RETRIES=FALLBACKS[_0x9a1b34(0x2e5)+_0x9a1b34(0x2a1)],INITIAL_BACKOFF=FALLBACKS[_0x9a1b34(0x24d)+_0x9a1b34(0x1a3)],DELETE_CLEANUP_DAYS=FALLBACKS[_0x9a1b34(0x28e)+'YS'],QUEUE_MAX_SIZE=FALLBACKS[_0x9a1b34(0x257)+_0x9a1b34(0x228)],DEFAULT_SEND_DELETE=![],DELETE_MODE='p',TARGET_JID=null;const nameCache=new _0x48d663({'stdTTL':0xe10});let flushTimer=null;const pendingRecovered=[];async function ensureDir(_0x28f416){const _0x307364=_0x9a1b34;try{await _0x596c57[_0x307364(0x1a1)](_0x28f416);}catch(_0x4adb49){if(_0x4adb49[_0x307364(0x21f)]===_0x307364(0x1b7))await _0x596c57[_0x307364(0x2ae)](_0x28f416,{'recursive':!![]});else throw _0x4adb49;}}function sleep(_0x383b2e){return new Promise(_0xb6ead1=>setTimeout(_0xb6ead1,_0x383b2e));}function _0x217c(){const _0x350a00=['sticker','\x20than\x20','no\x20send\x20ta','covery\x20Set','pollCreati','\x20ADD\x20COLUM','t\x20failed:\x20',',\x20Cleanup\x20','SELECT\x20med','[Delete]\x20C','\x20WHERE\x20key','ageItem\x20er','sock','[Delete]\x20H','onWhatsApp','jid','[delete]\x20F','split','REPLACE\x20IN','tatus:*\x0a','[delete]\x20M','arget\x20JID\x20','[Delete]\x20M','ed_at\x20FROM','access','ueue\x20is\x20fu','CKOFF_MS','M\x20messages','refs\x20(key,','ecovered\x20m','s\x20(msg_id,','has','jpg','nsertMessa','aveDeleteT','emove\x20file','egacy\x20forw','tings\x20(PM-','=\x27target_j','delete-rec','[Delete]\x20d','mp4','ailed\x20dele','dated_at)\x20','[Delete]\x20P','RAGMA\x20tabl','ENOENT','DELETE_MED','eletionWor','utoCleanOl','ker\x20item\x20e','g\x20deletion','estamp','object','CURRENCY','üìù\x20Content:','documentMe','messageTim','[Delete]\x20u','map','vered\x20to\x20b','ia\x20for\x20','audioMessa','1wSJoQo','INSERT\x20OR\x20','\x20\x20\x20\x20\x20\x20VALU','y\x20TEXT\x20PRI','\x20Recovery\x20','?,\x20?,\x20?,\x20?','LE\x20IF\x20NOT\x20','MODULE_CON','now','media_path','MARY\x20KEY,\x0a','@lid','\x20CONFLICT(','caption','.\x20Mode:\x20','DEBOUNCE_M','esent_at)\x0a','DELETE_INI','groupMetad','ailed\x20to\x20c','\x20PM.','d\x20unexpect','\x20DELETED\x20M','\x20full\x20(','gifPlaybac','boolean','messages.u','leanup\x20err','protocolMe','\x20set\x20targe','parse','\x20saved_at\x20','document','tionItem\x20e','\x20(all\x20atte','stat','webp','\x20delete\x20<j',',\x0a\x20\x20','TERVAL_MS','ata','entries','string','\x20group\x0a','exec','\x20chat_jid,','pm\x20\x20\x20\x20\x20\x20->','id\x27','üóë\x20*','remoteJidA','dia\x20error:','[Delete]\x20l','nWhatsApp\x20','\x20GROUP.\x20','[Delete]\x20n','t\x20JID.','tration\x20fa','psert','d\x20retry','slice','status@bro','toLowerCas','12GKSkqs','geToDB:\x20mi','R\x20DEFAULT\x20','ode\x20failed','[Delete]\x20r','key','mapping\x20fa','efreshConf','fter:\x20*','ecovered\x20o','length','imageMessa','\x20to\x20','awMessages','\x20WHERE\x20msg','get','IA_DIR','mimetype','O\x20delete_p','catch','\x20Cleanup\x20A','ed_at','push','originalMe','refs\x20(mode','code','overy','TEXT','\x20key=\x27targ','ssing\x20key.','\x20delete\x20cl','\x20value,\x20up','lush\x20loop\x20','ue\x20FROM\x20de','SIZE','210807dmUVkA','low','[Sticker]','saved_at','clear','[Delete]\x20D','json,\x20time','rror:\x20','unset','[Unknown\x20G','find','sages\x20(\x0a\x20\x20','basename','\x20message.','\x20days)','MEDIA_SEND','annot\x20dete','vered\x20to\x20a','eleteMessa','DELETE\x20FRO','d).\x20Leavin','trim','OUNCE_MS','or:\x20','ode\x27,\x27p\x27,\x20','extendedTe','edia\x20sent\x20','ble','adcast','MEDIA_DIRN','s\x20WHERE\x20ms','IA_DIRNAME','leanup\x20com','lue,\x20updat','media','\x20send\x20reco','INITIAL_BA','\x20delete\x20g|','\x20Send\x20Mode','cipant_alt','n:\x20','_path,\x20sav','ICT(key)\x20D','_id,\x20media','mentions','_at\x20INTEGE','QUEUE_MAX_','\x20failed','297FbghLk','at\x20path:\x20','[delete]\x20T','essage\x20sav','274430SoggZp','*Current\x20S','name','arget\x20fail','ssage','d\x20config.','error:\x20','r\x20later\x20re','messages.',',\x20?,\x20?)\x20ON','key)\x20DO\x20UP','delete\x20mod',',\x20message_','Message','ANUP_DAYS','\x20old\x20messa','delete','SELECT\x20val','FF_MS','[Delete]\x20a','[Poll:\x20','INSERT\x20INT','sing\x20colum','.updated_a','GROUP\x20(','aveDeleteM','ES\x20(?,\x20?,\x20','all','JID\x0a\x0a','zation\x20fai','failed\x20for','CREATE\x20TAB','PRAGMA\x20tab','run','led\x20for\x20','alue=exclu','ard\x20error:','(no-id)','ule\x20requir','g\x20incoming','aved\x20file\x20','edia\x20file\x20','sage','rocessMess','LAY_MS','indexOf','DELETE_CON','VAL_MS','ailed\x20to\x20r','CLEANUP_DA','stringify','ll\x20(',').\x20Droppin','ge_json,\x20m','et_jid\x27','[Delete]\x20t','[Delete]\x20i','ode\x20set\x20to','participan','led:\x20','includes','roup]','IMIT','cleared.','[Delete]\x20c','remoteJid','\x20remote_al','ND_DELETE','ETRIES','ed\x20error:\x20','AME','IA_SEND_DE','ummary\x20sen','NCURRENCY','ToFile\x20fai','EFAULT_SEN','FROM\x20messa','mediaPath','VALUES\x20(\x27t','nfig\x20regis','iled:\x20','mkdir','ded.value,','\x20\x20\x20updated','Active:\x20*','[Delete]\x20p','UE_MAX_SIZ','DELETE_DEB','404074XoDZhd','g_id=?','xtMessage','INTEGER','ptt','SELECT\x20msg','message','pdf','t=excluded','not\x20found\x20','get\x20group\x20','[Delete]\x20s','TEXT\x20PRIMA','ler\x20error:','ia_path,\x20s','o\x20send\x20tar','\x20event.','Configured','status','_id\x20IN\x20(','e\x20queue\x20is','nMessage\x20e','size','add','=\x27mode\x27','_DELAY_MS','alMessage\x20','[Delete]\x20m','fileName','function','able','40Nvfkoi','geRow\x20erro','otReloadCo','üë§\x20From:\x20@','\x20deleting.','join','DELETE_CLE','riginal\x20fo','conversati','edia\x20send\x20','has\x20no\x20col','jid,\x20parti','data','group','rmine\x20comm','ptv','stickerMes','MAX_SEND_R','d:\x20','\x20clear\x20tar','VALUES\x20(\x27m','DELETE_QUE','for\x20','end\x20attemp','floor','dMessages\x20','\x20days*','[Delete]\x20h','repeat','nable\x20to\x20d','[Delete]\x20f','load\x20faile','etchOrigin','ANUP_INTER','shift','er\x20item\x20er','ave\x20target','\x20is\x20empty,','notify','sender','uded.updat','anup\x20error','PROJECT_RO','sendMessag','164792kuhOpE','id>\x20\x20\x20\x20\x20->','\x20‚Äî\x20ensurin',')\x20ON\x20CONFL','keys','seconds','üó®\x20Group:\x20','CLEANUP_IN','msg_id','rwarded\x20fo','23982xWvQir','UpsertHand','filter','ig\x20error:\x20','190170ywPUae','plete.','vered\x20send','message_js','nsert\x20fail','afe\x20error:','DEFAULT_CO','set','fromMe','group\x20JID\x20','TO\x20message','ed_at=excl','e_info\x20fai','ete_prefs\x20','[Delete]\x20I','26271372wcBNyk','[Voice\x20not','led\x20fatall','ESSAGES\x20RE','refs\x20WHERE','dded\x20missi','ges\x20WHERE\x20','DEFAULT_SE','[Media]','leaning\x20','eleted\x20mes','essages\x27)','OM\x20message','videoMessa','aybeSaveMe','essageWork','is\x20set.','arget_jid\x20','\x20->\x20','ET\x20value=e','5.0.0','ror:\x20','_id,\x20messa','E\x20messages','[Audio]','audio','onMessageV','ptvMessage','ot-reloade','ALTER\x20TABL','\x20delete\x20p|','44Mvycvt','image','text','DATE\x20SET\x20v'];_0x217c=function(){return _0x350a00;};return _0x217c();}function normalizeToUserJid(_0x3604b3){const _0x58a229=_0x9a1b34;try{if(!_0x3604b3||typeof _0x3604b3!==_0x58a229(0x1f2))return _0x3604b3;const _0x585090=_0x3604b3[_0x58a229(0x28a)]('@');if(_0x585090===-(0x1*0x1bc5+-0x3b*-0x8+-0x1d9c))return _0x3604b3;const _0x701576=_0x3604b3[_0x58a229(0x203)](-0x5dc+0x1efc+-0x1920,_0x585090),_0x3cbda3=_0x3604b3['slice'](_0x585090),_0x544fee=_0x701576[_0x58a229(0x28a)](':');if(_0x544fee===-(0x1e9d+-0x6d8*0x1+-0x17c4))return _0x3604b3;return _0x701576['slice'](0x461*-0x7+0xb*-0x2a7+0x88c*0x7,_0x544fee)+_0x3cbda3;}catch(_0x1d1187){return _0x3604b3;}}async function refreshConfig(){const _0x55ce40=_0x9a1b34;try{const _0x11d683=getConfig()||{};DEFAULT_SEND_DELETE=typeof _0x11d683[_0x55ce40(0x16d)+_0x55ce40(0x2a0)]===_0x55ce40(0x1e1)?_0x11d683['DEFAULT_SE'+_0x55ce40(0x2a0)]:DEFAULT_SEND_DELETE,DEBOUNCE_DELAY_MS=Number(_0x11d683['DELETE_DEB'+_0x55ce40(0x23f)]??FALLBACKS['DEBOUNCE_M'+'S']),CONCURRENCY=Number(_0x11d683[_0x55ce40(0x28b)+'CURRENCY']??_0x11d683[_0x55ce40(0x1cf)+'CURRENCY_L'+_0x55ce40(0x29b)]??FALLBACKS[_0x55ce40(0x15d)+_0x55ce40(0x2a6)]),MEDIA_SEND_DELAY_MS=Number(_0x11d683['DELETE_MED'+_0x55ce40(0x2a4)+_0x55ce40(0x289)]??FALLBACKS[_0x55ce40(0x238)+_0x55ce40(0x2ce)]),CLEANUP_INTERVAL=Number(_0x11d683['DELETE_CLE'+_0x55ce40(0x2f5)+_0x55ce40(0x28c)]??FALLBACKS[_0x55ce40(0x307)+_0x55ce40(0x1ef)]),MAX_SEND_RETRIES=Number(_0x11d683['DELETE_MAX'+'_SEND_RETR'+'IES']??FALLBACKS[_0x55ce40(0x2e5)+_0x55ce40(0x2a1)]),INITIAL_BACKOFF=Number(_0x11d683[_0x55ce40(0x1d9)+'TIAL_BACKO'+_0x55ce40(0x26f)]??FALLBACKS[_0x55ce40(0x24d)+_0x55ce40(0x1a3)]),DELETE_CLEANUP_DAYS=Number(_0x11d683[_0x55ce40(0x2da)+_0x55ce40(0x26b)]??FALLBACKS['CLEANUP_DA'+'YS']),QUEUE_MAX_SIZE=Number(_0x11d683[_0x55ce40(0x2e9)+_0x55ce40(0x2b3)+'E']??FALLBACKS[_0x55ce40(0x257)+_0x55ce40(0x228)]);const _0x520d24=_0x11d683[_0x55ce40(0x2fe)+'OT']&&typeof _0x11d683[_0x55ce40(0x2fe)+'OT']===_0x55ce40(0x1f2)?_0x11d683['PROJECT_RO'+'OT']:process['cwd'](),_0x22af7e=_0x5cd9d5['resolve'](_0x520d24,_0x55ce40(0x2e0),_0x55ce40(0x26d));await ensureDir(_0x22af7e),MEDIA_DIR=_0x5cd9d5[_0x55ce40(0x2d9)](_0x22af7e,_0x11d683[_0x55ce40(0x1b8)+_0x55ce40(0x248)]??_0x11d683['DELETE_MED'+_0x55ce40(0x216)]??FALLBACKS[_0x55ce40(0x246)+_0x55ce40(0x2a3)]),await ensureDir(MEDIA_DIR);}catch(_0x398ae6){warn(_0x55ce40(0x20a)+_0x55ce40(0x20d)+_0x55ce40(0x156)+(_0x398ae6?.[_0x55ce40(0x2bb)]||_0x398ae6));}}try{hotReloadConfig&&hotReloadConfig(()=>{const _0x318465=_0x9a1b34;refreshConfig(),info(_0x318465(0x196)+_0x318465(0x182)+_0x318465(0x262));});}catch(_0x4aa585){warn(_0x9a1b34(0x2ef)+_0x9a1b34(0x2d6)+_0x9a1b34(0x2ac)+_0x9a1b34(0x200)+_0x9a1b34(0x2ad)+(_0x4aa585?.['message']||_0x4aa585));}refreshConfig();const MESSAGES_COLUMNS={'msg_id':_0x9a1b34(0x2c1)+'RY\x20KEY','chat_jid':_0x9a1b34(0x221),'remote_alt':'TEXT','sender_jid':'TEXT','participant_alt':_0x9a1b34(0x221),'message_json':_0x9a1b34(0x221),'timestamp':_0x9a1b34(0x2b8),'media_path':'TEXT','saved_at':_0x9a1b34(0x2b8),'resent_at':_0x9a1b34(0x2b8)};async function ensureTable(){const _0x5da747=_0x9a1b34;try{const _0x12e2c9=Object[_0x5da747(0x1f1)](MESSAGES_COLUMNS)['map'](([_0x38ba3f,_0x379d77])=>_0x38ba3f+'\x20'+_0x379d77)[_0x5da747(0x2d9)](_0x5da747(0x1ee));await db[_0x5da747(0x1f4)](_0x5da747(0x27c)+_0x5da747(0x1ce)+'EXISTS\x20mes'+_0x5da747(0x234)+_0x12e2c9+'\x0a);');let _0x21f49c=[];try{const _0x18bd2b=await db[_0x5da747(0x278)](_0x5da747(0x27d)+'le_info(\x27m'+_0x5da747(0x171));_0x21f49c=(_0x18bd2b||[])[_0x5da747(0x1c4)](_0x2cf65f=>_0x2cf65f[_0x5da747(0x25f)]);}catch(_0x40da61){warn(_0x5da747(0x1b5)+_0x5da747(0x1b6)+_0x5da747(0x163)+_0x5da747(0x298)+(_0x40da61?.[_0x5da747(0x2bb)]||_0x40da61));}for(const _0xadcd8d of Object[_0x5da747(0x304)](MESSAGES_COLUMNS)){if(!_0x21f49c[_0x5da747(0x299)](_0xadcd8d)){const _0x3f763a=MESSAGES_COLUMNS[_0xadcd8d];try{await db[_0x5da747(0x27e)](_0x5da747(0x183)+_0x5da747(0x17d)+_0x5da747(0x18e)+'N\x20'+_0xadcd8d+'\x20'+_0x3f763a),info(_0x5da747(0x270)+_0x5da747(0x16b)+'ng\x20column\x20'+_0x5da747(0x265)+_0xadcd8d);}catch(_0x469310){warn('[Delete]\x20f'+'ailed\x20to\x20a'+'dd\x20column\x20'+_0xadcd8d+':\x20'+(_0x469310?.[_0x5da747(0x2bb)]||_0x469310));}}}await db['exec'](_0x5da747(0x27c)+_0x5da747(0x1ce)+'EXISTS\x20del'+_0x5da747(0x164)+'(\x0a\x20\x20\x20\x20\x20\x20ke'+_0x5da747(0x1cb)+_0x5da747(0x1d2)+'\x20\x20\x20\x20\x20\x20valu'+'e\x20TEXT\x20NOT'+'\x20NULL,\x0a\x20\x20\x20'+_0x5da747(0x2b0)+_0x5da747(0x256)+_0x5da747(0x208)+'0\x0a\x20\x20\x20\x20);');try{const _0x1361a1=await db[_0x5da747(0x215)]('SELECT\x20val'+_0x5da747(0x227)+'lete_prefs'+_0x5da747(0x193)+_0x5da747(0x2cd));if(!_0x1361a1){const _0x1cd4fa=Math[_0x5da747(0x2ec)](Date[_0x5da747(0x1d0)]()/(-0x92+0x1*-0x2183+0x25fd));await db[_0x5da747(0x27e)](_0x5da747(0x272)+_0x5da747(0x218)+_0x5da747(0x1a5)+'\x20value,\x20up'+'dated_at)\x20'+_0x5da747(0x2e8)+_0x5da747(0x241)+'?)',[_0x1cd4fa]),DELETE_MODE='p';}else DELETE_MODE=_0x1361a1['value']==='g'?'g':'p';}catch(_0x3ed532){warn(_0x5da747(0x2b2)+_0x5da747(0x21e)+')\x20load\x20fai'+_0x5da747(0x298)+(_0x3ed532?.['message']||_0x3ed532));}try{const _0x46e139=await db[_0x5da747(0x215)](_0x5da747(0x26e)+_0x5da747(0x227)+'lete_prefs'+'\x20WHERE\x20key'+_0x5da747(0x1af)+_0x5da747(0x1f7));TARGET_JID=_0x46e139?.['value']||null;}catch(_0x542428){warn('[Delete]\x20t'+_0x5da747(0x177)+_0x5da747(0x2f3)+_0x5da747(0x2e6)+(_0x542428?.[_0x5da747(0x2bb)]||_0x542428)),TARGET_JID=null;}}catch(_0x428bd5){warn('[Delete]\x20e'+'nsureTable'+'\x20top\x20error'+':\x20'+(_0x428bd5?.[_0x5da747(0x2bb)]||_0x428bd5));throw _0x428bd5;}}async function streamMediaToFile(_0x248ae5,_0x19ab94){const _0x2d3980=_0x9a1b34;try{const _0x1aeb3a=_0x248ae5[_0x2d3980(0x2bb)][_0x19ab94+_0x2d3980(0x26a)],_0x42d6b5=await downloadContentFromMessage(_0x1aeb3a,_0x19ab94);let _0xa6dfdf='bin';if(_0x19ab94===_0x2d3980(0x186))_0xa6dfdf=_0x2d3980(0x1a9);else{if(_0x19ab94==='video'||_0x19ab94===_0x2d3980(0x2e3))_0xa6dfdf=_0x2d3980(0x1b2);else{if(_0x19ab94===_0x2d3980(0x17f))_0xa6dfdf='ogg';else{if(_0x19ab94===_0x2d3980(0x1e8))_0xa6dfdf=_0x1aeb3a?.[_0x2d3980(0x2d1)]?_0x1aeb3a[_0x2d3980(0x2d1)]['split']('.')['pop']():_0x2d3980(0x2bc);else{if(_0x19ab94===_0x2d3980(0x189))_0xa6dfdf=_0x2d3980(0x1ec);}}}}const _0x35dde8=_0x248ae5[_0x2d3980(0x20b)]['id']+'.'+_0xa6dfdf,_0x1abcb3=_0x5cd9d5['join'](MEDIA_DIR,_0x35dde8);await pipeline(_0x42d6b5,createWriteStream(_0x1abcb3));const _0x217159=await _0x596c57[_0x2d3980(0x1eb)](_0x1abcb3);if(_0x217159[_0x2d3980(0x2cb)]===-0x215e+-0x11*-0x4f+0x1c1f)return warn('[Delete]\x20s'+_0x2d3980(0x285)+_0x1abcb3+(_0x2d3980(0x2f9)+_0x2d3980(0x2d8))),await _0x596c57['rm'](_0x1abcb3,{'force':!![]}),null;return _0x1abcb3;}catch(_0x431eca){return warn(_0x2d3980(0x2c0)+'treamMedia'+_0x2d3980(0x2a7)+_0x2d3980(0x27f)+(_0x248ae5['key']?.['id']||'[no-id]')+':\x20'+(_0x431eca?.[_0x2d3980(0x2bb)]||_0x431eca)),null;}}async function maybeSaveMedia(_0x15cdc2){const _0x354db3=_0x9a1b34;try{const _0x1b22c5=['image','video','ptv',_0x354db3(0x17f),_0x354db3(0x1e8),_0x354db3(0x189)];for(const _0x172436 of _0x1b22c5){if(_0x172436==='ptv'){if(_0x15cdc2[_0x354db3(0x2bb)]?.[_0x354db3(0x181)])return await streamMediaToFile(_0x15cdc2,_0x354db3(0x2e3));continue;}if(_0x15cdc2[_0x354db3(0x2bb)]?.[_0x172436+'Message'])return await streamMediaToFile(_0x15cdc2,_0x172436);}return null;}catch(_0x134c32){return warn('[Delete]\x20m'+_0x354db3(0x174)+_0x354db3(0x1fa)+'\x20'+(_0x134c32?.[_0x354db3(0x2bb)]||_0x134c32)),null;}}async function insertMessageToDB(_0x3b466a,_0x460345){const _0xc9a7a3=_0x9a1b34;try{if(!_0x3b466a||!_0x3b466a[_0xc9a7a3(0x20b)])return;const {id:_0x2af21c,remoteJid:_0x14e01c,participant:_0x49d10d}=_0x3b466a['key'],_0x4f742b=_0x49d10d||_0x14e01c,_0x1b4882=typeof _0x3b466a[_0xc9a7a3(0x1c2)+_0xc9a7a3(0x1bd)]==='number'?_0x3b466a[_0xc9a7a3(0x1c2)+_0xc9a7a3(0x1bd)]:_0x3b466a[_0xc9a7a3(0x1c2)+'estamp']?.[_0xc9a7a3(0x22a)]||Math[_0xc9a7a3(0x2ec)](Date['now']()/(0x207+-0x11*-0x24+-0x1*0x83)),_0x30dd0f=_0x3b466a[_0xc9a7a3(0x20b)]?.[_0xc9a7a3(0x1f9)+'lt']||null,_0x3d35b3=_0x3b466a[_0xc9a7a3(0x20b)]?.[_0xc9a7a3(0x297)+'tAlt']||null,_0x2e384d=Math[_0xc9a7a3(0x2ec)](Date[_0xc9a7a3(0x1d0)]()/(-0x24a8+-0xb*-0x373+0x29f));if(!_0x2af21c){warn('[Delete]\x20i'+_0xc9a7a3(0x1aa)+_0xc9a7a3(0x207)+_0xc9a7a3(0x223)+'id');return;}const _0x2cbecd=_0xc9a7a3(0x1c9)+_0xc9a7a3(0x19b)+_0xc9a7a3(0x161)+_0xc9a7a3(0x1a7)+_0xc9a7a3(0x1f5)+_0xc9a7a3(0x29f)+'t,\x20sender_'+_0xc9a7a3(0x2df)+_0xc9a7a3(0x250)+_0xc9a7a3(0x269)+_0xc9a7a3(0x22f)+'stamp,\x20med'+_0xc9a7a3(0x2c3)+'aved_at,\x20r'+_0xc9a7a3(0x1d8)+_0xc9a7a3(0x1ca)+_0xc9a7a3(0x277)+_0xc9a7a3(0x1cd)+',\x20?,\x20?,\x20?,'+'\x20?)',_0xd0685d=[_0x2af21c,_0x14e01c||null,_0x30dd0f,_0x4f742b||null,_0x3d35b3,JSON[_0xc9a7a3(0x28f)](_0x3b466a),_0x1b4882,_0x460345||null,_0x2e384d,null];try{await db[_0xc9a7a3(0x27e)](_0x2cbecd,_0xd0685d);}catch(_0x2c2538){const _0x5e878d=String(_0x2c2538?.[_0xc9a7a3(0x2bb)]||'');if(_0x5e878d[_0xc9a7a3(0x299)](_0xc9a7a3(0x2de)+'umn')){warn(_0xc9a7a3(0x295)+_0xc9a7a3(0x15b)+'ed\x20due\x20mis'+_0xc9a7a3(0x273)+_0xc9a7a3(0x251)+_0x5e878d+(_0xc9a7a3(0x302)+'g\x20table\x20an'+_0xc9a7a3(0x202)));try{await ensureTable(),await db[_0xc9a7a3(0x27e)](_0x2cbecd,_0xd0685d);}catch(_0xb63cc7){warn(_0xc9a7a3(0x20a)+'etry\x20inser'+_0xc9a7a3(0x18f)+(_0xb63cc7?.[_0xc9a7a3(0x2bb)]||_0xb63cc7));}}else throw _0x2c2538;}}catch(_0x1b7c58){warn(_0xc9a7a3(0x295)+'nsertMessa'+'geToDB\x20fai'+_0xc9a7a3(0x298)+(_0x1b7c58?.[_0xc9a7a3(0x2bb)]||_0x1b7c58));}}async function fetchOriginalMessage(_0x24ebe8){const _0xade873=_0x9a1b34;try{if(!_0x24ebe8)return null;const _0x11021f=await db[_0xade873(0x215)](_0xade873(0x2ba)+_0xade873(0x17c)+_0xade873(0x292)+'edia_path,'+_0xade873(0x1e7)+_0xade873(0x2a9)+_0xade873(0x16c)+'msg_id=?',[_0x24ebe8]);if(_0x11021f)try{return{'msg_id':_0x11021f[_0xade873(0x308)],'message':JSON[_0xade873(0x1e6)](_0x11021f[_0xade873(0x15a)+'on']),'media_path':_0x11021f['media_path'],'saved_at':_0x11021f[_0xade873(0x22c)]};}catch(_0x4173b1){return{'msg_id':_0x11021f[_0xade873(0x308)],'message':null,'media_path':_0x11021f['media_path'],'saved_at':_0x11021f[_0xade873(0x22c)]};}return null;}catch(_0x47456b){return warn(_0xade873(0x2f2)+_0xade873(0x2f4)+_0xade873(0x2cf)+_0xade873(0x263)+(_0x47456b?.[_0xade873(0x2bb)]||_0x47456b)),null;}}async function deleteMessageRow(_0x47dbf5){const _0x19b7b9=_0x9a1b34;try{if(!_0x47dbf5)return;const _0x4118b1=await db[_0x19b7b9(0x215)](_0x19b7b9(0x191)+'ia_path\x20FR'+_0x19b7b9(0x172)+_0x19b7b9(0x247)+_0x19b7b9(0x2b6),[_0x47dbf5]);if(_0x4118b1?.[_0x19b7b9(0x1d1)])try{await _0x596c57['rm'](_0x4118b1[_0x19b7b9(0x1d1)],{'force':!![]});}catch(_0x6b2d00){warn('[Delete]\x20f'+_0x19b7b9(0x28d)+_0x19b7b9(0x1ac)+'\x20'+_0x4118b1[_0x19b7b9(0x1d1)]+':\x20'+(_0x6b2d00?.[_0x19b7b9(0x2bb)]||_0x6b2d00));}await db[_0x19b7b9(0x27e)](_0x19b7b9(0x23c)+'M\x20messages'+_0x19b7b9(0x214)+'_id=?',[_0x47dbf5]),info('[Delete]\x20d'+_0x19b7b9(0x170)+'sages\x20row:'+'\x20'+_0x47dbf5);}catch(_0x297a33){warn(_0x19b7b9(0x1b1)+_0x19b7b9(0x23b)+_0x19b7b9(0x2d5)+'r:\x20'+(_0x297a33?.['message']||_0x297a33));}}async function sendWithRetry(_0x42cb1d,_0x262f13,_0x167eff=[]){const _0x250087=_0x9a1b34,_0x4dac55=Number(MAX_SEND_RETRIES||FALLBACKS[_0x250087(0x2e5)+'ETRIES']);let _0x219a0c=-0xb94*0x2+-0x11f9+0x2921,_0x118047=Number(INITIAL_BACKOFF||FALLBACKS[_0x250087(0x24d)+_0x250087(0x1a3)]);const _0x51671d=[_0x42cb1d,TARGET_JID,getBotJid()][_0x250087(0x155)](Boolean)[_0x250087(0x1c4)](normalizeToUserJid),_0x206e42=new Set(),_0x306486=[];for(const _0x43791f of _0x51671d){if(!_0x43791f)continue;!_0x206e42[_0x250087(0x1a8)](_0x43791f)&&(_0x206e42[_0x250087(0x2cc)](_0x43791f),_0x306486[_0x250087(0x21c)](_0x43791f));}let _0xd6046e=_0x306486[_0x250087(0x210)]?_0x306486[-0x26c0+0x1a8e+0xc32]:null;if(_0xd6046e&&_0xd6046e['endsWith'](_0x250087(0x1d3))&&typeof botRef?.[_0x250087(0x195)]?.['onWhatsApp']===_0x250087(0x2d2))try{const _0x48a1d6=await botRef['sock']['onWhatsApp'](_0xd6046e);if(Array['isArray'](_0x48a1d6)&&_0x48a1d6[0x10e6+0x1*0x2033+-0x3119]&&_0x48a1d6[-0x104a+-0x6aa+0x16f4][_0x250087(0x198)])_0xd6046e=normalizeToUserJid(_0x48a1d6[0x81e+0x6c9+-0xee7][_0x250087(0x198)]);}catch(_0x30ec1c){warn('[Delete]\x20o'+_0x250087(0x1fc)+_0x250087(0x20c)+_0x250087(0x2ad)+(_0x30ec1c?.[_0x250087(0x2bb)]||_0x30ec1c));}while(_0x219a0c<_0x4dac55){try{if(!_0xd6046e)throw new Error(_0x250087(0x18b)+'rget\x20avail'+_0x250087(0x2d3));if(Array['isArray'](_0x167eff)&&_0x167eff[_0x250087(0x210)]&&typeof _0x262f13===_0x250087(0x1be)&&_0x262f13!==null)_0x262f13[_0x250087(0x255)]=_0x167eff;return await botRef[_0x250087(0x2ff)+'e'](_0xd6046e,_0x262f13),!![];}catch(_0x2ab09e){_0x219a0c++;const _0x5db5db=String(_0x2ab09e?.['message']||'')['toLowerCas'+'e']()['includes']('rate')||_0x2ab09e?.[_0x250087(0x2c7)]===-0x1a3a+0x25a7+-0xc0*0xd;warn('[Delete]\x20s'+_0x250087(0x2eb)+'t\x20'+_0x219a0c+_0x250087(0x212)+_0xd6046e+'\x20failed:\x20'+(_0x2ab09e?.[_0x250087(0x2bb)]||_0x2ab09e));if(_0x219a0c>=_0x4dac55||!_0x5db5db)return![];await sleep(_0x118047),_0x118047*=0x1025*0x2+-0x2140+0xf8;}}return![];}function extractContent(_0x56a782){const _0x4bd86e=_0x9a1b34;if(!_0x56a782)return'';if(_0x56a782['conversati'+'on'])return _0x56a782[_0x4bd86e(0x2dc)+'on'];if(_0x56a782[_0x4bd86e(0x242)+_0x4bd86e(0x2b7)])return _0x56a782[_0x4bd86e(0x242)+_0x4bd86e(0x2b7)][_0x4bd86e(0x187)];if(_0x56a782[_0x4bd86e(0x211)+'ge'])return _0x56a782[_0x4bd86e(0x211)+'ge'][_0x4bd86e(0x1d5)]||'';if(_0x56a782[_0x4bd86e(0x173)+'ge'])return _0x56a782['videoMessa'+'ge'][_0x4bd86e(0x1d5)]||'';if(_0x56a782[_0x4bd86e(0x181)])return _0x56a782[_0x4bd86e(0x181)][_0x4bd86e(0x1d5)]||'';if(_0x56a782[_0x4bd86e(0x1c7)+'ge'])return _0x56a782[_0x4bd86e(0x1c7)+'ge']?.[_0x4bd86e(0x2b9)]?_0x4bd86e(0x167)+'e]':_0x4bd86e(0x17e);if(_0x56a782[_0x4bd86e(0x1c1)+'ssage'])return _0x56a782[_0x4bd86e(0x1c1)+_0x4bd86e(0x261)][_0x4bd86e(0x2d1)]||'';if(_0x56a782['stickerMes'+_0x4bd86e(0x287)])return _0x4bd86e(0x22b);if(_0x56a782[_0x4bd86e(0x18d)+'onMessageV'+'3'])return _0x4bd86e(0x271)+(_0x56a782[_0x4bd86e(0x18d)+_0x4bd86e(0x180)+'3']['name']||'poll')+']';return _0x4bd86e(0x16e);}function isMediaMessage(_0xca7c9f){const _0x1fd077=_0x9a1b34;if(!_0xca7c9f)return![];const _0x33e44f=Object[_0x1fd077(0x304)](_0xca7c9f||{});for(const _0x4d8b2d of _0x33e44f){if(_0x4d8b2d['endsWith'](_0x1fd077(0x26a))&&[_0x1fd077(0x211)+'ge','videoMessa'+'ge','audioMessa'+'ge',_0x1fd077(0x1c1)+_0x1fd077(0x261),_0x1fd077(0x2e4)+_0x1fd077(0x287),_0x1fd077(0x181)]['includes'](_0x4d8b2d))return!![];}return![];}async function buildPayloadForSavedFile(_0x1e1657,_0x2498e4){const _0x4b8226=_0x9a1b34,_0xcdaad4=_0x2498e4?.[_0x4b8226(0x2bb)]||{},_0x3f23f9=extractContent(_0xcdaad4)||undefined;try{await _0x596c57['access'](_0x1e1657);}catch(_0x4a2eb3){return warn(_0x4b8226(0x19f)+_0x4b8226(0x286)+_0x4b8226(0x2be)+_0x4b8226(0x25a)+_0x1e1657),null;}if(_0xcdaad4[_0x4b8226(0x2e4)+_0x4b8226(0x287)])return{'sticker':{'url':_0x1e1657}};if(_0xcdaad4[_0x4b8226(0x181)])return{'video':{'url':_0x1e1657},'ptv':!![],'caption':_0x3f23f9,'mimetype':_0xcdaad4[_0x4b8226(0x181)]?.[_0x4b8226(0x217)]};if(_0xcdaad4[_0x4b8226(0x173)+'ge'])return{'video':{'url':_0x1e1657},'caption':_0x3f23f9,'gifPlayback':!!_0xcdaad4[_0x4b8226(0x173)+'ge']?.[_0x4b8226(0x1e0)+'k'],'mimetype':_0xcdaad4[_0x4b8226(0x173)+'ge']?.['mimetype']};if(_0xcdaad4[_0x4b8226(0x211)+'ge'])return{'image':{'url':_0x1e1657},'caption':_0x3f23f9};if(_0xcdaad4['audioMessa'+'ge'])return{'audio':{'url':_0x1e1657},'ptt':!!_0xcdaad4[_0x4b8226(0x1c7)+'ge']?.[_0x4b8226(0x2b9)],'mimetype':_0xcdaad4[_0x4b8226(0x1c7)+'ge']?.[_0x4b8226(0x217)],'seconds':_0xcdaad4['audioMessa'+'ge']?.[_0x4b8226(0x305)]};if(_0xcdaad4['documentMe'+'ssage'])return{'document':{'url':_0x1e1657,'fileName':_0xcdaad4[_0x4b8226(0x1c1)+'ssage']?.[_0x4b8226(0x2d1)]||_0x5cd9d5[_0x4b8226(0x235)](_0x1e1657)},'mimetype':_0xcdaad4['documentMe'+_0x4b8226(0x261)]?.['mimetype'],'caption':_0xcdaad4[_0x4b8226(0x1c1)+'ssage']?.['caption']||_0x3f23f9};return{'document':{'url':_0x1e1657,'fileName':_0x5cd9d5[_0x4b8226(0x235)](_0x1e1657)},'caption':_0x3f23f9};}async function processDeletionItem(_0x47fba6){const _0xb9aa8f=_0x9a1b34;try{const _0xb0c498=_0x47fba6[_0xb9aa8f(0x304)]||[];if(!_0xb0c498[_0xb9aa8f(0x210)])return;for(const _0x42a3c6 of _0xb0c498){const _0x33b0f2=await fetchOriginalMessage(_0x42a3c6['id']);if(!_0x33b0f2||!_0x33b0f2[_0xb9aa8f(0x2bb)])continue;const _0x1f47fd=_0x33b0f2[_0xb9aa8f(0x2bb)],_0x5ef3d1=getBotJidRaw(),_0x422eb5=_0x1f47fd['key']?.[_0xb9aa8f(0x297)+'t']||_0x1f47fd['key']?.[_0xb9aa8f(0x29e)];if(_0x1f47fd[_0xb9aa8f(0x20b)]?.[_0xb9aa8f(0x15f)]||_0x422eb5===_0x5ef3d1)continue;const _0x497279=_0x1f47fd[_0xb9aa8f(0x20b)]['participan'+'t']||_0x1f47fd[_0xb9aa8f(0x20b)][_0xb9aa8f(0x29e)],_0x382314=extractContent(_0x1f47fd['message']);let _0xe30a95=nameCache[_0xb9aa8f(0x215)](_0x497279);if(!_0xe30a95){try{const [_0xf99adc]=await botRef[_0xb9aa8f(0x195)][_0xb9aa8f(0x197)](_0x497279);_0xe30a95=_0xf99adc?.[_0xb9aa8f(0x2fa)]||'~'+_0x497279[_0xb9aa8f(0x19a)]('@')[0xdd5+-0x1f*-0x106+-0x1*0x2d8f];}catch{_0xe30a95='~'+_0x497279['split']('@')[0xa*0x8b+0x1716+-0x1c84];}nameCache[_0xb9aa8f(0x15e)](_0x497279,_0xe30a95);}let _0x35baa2='';if(isJidGroup(_0x1f47fd[_0xb9aa8f(0x20b)]['remoteJid']))try{_0x35baa2=(await botRef[_0xb9aa8f(0x195)][_0xb9aa8f(0x1da)+_0xb9aa8f(0x1f0)](_0x1f47fd[_0xb9aa8f(0x20b)][_0xb9aa8f(0x29e)]))['subject'];}catch{_0x35baa2=_0xb9aa8f(0x232)+_0xb9aa8f(0x29a);}deletionPush({'msg_id':_0x33b0f2[_0xb9aa8f(0x308)],'sender':_0x497279,'name':_0xe30a95,'group':_0x35baa2,'content':_0x382314,'mediaPath':_0x33b0f2[_0xb9aa8f(0x1d1)]||null,'originalMessage':_0x1f47fd});}}catch(_0x4b8da1){warn(_0xb9aa8f(0x2b2)+'rocessDele'+_0xb9aa8f(0x1e9)+_0xb9aa8f(0x230)+(_0x4b8da1?.[_0xb9aa8f(0x2bb)]||_0x4b8da1));}}async function deletionWorker(){const _0x20df05=_0x9a1b34,_0x5417f5=CONCURRENCY||FALLBACKS['DEFAULT_CO'+_0x20df05(0x2a6)];while(deletionQueue[_0x20df05(0x210)]>0x1722+0x1c27*-0x1+0x505&&activeDeletionTasks<_0x5417f5){const _0xf6610c=deletionQueue[_0x20df05(0x2f6)]();if(!_0xf6610c)break;activeDeletionTasks++,((async()=>{const _0x2eeffd=_0x20df05;try{await processDeletionItem(_0xf6610c);}catch(_0x2d7d6e){warn(_0x2eeffd(0x1b1)+_0x2eeffd(0x1b9)+_0x2eeffd(0x1bb)+_0x2eeffd(0x230)+(_0x2d7d6e?.[_0x2eeffd(0x2bb)]||_0x2d7d6e));}finally{activeDeletionTasks--,setImmediate(()=>{const _0xb56224=_0x2eeffd;if(deletionQueue['length'])deletionWorker()[_0xb56224(0x219)](()=>{});});}})());}}function deletionPush(_0x10f4d0){pendingRecovered['push'](_0x10f4d0),clearTimeout(flushTimer),flushTimer=setTimeout(()=>{const _0x13b64b=pendingRecovered['splice'](0x5*-0xeb+0x51*-0x2f+0x1376,pendingRecovered['length']);((async()=>{try{await flushRecoveredBatch(_0x13b64b);}catch(_0x29bd9b){warn('[Delete]\x20f'+'lushRecove'+'redBatch\x20e'+'rror:\x20'+(_0x29bd9b?.['message']||_0x29bd9b));}})());},DEBOUNCE_DELAY_MS||FALLBACKS['DEBOUNCE_M'+'S']);}function resolveDeleteTarget(_0x2f7230){const _0x1db626=getBotJid();if(DELETE_MODE==='g'&&TARGET_JID){if(TARGET_JID===_0x2f7230)return _0x1db626;return TARGET_JID;}return _0x1db626;}async function saveDeleteMode(_0x3db295){const _0x7d1ea1=_0x9a1b34;try{const _0x28497a=_0x3db295==='g'?'g':'p',_0x33ea6a=Math[_0x7d1ea1(0x2ec)](Date[_0x7d1ea1(0x1d0)]()/(0x2422+0x161d+0x121d*-0x3));return await db['run'](_0x7d1ea1(0x272)+_0x7d1ea1(0x218)+_0x7d1ea1(0x1a5)+'\x20value,\x20up'+_0x7d1ea1(0x1b4)+_0x7d1ea1(0x2e8)+'ode\x27,\x20?,\x20?'+_0x7d1ea1(0x303)+_0x7d1ea1(0x253)+'O\x20UPDATE\x20S'+_0x7d1ea1(0x179)+'xcluded.va'+_0x7d1ea1(0x24a)+_0x7d1ea1(0x162)+_0x7d1ea1(0x2fc)+_0x7d1ea1(0x21b),[_0x28497a,_0x33ea6a]),DELETE_MODE=_0x28497a,info('[Delete]\x20m'+'ode\x20saved:'+'\x20'+DELETE_MODE),!![];}catch(_0x49168c){return warn(_0x7d1ea1(0x2c0)+_0x7d1ea1(0x276)+_0x7d1ea1(0x209)+':\x20'+(_0x49168c?.['message']||_0x49168c)),![];}}async function saveDeleteTarget(_0x253e5f){const _0x1ed9ff=_0x9a1b34;try{const _0x5d3bae=Math[_0x1ed9ff(0x2ec)](Date[_0x1ed9ff(0x1d0)]()/(0x1b*0x15c+-0x1*0xc43+-0x1489));if(!_0x253e5f)return await db['run']('DELETE\x20FRO'+'M\x20delete_p'+_0x1ed9ff(0x16a)+_0x1ed9ff(0x222)+_0x1ed9ff(0x293)),TARGET_JID=null,info('[Delete]\x20t'+'arget_jid\x20'+'cleared'),!![];else{const _0x92207b=normalizeToUserJid(_0x253e5f);return await db[_0x1ed9ff(0x27e)](_0x1ed9ff(0x272)+_0x1ed9ff(0x218)+_0x1ed9ff(0x1a5)+_0x1ed9ff(0x225)+'dated_at)\x20'+_0x1ed9ff(0x2ab)+'arget_jid\x27'+_0x1ed9ff(0x266)+_0x1ed9ff(0x1d4)+_0x1ed9ff(0x267)+_0x1ed9ff(0x188)+_0x1ed9ff(0x280)+_0x1ed9ff(0x2af)+'\x20updated_a'+_0x1ed9ff(0x2bd)+_0x1ed9ff(0x274)+'t',[_0x92207b,_0x5d3bae]),TARGET_JID=_0x92207b,info(_0x1ed9ff(0x294)+_0x1ed9ff(0x177)+'saved:\x20'+TARGET_JID),!![];}}catch(_0x469c55){return warn(_0x1ed9ff(0x2c0)+_0x1ed9ff(0x1ab)+_0x1ed9ff(0x260)+'ed:\x20'+(_0x469c55?.[_0x1ed9ff(0x2bb)]||_0x469c55)),![];}}async function flushRecoveredBatch(_0x5d4b5d){const _0x3e7581=_0x9a1b34;if(!_0x5d4b5d||_0x5d4b5d[_0x3e7581(0x210)]===-0x1*0x13eb+0x1c97+-0x8ac)return;if(!DEFAULT_SEND_DELETE){info(_0x3e7581(0x22e)+_0x3e7581(0x2a8)+'D_DELETE\x20f'+'alse\x20‚Äî\x20ski'+'pping\x20reco'+_0x3e7581(0x159)+'s.');return;}const _0x55ff38=_0x5d4b5d[_0x3e7581(0x233)](_0x5af010=>_0x5af010[_0x3e7581(0x21d)+'ssage'])?.[_0x3e7581(0x21d)+_0x3e7581(0x261)]?.[_0x3e7581(0x20b)]?.['remoteJid']||null,_0x2d108d=resolveDeleteTarget(_0x55ff38)||getBotJid();if(!_0x2d108d){warn(_0x3e7581(0x1fe)+_0x3e7581(0x2c4)+'get\x20availa'+_0x3e7581(0x244));return;}const _0x533aa2=[...new Set(_0x5d4b5d[_0x3e7581(0x1c4)](_0x3481dc=>_0x3481dc[_0x3e7581(0x2fb)]))],_0x1ec47b=_0x5d4b5d[_0x3e7581(0x1c4)](_0x1180cf=>_0x3e7581(0x2d7)+_0x1180cf[_0x3e7581(0x2fb)][_0x3e7581(0x19a)]('@')[0x8dd*0x1+0x8f5*0x2+0x1c9*-0xf]+'\x20('+_0x1180cf[_0x3e7581(0x25f)]+')\x0a'+(_0x1180cf[_0x3e7581(0x2e1)]?_0x3e7581(0x306)+_0x1180cf[_0x3e7581(0x2e1)]+'\x0a':'')+(_0x3e7581(0x1c0)+'\x20'+_0x1180cf['content']+'\x0a')+'‚îÄ'[_0x3e7581(0x2f0)](0x1517+0x1152+-0x2650))['join']('\x0a'),_0xb52865=_0x3e7581(0x1f8)+_0x5d4b5d['length']+(_0x3e7581(0x1de)+_0x3e7581(0x169)+'COVERED*\x20üóë'+'\x0a\x0a');try{const _0x126259=await sendWithRetry(_0x2d108d,{'text':_0xb52865+_0x1ec47b},_0x533aa2);if(!_0x126259)warn(_0x3e7581(0x2c0)+_0x3e7581(0x2a5)+'d\x20may\x20have'+_0x3e7581(0x258));}catch(_0x20c364){warn(_0x3e7581(0x2c0)+_0x3e7581(0x2a5)+_0x3e7581(0x1dd)+_0x3e7581(0x2a2)+(_0x20c364?.[_0x3e7581(0x2bb)]||_0x20c364));}for(const _0x54a353 of _0x5d4b5d){try{const _0x5c748c=_0x54a353[_0x3e7581(0x2aa)],_0x855e40=_0x54a353[_0x3e7581(0x21d)+'ssage'],_0x2ecc57=!!_0x5c748c||isMediaMessage(_0x855e40?.[_0x3e7581(0x2bb)]);if(!_0x2ecc57){try{await deleteMessageRow(_0x54a353[_0x3e7581(0x308)]);}catch(_0x2d2dbe){}continue;}const _0xbdf9a6=_0x855e40?.[_0x3e7581(0x20b)]?.['id']||_0x3e7581(0x282),_0x3aa610=await buildPayloadForSavedFile(_0x5c748c,_0x855e40);if(_0x3aa610){const _0x3f0f68=await sendWithRetry(_0x2d108d,_0x3aa610);if(_0x3f0f68){info(_0x3e7581(0x20a)+_0x3e7581(0x1a6)+_0x3e7581(0x243)+_0x3e7581(0x2ea)+_0xbdf9a6+_0x3e7581(0x178)+_0x2d108d),await deleteMessageRow(_0x54a353['msg_id']),await sleep(MEDIA_SEND_DELAY_MS||FALLBACKS[_0x3e7581(0x238)+_0x3e7581(0x2ce)]);continue;}else warn(_0x3e7581(0x2d0)+_0x3e7581(0x2dd)+_0x3e7581(0x27b)+'\x20'+_0xbdf9a6+'.');}try{const _0x566d6f=await sendWithRetry(_0x2d108d,{'forward':_0x855e40});if(_0x566d6f){info(_0x3e7581(0x20a)+_0x3e7581(0x20f)+_0x3e7581(0x2db)+_0x3e7581(0x152)+'r\x20'+_0xbdf9a6+'\x20->\x20'+_0x2d108d),await deleteMessageRow(_0x54a353[_0x3e7581(0x308)]),await sleep(MEDIA_SEND_DELAY_MS||FALLBACKS['MEDIA_SEND'+_0x3e7581(0x2ce)]);continue;}}catch(_0x1f724b){warn(_0x3e7581(0x1fb)+_0x3e7581(0x1ad)+_0x3e7581(0x281)+'\x20'+(_0x1f724b?.[_0x3e7581(0x2bb)]||_0x1f724b));}warn(_0x3e7581(0x1c3)+_0x3e7581(0x2f1)+'eliver\x20med'+_0x3e7581(0x1c6)+_0xbdf9a6+(_0x3e7581(0x1ea)+'mpts\x20faile'+_0x3e7581(0x23d)+'g\x20in\x20DB\x20fo'+_0x3e7581(0x264)+'try/cleanu'+'p.'));}catch(_0x5d7a13){warn(_0x3e7581(0x2f2)+_0x3e7581(0x226)+'item\x20error'+':\x20'+(_0x5d7a13?.[_0x3e7581(0x2bb)]||_0x5d7a13));}}}async function rawMessagesUpsertHandler({messages:_0x203e73}){const _0x10571e=_0x9a1b34;try{if(!_0x203e73||!Array['isArray'](_0x203e73))return;for(const _0x18fa43 of _0x203e73){if(!_0x18fa43||!_0x18fa43[_0x10571e(0x2bb)]||_0x18fa43[_0x10571e(0x20b)]?.[_0x10571e(0x29e)]===_0x10571e(0x204)+_0x10571e(0x245))continue;if(_0x18fa43[_0x10571e(0x20b)]?.[_0x10571e(0x15f)])continue;if(messageQueue[_0x10571e(0x210)]>=QUEUE_MAX_SIZE){warn(_0x10571e(0x19f)+_0x10571e(0x25c)+_0x10571e(0x2c9)+_0x10571e(0x1df)+messageQueue[_0x10571e(0x210)]+(').\x20Droppin'+_0x10571e(0x284)+_0x10571e(0x236)));continue;}messageQueue[_0x10571e(0x21c)](_0x18fa43),setImmediate(()=>{const _0x197b45=_0x10571e;messageWorker()[_0x197b45(0x219)](()=>{});});const _0xde674b=_0x18fa43[_0x10571e(0x2bb)]?.[_0x10571e(0x1e4)+'ssage'];if(_0xde674b?.['type']===0x183f+-0x1bf1+0x3b2&&_0xde674b?.[_0x10571e(0x20b)]){if(deletionQueue['length']>=QUEUE_MAX_SIZE){warn(_0x10571e(0x22e)+'eletion\x20pr'+'ocessing\x20q'+_0x10571e(0x1a2)+_0x10571e(0x290)+deletionQueue[_0x10571e(0x210)]+(_0x10571e(0x291)+_0x10571e(0x1bc)+_0x10571e(0x2c5)));continue;}deletionQueue['push']({'keys':[_0xde674b[_0x10571e(0x20b)]],'remoteJid':_0x18fa43['key']['remoteJid']}),setImmediate(()=>{const _0x33b6d6=_0x10571e;deletionWorker()[_0x33b6d6(0x219)](()=>{});});}}}catch(_0x2da7a2){warn(_0x10571e(0x20a)+_0x10571e(0x213)+_0x10571e(0x154)+_0x10571e(0x2c2)+'\x20'+(_0x2da7a2?.[_0x10571e(0x2bb)]||_0x2da7a2));}}async function processMessageItem(_0x36b788){const _0x21b419=_0x9a1b34;try{if(!_0x36b788||!_0x36b788[_0x21b419(0x2bb)]||_0x36b788[_0x21b419(0x20b)]?.['fromMe'])return;const _0x1ab3b7=await maybeSaveMedia(_0x36b788);await insertMessageToDB(_0x36b788,_0x1ab3b7);}catch(_0x5dd0ee){warn(_0x21b419(0x2b2)+_0x21b419(0x288)+_0x21b419(0x194)+'ror:\x20'+(_0x5dd0ee?.[_0x21b419(0x2bb)]||_0x5dd0ee));}}async function messageWorker(){const _0x2306f2=_0x9a1b34,_0x2d4334=CONCURRENCY||FALLBACKS[_0x2306f2(0x15d)+_0x2306f2(0x2a6)];while(messageQueue[_0x2306f2(0x210)]>0xb80*0x3+0x1d67+-0x3fe7&&activeMessageTasks<_0x2d4334){const _0x28a6f9=messageQueue[_0x2306f2(0x2f6)]();if(!_0x28a6f9)break;activeMessageTasks++,((async()=>{const _0x28939b=_0x2306f2;try{await processMessageItem(_0x28a6f9);}catch(_0x1c5e85){warn('[Delete]\x20m'+_0x28939b(0x175)+_0x28939b(0x2f7)+_0x28939b(0x17b)+(_0x1c5e85?.[_0x28939b(0x2bb)]||_0x1c5e85));}finally{activeMessageTasks--,setImmediate(()=>{const _0x4aaaf2=_0x28939b;if(messageQueue[_0x4aaaf2(0x210)])messageWorker()[_0x4aaaf2(0x219)](()=>{});});}})());}}async function autoCleanOldMessagesSafe(){const _0x4b305c=_0x9a1b34;try{await autoCleanOldMessages();}catch(_0xcc1d3a){warn(_0x4b305c(0x270)+_0x4b305c(0x1ba)+'dMessagesS'+_0x4b305c(0x15c)+'\x20'+(_0xcc1d3a?.['message']||_0xcc1d3a));}}async function autoCleanOldMessages(){const _0x488fd1=_0x9a1b34;try{const _0x5ec544=Math[_0x488fd1(0x2ec)](Date[_0x488fd1(0x1d0)]()/(-0x24e9*-0x1+0x2057+-0x4158))-Number(DELETE_CLEANUP_DAYS||FALLBACKS[_0x488fd1(0x28e)+'YS'])*(0x1eb*0x1+0xde9*0x1+-0x13*0xd4)*(0x14ac+0x2155+-0x35c5)*(0x66*-0x6+0x11b5+-0x15f*0xb),_0x895bd=await db[_0x488fd1(0x278)](_0x488fd1(0x2ba)+_0x488fd1(0x254)+_0x488fd1(0x252)+_0x488fd1(0x1a0)+'\x20messages\x20'+'WHERE\x20save'+'d_at\x20IS\x20NO'+'T\x20NULL\x20AND'+'\x20saved_at\x20'+'<\x20?',[_0x5ec544]);if(!_0x895bd||_0x895bd[_0x488fd1(0x210)]===0x535+-0x2387*-0x1+-0x4f*0x84)return;info(_0x488fd1(0x29d)+_0x488fd1(0x16f)+_0x895bd['length']+(_0x488fd1(0x26c)+'ges\x20(older'+_0x488fd1(0x18a))+DELETE_CLEANUP_DAYS+_0x488fd1(0x237));for(const _0x8c7521 of _0x895bd){if(_0x8c7521[_0x488fd1(0x1d1)])try{await _0x596c57['rm'](_0x8c7521[_0x488fd1(0x1d1)],{'force':!![]});}catch(_0x37e68a){warn(_0x488fd1(0x2f2)+_0x488fd1(0x1b3)+'ting\x20file\x20'+_0x8c7521[_0x488fd1(0x1d1)]+':\x20'+(_0x37e68a?.[_0x488fd1(0x2bb)]||_0x37e68a));}}const _0x59e567=_0x895bd[_0x488fd1(0x1c4)](_0x2e5a36=>_0x2e5a36[_0x488fd1(0x308)]),_0x3897df=-0x14a5+-0x1cfa+-0x21*-0x187;for(let _0x220c55=-0x545*0x7+0x24f+0x2294;_0x220c55<_0x59e567[_0x488fd1(0x210)];_0x220c55+=_0x3897df){const _0x15ed2f=_0x59e567[_0x488fd1(0x203)](_0x220c55,_0x220c55+_0x3897df),_0x317af4=_0x15ed2f[_0x488fd1(0x1c4)](()=>'?')[_0x488fd1(0x2d9)](',');await db[_0x488fd1(0x27e)](_0x488fd1(0x23c)+_0x488fd1(0x1a4)+_0x488fd1(0x214)+_0x488fd1(0x2c8)+_0x317af4+')',_0x15ed2f);}info(_0x488fd1(0x29d)+_0x488fd1(0x249)+_0x488fd1(0x158));}catch(_0x165997){warn(_0x488fd1(0x270)+_0x488fd1(0x1ba)+_0x488fd1(0x2ed)+'failed:\x20'+(_0x165997?.[_0x488fd1(0x2bb)]||_0x165997));}}const processedCmdKeys=new Map(),CMD_DEDUPE_TTL_MS=(-0x25e4+0x24d8+-0x1*-0x12a)*(0x71d+-0x21cc+0x1e97*0x1);function markCmdProcessed(_0x253837){const _0x6a9b40=_0x9a1b34;if(!_0x253837)return;if(processedCmdKeys['has'](_0x253837))try{clearTimeout(processedCmdKeys[_0x6a9b40(0x215)](_0x253837));}catch(_0x2a725d){};const _0xe706bf=setTimeout(()=>processedCmdKeys[_0x6a9b40(0x26d)](_0x253837),CMD_DEDUPE_TTL_MS);processedCmdKeys[_0x6a9b40(0x15e)](_0x253837,_0xe706bf);}function isCmdProcessed(_0x5cf52e){const _0x258774=_0x9a1b34;return _0x5cf52e&&processedCmdKeys[_0x258774(0x1a8)](_0x5cf52e);}export async function onMessage(_0x14d98b){const _0xe5d616=_0x9a1b34;try{if(!_0x14d98b||!_0x14d98b[_0xe5d616(0x20b)]||!_0x14d98b[_0xe5d616(0x2bb)]||!_0x14d98b['isCommand'])return;if(isJidGroup(_0x14d98b['key'][_0xe5d616(0x29e)]))return;const _0x274aee=_0x14d98b['key'][_0xe5d616(0x15f)],_0x4118a7=await isSudo(botRef,_0x14d98b)['catch'](()=>![]);if(!_0x274aee&&!_0x4118a7)return;let _0x2e1971=_0x274aee?getBotJid():_0x14d98b[_0xe5d616(0x20b)]['remoteJid'];if(!_0x2e1971){warn(_0xe5d616(0x192)+_0xe5d616(0x239)+_0xe5d616(0x2e2)+'and\x20reply\x20'+'target.');return;}const _0x211329=String(_0x14d98b[_0xe5d616(0x20b)][_0xe5d616(0x29e)]||'')+'::'+String(_0x14d98b[_0xe5d616(0x20b)]['id']||_0x14d98b[_0xe5d616(0x20b)][_0xe5d616(0x297)+'t']||'');if(isCmdProcessed(_0x211329))return;markCmdProcessed(_0x211329);const _0x3e8140=_0x14d98b[_0xe5d616(0x187)]||'',_0x56abe2=_0x3e8140[_0xe5d616(0x23e)]()[_0xe5d616(0x19a)](/\s+/),_0x551648=(_0x56abe2[-0x11e1+-0x2552+0xd*0x43f]||'')[_0xe5d616(0x205)+'e']();if(!commands['includes'](_0x551648))return;const _0x296e0b=(_0x56abe2[0x21*0x11a+-0x413+-0x2046]||'')[_0xe5d616(0x205)+'e']();if(_0x296e0b&&_0x296e0b[_0xe5d616(0x299)]('@')){const _0x52d335=normalizeToUserJid(_0x296e0b),_0x44ed04=await saveDeleteTarget(_0x52d335);await sendWithRetry(_0x2e1971,{'text':_0x44ed04?_0xe5d616(0x25b)+_0xe5d616(0x19e)+'saved:\x20'+_0x52d335:_0xe5d616(0x199)+'ailed\x20to\x20s'+_0xe5d616(0x2f8)+'\x20JID'});return;}if([_0xe5d616(0x22d),_0xe5d616(0x231),'remove']['includes'](_0x296e0b)){const _0x3ffca8=await saveDeleteTarget(null);await sendWithRetry(_0x2e1971,{'text':_0x3ffca8?'[delete]\x20T'+'arget\x20JID\x20'+_0xe5d616(0x29c):'[delete]\x20F'+_0xe5d616(0x1db)+'lear\x20targe'+_0xe5d616(0x1ff)});return;}if(['p','pm'][_0xe5d616(0x299)](_0x296e0b)){await saveDeleteMode('p'),await sendWithRetry(_0x2e1971,{'text':_0xe5d616(0x19d)+_0xe5d616(0x296)+_0xe5d616(0x1dc)});return;}if(['g','group','gp']['includes'](_0x296e0b)){await saveDeleteMode('g');const _0x43aefb=TARGET_JID?_0xe5d616(0x2c6)+'\x20group:\x20'+TARGET_JID:'No\x20target\x20'+_0xe5d616(0x160)+_0xe5d616(0x176);await sendWithRetry(_0x2e1971,{'text':_0xe5d616(0x19d)+'ode\x20set\x20to'+_0xe5d616(0x1fd)+_0x43aefb});return;}const _0x3bec69=DELETE_MODE==='g'?_0xe5d616(0x275)+(TARGET_JID||'not\x20set')+')':'PM';await sendWithRetry(_0x2e1971,{'text':'*Delete\x20Re'+_0xe5d616(0x18c)+_0xe5d616(0x1ae)+'Only)*\x0a\x0a'+'Usage:\x0a'+(_0xe5d616(0x184)+_0xe5d616(0x1f6)+_0xe5d616(0x24c)+_0xe5d616(0x1c5)+'ot\x20PM\x0a')+(_0xe5d616(0x24e)+'group\x20\x20\x20->'+_0xe5d616(0x24c)+_0xe5d616(0x23a)+_0xe5d616(0x1f3))+(_0xe5d616(0x1ed)+_0xe5d616(0x301)+_0xe5d616(0x1e5)+'t\x20group\x20JI'+'D\x0a')+(_0xe5d616(0x224)+'ear\x20\x20\x20\x20\x20->'+_0xe5d616(0x2e7)+_0xe5d616(0x2bf)+_0xe5d616(0x279))+(_0xe5d616(0x25e)+_0xe5d616(0x19c))+(_0xe5d616(0x24f)+':\x20*'+_0x3bec69+'*\x0a')+(_0xe5d616(0x1cc)+_0xe5d616(0x2b1)+DEFAULT_SEND_DELETE+'*\x0a')+(_0xe5d616(0x21a)+_0xe5d616(0x20e)+DELETE_CLEANUP_DAYS+_0xe5d616(0x2ee))});}catch(_0x322b93){error(_0x322b93,'[Delete]\x20o'+_0xe5d616(0x2ca)+_0xe5d616(0x230)+(_0x322b93?.[_0xe5d616(0x2bb)]||_0x322b93));}}export async function initialize(_0x26b265){const _0x2a87e5=_0x9a1b34;if(!_0x26b265)throw new Error(_0x2a87e5(0x268)+_0x2a87e5(0x283)+'es\x20bot\x20arg');botRef=_0x26b265,await refreshConfig(),await ensureTable()[_0x2a87e5(0x219)](_0x5338bf=>{const _0x39121d=_0x2a87e5;error(_0x39121d(0x22e)+'B\x20initiali'+_0x39121d(0x27a)+_0x39121d(0x168)+'y:\x20'+(_0x5338bf?.['message']||_0x5338bf));throw _0x5338bf;}),startManagedListener({'botRef':botRef,'eventName':_0x2a87e5(0x1e2)+_0x2a87e5(0x201),'handler':rawMessagesUpsertHandler,'moduleName':name}),await autoCleanOldMessagesSafe()[_0x2a87e5(0x219)](_0x3d9e48=>warn(_0x2a87e5(0x295)+'nitial\x20cle'+_0x2a87e5(0x2fd)+':\x20'+(_0x3d9e48?.[_0x2a87e5(0x2bb)]||_0x3d9e48)));if(cleanupInterval)clearInterval(cleanupInterval);cleanupInterval=setInterval(autoCleanOldMessagesSafe,CLEANUP_INTERVAL||FALLBACKS[_0x2a87e5(0x307)+_0x2a87e5(0x1ef)]),info(_0x2a87e5(0x165)+'nitialized'+_0x2a87e5(0x1d6)+DELETE_MODE+(_0x2a87e5(0x190)+'Days:\x20')+DELETE_CLEANUP_DAYS);}export async function cleanup(){const _0x41bbfd=_0x9a1b34;try{stopManagedListener(name,_0x41bbfd(0x1e2)+_0x41bbfd(0x201)),cleanupInterval&&(clearInterval(cleanupInterval),cleanupInterval=null),messageQueue['length']=-0x3*0xba5+0x1978+0x1*0x977,deletionQueue[_0x41bbfd(0x210)]=0x1443+0x2199*0x1+-0x4*0xd77,pendingRecovered[_0x41bbfd(0x210)]=0x5*0x427+0x151+0x1d7*-0xc;}catch(_0x260401){warn(_0x41bbfd(0x29d)+_0x41bbfd(0x1e3)+_0x41bbfd(0x240)+(_0x260401?.[_0x41bbfd(0x2bb)]||_0x260401));}finally{botRef=null;}}export default{'name':name,'version':version,'priority':priority,'configKeys':configKeys,'commands':commands,'initialize':initialize,'onMessage':onMessage,'cleanup':cleanup};