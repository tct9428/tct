const _0xecb24c=_0x1817;(function(_0x152b15,_0x3bad01){const _0x572c66=_0x1817,_0x42f77f=_0x152b15();while(!![]){try{const _0x4cdc38=parseInt(_0x572c66(0x238))/(0x5af+0x1d7b+0x2329*-0x1)+parseInt(_0x572c66(0x298))/(-0x75b*-0x2+-0x180a+0x956)*(parseInt(_0x572c66(0x1d2))/(0x168f+0xa3e*-0x1+-0xc4e))+parseInt(_0x572c66(0x2bc))/(0x47*-0x89+-0x1*-0x1d9+0x6*0x607)+parseInt(_0x572c66(0x2b2))/(0x13a0+-0x2*0x88c+-0x283)*(-parseInt(_0x572c66(0x235))/(0x1ebd+-0x1c6*0x3+-0x1965))+parseInt(_0x572c66(0x365))/(0x17ef+0x1a53+-0x323b*0x1)*(-parseInt(_0x572c66(0x379))/(0xa00+-0x1dcc+0x13d4))+parseInt(_0x572c66(0x2b6))/(0x1741*0x1+-0x7*0x455+0x71b*0x1)*(-parseInt(_0x572c66(0x2a9))/(-0x52+-0x27e*0x1+0x2da))+parseInt(_0x572c66(0x2c6))/(-0x18fa+-0x232c+0x3c31)*(parseInt(_0x572c66(0x35a))/(-0x35b*-0x6+-0x4*0x3a+-0x997*0x2));if(_0x4cdc38===_0x3bad01)break;else _0x42f77f['push'](_0x42f77f['shift']());}catch(_0xa4640e){_0x42f77f['push'](_0x42f77f['shift']());}}}(_0x19bb,0x56cb3+-0xd184b+0xe8a89*0x1));import _0x687865 from'path';import _0x3c027d from'fs/promises';import{createWriteStream}from'fs';import{pipeline}from'stream/promises';import{downloadContentFromMessage,isJidGroup}from'@whiskeysockets/baileys';import{info,warn,error}from'../utils/logger.js';import{getConfig,hotReloadConfig}from'../utils/config.js';import{db}from'../utils/database.js';import _0x5da05a from'node-cache';import{isSudo}from'../utils/sudo.js';import{getBotJid,getBotJidRaw}from'../utils/bot-state.js';import{startManagedListener,stopManagedListener}from'../utils/listenerManager.js';export const name=_0xecb24c(0x2c7)+'overy';function _0x1817(_0x47eb98,_0x957d80){const _0x5c8d40=_0x19bb();return _0x1817=function(_0x412edb,_0x3d24ee){_0x412edb=_0x412edb-(0xc41+-0x392+-0x6e9);let _0x738ce5=_0x5c8d40[_0x412edb];return _0x738ce5;},_0x1817(_0x47eb98,_0x957d80);}export const version=_0xecb24c(0x216);export const priority=-0x2128+0x217d+-0x23;export const commands=['delete'];export const configKeys=[_0xecb24c(0x1ee)+'IA_DIRNAME',_0xecb24c(0x20d)+'OUNCE_MS',_0xecb24c(0x1d5)+_0xecb24c(0x212),_0xecb24c(0x315)+_0xecb24c(0x2e2),'DELETE_CLE'+_0xecb24c(0x28b),_0xecb24c(0x222)+_0xecb24c(0x27b)+_0xecb24c(0x381),_0xecb24c(0x20a)+_0xecb24c(0x2e0)+'E'];const FALLBACKS={'DEBOUNCE_MS':0xbb8,'MEDIA_DIRNAME':'media','DEFAULT_CONCURRENCY':0x2,'CLEANUP_INTERVAL_MS':(0x26de+0xe*-0x1c9+-0xdda)*(0x3cb*-0x5+0x2*0x90f+0x115)*(0x17ad*0x1+0x14bd+-0x2c2e)*(0x2624+-0x1b24+0x4*-0x1c6),'MEDIA_SEND_DELAY_MS':0x12c,'MAX_SEND_RETRIES':0x3,'INITIAL_BACKOFF_MS':0x1f4,'CLEANUP_DAYS':0x3,'QUEUE_MAX_SIZE':0x1f4};let botRef=null,cleanupInterval=null;const messageQueue=[],deletionQueue=[];let activeMessageTasks=0x5fe+0x2184+0x1a*-0x185,activeDeletionTasks=-0xa0*-0x1c+-0x105+-0x107b,MEDIA_DIR=null,DEBOUNCE_DELAY_MS=FALLBACKS['DEBOUNCE_M'+'S'],CONCURRENCY=FALLBACKS[_0xecb24c(0x1ef)+'NCURRENCY'],MEDIA_SEND_DELAY_MS=FALLBACKS[_0xecb24c(0x2ee)+_0xecb24c(0x267)],CLEANUP_INTERVAL=FALLBACKS[_0xecb24c(0x2a3)+'TERVAL_MS'],MAX_SEND_RETRIES=FALLBACKS[_0xecb24c(0x25f)+_0xecb24c(0x2e9)],INITIAL_BACKOFF=FALLBACKS[_0xecb24c(0x376)+'CKOFF_MS'],DELETE_CLEANUP_DAYS=FALLBACKS['CLEANUP_DA'+'YS'],QUEUE_MAX_SIZE=FALLBACKS[_0xecb24c(0x37a)+_0xecb24c(0x1fc)],DEFAULT_SEND_DELETE=![],DELETE_MODE='p',TARGET_JID=null;const nameCache=new _0x5da05a({'stdTTL':0xe10});let flushTimer=null;const pendingRecovered=[];async function ensureDir(_0x41997e){const _0x3fc164=_0xecb24c;try{await _0x3c027d[_0x3fc164(0x33c)](_0x41997e);}catch(_0x20cb0f){if(_0x20cb0f[_0x3fc164(0x295)]===_0x3fc164(0x34a))await _0x3c027d[_0x3fc164(0x347)](_0x41997e,{'recursive':!![]});else throw _0x20cb0f;}}function sleep(_0x4bf6f9){return new Promise(_0x683aa7=>setTimeout(_0x683aa7,_0x4bf6f9));}function normalizeToUserJid(_0xc3398e){const _0x43aa2a=_0xecb24c;try{if(!_0xc3398e||typeof _0xc3398e!=='string')return _0xc3398e;const _0x488018=_0xc3398e[_0x43aa2a(0x388)]('@');if(_0x488018===-(-0x1*0x1b3b+-0xad6+0x2612))return _0xc3398e;const _0xe14906=_0xc3398e['slice'](-0x17*-0xaa+-0x19d6+0xa90,_0x488018),_0x18e4a3=_0xc3398e[_0x43aa2a(0x1c9)](_0x488018),_0x2fff2f=_0xe14906[_0x43aa2a(0x388)](':');if(_0x2fff2f===-(0x1d9*-0x11+-0x17cc+0x3736))return _0xc3398e;return _0xe14906[_0x43aa2a(0x1c9)](-0x1f7+-0x206c+0x2263,_0x2fff2f)+_0x18e4a3;}catch(_0x1a4b32){return _0xc3398e;}}async function refreshConfig(){const _0x1767dc=_0xecb24c;try{const _0x58872a=getConfig()||{};DEFAULT_SEND_DELETE=typeof _0x58872a[_0x1767dc(0x315)+_0x1767dc(0x2e2)]===_0x1767dc(0x1cd)?_0x58872a[_0x1767dc(0x315)+'ND_DELETE']:DEFAULT_SEND_DELETE,DEBOUNCE_DELAY_MS=Number(_0x58872a[_0x1767dc(0x20d)+_0x1767dc(0x26c)]??FALLBACKS[_0x1767dc(0x2e7)+'S']),CONCURRENCY=Number(_0x58872a[_0x1767dc(0x1d5)+'CURRENCY']??_0x58872a[_0x1767dc(0x34b)+'CURRENCY_L'+'IMIT']??FALLBACKS['DEFAULT_CO'+_0x1767dc(0x2f1)]),MEDIA_SEND_DELAY_MS=Number(_0x58872a[_0x1767dc(0x1ee)+_0x1767dc(0x26b)+_0x1767dc(0x37f)]??FALLBACKS['MEDIA_SEND'+_0x1767dc(0x267)]),CLEANUP_INTERVAL=Number(_0x58872a[_0x1767dc(0x222)+'ANUP_INTER'+_0x1767dc(0x381)]??FALLBACKS[_0x1767dc(0x2a3)+_0x1767dc(0x1e8)]),MAX_SEND_RETRIES=Number(_0x58872a['DELETE_MAX'+'_SEND_RETR'+_0x1767dc(0x2b5)]??FALLBACKS[_0x1767dc(0x25f)+_0x1767dc(0x2e9)]),INITIAL_BACKOFF=Number(_0x58872a[_0x1767dc(0x1d6)+_0x1767dc(0x337)+_0x1767dc(0x2f3)]??FALLBACKS['INITIAL_BA'+_0x1767dc(0x200)]),DELETE_CLEANUP_DAYS=Number(_0x58872a['DELETE_CLE'+_0x1767dc(0x28b)]??FALLBACKS[_0x1767dc(0x220)+'YS']),QUEUE_MAX_SIZE=Number(_0x58872a[_0x1767dc(0x20a)+'UE_MAX_SIZ'+'E']??FALLBACKS[_0x1767dc(0x37a)+'SIZE']);const _0x56741f=_0x58872a[_0x1767dc(0x21d)+'OT']&&typeof _0x58872a['PROJECT_RO'+'OT']===_0x1767dc(0x306)?_0x58872a[_0x1767dc(0x21d)+'OT']:process['cwd'](),_0x123e17=_0x687865['resolve'](_0x56741f,_0x1767dc(0x377),_0x1767dc(0x2cd));await ensureDir(_0x123e17),MEDIA_DIR=_0x687865[_0x1767dc(0x325)](_0x123e17,_0x58872a[_0x1767dc(0x1ee)+_0x1767dc(0x218)]??_0x58872a['DELETE_MED'+_0x1767dc(0x2f5)]??FALLBACKS[_0x1767dc(0x35c)+_0x1767dc(0x1e3)]),await ensureDir(MEDIA_DIR);}catch(_0x131162){warn(_0x1767dc(0x232)+_0x1767dc(0x356)+_0x1767dc(0x2d1)+(_0x131162?.[_0x1767dc(0x20e)]||_0x131162));}}try{hotReloadConfig&&hotReloadConfig(()=>{const _0xb92581=_0xecb24c;refreshConfig(),info(_0xb92581(0x36f)+_0xb92581(0x1eb)+_0xb92581(0x31d));});}catch(_0x40ce89){warn(_0xecb24c(0x357)+'otReloadCo'+_0xecb24c(0x36a)+_0xecb24c(0x20f)+'iled:\x20'+(_0x40ce89?.['message']||_0x40ce89));}refreshConfig();const MESSAGES_COLUMNS={'msg_id':_0xecb24c(0x217)+_0xecb24c(0x374),'chat_jid':'TEXT','remote_alt':'TEXT','sender_jid':_0xecb24c(0x1f1),'participant_alt':_0xecb24c(0x1f1),'message_json':_0xecb24c(0x1f1),'timestamp':_0xecb24c(0x2d9),'media_path':_0xecb24c(0x1f1),'saved_at':_0xecb24c(0x2d9),'resent_at':_0xecb24c(0x2d9)};async function ensureTable(){const _0x3a6d21=_0xecb24c;try{const _0x111230=Object[_0x3a6d21(0x224)](MESSAGES_COLUMNS)[_0x3a6d21(0x360)](([_0x13caff,_0xdd4d19])=>_0x13caff+'\x20'+_0xdd4d19)['join'](',\x0a\x20\x20');await db['exec'](_0x3a6d21(0x37b)+_0x3a6d21(0x2e3)+_0x3a6d21(0x30f)+_0x3a6d21(0x22d)+_0x111230+'\x0a);');let _0x47b6fd=[];try{const _0x577e67=await db[_0x3a6d21(0x2c2)](_0x3a6d21(0x2f7)+_0x3a6d21(0x2b9)+'essages\x27)');_0x47b6fd=(_0x577e67||[])['map'](_0x41159c=>_0x41159c['name']);}catch(_0x4444d2){warn(_0x3a6d21(0x1d4)+_0x3a6d21(0x2fd)+'e_info\x20fai'+'led:\x20'+(_0x4444d2?.[_0x3a6d21(0x20e)]||_0x4444d2));}for(const _0x30b366 of Object[_0x3a6d21(0x363)](MESSAGES_COLUMNS)){if(!_0x47b6fd[_0x3a6d21(0x33a)](_0x30b366)){const _0x1660ea=MESSAGES_COLUMNS[_0x30b366];try{await db[_0x3a6d21(0x28f)](_0x3a6d21(0x236)+_0x3a6d21(0x2eb)+'\x20ADD\x20COLUM'+'N\x20'+_0x30b366+'\x20'+_0x1660ea),info('[Delete]\x20a'+_0x3a6d21(0x348)+_0x3a6d21(0x2b1)+_0x3a6d21(0x258)+_0x30b366);}catch(_0x2120b2){warn(_0x3a6d21(0x273)+_0x3a6d21(0x2b0)+_0x3a6d21(0x1f5)+_0x30b366+':\x20'+(_0x2120b2?.[_0x3a6d21(0x20e)]||_0x2120b2));}}}await db['exec']('CREATE\x20TAB'+_0x3a6d21(0x2e3)+'EXISTS\x20del'+_0x3a6d21(0x34e)+_0x3a6d21(0x213)+'y\x20TEXT\x20PRI'+_0x3a6d21(0x28a)+_0x3a6d21(0x26f)+_0x3a6d21(0x2af)+_0x3a6d21(0x290)+_0x3a6d21(0x1df)+'_at\x20INTEGE'+_0x3a6d21(0x247)+_0x3a6d21(0x321));try{const _0x3c5abc=await db[_0x3a6d21(0x289)](_0x3a6d21(0x254)+_0x3a6d21(0x310)+_0x3a6d21(0x301)+'\x20WHERE\x20key'+_0x3a6d21(0x358));if(!_0x3c5abc){const _0x4b7539=Math['floor'](Date[_0x3a6d21(0x23a)]()/(0xeb2+-0x1*-0x110a+-0x1bd4));await db[_0x3a6d21(0x28f)](_0x3a6d21(0x340)+_0x3a6d21(0x389)+_0x3a6d21(0x21b)+_0x3a6d21(0x31e)+_0x3a6d21(0x2b7)+_0x3a6d21(0x2c8)+_0x3a6d21(0x241)+'?)',[_0x4b7539]),DELETE_MODE='p';}else DELETE_MODE=_0x3c5abc['value']==='g'?'g':'p';}catch(_0x55a51c){warn(_0x3a6d21(0x2a6)+'refs\x20(mode'+')\x20load\x20fai'+_0x3a6d21(0x26e)+(_0x55a51c?.[_0x3a6d21(0x20e)]||_0x55a51c));}try{const _0x3a674b=await db[_0x3a6d21(0x289)](_0x3a6d21(0x254)+'ue\x20FROM\x20de'+_0x3a6d21(0x301)+_0x3a6d21(0x26d)+_0x3a6d21(0x29c)+_0x3a6d21(0x35e));TARGET_JID=_0x3a674b?.['value']||null;}catch(_0x43b325){warn('[Delete]\x20t'+_0x3a6d21(0x239)+_0x3a6d21(0x255)+'d:\x20'+(_0x43b325?.[_0x3a6d21(0x20e)]||_0x43b325)),TARGET_JID=null;}}catch(_0x1b11c5){warn(_0x3a6d21(0x274)+_0x3a6d21(0x21a)+_0x3a6d21(0x2ff)+':\x20'+(_0x1b11c5?.['message']||_0x1b11c5));throw _0x1b11c5;}}async function streamMediaToFile(_0x481208,_0x477489){const _0xce7a81=_0xecb24c;try{const _0x21fba5=_0x481208[_0xce7a81(0x20e)][_0x477489+'Message'],_0x141606=await downloadContentFromMessage(_0x21fba5,_0x477489);let _0x55e4d2=_0xce7a81(0x206);if(_0x477489===_0xce7a81(0x2a5))_0x55e4d2=_0xce7a81(0x2ef);else{if(_0x477489==='video'||_0x477489===_0xce7a81(0x204))_0x55e4d2='mp4';else{if(_0x477489===_0xce7a81(0x2e4))_0x55e4d2=_0xce7a81(0x2e1);else{if(_0x477489==='document')_0x55e4d2=_0x21fba5?.[_0xce7a81(0x32c)]?_0x21fba5[_0xce7a81(0x32c)][_0xce7a81(0x2bd)]('.')['pop']():'pdf';else{if(_0x477489===_0xce7a81(0x24f))_0x55e4d2='webp';}}}}const _0x3fe400=_0x481208[_0xce7a81(0x227)]['id']+'.'+_0x55e4d2,_0x476ecf=_0x687865['join'](MEDIA_DIR,_0x3fe400);await pipeline(_0x141606,createWriteStream(_0x476ecf));const _0x27d7f3=await _0x3c027d[_0xce7a81(0x244)](_0x476ecf);if(_0x27d7f3[_0xce7a81(0x335)]===0xd09+-0x3f4+-0x915)return warn(_0xce7a81(0x2ae)+_0xce7a81(0x30b)+_0x476ecf+(_0xce7a81(0x1e4)+_0xce7a81(0x304))),await _0x3c027d['rm'](_0x476ecf,{'force':!![]}),null;return _0x476ecf;}catch(_0x529fb3){return warn(_0xce7a81(0x2ae)+_0xce7a81(0x2f6)+_0xce7a81(0x1cf)+_0xce7a81(0x2c4)+(_0x481208['key']?.['id']||'[no-id]')+':\x20'+(_0x529fb3?.[_0xce7a81(0x20e)]||_0x529fb3)),null;}}async function maybeSaveMedia(_0x47ceb5){const _0x2e2f54=_0xecb24c;try{const _0x24720e=['image',_0x2e2f54(0x32e),_0x2e2f54(0x204),_0x2e2f54(0x2e4),'document',_0x2e2f54(0x24f)];for(const _0x1e3379 of _0x24720e){if(_0x1e3379===_0x2e2f54(0x204)){if(_0x47ceb5[_0x2e2f54(0x20e)]?.['ptvMessage'])return await streamMediaToFile(_0x47ceb5,'ptv');continue;}if(_0x47ceb5[_0x2e2f54(0x20e)]?.[_0x1e3379+_0x2e2f54(0x25e)])return await streamMediaToFile(_0x47ceb5,_0x1e3379);}return null;}catch(_0x20f36b){return warn(_0x2e2f54(0x352)+'aybeSaveMe'+_0x2e2f54(0x384)+'\x20'+(_0x20f36b?.[_0x2e2f54(0x20e)]||_0x20f36b)),null;}}async function insertMessageToDB(_0x1873f4,_0x3bda5f){const _0x14362a=_0xecb24c;try{if(!_0x1873f4||!_0x1873f4[_0x14362a(0x227)])return;const {id:_0x53e3c8,remoteJid:_0x2b2c69,participant:_0xde76c7}=_0x1873f4[_0x14362a(0x227)],_0x182f39=_0xde76c7||_0x2b2c69,_0x57d0f5=typeof _0x1873f4[_0x14362a(0x1e5)+_0x14362a(0x1fe)]===_0x14362a(0x28c)?_0x1873f4[_0x14362a(0x1e5)+'estamp']:_0x1873f4['messageTim'+_0x14362a(0x1fe)]?.[_0x14362a(0x330)]||Math['floor'](Date[_0x14362a(0x23a)]()/(-0x243*0x5+0x1efa+-0xf*0x10d)),_0x1c0963=_0x1873f4[_0x14362a(0x227)]?.['remoteJidA'+'lt']||null,_0x204a8f=_0x1873f4[_0x14362a(0x227)]?.[_0x14362a(0x29a)+'tAlt']||null,_0x4d85b2=Math[_0x14362a(0x29f)](Date[_0x14362a(0x23a)]()/(-0xc0+0x204d*-0x1+0x24f5));if(!_0x53e3c8){warn(_0x14362a(0x35d)+_0x14362a(0x22b)+'geToDB:\x20mi'+'ssing\x20key.'+'id');return;}const _0x234cfb=_0x14362a(0x2c0)+_0x14362a(0x263)+_0x14362a(0x1f7)+_0x14362a(0x207)+_0x14362a(0x2c1)+'\x20remote_al'+_0x14362a(0x24b)+_0x14362a(0x2cb)+_0x14362a(0x25b)+_0x14362a(0x373)+_0x14362a(0x323)+_0x14362a(0x25c)+'ia_path,\x20s'+'aved_at,\x20r'+_0x14362a(0x300)+_0x14362a(0x313)+_0x14362a(0x251)+_0x14362a(0x31a)+_0x14362a(0x202)+'\x20?)',_0x4e80ff=[_0x53e3c8,_0x2b2c69||null,_0x1c0963,_0x182f39||null,_0x204a8f,JSON[_0x14362a(0x1ca)](_0x1873f4),_0x57d0f5,_0x3bda5f||null,_0x4d85b2,null];try{await db[_0x14362a(0x28f)](_0x234cfb,_0x4e80ff);}catch(_0x21ed5a){const _0x4ad261=String(_0x21ed5a?.[_0x14362a(0x20e)]||'');if(_0x4ad261[_0x14362a(0x33a)](_0x14362a(0x281)+_0x14362a(0x22f))){warn(_0x14362a(0x35d)+'nsert\x20fail'+'ed\x20due\x20mis'+_0x14362a(0x283)+'n:\x20'+_0x4ad261+('\x20—\x20ensurin'+_0x14362a(0x29e)+'d\x20retry'));try{await ensureTable(),await db[_0x14362a(0x28f)](_0x234cfb,_0x4e80ff);}catch(_0x28a71d){warn(_0x14362a(0x232)+_0x14362a(0x1fb)+_0x14362a(0x27e)+(_0x28a71d?.[_0x14362a(0x20e)]||_0x28a71d));}}else throw _0x21ed5a;}}catch(_0x816e6e){warn(_0x14362a(0x35d)+_0x14362a(0x22b)+_0x14362a(0x329)+'led:\x20'+(_0x816e6e?.[_0x14362a(0x20e)]||_0x816e6e));}}async function fetchOriginalMessage(_0x136e8a){const _0x254242=_0xecb24c;try{if(!_0x136e8a)return null;const _0x25d3fc=await db[_0x254242(0x289)](_0x254242(0x24d)+_0x254242(0x201)+_0x254242(0x286)+_0x254242(0x33e)+_0x254242(0x223)+_0x254242(0x37e)+'ges\x20WHERE\x20'+_0x254242(0x370),[_0x136e8a]);if(_0x25d3fc)try{return{'msg_id':_0x25d3fc[_0x254242(0x2d5)],'message':JSON[_0x254242(0x2e6)](_0x25d3fc[_0x254242(0x294)+'on']),'media_path':_0x25d3fc[_0x254242(0x287)],'saved_at':_0x25d3fc[_0x254242(0x2fa)]};}catch(_0x5ab88a){return{'msg_id':_0x25d3fc[_0x254242(0x2d5)],'message':null,'media_path':_0x25d3fc[_0x254242(0x287)],'saved_at':_0x25d3fc[_0x254242(0x2fa)]};}return null;}catch(_0x5cf567){return warn(_0x254242(0x273)+_0x254242(0x1d0)+'alMessage\x20'+_0x254242(0x210)+(_0x5cf567?.['message']||_0x5cf567)),null;}}async function deleteMessageRow(_0xebbece){const _0x419cf5=_0xecb24c;try{if(!_0xebbece)return;const _0x419d4c=await db[_0x419cf5(0x289)](_0x419cf5(0x246)+_0x419cf5(0x2bf)+_0x419cf5(0x2ec)+_0x419cf5(0x2c3)+_0x419cf5(0x375),[_0xebbece]);if(_0x419d4c?.[_0x419cf5(0x287)])try{await _0x3c027d['rm'](_0x419d4c[_0x419cf5(0x287)],{'force':!![]});}catch(_0x331dfb){warn('[Delete]\x20f'+_0x419cf5(0x382)+'emove\x20file'+'\x20'+_0x419d4c[_0x419cf5(0x287)]+':\x20'+(_0x331dfb?.[_0x419cf5(0x20e)]||_0x331dfb));}await db[_0x419cf5(0x28f)](_0x419cf5(0x256)+_0x419cf5(0x208)+_0x419cf5(0x309)+_0x419cf5(0x209),[_0xebbece]),info(_0x419cf5(0x1e0)+_0x419cf5(0x22a)+_0x419cf5(0x32d)+'\x20'+_0xebbece);}catch(_0x165200){warn(_0x419cf5(0x1e0)+'eleteMessa'+_0x419cf5(0x1dd)+_0x419cf5(0x24e)+(_0x165200?.[_0x419cf5(0x20e)]||_0x165200));}}async function sendWithRetry(_0x2f8e27,_0x5e345d,_0x2fd789=[]){const _0x3753a6=_0xecb24c,_0x4f9d55=Number(MAX_SEND_RETRIES||FALLBACKS[_0x3753a6(0x25f)+_0x3753a6(0x2e9)]);let _0x4f22af=0x2*0x1226+0x8aa+0x2cf6*-0x1,_0x304c85=Number(INITIAL_BACKOFF||FALLBACKS[_0x3753a6(0x376)+_0x3753a6(0x200)]);const _0x24b69d=[_0x2f8e27,TARGET_JID,getBotJid()][_0x3753a6(0x268)](Boolean)['map'](normalizeToUserJid),_0x2ab7ff=new Set(),_0x3623aa=[];for(const _0x26e3ed of _0x24b69d){if(!_0x26e3ed)continue;!_0x2ab7ff[_0x3753a6(0x332)](_0x26e3ed)&&(_0x2ab7ff[_0x3753a6(0x27f)](_0x26e3ed),_0x3623aa['push'](_0x26e3ed));}let _0x161058=_0x3623aa[_0x3753a6(0x38b)]?_0x3623aa[0x1219*-0x1+-0x1*0x7ec+-0x1a05*-0x1]:null;if(_0x161058&&_0x161058[_0x3753a6(0x2ca)]('@lid')&&typeof botRef?.[_0x3753a6(0x2ed)]?.[_0x3753a6(0x29d)]===_0x3753a6(0x23d))try{const _0x2c2401=await botRef['sock'][_0x3753a6(0x29d)](_0x161058);if(Array['isArray'](_0x2c2401)&&_0x2c2401[0x26bc+0x1dc1*-0x1+-0x8fb]&&_0x2c2401[0x1*0x1a2f+-0x1177+-0x8b8][_0x3753a6(0x23e)])_0x161058=normalizeToUserJid(_0x2c2401[0x1f69+-0x341*0x7+-0x8a2*0x1][_0x3753a6(0x23e)]);}catch(_0x25cb7e){warn('[Delete]\x20o'+_0x3753a6(0x30e)+'mapping\x20fa'+_0x3753a6(0x368)+(_0x25cb7e?.[_0x3753a6(0x20e)]||_0x25cb7e));}while(_0x4f22af<_0x4f9d55){try{if(!_0x161058)throw new Error(_0x3753a6(0x319)+_0x3753a6(0x1ec)+_0x3753a6(0x24a));if(Array[_0x3753a6(0x2a0)](_0x2fd789)&&_0x2fd789['length']&&typeof _0x5e345d===_0x3753a6(0x1f0)&&_0x5e345d!==null)_0x5e345d[_0x3753a6(0x30c)]=_0x2fd789;return await botRef[_0x3753a6(0x266)+'e'](_0x161058,_0x5e345d),!![];}catch(_0x2ec7b7){_0x4f22af++;const _0x94bae3=String(_0x2ec7b7?.[_0x3753a6(0x20e)]||'')[_0x3753a6(0x299)+'e']()[_0x3753a6(0x33a)]('rate')||_0x2ec7b7?.[_0x3753a6(0x318)]===-0x9*0x373+-0x25*-0x10d+-0x629;warn(_0x3753a6(0x2ae)+_0x3753a6(0x343)+'t\x20'+_0x4f22af+_0x3753a6(0x2f9)+_0x161058+_0x3753a6(0x33f)+(_0x2ec7b7?.[_0x3753a6(0x20e)]||_0x2ec7b7));if(_0x4f22af>=_0x4f9d55||!_0x94bae3)return![];await sleep(_0x304c85),_0x304c85*=-0x1c*-0x8a+-0x1299+0x1f*0x1d;}}return![];}function extractContent(_0x3808ff){const _0xdb653=_0xecb24c;if(!_0x3808ff)return'';if(_0x3808ff[_0xdb653(0x20c)+'on'])return _0x3808ff[_0xdb653(0x20c)+'on'];if(_0x3808ff[_0xdb653(0x228)+_0xdb653(0x317)])return _0x3808ff['extendedTe'+_0xdb653(0x317)]['text'];if(_0x3808ff[_0xdb653(0x203)+'ge'])return _0x3808ff[_0xdb653(0x203)+'ge'][_0xdb653(0x234)]||'';if(_0x3808ff[_0xdb653(0x242)+'ge'])return _0x3808ff[_0xdb653(0x242)+'ge'][_0xdb653(0x234)]||'';if(_0x3808ff[_0xdb653(0x31c)])return _0x3808ff['ptvMessage'][_0xdb653(0x234)]||'';if(_0x3808ff[_0xdb653(0x257)+'ge'])return _0x3808ff[_0xdb653(0x257)+'ge']?.[_0xdb653(0x2f0)]?_0xdb653(0x1cc)+'e]':_0xdb653(0x1ea);if(_0x3808ff[_0xdb653(0x2a1)+_0xdb653(0x2a7)])return _0x3808ff['documentMe'+_0xdb653(0x2a7)][_0xdb653(0x32c)]||'';if(_0x3808ff[_0xdb653(0x34c)+'sage'])return _0xdb653(0x355);if(_0x3808ff['pollCreati'+'onMessageV'+'3'])return'[Poll:\x20'+(_0x3808ff[_0xdb653(0x2f2)+_0xdb653(0x2d4)+'3'][_0xdb653(0x34d)]||_0xdb653(0x275))+']';return _0xdb653(0x215);}function isMediaMessage(_0x23472c){const _0x2b02a3=_0xecb24c;if(!_0x23472c)return![];const _0x446952=Object[_0x2b02a3(0x363)](_0x23472c||{});for(const _0x5ab970 of _0x446952){if(_0x5ab970['endsWith'](_0x2b02a3(0x25e))&&[_0x2b02a3(0x203)+'ge',_0x2b02a3(0x242)+'ge',_0x2b02a3(0x257)+'ge','documentMe'+_0x2b02a3(0x2a7),_0x2b02a3(0x34c)+_0x2b02a3(0x387),_0x2b02a3(0x31c)]['includes'](_0x5ab970))return!![];}return![];}async function buildPayloadForSavedFile(_0x5a2f13,_0x4e31a8){const _0x16aff0=_0xecb24c,_0x32f125=_0x4e31a8?.[_0x16aff0(0x20e)]||{},_0x2ad0e8=extractContent(_0x32f125)||undefined;try{await _0x3c027d[_0x16aff0(0x33c)](_0x5a2f13);}catch(_0x52ad41){return warn(_0x16aff0(0x1cb)+'edia\x20file\x20'+_0x16aff0(0x359)+_0x16aff0(0x2e8)+_0x5a2f13),null;}if(_0x32f125[_0x16aff0(0x34c)+_0x16aff0(0x387)])return{'sticker':{'url':_0x5a2f13}};if(_0x32f125[_0x16aff0(0x31c)])return{'video':{'url':_0x5a2f13},'ptv':!![],'caption':_0x2ad0e8,'mimetype':_0x32f125[_0x16aff0(0x31c)]?.[_0x16aff0(0x2d8)]};if(_0x32f125[_0x16aff0(0x242)+'ge'])return{'video':{'url':_0x5a2f13},'caption':_0x2ad0e8,'gifPlayback':!!_0x32f125[_0x16aff0(0x242)+'ge']?.[_0x16aff0(0x243)+'k'],'mimetype':_0x32f125['videoMessa'+'ge']?.[_0x16aff0(0x2d8)]};if(_0x32f125[_0x16aff0(0x203)+'ge'])return{'image':{'url':_0x5a2f13},'caption':_0x2ad0e8};if(_0x32f125['audioMessa'+'ge'])return{'audio':{'url':_0x5a2f13},'ptt':!!_0x32f125['audioMessa'+'ge']?.[_0x16aff0(0x2f0)],'mimetype':_0x32f125[_0x16aff0(0x257)+'ge']?.['mimetype'],'seconds':_0x32f125[_0x16aff0(0x257)+'ge']?.['seconds']};if(_0x32f125['documentMe'+'ssage'])return{'document':{'url':_0x5a2f13,'fileName':_0x32f125[_0x16aff0(0x2a1)+_0x16aff0(0x2a7)]?.[_0x16aff0(0x32c)]||_0x687865[_0x16aff0(0x2ac)](_0x5a2f13)},'mimetype':_0x32f125[_0x16aff0(0x2a1)+_0x16aff0(0x2a7)]?.['mimetype'],'caption':_0x32f125[_0x16aff0(0x2a1)+_0x16aff0(0x2a7)]?.[_0x16aff0(0x234)]||_0x2ad0e8};return{'document':{'url':_0x5a2f13,'fileName':_0x687865[_0x16aff0(0x2ac)](_0x5a2f13)},'caption':_0x2ad0e8};}async function processDeletionItem(_0x41b150){const _0x2506b8=_0xecb24c;try{const _0x5812b7=_0x41b150[_0x2506b8(0x363)]||[];if(!_0x5812b7['length'])return;for(const _0x4b6897 of _0x5812b7){const _0x1e906a=await fetchOriginalMessage(_0x4b6897['id']);if(!_0x1e906a||!_0x1e906a[_0x2506b8(0x20e)])continue;const _0x407cb0=_0x1e906a[_0x2506b8(0x20e)],_0x3a232f=getBotJidRaw(),_0x15e623=_0x407cb0[_0x2506b8(0x227)]?.[_0x2506b8(0x29a)+'t']||_0x407cb0[_0x2506b8(0x227)]?.[_0x2506b8(0x2f4)];if(_0x407cb0['key']?.[_0x2506b8(0x31f)]||_0x15e623===_0x3a232f)continue;const _0x3d2f0e=_0x407cb0[_0x2506b8(0x227)][_0x2506b8(0x29a)+'t']||_0x407cb0[_0x2506b8(0x227)][_0x2506b8(0x2f4)],_0x4a1dc9=extractContent(_0x407cb0['message']);let _0x204da7=nameCache['get'](_0x3d2f0e);if(!_0x204da7){try{const [_0x4f6e0d]=await botRef[_0x2506b8(0x2ed)][_0x2506b8(0x29d)](_0x3d2f0e);_0x204da7=_0x4f6e0d?.[_0x2506b8(0x380)]||'~'+_0x3d2f0e[_0x2506b8(0x2bd)]('@')[0x1*0x12a+0x381*0x7+-0x19b1];}catch{_0x204da7='~'+_0x3d2f0e[_0x2506b8(0x2bd)]('@')[0xe7*-0x3+0xe7a+-0x83*0x17];}nameCache[_0x2506b8(0x248)](_0x3d2f0e,_0x204da7);}let _0x430268='';if(isJidGroup(_0x407cb0[_0x2506b8(0x227)][_0x2506b8(0x2f4)]))try{_0x430268=(await botRef[_0x2506b8(0x2ed)][_0x2506b8(0x1db)+_0x2506b8(0x2dd)](_0x407cb0[_0x2506b8(0x227)][_0x2506b8(0x2f4)]))[_0x2506b8(0x280)];}catch{_0x430268='[Unknown\x20G'+_0x2506b8(0x2fb);}deletionPush({'msg_id':_0x1e906a[_0x2506b8(0x2d5)],'sender':_0x3d2f0e,'name':_0x204da7,'group':_0x430268,'content':_0x4a1dc9,'mediaPath':_0x1e906a[_0x2506b8(0x287)]||null,'originalMessage':_0x407cb0});}}catch(_0x122803){warn('[Delete]\x20p'+_0x2506b8(0x265)+'tionItem\x20e'+_0x2506b8(0x2d0)+(_0x122803?.[_0x2506b8(0x20e)]||_0x122803));}}async function deletionWorker(){const _0x222445=_0xecb24c,_0x49e4f7=CONCURRENCY||FALLBACKS[_0x222445(0x1ef)+'NCURRENCY'];while(deletionQueue['length']>0x1*0x4cf+0x23b2+0x1*-0x2881&&activeDeletionTasks<_0x49e4f7){const _0x19d371=deletionQueue[_0x222445(0x339)]();if(!_0x19d371)break;activeDeletionTasks++,((async()=>{const _0x28bf04=_0x222445;try{await processDeletionItem(_0x19d371);}catch(_0x202b74){warn(_0x28bf04(0x1e0)+'eletionWor'+'ker\x20item\x20e'+_0x28bf04(0x2d0)+(_0x202b74?.[_0x28bf04(0x20e)]||_0x202b74));}finally{activeDeletionTasks--,setImmediate(()=>{const _0x1e80bb=_0x28bf04;if(deletionQueue[_0x1e80bb(0x38b)])deletionWorker()[_0x1e80bb(0x252)](()=>{});});}})());}}function deletionPush(_0x55d18d){const _0x2777e9=_0xecb24c;pendingRecovered[_0x2777e9(0x214)](_0x55d18d),clearTimeout(flushTimer),flushTimer=setTimeout(()=>{const _0x4b87c4=_0x2777e9,_0x172703=pendingRecovered[_0x4b87c4(0x312)](-0x33*0xb+0xfd+-0x134*-0x1,pendingRecovered[_0x4b87c4(0x38b)]);((async()=>{const _0x17dfd3=_0x4b87c4;try{await flushRecoveredBatch(_0x172703);}catch(_0x392943){warn(_0x17dfd3(0x273)+_0x17dfd3(0x296)+'redBatch\x20e'+_0x17dfd3(0x2d0)+(_0x392943?.[_0x17dfd3(0x20e)]||_0x392943));}})());},DEBOUNCE_DELAY_MS||FALLBACKS[_0x2777e9(0x2e7)+'S']);}function resolveDeleteTarget(_0x393b10){const _0x101a61=getBotJid();if(DELETE_MODE==='g'&&TARGET_JID){if(TARGET_JID===_0x393b10)return _0x101a61;return TARGET_JID;}return _0x101a61;}async function saveDeleteMode(_0x4efff5){const _0x442fab=_0xecb24c;try{const _0x1b8af6=_0x4efff5==='g'?'g':'p',_0x4f4c43=Math[_0x442fab(0x29f)](Date[_0x442fab(0x23a)]()/(-0x1a60+0x162b+0x81d));return await db['run'](_0x442fab(0x340)+'O\x20delete_p'+_0x442fab(0x21b)+_0x442fab(0x31e)+'dated_at)\x20'+_0x442fab(0x2c8)+_0x442fab(0x1d9)+_0x442fab(0x342)+'ICT(key)\x20D'+_0x442fab(0x28d)+_0x442fab(0x20b)+_0x442fab(0x2da)+_0x442fab(0x383)+_0x442fab(0x1f6)+_0x442fab(0x1c6)+_0x442fab(0x1f8),[_0x1b8af6,_0x4f4c43]),DELETE_MODE=_0x1b8af6,info('[Delete]\x20m'+_0x442fab(0x336)+'\x20'+DELETE_MODE),!![];}catch(_0x5c8e0c){return warn(_0x442fab(0x2ae)+_0x442fab(0x24c)+'ode\x20failed'+':\x20'+(_0x5c8e0c?.['message']||_0x5c8e0c)),![];}}async function saveDeleteTarget(_0x37ea47){const _0x42cef9=_0xecb24c;try{const _0x1ef3ad=Math[_0x42cef9(0x29f)](Date[_0x42cef9(0x23a)]()/(0x1b96+-0x2336+0xb88));if(!_0x37ea47)return await db[_0x42cef9(0x28f)](_0x42cef9(0x256)+_0x42cef9(0x276)+_0x42cef9(0x288)+_0x42cef9(0x1ed)+_0x42cef9(0x364)),TARGET_JID=null,info(_0x42cef9(0x21f)+_0x42cef9(0x239)+_0x42cef9(0x334)),!![];else{const _0x1bd882=normalizeToUserJid(_0x37ea47);return await db[_0x42cef9(0x28f)](_0x42cef9(0x340)+_0x42cef9(0x389)+'refs\x20(key,'+'\x20value,\x20up'+_0x42cef9(0x2b7)+_0x42cef9(0x37d)+_0x42cef9(0x308)+',\x20?,\x20?)\x20ON'+'\x20CONFLICT('+_0x42cef9(0x23c)+_0x42cef9(0x386)+_0x42cef9(0x346)+_0x42cef9(0x314)+_0x42cef9(0x36b)+_0x42cef9(0x272)+'.updated_a'+'t',[_0x1bd882,_0x1ef3ad]),TARGET_JID=_0x1bd882,info(_0x42cef9(0x21f)+_0x42cef9(0x239)+_0x42cef9(0x27c)+TARGET_JID),!![];}}catch(_0x1770f0){return warn('[Delete]\x20s'+_0x42cef9(0x22c)+_0x42cef9(0x2ce)+_0x42cef9(0x2ad)+(_0x1770f0?.[_0x42cef9(0x20e)]||_0x1770f0)),![];}}async function flushRecoveredBatch(_0x9a5f5d){const _0x4170f2=_0xecb24c;if(!_0x9a5f5d||_0x9a5f5d['length']===0x941+-0x1060*-0x2+-0x2a01*0x1)return;if(!DEFAULT_SEND_DELETE){info(_0x4170f2(0x226)+_0x4170f2(0x2e5)+_0x4170f2(0x23b)+_0x4170f2(0x2c5)+_0x4170f2(0x345)+_0x4170f2(0x1e7)+'s.');return;}const _0x20acfc=_0x9a5f5d[_0x4170f2(0x1f2)](_0x4a31bb=>_0x4a31bb[_0x4170f2(0x260)+_0x4170f2(0x2a7)])?.[_0x4170f2(0x260)+_0x4170f2(0x2a7)]?.['key']?.[_0x4170f2(0x2f4)]||null,_0x187327=resolveDeleteTarget(_0x20acfc)||getBotJid();if(!_0x187327){warn(_0x4170f2(0x305)+_0x4170f2(0x2ab)+'get\x20availa'+_0x4170f2(0x331));return;}const _0xc4b680=[...new Set(_0x9a5f5d[_0x4170f2(0x360)](_0x1ef55e=>_0x1ef55e[_0x4170f2(0x369)]))],_0x12615b=_0x9a5f5d[_0x4170f2(0x360)](_0x241a0a=>_0x4170f2(0x2dc)+_0x241a0a[_0x4170f2(0x369)][_0x4170f2(0x2bd)]('@')[-0x1aec+-0x528*0x1+0x4*0x805]+'\x20('+_0x241a0a['name']+')\x0a'+(_0x241a0a[_0x4170f2(0x361)]?_0x4170f2(0x22e)+_0x241a0a['group']+'\x0a':'')+(_0x4170f2(0x21e)+'\x20'+_0x241a0a[_0x4170f2(0x27a)]+'\x0a')+'─'['repeat'](-0xcbd*-0x1+-0xf5b+-0x2b7*-0x1))[_0x4170f2(0x325)]('\x0a'),_0x150328=_0x4170f2(0x34f)+_0x9a5f5d[_0x4170f2(0x38b)]+(_0x4170f2(0x253)+_0x4170f2(0x1c8)+'COVERED*\x20🗑'+'\x0a\x0a');try{const _0x47a2fb=await sendWithRetry(_0x187327,{'text':_0x150328+_0x12615b},_0xc4b680);if(!_0x47a2fb)warn(_0x4170f2(0x2ae)+_0x4170f2(0x264)+_0x4170f2(0x354)+_0x4170f2(0x269));}catch(_0x12d890){warn(_0x4170f2(0x2ae)+_0x4170f2(0x264)+_0x4170f2(0x36c)+_0x4170f2(0x1d7)+(_0x12d890?.[_0x4170f2(0x20e)]||_0x12d890));}for(const _0x54bd27 of _0x9a5f5d){try{const _0x1a8dec=_0x54bd27['mediaPath'],_0x5e01d1=_0x54bd27['originalMe'+'ssage'],_0x2de636=!!_0x1a8dec||isMediaMessage(_0x5e01d1?.[_0x4170f2(0x20e)]);if(!_0x2de636){try{await deleteMessageRow(_0x54bd27[_0x4170f2(0x2d5)]);}catch(_0x441248){}continue;}const _0x518a39=_0x5e01d1?.[_0x4170f2(0x227)]?.['id']||_0x4170f2(0x233),_0x2deb27=await buildPayloadForSavedFile(_0x1a8dec,_0x5e01d1);if(_0x2deb27){const _0x49241a=await sendWithRetry(_0x187327,_0x2deb27);if(_0x49241a){info(_0x4170f2(0x232)+_0x4170f2(0x2d3)+_0x4170f2(0x25a)+_0x4170f2(0x328)+_0x518a39+_0x4170f2(0x378)+_0x187327),await deleteMessageRow(_0x54bd27[_0x4170f2(0x2d5)]),await sleep(MEDIA_SEND_DELAY_MS||FALLBACKS[_0x4170f2(0x2ee)+_0x4170f2(0x267)]);continue;}else warn('[Delete]\x20m'+_0x4170f2(0x250)+'failed\x20for'+'\x20'+_0x518a39+'.');}try{const _0x35fad6=await sendWithRetry(_0x187327,{'forward':_0x5e01d1});if(_0x35fad6){info(_0x4170f2(0x232)+_0x4170f2(0x271)+_0x4170f2(0x1dc)+_0x4170f2(0x26a)+'r\x20'+_0x518a39+_0x4170f2(0x378)+_0x187327),await deleteMessageRow(_0x54bd27['msg_id']),await sleep(MEDIA_SEND_DELAY_MS||FALLBACKS[_0x4170f2(0x2ee)+_0x4170f2(0x267)]);continue;}}catch(_0x1be3b1){warn('[Delete]\x20l'+_0x4170f2(0x302)+_0x4170f2(0x307)+'\x20'+(_0x1be3b1?.['message']||_0x1be3b1));}warn('[Delete]\x20u'+_0x4170f2(0x1da)+'eliver\x20med'+_0x4170f2(0x229)+_0x518a39+(_0x4170f2(0x1e2)+_0x4170f2(0x1de)+_0x4170f2(0x2be)+'g\x20in\x20DB\x20fo'+_0x4170f2(0x27d)+'try/cleanu'+'p.'));}catch(_0x406ed5){warn(_0x4170f2(0x273)+_0x4170f2(0x29b)+_0x4170f2(0x327)+':\x20'+(_0x406ed5?.[_0x4170f2(0x20e)]||_0x406ed5));}}}async function rawMessagesUpsertHandler({messages:_0x1506a7}){const _0x533ff3=_0xecb24c;try{if(!_0x1506a7||!Array[_0x533ff3(0x2a0)](_0x1506a7))return;for(const _0xb2ef34 of _0x1506a7){if(!_0xb2ef34||!_0xb2ef34[_0x533ff3(0x20e)]||_0xb2ef34[_0x533ff3(0x227)]?.[_0x533ff3(0x2f4)]===_0x533ff3(0x38a)+_0x533ff3(0x30a))continue;if(_0xb2ef34[_0x533ff3(0x227)]?.[_0x533ff3(0x31f)])continue;if(messageQueue['length']>=QUEUE_MAX_SIZE){warn(_0x533ff3(0x1cb)+_0x533ff3(0x1f9)+'e\x20queue\x20is'+'\x20full\x20('+messageQueue['length']+(_0x533ff3(0x23f)+_0x533ff3(0x277)+'\x20message.'));continue;}messageQueue[_0x533ff3(0x214)](_0xb2ef34),setImmediate(()=>{messageWorker()['catch'](()=>{});});const _0x2f2e05=_0xb2ef34[_0x533ff3(0x20e)]?.[_0x533ff3(0x2b4)+_0x533ff3(0x2a7)];if(_0x2f2e05?.['type']===-0x52c+0x1*0x18c2+-0x1396&&_0x2f2e05?.[_0x533ff3(0x227)]){if(deletionQueue[_0x533ff3(0x38b)]>=QUEUE_MAX_SIZE){warn(_0x533ff3(0x226)+'eletion\x20pr'+_0x533ff3(0x350)+_0x533ff3(0x25d)+_0x533ff3(0x2bb)+deletionQueue['length']+(_0x533ff3(0x23f)+'g\x20deletion'+_0x533ff3(0x1d1)));continue;}deletionQueue[_0x533ff3(0x214)]({'keys':[_0x2f2e05[_0x533ff3(0x227)]],'remoteJid':_0xb2ef34['key'][_0x533ff3(0x2f4)]}),setImmediate(()=>{const _0x38c74e=_0x533ff3;deletionWorker()[_0x38c74e(0x252)](()=>{});});}}}catch(_0x2ea29e){warn(_0x533ff3(0x232)+_0x533ff3(0x225)+_0x533ff3(0x270)+_0x533ff3(0x33d)+'\x20'+(_0x2ea29e?.['message']||_0x2ea29e));}}async function processMessageItem(_0x405b2d){const _0x4ef04c=_0xecb24c;try{if(!_0x405b2d||!_0x405b2d['message']||_0x405b2d['key']?.[_0x4ef04c(0x31f)])return;const _0x392e79=await maybeSaveMedia(_0x405b2d);await insertMessageToDB(_0x405b2d,_0x392e79);}catch(_0x2c377b){warn('[Delete]\x20p'+_0x4ef04c(0x221)+_0x4ef04c(0x353)+'ror:\x20'+(_0x2c377b?.[_0x4ef04c(0x20e)]||_0x2c377b));}}async function messageWorker(){const _0x326347=_0xecb24c,_0x5d4b9d=CONCURRENCY||FALLBACKS[_0x326347(0x1ef)+_0x326347(0x2f1)];while(messageQueue[_0x326347(0x38b)]>0x1*-0x1b1d+-0x22c+0x7*0x42f&&activeMessageTasks<_0x5d4b9d){const _0x1e2f4b=messageQueue['shift']();if(!_0x1e2f4b)break;activeMessageTasks++,((async()=>{const _0x4328e4=_0x326347;try{await processMessageItem(_0x1e2f4b);}catch(_0x5af97d){warn(_0x4328e4(0x352)+_0x4328e4(0x291)+_0x4328e4(0x341)+_0x4328e4(0x2f8)+(_0x5af97d?.[_0x4328e4(0x20e)]||_0x5af97d));}finally{activeMessageTasks--,setImmediate(()=>{const _0x399114=_0x4328e4;if(messageQueue['length'])messageWorker()[_0x399114(0x252)](()=>{});});}})());}}function _0x19bb(){const _0x5572de=['ailed\x20to\x20s','GROUP\x20(','message_js','code','lushRecove','[Delete]\x20o','4sGOtDU','toLowerCas','participan','lush\x20loop\x20','=\x27target_j','onWhatsApp','g\x20table\x20an','floor','isArray','documentMe','nitialized','CLEANUP_IN','\x20than\x20','image','[Delete]\x20p','ssage','\x20GROUP.\x20','60xYZpMq','\x20delete\x20<j','o\x20send\x20tar','basename','ed:\x20','[Delete]\x20s','e\x20TEXT\x20NOT','ailed\x20to\x20a','ng\x20column\x20','1165265reaJua','_id\x20IN\x20(','protocolMe','IES','1345797SGgbwD','dated_at)\x20','\x20days*','le_info(\x27m','leanup\x20err','ll\x20(','658600idhnfJ','split','d).\x20Leavin','ia_path\x20FR','INSERT\x20OR\x20','\x20chat_jid,','all','s\x20WHERE\x20ms','led\x20for\x20','alse\x20—\x20ski','22RerjZK','delete-rec','VALUES\x20(\x27m','WHERE\x20save','endsWith','jid,\x20parti','remove','delete','arget\x20fail','failed:\x20','rror:\x20','ig\x20error:\x20','plete.','ecovered\x20m','onMessageV','msg_id','rmine\x20comm','\x20JID','mimetype','INTEGER','xcluded.va','\x20delete\x20p|','👤\x20From:\x20@','ata','id>\x20\x20\x20\x20\x20->','_path,\x20sav','UE_MAX_SIZ','ogg','ND_DELETE','LE\x20IF\x20NOT\x20','audio','EFAULT_SEN','parse','DEBOUNCE_M','at\x20path:\x20','ETRIES','t\x20JID.','E\x20messages','OM\x20message','sock','MEDIA_SEND','jpg','ptt','NCURRENCY','pollCreati','FF_MS','remoteJid','IA_DIR','treamMedia','PRAGMA\x20tab','ror:\x20','\x20to\x20','saved_at','roup]','and\x20reply\x20','RAGMA\x20tabl',':\x20*','\x20top\x20error','esent_at)\x0a','lete_prefs','egacy\x20forw','nMessage\x20e','\x20deleting.','[Delete]\x20n','string','ard\x20error:','arget_jid\x27','\x20WHERE\x20msg','adcast','aved\x20file\x20','mentions','\x20days)','nWhatsApp\x20','EXISTS\x20mes','ue\x20FROM\x20de','ave\x20target','splice','\x20\x20\x20\x20\x20\x20VALU','ded.value,','DEFAULT_SE','ear\x20\x20\x20\x20\x20->','xtMessage','status','no\x20send\x20ta','?,\x20?,\x20?,\x20?','vered\x20to\x20a','ptvMessage','d\x20config.','\x20value,\x20up','fromMe','\x20delete\x20cl','0\x0a\x20\x20\x20\x20);','not\x20set','json,\x20time','target.','join','\x20PM.','item\x20error','for\x20','geToDB\x20fai','messages.u','isCommand','fileName','sages\x20row:','video','covery\x20Set','low','ble','has','is\x20set.','cleared','size','ode\x20saved:','TIAL_BACKO','utoCleanOl','shift','includes','t\x20group\x20JI','access','ler\x20error:','edia_path,','\x20failed:\x20','INSERT\x20INT','er\x20item\x20er',')\x20ON\x20CONFL','end\x20attemp','psert','pping\x20reco','alue=exclu','mkdir','dded\x20missi','unset','ENOENT','MODULE_CON','stickerMes','name','ete_prefs\x20','🗑\x20*','ocessing\x20q','\x20delete\x20g|','[Delete]\x20m','ageItem\x20er','d\x20may\x20have','[Sticker]','efreshConf','[Delete]\x20h','=\x27mode\x27','not\x20found\x20','2963796HGeAuB','Usage:\x0a','MEDIA_DIRN','[Delete]\x20i','id\x27','leanup\x20com','map','group','[delete]\x20F','keys','et_jid\x27','20041qlQKHT','group\x20JID\x20','ges\x20(older','iled:\x20','sender','nfig\x20regis','\x20updated_a','d\x20unexpect','d_at\x20IS\x20NO','annot\x20dete','[Delete]\x20H','msg_id=?','\x20Recovery\x20','<\x20?',',\x20message_','RY\x20KEY','g_id=?','INITIAL_BA','data','\x20->\x20','608NkGoYs','QUEUE_MAX_','CREATE\x20TAB','ode\x20set\x20to','VALUES\x20(\x27t','FROM\x20messa','LAY_MS','notify','VAL_MS','ailed\x20to\x20r','lue,\x20updat','dia\x20error:','\x20send\x20reco','DATE\x20SET\x20v','sage','indexOf','O\x20delete_p','status@bro','length','uded.updat','ailed\x20to\x20c','ESSAGES\x20RE','slice','stringify','[Delete]\x20M','[Voice\x20not','boolean','Days:\x20','ToFile\x20fai','etchOrigin','\x20event.','425793MrpDwL','[delete]\x20M','[Delete]\x20P','DELETE_CON','DELETE_INI','ed\x20error:\x20','leaning\x20','ode\x27,\x20?,\x20?','nable\x20to\x20d','groupMetad','riginal\x20fo','geRow\x20erro','mpts\x20faile','\x20\x20\x20updated','[Delete]\x20d','\x20Send\x20Mode','\x20(all\x20atte','AME','\x20is\x20empty,','messageTim','[Delete]\x20c','vered\x20send','TERVAL_MS','y:\x20','[Audio]','ot-reloade','rget\x20avail','\x20key=\x27targ','DELETE_MED','DEFAULT_CO','object','TEXT','find','led\x20fatall','\x20clear\x20tar','dd\x20column\x20','ed_at=excl','TO\x20message','ed_at','essage\x20sav','vered\x20to\x20b','etry\x20inser','SIZE','*Delete\x20Re','estamp','\x20messages\x20','CKOFF_MS','_id,\x20messa',',\x20?,\x20?,\x20?,','imageMessa','ptv','nitial\x20cle','bin','s\x20(msg_id,','M\x20messages','_id=?','DELETE_QUE','ET\x20value=e','conversati','DELETE_DEB','message','tration\x20fa','error:\x20','anup\x20error','CURRENCY','(\x0a\x20\x20\x20\x20\x20\x20ke','push','[Media]','5.0.0','TEXT\x20PRIMA','IA_DIRNAME','tings\x20(PM-','nsureTable','refs\x20(key,','ailed\x20dele','PROJECT_RO','📝\x20Content:','[Delete]\x20t','CLEANUP_DA','rocessMess','DELETE_CLE','\x20saved_at\x20','entries','awMessages','[Delete]\x20D','key','extendedTe','ia\x20for\x20','eleted\x20mes','nsertMessa','aveDeleteT','sages\x20(\x0a\x20\x20','🗨\x20Group:\x20','umn','\x20group:\x20','.\x20Mode:\x20','[Delete]\x20r','(no-id)','caption','6PvsNNS','ALTER\x20TABL','[Delete]\x20C','855650GkROwl','arget_jid\x20','now','D_DELETE\x20f','key)\x20DO\x20UP','function','jid',').\x20Droppin','arget\x20JID\x20','ode\x27,\x27p\x27,\x20','videoMessa','gifPlaybac','stat','delete\x20mod','SELECT\x20med','R\x20DEFAULT\x20','set','tatus:*\x0a','able','t,\x20sender_','aveDeleteM','SELECT\x20msg','r:\x20','sticker','edia\x20send\x20','ES\x20(?,\x20?,\x20','catch','\x20DELETED\x20M','SELECT\x20val','load\x20faile','DELETE\x20FRO','audioMessa','messages.','es\x20bot\x20arg','edia\x20sent\x20','cipant_alt','stamp,\x20med','ueue\x20is\x20fu','Message','MAX_SEND_R','originalMe','_id,\x20media','B\x20initiali','REPLACE\x20IN','ummary\x20sen','rocessDele','sendMessag','_DELAY_MS','filter','\x20failed','rwarded\x20fo','IA_SEND_DE','OUNCE_MS','\x20WHERE\x20key','led:\x20','\x20\x20\x20\x20\x20\x20valu','UpsertHand','ecovered\x20o','t=excluded','[Delete]\x20f','[Delete]\x20e','poll','M\x20delete_p','g\x20incoming','*Current\x20S','[Delete]\x20I','content','ANUP_INTER','saved:\x20','r\x20later\x20re','t\x20failed:\x20','add','subject','has\x20no\x20col','ed_at\x20FROM','sing\x20colum','trim','[Delete]\x20a','ge_json,\x20m','media_path','refs\x20WHERE','get','MARY\x20KEY,\x0a','ANUP_DAYS','number','O\x20UPDATE\x20S','group\x20\x20\x20->','run','\x20NULL,\x0a\x20\x20\x20','essageWork'];_0x19bb=function(){return _0x5572de;};return _0x19bb();}async function autoCleanOldMessagesSafe(){const _0x1b6418=_0xecb24c;try{await autoCleanOldMessages();}catch(_0x2a0e46){warn(_0x1b6418(0x285)+_0x1b6418(0x338)+'dMessagesS'+'afe\x20error:'+'\x20'+(_0x2a0e46?.['message']||_0x2a0e46));}}async function autoCleanOldMessages(){const _0x4f3c54=_0xecb24c;try{const _0x512558=Math[_0x4f3c54(0x29f)](Date[_0x4f3c54(0x23a)]()/(-0xdf6*-0x1+-0x17c8+0xdba))-Number(DELETE_CLEANUP_DAYS||FALLBACKS[_0x4f3c54(0x220)+'YS'])*(-0x2574+0x1a50+-0x2cf*-0x4)*(0x1f03*0x1+0x1*-0x1dad+-0x11a)*(0xbef+0x1ce4+-0x2897*0x1),_0x59ac7d=await db[_0x4f3c54(0x2c2)](_0x4f3c54(0x24d)+_0x4f3c54(0x261)+_0x4f3c54(0x2df)+_0x4f3c54(0x282)+_0x4f3c54(0x1ff)+_0x4f3c54(0x2c9)+_0x4f3c54(0x36d)+'T\x20NULL\x20AND'+_0x4f3c54(0x223)+_0x4f3c54(0x372),[_0x512558]);if(!_0x59ac7d||_0x59ac7d['length']===-0x189b*-0x1+0xc81+-0x251c)return;info(_0x4f3c54(0x1e6)+_0x4f3c54(0x1d8)+_0x59ac7d[_0x4f3c54(0x38b)]+('\x20old\x20messa'+_0x4f3c54(0x367)+_0x4f3c54(0x2a4))+DELETE_CLEANUP_DAYS+_0x4f3c54(0x30d));for(const _0x312088 of _0x59ac7d){if(_0x312088[_0x4f3c54(0x287)])try{await _0x3c027d['rm'](_0x312088[_0x4f3c54(0x287)],{'force':!![]});}catch(_0x202534){warn(_0x4f3c54(0x273)+_0x4f3c54(0x21c)+'ting\x20file\x20'+_0x312088[_0x4f3c54(0x287)]+':\x20'+(_0x202534?.[_0x4f3c54(0x20e)]||_0x202534));}}const _0x24a8c1=_0x59ac7d[_0x4f3c54(0x360)](_0x7eb4da=>_0x7eb4da[_0x4f3c54(0x2d5)]),_0x2cda13=0x1ec+0x1f*-0xdb+0x1961;for(let _0x1c47f8=0x1*-0x1a03+0x8*0x33a+0x33;_0x1c47f8<_0x24a8c1[_0x4f3c54(0x38b)];_0x1c47f8+=_0x2cda13){const _0x428f08=_0x24a8c1[_0x4f3c54(0x1c9)](_0x1c47f8,_0x1c47f8+_0x2cda13),_0x2d9afd=_0x428f08[_0x4f3c54(0x360)](()=>'?')['join'](',');await db[_0x4f3c54(0x28f)]('DELETE\x20FRO'+_0x4f3c54(0x208)+_0x4f3c54(0x309)+_0x4f3c54(0x2b3)+_0x2d9afd+')',_0x428f08);}info(_0x4f3c54(0x1e6)+_0x4f3c54(0x35f)+_0x4f3c54(0x2d2));}catch(_0x318541){warn(_0x4f3c54(0x285)+'utoCleanOl'+'dMessages\x20'+_0x4f3c54(0x2cf)+(_0x318541?.[_0x4f3c54(0x20e)]||_0x318541));}}const processedCmdKeys=new Map(),CMD_DEDUPE_TTL_MS=(0x13*0x16a+-0xefc+-0x2f1*0x4)*(0x1d80+0x1b17+-0x34af);function markCmdProcessed(_0x4d1f13){const _0x4ca439=_0xecb24c;if(!_0x4d1f13)return;if(processedCmdKeys[_0x4ca439(0x332)](_0x4d1f13))try{clearTimeout(processedCmdKeys[_0x4ca439(0x289)](_0x4d1f13));}catch(_0xe0f75f){};const _0x2ff949=setTimeout(()=>processedCmdKeys[_0x4ca439(0x2cd)](_0x4d1f13),CMD_DEDUPE_TTL_MS);processedCmdKeys['set'](_0x4d1f13,_0x2ff949);}function isCmdProcessed(_0x55d3e5){const _0x57155d=_0xecb24c;return _0x55d3e5&&processedCmdKeys[_0x57155d(0x332)](_0x55d3e5);}export async function onMessage(_0xf4a1bf){const _0xf44fe2=_0xecb24c;try{if(!_0xf4a1bf||!_0xf4a1bf[_0xf44fe2(0x227)]||!_0xf4a1bf[_0xf44fe2(0x20e)]||!_0xf4a1bf[_0xf44fe2(0x32b)])return;if(isJidGroup(_0xf4a1bf[_0xf44fe2(0x227)][_0xf44fe2(0x2f4)]))return;const _0x18f8b6=_0xf4a1bf['key'][_0xf44fe2(0x31f)],_0x433b92=await isSudo(botRef,_0xf4a1bf)[_0xf44fe2(0x252)](()=>![]);if(!_0x18f8b6&&!_0x433b92)return;let _0x3260e1=_0x18f8b6?getBotJid():_0xf4a1bf[_0xf44fe2(0x227)][_0xf44fe2(0x2f4)];if(!_0x3260e1){warn(_0xf44fe2(0x237)+_0xf44fe2(0x36e)+_0xf44fe2(0x2d6)+_0xf44fe2(0x2fc)+_0xf44fe2(0x324));return;}const _0xeb11b1=String(_0xf4a1bf['key'][_0xf44fe2(0x2f4)]||'')+'::'+String(_0xf4a1bf[_0xf44fe2(0x227)]['id']||_0xf4a1bf[_0xf44fe2(0x227)][_0xf44fe2(0x29a)+'t']||'');if(isCmdProcessed(_0xeb11b1))return;markCmdProcessed(_0xeb11b1);const _0x3155cf=_0xf4a1bf['text']||'',_0x597582=_0x3155cf[_0xf44fe2(0x284)]()['split'](/\s+/),_0x153921=(_0x597582[0x1f27+-0xb83+0x2*-0x9d2]||'')[_0xf44fe2(0x299)+'e']();if(!commands['includes'](_0x153921))return;const _0x3a7062=(_0x597582[0x3d*0x39+-0xa9d*0x1+-0x3*0xfd]||'')['toLowerCas'+'e']();if(_0x3a7062&&_0x3a7062['includes']('@')){const _0x79a948=normalizeToUserJid(_0x3a7062),_0x109dd8=await saveDeleteTarget(_0x79a948);await sendWithRetry(_0x3260e1,{'text':_0x109dd8?'[delete]\x20T'+_0xf44fe2(0x240)+_0xf44fe2(0x27c)+_0x79a948:_0xf44fe2(0x362)+_0xf44fe2(0x292)+_0xf44fe2(0x311)+_0xf44fe2(0x2d7)});return;}if(['clear',_0xf44fe2(0x349),_0xf44fe2(0x2cc)][_0xf44fe2(0x33a)](_0x3a7062)){const _0x1843e8=await saveDeleteTarget(null);await sendWithRetry(_0x3260e1,{'text':_0x1843e8?'[delete]\x20T'+_0xf44fe2(0x240)+'cleared.':_0xf44fe2(0x362)+_0xf44fe2(0x1c7)+'lear\x20targe'+_0xf44fe2(0x2ea)});return;}if(['p','pm'][_0xf44fe2(0x33a)](_0x3a7062)){await saveDeleteMode('p'),await sendWithRetry(_0x3260e1,{'text':_0xf44fe2(0x1d3)+'ode\x20set\x20to'+_0xf44fe2(0x326)});return;}if(['g',_0xf44fe2(0x361),'gp'][_0xf44fe2(0x33a)](_0x3a7062)){await saveDeleteMode('g');const _0xed553e=TARGET_JID?'Configured'+_0xf44fe2(0x230)+TARGET_JID:'No\x20target\x20'+_0xf44fe2(0x366)+_0xf44fe2(0x333);await sendWithRetry(_0x3260e1,{'text':_0xf44fe2(0x1d3)+_0xf44fe2(0x37c)+_0xf44fe2(0x2a8)+_0xed553e});return;}const _0x2df62f=DELETE_MODE==='g'?_0xf44fe2(0x293)+(TARGET_JID||_0xf44fe2(0x322))+')':'PM';await sendWithRetry(_0x3260e1,{'text':_0xf44fe2(0x1fd)+_0xf44fe2(0x32f)+_0xf44fe2(0x219)+'Only)*\x0a\x0a'+_0xf44fe2(0x35b)+(_0xf44fe2(0x2db)+'pm\x20\x20\x20\x20\x20\x20->'+_0xf44fe2(0x385)+_0xf44fe2(0x1fa)+'ot\x20PM\x0a')+(_0xf44fe2(0x351)+_0xf44fe2(0x28e)+_0xf44fe2(0x385)+_0xf44fe2(0x31b)+'\x20group\x0a')+(_0xf44fe2(0x2aa)+_0xf44fe2(0x2de)+'\x20set\x20targe'+_0xf44fe2(0x33b)+'D\x0a')+(_0xf44fe2(0x320)+_0xf44fe2(0x316)+_0xf44fe2(0x1f4)+'get\x20group\x20'+'JID\x0a\x0a')+(_0xf44fe2(0x278)+_0xf44fe2(0x249))+(_0xf44fe2(0x1e1)+_0xf44fe2(0x2fe)+_0x2df62f+'*\x0a')+(_0xf44fe2(0x371)+'Active:\x20*'+DEFAULT_SEND_DELETE+'*\x0a')+('\x20Cleanup\x20A'+'fter:\x20*'+DELETE_CLEANUP_DAYS+_0xf44fe2(0x2b8))});}catch(_0x408720){error(_0x408720,_0xf44fe2(0x297)+_0xf44fe2(0x303)+'rror:\x20'+(_0x408720?.['message']||_0x408720));}}export async function initialize(_0x187348){const _0x452395=_0xecb24c;if(!_0x187348)throw new Error(_0x452395(0x245)+'ule\x20requir'+_0x452395(0x259));botRef=_0x187348,await refreshConfig(),await ensureTable()[_0x452395(0x252)](_0x2109cd=>{const _0x48dccf=_0x452395;error('[Delete]\x20D'+_0x48dccf(0x262)+'zation\x20fai'+_0x48dccf(0x1f3)+_0x48dccf(0x1e9)+(_0x2109cd?.['message']||_0x2109cd));throw _0x2109cd;}),startManagedListener({'botRef':botRef,'eventName':_0x452395(0x32a)+_0x452395(0x344),'handler':rawMessagesUpsertHandler,'moduleName':name}),await autoCleanOldMessagesSafe()['catch'](_0x383ea1=>warn(_0x452395(0x35d)+_0x452395(0x205)+_0x452395(0x211)+':\x20'+(_0x383ea1?.[_0x452395(0x20e)]||_0x383ea1)));if(cleanupInterval)clearInterval(cleanupInterval);cleanupInterval=setInterval(autoCleanOldMessagesSafe,CLEANUP_INTERVAL||FALLBACKS['CLEANUP_IN'+_0x452395(0x1e8)]),info(_0x452395(0x279)+_0x452395(0x2a2)+_0x452395(0x231)+DELETE_MODE+(',\x20Cleanup\x20'+_0x452395(0x1ce))+DELETE_CLEANUP_DAYS);}export async function cleanup(){const _0x4c34b0=_0xecb24c;try{stopManagedListener(name,_0x4c34b0(0x32a)+_0x4c34b0(0x344)),cleanupInterval&&(clearInterval(cleanupInterval),cleanupInterval=null),messageQueue[_0x4c34b0(0x38b)]=0x1c42+-0x1a2d+-0x215,deletionQueue[_0x4c34b0(0x38b)]=-0xa25+0x174+0x5*0x1bd,pendingRecovered['length']=0x80f+-0x138f*0x1+-0x80*-0x17;}catch(_0x4e8f59){warn('[Delete]\x20c'+_0x4c34b0(0x2ba)+'or:\x20'+(_0x4e8f59?.[_0x4c34b0(0x20e)]||_0x4e8f59));}finally{botRef=null;}}export default{'name':name,'version':version,'priority':priority,'configKeys':configKeys,'commands':commands,'initialize':initialize,'onMessage':onMessage,'cleanup':cleanup};