const _0x8a9f0e=_0x1982;(function(_0x28cfc5,_0x380ff8){const _0x280cbd=_0x1982,_0xe2badd=_0x28cfc5();while(!![]){try{const _0x37afde=parseInt(_0x280cbd(0x1bd))/(0xc5c+0xd01*-0x1+0xa6)*(-parseInt(_0x280cbd(0x1d1))/(0x16e3+0x103b*0x1+0x2*-0x138e))+parseInt(_0x280cbd(0x1f8))/(0xd8c+-0xf2b+0x1a2)*(-parseInt(_0x280cbd(0x1e1))/(0x182b*0x1+-0xd6*0x1+0x1751*-0x1))+parseInt(_0x280cbd(0x26c))/(0x44*0x38+0x2f9*0x3+-0x11*0x166)+-parseInt(_0x280cbd(0x1b5))/(-0x3*0x876+-0x155d+0x2ec5)*(parseInt(_0x280cbd(0x1ea))/(0x256d*-0x1+0x19f+0x23d5))+parseInt(_0x280cbd(0x240))/(0x89d+0x59+-0x8ee)*(-parseInt(_0x280cbd(0x211))/(0x2f*0x23+-0x1926+0x12c2))+parseInt(_0x280cbd(0x285))/(-0x28d*-0x2+0x5c*-0x23+0x784*0x1)+-parseInt(_0x280cbd(0x278))/(0x9c8+-0x395*0x4+0x19*0x2f)*(-parseInt(_0x280cbd(0x20f))/(0x15e*-0x16+-0x2*-0x2f4+-0x8*-0x307));if(_0x37afde===_0x380ff8)break;else _0xe2badd['push'](_0xe2badd['shift']());}catch(_0x14b497){_0xe2badd['push'](_0xe2badd['shift']());}}}(_0x1bb0,0x1017b*0x14+0x19354f+-0xafd9*0x2c));import{info,warn,error}from'../utils/logger.js';import{downloadContentFromMessage,isJidGroup}from'@whiskeysockets/baileys';import{getConfig,hotReloadConfig}from'../utils/config.js';import{db}from'../utils/database.js';import{isSudo}from'../utils/sudo.js';import{getBotJid}from'../utils/bot-state.js';import{startManagedListener,stopManagedListener}from'../utils/listenerManager.js';export const name=_0x8a9f0e(0x1ca);export const version=_0x8a9f0e(0x27d)+_0x8a9f0e(0x186);export const priority=0x604*0x4+-0xdb4+0x9fd*-0x1;export const commands=['viewonce'];export const configKeys=['VIEWONCE_S'+_0x8a9f0e(0x190)+_0x8a9f0e(0x22a)+_0x8a9f0e(0x28a),_0x8a9f0e(0x1c5)+'LLOW_GROUP'+_0x8a9f0e(0x27a)+_0x8a9f0e(0x260)];let botRef=null,SKIP_IF_TARGET_EQUALS_SOURCE=!![],ALLOW_GROUP_COMMANDS_DEFAULT=![],MODE='p',TARGET_JID=null,ALLOW_GROUP_COMMANDS=ALLOW_GROUP_COMMANDS_DEFAULT,NOTIFY_VIEWONCE=![];function refreshConfig(){const _0x390977=_0x8a9f0e;try{const _0x519e1b=getConfig()||{};SKIP_IF_TARGET_EQUALS_SOURCE=_0x519e1b[_0x390977(0x274)+_0x390977(0x190)+_0x390977(0x22a)+_0x390977(0x28a)]!==undefined?Boolean(_0x519e1b[_0x390977(0x274)+_0x390977(0x190)+_0x390977(0x22a)+_0x390977(0x28a)]):SKIP_IF_TARGET_EQUALS_SOURCE,ALLOW_GROUP_COMMANDS_DEFAULT=Boolean(_0x519e1b['VIEWONCE_A'+_0x390977(0x212)+_0x390977(0x27a)+_0x390977(0x260)]??ALLOW_GROUP_COMMANDS_DEFAULT),info('['+name+(_0x390977(0x18a)+_0x390977(0x250)));}catch(_0x5776af){warn('['+name+(']\x20refreshC'+_0x390977(0x235)+_0x390977(0x218))+(_0x5776af?.[_0x390977(0x236)]||_0x5776af));}}try{hotReloadConfig&&hotReloadConfig((_0x5e908e=[])=>{const _0x2361b1=_0x8a9f0e,_0x4dd2ad=['VIEWONCE_S'+'KIP_IF_TAR'+'GET_EQUALS'+_0x2361b1(0x28a),_0x2361b1(0x1c5)+_0x2361b1(0x212)+_0x2361b1(0x27a)+_0x2361b1(0x260)];if((_0x5e908e||[])['some'](_0x196a4f=>_0x4dd2ad[_0x2361b1(0x18e)](_0x196a4f)))refreshConfig();});}catch(_0x2a018b){warn('['+name+(_0x8a9f0e(0x283)+_0x8a9f0e(0x253)+'gistration'+_0x8a9f0e(0x1af))+(_0x2a018b?.[_0x8a9f0e(0x236)]||_0x2a018b));}refreshConfig();async function ensureSchema(){const _0x5b9bcd=_0x8a9f0e;try{await db[_0x5b9bcd(0x1fd)](_0x5b9bcd(0x197)+_0x5b9bcd(0x254)+_0x5b9bcd(0x214)+_0x5b9bcd(0x1f5)+_0x5b9bcd(0x1d7)+_0x5b9bcd(0x24f)+'ey\x20TEXT\x20PR'+_0x5b9bcd(0x25f)+_0x5b9bcd(0x1b8)+_0x5b9bcd(0x258)+_0x5b9bcd(0x1be)+'\x20\x20\x20\x20\x20\x20\x20\x20up'+_0x5b9bcd(0x1df)+_0x5b9bcd(0x184)+_0x5b9bcd(0x22e)+'\x20\x20\x20);\x0a\x20\x20\x20\x20');try{const _0x5ac6df=await db[_0x5b9bcd(0x1e4)](_0x5b9bcd(0x180)+_0x5b9bcd(0x1e8)+_0x5b9bcd(0x239)+_0x5b9bcd(0x23b)+_0x5b9bcd(0x1ec));MODE=_0x5ac6df?.[_0x5b9bcd(0x1ba)]==='g'?'g':'p';}catch(_0xfbd2ad){}try{const _0x49f328=await db[_0x5b9bcd(0x1e4)](_0x5b9bcd(0x180)+'ue\x20FROM\x20vi'+_0x5b9bcd(0x239)+_0x5b9bcd(0x23b)+'ey=\x27target'+_0x5b9bcd(0x221));TARGET_JID=_0x49f328?.[_0x5b9bcd(0x1ba)]||null;}catch(_0x29878d){TARGET_JID=null;}try{const _0x52835d=await db[_0x5b9bcd(0x1e4)](_0x5b9bcd(0x180)+_0x5b9bcd(0x1e8)+_0x5b9bcd(0x239)+_0x5b9bcd(0x23b)+_0x5b9bcd(0x1dc)+_0x5b9bcd(0x207)+_0x5b9bcd(0x1a4));ALLOW_GROUP_COMMANDS=_0x52835d?.[_0x5b9bcd(0x1ba)]==='1';}catch(_0x425c5d){ALLOW_GROUP_COMMANDS=ALLOW_GROUP_COMMANDS_DEFAULT;}try{const _0x13c27c=await db['get'](_0x5b9bcd(0x180)+_0x5b9bcd(0x1e8)+_0x5b9bcd(0x239)+_0x5b9bcd(0x23b)+'ey=\x27notify'+_0x5b9bcd(0x1da));NOTIFY_VIEWONCE=_0x13c27c?.['value']==='1';}catch(_0x291a54){NOTIFY_VIEWONCE=![];}info('['+name+(_0x5b9bcd(0x1e9)+_0x5b9bcd(0x23f))+MODE+',\x20target='+(TARGET_JID||'unset')+_0x5b9bcd(0x228)+NOTIFY_VIEWONCE+(_0x5b9bcd(0x1f1)+'oup_comman'+_0x5b9bcd(0x26d))+ALLOW_GROUP_COMMANDS+')');}catch(_0x2a95be){error(_0x2a95be,'['+name+(_0x5b9bcd(0x1c0)+_0x5b9bcd(0x257)+'d'));throw _0x2a95be;}}async function savePref(_0x3e32e7,_0x653aa7){const _0x31485a=_0x8a9f0e;try{const _0x446098=Math[_0x31485a(0x196)](Date[_0x31485a(0x272)]()/(-0x26d1+-0xac8+0x3581));await db['run'](_0x31485a(0x20b)+_0x31485a(0x1ce)+_0x31485a(0x17f)+'y,value,up'+'dated_at)\x20'+_0x31485a(0x276)+_0x31485a(0x193)+_0x31485a(0x242)+_0x31485a(0x191)+_0x31485a(0x1dd)+'lue=exclud'+'ed.value,\x20'+'updated_at'+_0x31485a(0x1ed)+_0x31485a(0x1c4),[_0x3e32e7,_0x653aa7,_0x446098]);}catch(_0x5d855e){return warn('['+name+(']\x20savePref'+':\x20DB\x20write'+'\x20failed\x20fo'+'r\x20')+_0x3e32e7+'='+_0x653aa7+_0x31485a(0x251)+(_0x5d855e?.[_0x31485a(0x236)]||_0x5d855e)),![];}try{const _0x5da9aa=await db[_0x31485a(0x1e4)](_0x31485a(0x180)+_0x31485a(0x1e8)+_0x31485a(0x239)+_0x31485a(0x23b)+_0x31485a(0x25e),[_0x3e32e7]),_0x2f94f3=_0x5da9aa?.[_0x31485a(0x1ba)]??_0x653aa7;if(_0x3e32e7===_0x31485a(0x1b6))MODE=_0x2f94f3==='g'?'g':'p';if(_0x3e32e7===_0x31485a(0x210))TARGET_JID=_0x2f94f3||null;if(_0x3e32e7===_0x31485a(0x1bf)+_0x31485a(0x1ab))ALLOW_GROUP_COMMANDS=_0x2f94f3==='1';if(_0x3e32e7===_0x31485a(0x269)+'wonce')NOTIFY_VIEWONCE=_0x2f94f3==='1';return info('['+name+(_0x31485a(0x1a0)+_0x31485a(0x20a)+_0x31485a(0x289))+_0x3e32e7+'='+_0x2f94f3),!![];}catch(_0x51b86e){warn('['+name+(_0x31485a(0x248)+_0x31485a(0x1f4)+_0x31485a(0x264)+_0x31485a(0x1db)+'r\x20')+_0x3e32e7+'='+_0x653aa7+'\x20—\x20'+(_0x51b86e?.['message']||_0x51b86e));if(_0x3e32e7===_0x31485a(0x1b6))MODE=_0x653aa7==='g'?'g':'p';if(_0x3e32e7===_0x31485a(0x210))TARGET_JID=_0x653aa7||null;if(_0x3e32e7===_0x31485a(0x1bf)+_0x31485a(0x1ab))ALLOW_GROUP_COMMANDS=_0x653aa7==='1';if(_0x3e32e7==='notify_vie'+_0x31485a(0x26b))NOTIFY_VIEWONCE=_0x653aa7==='1';return!![];}}function normalizeToUserJid(_0x3831c8){const _0x26e0ca=_0x8a9f0e;try{if(!_0x3831c8||typeof _0x3831c8!==_0x26e0ca(0x18d))return _0x3831c8;const _0x284183=_0x3831c8[_0x26e0ca(0x25c)]('@');if(_0x284183===-(0x1b05*0x1+0x25*-0xa3+0x3b*-0xf))return _0x3831c8;const _0x420b27=_0x3831c8[_0x26e0ca(0x280)](-0x1a44+-0x1743*-0x1+0x301,_0x284183),_0x330e91=_0x3831c8[_0x26e0ca(0x280)](_0x284183),_0x5e7e0a=_0x420b27[_0x26e0ca(0x25c)](':');if(_0x5e7e0a===-(-0x166d*-0x1+-0xbd6+-0x10f*0xa))return _0x3831c8;return _0x420b27[_0x26e0ca(0x280)](-0xc41+0x8b*0x45+-0x1936*0x1,_0x5e7e0a)+_0x330e91;}catch(_0x3c6ec0){return _0x3831c8;}}async function trySend(_0x31aec0,_0x3f7901){const _0x4c0d50=_0x8a9f0e;try{const _0x40c149=normalizeToUserJid(String(_0x31aec0));if(!_0x40c149)throw new Error(_0x4c0d50(0x281)+'rget');if(typeof botRef?.['sendMessag'+'e']===_0x4c0d50(0x256)){await botRef[_0x4c0d50(0x23c)+'e'](_0x40c149,_0x3f7901);return;}if(botRef?.[_0x4c0d50(0x27c)]&&typeof botRef[_0x4c0d50(0x27c)]['sendMessag'+'e']==='function'){await botRef[_0x4c0d50(0x27c)]['sendMessag'+'e'](_0x40c149,_0x3f7901);return;}throw new Error('no\x20sendMes'+_0x4c0d50(0x231)+'able');}catch(_0x4cf95a){throw _0x4cf95a;}}function _0x1bb0(){const _0x344a37=['r:\x20','hat\x20*start','age','ot\x20instanc','listRespon','Content\x20er','ssage','\x20-\x20attempt','No\x20target\x20','_jid\x27','setting.','o\x20*','\x20Notificat','key',']\x20Reply\x20st',']\x20forwardR',',\x20notify=','ttonId','GET_EQUALS','rget\x20-\x20abo','ream','o\x20download','AULT\x200\x0a\x20\x20\x20','d:\x20','text','sage\x20avail',']\x20download','\x20set\x20mode.','\x20Failed\x20to','onfig\x20erro','message','\x20that\x20mess','JID\x20set.','ewonce_pre','isCommand','fs\x20WHERE\x20k','sendMessag','extendedTe','*Target\x20JI','\x20(mode=','2826104zillRV','[viewonce]','CONFLICT(k','et\x20JID:\x20','to\x20PM.','GROUP\x20(','once\x20inner',']\x20failed\x20t',']\x20savePref','values',':\x20reply\x20to','get\x20JID.','\x20clear\x20tar','image','essage\x20did','\x0a\x20\x20\x20\x20\x20\x20\x20\x20k','efreshed','\x20—\x20','in\x20a\x20view-','dConfig\x20re','ATE\x20TABLE\x20','viewOnceMe','function','hema\x20faile','alue\x20TEXT\x20',']\x20upsertHa','isViewOnce','\x20message\x20t','indexOf','Configured','ey=?','IMARY\x20KEY,','DEFAULT','underscore','arts\x20with\x20','e\x20handler\x20','fter\x20write','messages.u','View-Once\x20','notify','ge\x20to\x20','notify_vie','Recovered\x0a','wonce','8994065VfZUHV','ds=','\x20not\x20conta','once\x20Setti','conversati','length','now','caption','VIEWONCE_S','quotedMess','VALUES\x20(?,','OFF','1563452ZNbBXd','group','_COMMANDS_',']\x20handleUp','sock','2.0.0-patc','delete','wId','slice','no\x20send\x20ta','has',']\x20hotReloa','ble;\x20falli','122460maSaiQ','\x20p|g`\x0a','n/octet-st','toLowerCas','ded:\x20','_SOURCE',']\x20initiali','ore)\x20to\x20at','\x20Target\x20JI','contextInf',']\x20getBotJi','urrently\x20*','t\x20supporte','_prefs\x20(ke','SELECT\x20val','nitialize\x20','very.','imageMessa','NTEGER\x20DEF','rting\x20comm','hed','viewonce.i','overed\x20vid','videoMessa',']\x20config\x20r','isArray','at\x20starts\x20','string','includes','\x20notify\x20on','KIP_IF_TAR','ey)\x20DO\x20UPD','seMessage','\x20?,\x20?)\x20ON\x20','adcast','unset','floor','\x0a\x20\x20\x20\x20\x20\x20CRE','ecoveredTo','age\x20with\x20a','pushName','\x20cleaned\x20u','tener)','emoteJid','end\x20failed','To\x20recover',']\x20pref\x20sav',']\x20cleanup\x20','unknown','tempt\x20reco','ands\x27','add','\x20in\x20','et*:\x20','buttonsRes','\x20Mode\x20set\x20','split','p_commands','set','\x20error:\x20','true','\x20failed:\x20','endsWith','ctReply','bin','\x20the\x20view-','overed\x20doc','24kEdvGs','mode','error:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20v','push','value','\x20in\x20chat\x20','D\x20cleared.','400417csuMlI','NOT\x20NULL,\x0a','allow_grou',']\x20ensureSc','ing\x20recove','video','charAt','updated_at','VIEWONCE_A','sertSingle','gifPlaybac','selectedRo','*Anti-View','viewonce','iew-once\x20i','\x0a\x0afrom:\x20','recovered.','O\x20viewonce','ned\x20false','ssageV2','6yAfTSg','fications\x20','@g.us',']\x20no\x20desti','psert','ly)*\x0a\x0a','ce_prefs\x20(',']\x20command\x20','\x20`viewonce','_viewonce\x27','\x20failed\x20fo','ey=\x27allow_','ATE\x20SET\x20va','nner\x20is\x20no','dated_at\x20I','message\x20th','16gTkPmc','unknown\x20ch','ng\x20back\x20to','get',']\x20Sent\x20rec','with\x20\x27_\x27\x20(','Not\x20set','ue\x20FROM\x20vi',']\x20DB\x20ready','1189769FdwAbo','alized\x20lis','ey=\x27mode\x27','=excluded.','e\x20<jid>`\x0a','\x20save\x20noti','concat',',\x20allow_gr','remoteJid','xtMessage',':\x20reload\x20a','STS\x20viewon','ions*:\x20','\x20inner\x20med','1288587mSDyRh','ndler\x20erro','participan','fromMe','trim','exec','ngs\x20(PM-On','ge\x20with\x20a\x20','d\x20unavaila','catch','\x20save\x20targ','requires\x20b','ument\x20to\x20','remove','ions\x20are\x20c','group_comm','\x20ctx.key.r','eo\x20to\x20','ed\x20&\x20reloa','INSERT\x20INT','rmation\x20ta','*Notificat','ponseMessa','324qLmZpL','target_jid','27tKDDcJ','LLOW_GROUP',']\x20notify\x20s','IF\x20NOT\x20EXI','ions\x20set\x20t','singleSele','not\x20set'];_0x1bb0=function(){return _0x344a37;};return _0x1bb0();}const DEDUPE_TTL_MS=(0x679*0x3+0x9b+0x4*-0x4ff)*(-0x9*0x457+-0x1*-0x26f+0x2888),processedKeys=new Map();function markProcessed(_0x5375a9){const _0x38eb51=_0x8a9f0e;if(!_0x5375a9)return;if(processedKeys[_0x38eb51(0x282)](_0x5375a9))try{clearTimeout(processedKeys['get'](_0x5375a9));}catch(_0x93f04e){}const _0x390185=setTimeout(()=>processedKeys[_0x38eb51(0x27e)](_0x5375a9),DEDUPE_TTL_MS);processedKeys['set'](_0x5375a9,_0x390185);}function isProcessed(_0x4efc15){const _0x123604=_0x8a9f0e;return _0x4efc15&&processedKeys[_0x123604(0x282)](_0x4efc15);}function extractContextInfo(_0x9f30db){const _0x23187d=_0x8a9f0e;if(!_0x9f30db||!_0x9f30db[_0x23187d(0x236)])return null;const _0x4e13f6=_0x9f30db['message'];return _0x4e13f6['extendedTe'+'xtMessage']?.[_0x23187d(0x28e)+'o']||_0x4e13f6[_0x23187d(0x28e)+'o']||null;}function extractViewOnceInnerFromQuoted(_0x16a2a5){const _0x4b7053=_0x8a9f0e;if(!_0x16a2a5)return null;return _0x16a2a5?.['viewOnceMe'+_0x4b7053(0x21e)]?.[_0x4b7053(0x236)]||_0x16a2a5?.[_0x4b7053(0x255)+_0x4b7053(0x1d0)]?.[_0x4b7053(0x236)]||(_0x16a2a5['imageMessa'+'ge']?_0x16a2a5:null)||(_0x16a2a5[_0x4b7053(0x189)+'ge']?_0x16a2a5:null)||null;}function getSelfJid(){return getBotJid()||null;}function resolveDestination(_0x36f14b){const _0x25e72f=getSelfJid();if(MODE==='g'&&TARGET_JID){if(SKIP_IF_TARGET_EQUALS_SOURCE&&TARGET_JID===_0x36f14b)return _0x25e72f;return TARGET_JID;}return _0x25e72f;}function stripDomain(_0x3e10a2){const _0x7416e8=_0x8a9f0e;if(!_0x3e10a2||typeof _0x3e10a2!==_0x7416e8(0x18d))return _0x3e10a2;const _0x43db1d=_0x3e10a2[_0x7416e8(0x25c)]('@');if(_0x43db1d===-(0x1584+0x1bd5+-0x4*0xc56))return _0x3e10a2;return _0x3e10a2[_0x7416e8(0x280)](-0xebe+-0x2*-0xb08+-0x752,_0x43db1d);}async function handleUpsertSingle(_0x4ce2eb){const _0x5a6e9f=_0x8a9f0e;try{if(!_0x4ce2eb||!_0x4ce2eb[_0x5a6e9f(0x225)])return;if(_0x4ce2eb[_0x5a6e9f(0x225)]?.[_0x5a6e9f(0x1f2)]==='status@bro'+_0x5a6e9f(0x194))return;if(Boolean(_0x4ce2eb['key']?.['fromMe']))return;const _0x3c5186=String(_0x4ce2eb[_0x5a6e9f(0x225)][_0x5a6e9f(0x1f2)]||'')+'::'+String(_0x4ce2eb[_0x5a6e9f(0x225)]['id']||'');if(isProcessed(_0x3c5186))return;markProcessed(_0x3c5186);const _0x5c7d33=Boolean(_0x4ce2eb[_0x5a6e9f(0x225)]?.[_0x5a6e9f(0x25a)]),_0x3b122d=Boolean(_0x4ce2eb[_0x5a6e9f(0x236)]?.[_0x5a6e9f(0x255)+_0x5a6e9f(0x21e)]||_0x4ce2eb[_0x5a6e9f(0x236)]?.[_0x5a6e9f(0x255)+_0x5a6e9f(0x1d0)]);if(!_0x5c7d33&&!_0x3b122d)return;if(!NOTIFY_VIEWONCE)return;const _0x456c94=_0x4ce2eb[_0x5a6e9f(0x19a)]||_0x4ce2eb['key']?.[_0x5a6e9f(0x1fa)+'t']||_0x4ce2eb[_0x5a6e9f(0x225)]?.['remoteJid']||null,_0x3b3cac=_0x456c94?stripDomain(String(_0x456c94)):_0x5a6e9f(0x1a2),_0x36cbdd=_0x4ce2eb[_0x5a6e9f(0x225)]?.[_0x5a6e9f(0x1f2)]?stripDomain(_0x4ce2eb[_0x5a6e9f(0x225)][_0x5a6e9f(0x1f2)]):_0x5a6e9f(0x1e2)+'at',_0x9e2aa7=resolveDestination(_0x4ce2eb[_0x5a6e9f(0x225)]?.['remoteJid']);if(!_0x9e2aa7)return;const _0x598122='👁️\x20Detected'+'\x20view-once'+'\x20from\x20'+_0x3b3cac+_0x5a6e9f(0x1bb)+_0x36cbdd+('.\x0aReply\x20to'+_0x5a6e9f(0x237)+_0x5a6e9f(0x199)+_0x5a6e9f(0x25b)+_0x5a6e9f(0x219)+'s\x20with*\x20\x27_'+'\x27\x20(undersc'+_0x5a6e9f(0x28c)+_0x5a6e9f(0x1a3)+_0x5a6e9f(0x182));try{await trySend(_0x9e2aa7,{'text':_0x598122}),info('['+name+(']\x20Notified'+'\x20')+_0x9e2aa7+('\x20of\x20view-o'+'nce\x20from\x20')+_0x3b3cac+'\x20in\x20'+_0x36cbdd);}catch(_0x217616){warn('['+name+(_0x5a6e9f(0x213)+_0x5a6e9f(0x19e)+':\x20')+(_0x217616?.[_0x5a6e9f(0x236)]||_0x217616));}}catch(_0x3fe127){warn('['+name+(_0x5a6e9f(0x27b)+_0x5a6e9f(0x1c6)+_0x5a6e9f(0x1ad))+(_0x3fe127?.['message']||_0x3fe127));}}async function upsertHandler({messages:_0x22d933}){const _0x407cfe=_0x8a9f0e;try{if(!Array[_0x407cfe(0x18b)](_0x22d933))return;for(const _0x5783cc of _0x22d933)await handleUpsertSingle(_0x5783cc);}catch(_0xf1cc){warn('['+name+(_0x407cfe(0x259)+_0x407cfe(0x1f9)+_0x407cfe(0x218))+(_0xf1cc?.['message']||_0xf1cc));}}function _0x1982(_0x5d2714,_0x3a35ec){const _0x3a8997=_0x1bb0();return _0x1982=function(_0x71cb6,_0x5e0d1d){_0x71cb6=_0x71cb6-(0x25c0+0x1af+-0x25f0);let _0x4d0e16=_0x3a8997[_0x71cb6];return _0x4d0e16;},_0x1982(_0x5d2714,_0x3a35ec);}async function downloadBufferFromContent(_0x45b820,_0x537bc6){const _0x4c3582=_0x8a9f0e;try{if(!_0x45b820||!_0x537bc6)return null;const _0x6d0eb7=await downloadContentFromMessage(_0x45b820,_0x537bc6);if(!_0x6d0eb7)return null;const _0x2eda2b=[];for await(const _0x385549 of _0x6d0eb7){_0x2eda2b[_0x4c3582(0x1b9)](_0x385549);}if(!_0x2eda2b[_0x4c3582(0x271)])return null;return Buffer[_0x4c3582(0x1f0)](_0x2eda2b);}catch(_0x457aad){return warn('['+name+(_0x4c3582(0x232)+'BufferFrom'+_0x4c3582(0x21d)+'ror:\x20')+(_0x457aad?.[_0x4c3582(0x236)]||_0x457aad)),null;}}async function forwardRecoveredToDest(_0x11a68c,_0x5b05c2,_0x2956a2,_0x1155d4){const _0x3a9bfe=_0x8a9f0e,_0x4bec51=resolveDestination(_0x2956a2);if(!_0x4bec51)return warn('['+name+(_0x3a9bfe(0x1d4)+'nation\x20res'+'olved')),![];try{const _0x2630d2=_0x11a68c?.[_0x3a9bfe(0x183)+'ge']?.[_0x3a9bfe(0x273)]||_0x11a68c?.['videoMessa'+'ge']?.[_0x3a9bfe(0x273)]||'',_0x3de58c=_0x1155d4?stripDomain(_0x1155d4):'unknown\x20us'+'er',_0x1755ab=_0x2956a2?stripDomain(_0x2956a2):_0x3a9bfe(0x1e2)+'at',_0x1b8c3b=_0x3a9bfe(0x1cc)+_0x3de58c+_0x3a9bfe(0x1a6)+_0x1755ab,_0x4c4168=_0x3a9bfe(0x266)+_0x3a9bfe(0x26a)+_0x2630d2+_0x1b8c3b;if(_0x11a68c['imageMessa'+'ge'])return await trySend(_0x4bec51,{'image':_0x5b05c2,'caption':_0x4c4168}),info('['+name+(']\x20Sent\x20rec'+'overed\x20ima'+_0x3a9bfe(0x268))+_0x4bec51),!![];if(_0x11a68c[_0x3a9bfe(0x189)+'ge']){const _0x3a198e=Boolean(_0x11a68c[_0x3a9bfe(0x189)+'ge']?.[_0x3a9bfe(0x1c7)+'k']);return await trySend(_0x4bec51,{'video':_0x5b05c2,'caption':_0x4c4168,'gifPlayback':_0x3a198e}),info('['+name+(']\x20Sent\x20rec'+_0x3a9bfe(0x188)+_0x3a9bfe(0x209))+_0x4bec51),!![];}return await trySend(_0x4bec51,{'document':_0x5b05c2,'fileName':_0x3a9bfe(0x1cd)+_0x3a9bfe(0x1b2),'mimetype':'applicatio'+_0x3a9bfe(0x287)+_0x3a9bfe(0x22c),'caption':_0x4c4168}),info('['+name+(_0x3a9bfe(0x1e5)+_0x3a9bfe(0x1b4)+_0x3a9bfe(0x204))+_0x4bec51),!![];}catch(_0x2e1cc9){return warn('['+name+(_0x3a9bfe(0x227)+'ecoveredTo'+'Dest\x20faile'+_0x3a9bfe(0x22f))+(_0x2e1cc9?.[_0x3a9bfe(0x236)]||_0x2e1cc9)),![];}}function extractTextFromCtx(_0x3562ff){const _0x24870e=_0x8a9f0e;if(!_0x3562ff||!_0x3562ff[_0x24870e(0x236)])return'';const _0x1b0d0d=_0x3562ff[_0x24870e(0x236)];return _0x1b0d0d[_0x24870e(0x270)+'on']||_0x1b0d0d['extendedTe'+_0x24870e(0x1f3)]?.[_0x24870e(0x230)]||_0x1b0d0d[_0x24870e(0x183)+'ge']?.[_0x24870e(0x273)]||_0x1b0d0d[_0x24870e(0x189)+'ge']?.['caption']||'';}const processedCmdKeys=new Map(),CMD_DEDUPE_TTL_MS=(0x15*-0x63+0x1b8b+-0x134e)*(-0x3e*-0x2f+-0x1a1*0xd+-0x491*-0x3);function markCmdProcessed(_0x56487b){const _0x1dd43c=_0x8a9f0e;if(!_0x56487b)return;if(processedCmdKeys[_0x1dd43c(0x282)](_0x56487b))try{clearTimeout(processedCmdKeys[_0x1dd43c(0x1e4)](_0x56487b));}catch(_0x397ba3){};const _0xf925ae=setTimeout(()=>processedCmdKeys[_0x1dd43c(0x27e)](_0x56487b),CMD_DEDUPE_TTL_MS);processedCmdKeys[_0x1dd43c(0x1ac)](_0x56487b,_0xf925ae);}function isCmdProcessed(_0x50565e){return _0x50565e&&processedCmdKeys['has'](_0x50565e);}const recentResponded=new Set();export async function onMessage(_0x3b8122){const _0x479063=_0x8a9f0e;try{if(!_0x3b8122||!_0x3b8122[_0x479063(0x225)]||!_0x3b8122[_0x479063(0x236)])return;const _0x238f09=_0x3b8122[_0x479063(0x225)]?.['id']||null;if(_0x238f09){if(recentResponded['has'](_0x238f09))return;recentResponded[_0x479063(0x1a5)](_0x238f09),setTimeout(()=>recentResponded[_0x479063(0x27e)](_0x238f09),(0x1285+-0x4ee*0x4+-0x1*-0x16f)*(0xad8*-0x2+0x5a6+-0x45*-0x4a));}if(_0x3b8122[_0x479063(0x23a)]){const _0x3c2ea1=_0x3b8122[_0x479063(0x225)][_0x479063(0x1f2)],_0x158f19=typeof _0x3c2ea1===_0x479063(0x18d)&&_0x3c2ea1[_0x479063(0x1b0)]('@g.us');if(_0x158f19&&!ALLOW_GROUP_COMMANDS){}else{const _0xc013a=Boolean(_0x3b8122[_0x479063(0x225)][_0x479063(0x1fb)]);if(!_0x158f19&&!_0xc013a){const _0x14c2e9=await isSudo(botRef,_0x3b8122)['catch'](()=>![]);if(!_0x14c2e9){}else await handleCommand(_0x3b8122)[_0x479063(0x201)](_0x4fe502=>warn('['+name+(_0x479063(0x1d8)+'error:\x20')+(_0x4fe502?.[_0x479063(0x236)]||_0x4fe502)));}else{const _0x33f080=await isSudo(botRef,_0x3b8122)[_0x479063(0x201)](()=>![]),_0x3aa2cc=Boolean(_0x3b8122[_0x479063(0x225)][_0x479063(0x1fb)]);(_0x3aa2cc||_0x33f080)&&await handleCommand(_0x3b8122)[_0x479063(0x201)](_0x4080f1=>warn('['+name+(_0x479063(0x1d8)+_0x479063(0x1b7))+(_0x4080f1?.[_0x479063(0x236)]||_0x4080f1)));}}}const _0xcd0bc2=extractContextInfo(_0x3b8122);if(!_0xcd0bc2||!_0xcd0bc2['quotedMess'+_0x479063(0x21a)])return;const _0x457c65=extractTextFromCtx(_0x3b8122)||'';if(!_0x457c65)return;const _0x3cb336=_0x457c65['trim']()[_0x479063(0x1c3)](0xca*0x24+-0x2700+0xa98);if(_0x3cb336!=='_')return;info('['+name+(_0x479063(0x226)+_0x479063(0x262)+_0x479063(0x261)+_0x479063(0x21f)+_0x479063(0x1c1)+'ry'));const _0x595af4=extractViewOnceInnerFromQuoted(_0xcd0bc2[_0x479063(0x275)+_0x479063(0x21a)]);if(!_0x595af4){warn('['+name+(']\x20quoted\x20m'+_0x479063(0x24e)+_0x479063(0x26e)+_0x479063(0x252)+_0x479063(0x246)+'\x20message'));return;}let _0x352024=null,_0x554a89=null;if(_0x595af4[_0x479063(0x183)+'ge'])_0x352024=_0x595af4[_0x479063(0x183)+'ge'],_0x554a89=_0x479063(0x24d);else _0x595af4[_0x479063(0x189)+'ge']&&(_0x352024=_0x595af4['videoMessa'+'ge'],_0x554a89=_0x479063(0x1c2));if(!_0x352024||!_0x554a89){warn('['+name+(']\x20quoted\x20v'+_0x479063(0x1cb)+_0x479063(0x1de)+_0x479063(0x291)+'d\x20media\x20ty'+'pe'));return;}const _0x1a825d=await downloadBufferFromContent(_0x352024,_0x554a89);if(!_0x1a825d){warn('['+name+(_0x479063(0x247)+_0x479063(0x22d)+_0x479063(0x1f7)+'ia\x20buffer'));return;}const _0x2b2702=_0x3b8122[_0x479063(0x225)][_0x479063(0x1f2)]||null,_0x42e2db=_0xcd0bc2[_0x479063(0x1fa)+'t']||null,_0x54d400=await forwardRecoveredToDest(_0x595af4,_0x1a825d,_0x2b2702,_0x42e2db);if(!_0x54d400)warn('['+name+(_0x479063(0x227)+_0x479063(0x198)+'Dest\x20retur'+_0x479063(0x1cf)));}catch(_0x2357dc){error(_0x2357dc,'['+name+(']\x20onMessag'+_0x479063(0x263)+_0x479063(0x1b7))+(_0x2357dc?.['message']||_0x2357dc));}}async function handleCommand(_0x5ea4e0){const _0x40d289=_0x8a9f0e;try{if(!_0x5ea4e0||!_0x5ea4e0['key']||!_0x5ea4e0[_0x40d289(0x236)])return;const _0x341f9b=_0x5ea4e0['key'][_0x40d289(0x1f2)],_0x21586b=typeof _0x341f9b===_0x40d289(0x18d)&&_0x341f9b[_0x40d289(0x1b0)](_0x40d289(0x1d3));if(_0x21586b&&!ALLOW_GROUP_COMMANDS)return;const _0x4155f2=Boolean(_0x5ea4e0[_0x40d289(0x225)][_0x40d289(0x1fb)]);if(!_0x21586b&&!_0x4155f2){const _0x781842=await isSudo(botRef,_0x5ea4e0)[_0x40d289(0x201)](()=>![]);if(!_0x781842)return;}const _0x104ffe=Boolean(_0x5ea4e0['key'][_0x40d289(0x1fb)]),_0x3b5c92=await isSudo(botRef,_0x5ea4e0)[_0x40d289(0x201)](()=>![]);let _0x27fc42;if(_0x104ffe)_0x27fc42=getBotJid()||_0x5ea4e0['key']['remoteJid']||_0x5ea4e0[_0x40d289(0x225)][_0x40d289(0x1fa)+'t']||null,!_0x27fc42&&(warn('['+name+(_0x40d289(0x28f)+_0x40d289(0x200)+_0x40d289(0x284)+_0x40d289(0x1e3)+_0x40d289(0x208)+_0x40d289(0x19d))),_0x27fc42=_0x5ea4e0[_0x40d289(0x225)][_0x40d289(0x1f2)]||null);else{if(_0x3b5c92)_0x27fc42=_0x5ea4e0['key'][_0x40d289(0x1f2)];else return;}if(!_0x27fc42){warn('['+name+(']\x20no\x20confi'+_0x40d289(0x20c)+_0x40d289(0x22b)+_0x40d289(0x185)+'and'));return;}const _0x3c3769=String(_0x5ea4e0[_0x40d289(0x225)][_0x40d289(0x1f2)]||'')+'::'+String(_0x5ea4e0[_0x40d289(0x225)]['id']||_0x5ea4e0[_0x40d289(0x225)][_0x40d289(0x1fa)+'t']||'');if(isCmdProcessed(_0x3c3769))return;markCmdProcessed(_0x3c3769);const _0x5531f1=typeof _0x5ea4e0['text']==='string'&&_0x5ea4e0[_0x40d289(0x230)][_0x40d289(0x1fc)]()[_0x40d289(0x271)]?_0x5ea4e0[_0x40d289(0x230)]['trim']():function _0x3bd07e(_0x1ccdd6){const _0x7605fa=_0x40d289;if(!_0x1ccdd6||!_0x1ccdd6['message'])return'';const _0x365509=_0x1ccdd6['message'];if(_0x365509[_0x7605fa(0x270)+'on'])return _0x365509[_0x7605fa(0x270)+'on'];if(_0x365509[_0x7605fa(0x23d)+_0x7605fa(0x1f3)]?.[_0x7605fa(0x230)])return _0x365509[_0x7605fa(0x23d)+_0x7605fa(0x1f3)][_0x7605fa(0x230)];if(_0x365509[_0x7605fa(0x183)+'ge']?.[_0x7605fa(0x273)])return _0x365509['imageMessa'+'ge'][_0x7605fa(0x273)];if(_0x365509['videoMessa'+'ge']?.['caption'])return _0x365509['videoMessa'+'ge'][_0x7605fa(0x273)];if(_0x365509['buttonsRes'+_0x7605fa(0x20e)+'ge']?.['selectedBu'+_0x7605fa(0x229)])return _0x365509[_0x7605fa(0x1a8)+_0x7605fa(0x20e)+'ge']['selectedBu'+_0x7605fa(0x229)];if(_0x365509[_0x7605fa(0x21c)+_0x7605fa(0x192)]?.[_0x7605fa(0x216)+_0x7605fa(0x1b1)]?.['selectedRo'+_0x7605fa(0x27f)])return _0x365509[_0x7605fa(0x21c)+_0x7605fa(0x192)]['singleSele'+'ctReply'][_0x7605fa(0x1c8)+_0x7605fa(0x27f)];return'';}(_0x5ea4e0)||'';if(!_0x5531f1)return;const _0x3ca560=(_0x5531f1[_0x40d289(0x1aa)](/\r?\n/)[0x199d+-0x1e0e+-0x1*-0x471]||'')[_0x40d289(0x1fc)](),_0x9d4f28=_0x3ca560[_0x40d289(0x1aa)](/\s+/),_0xc2ff24=(_0x9d4f28[0xa5f+-0x1f0b+0xfc*0x15]||'')[_0x40d289(0x288)+'e']();if(!commands[_0x40d289(0x18e)](_0xc2ff24))return;const _0x488eb1=(_0x9d4f28[0x7b4+0x61*0x37+-0x1c8a]||'')[_0x40d289(0x288)+'e']();if(_0x488eb1===_0x40d289(0x267)){const _0x1ef08b=(_0x9d4f28[0x1747*-0x1+-0xe37*0x1+0x2580]||'')['toLowerCas'+'e']();if(!_0x1ef08b){await trySend(_0x27fc42,{'text':'[viewonce]'+'\x20Notificat'+_0x40d289(0x206)+_0x40d289(0x290)+(NOTIFY_VIEWONCE?'ON':_0x40d289(0x277))+'*'});return;}const _0x425554=_0x1ef08b==='on'||_0x1ef08b==='1'||_0x1ef08b===_0x40d289(0x1ae),_0x1694d2=await savePref('notify_vie'+'wonce',_0x425554?'1':'0');if(!_0x1694d2){await trySend(_0x27fc42,{'text':_0x40d289(0x241)+_0x40d289(0x234)+_0x40d289(0x1ef)+_0x40d289(0x1d2)+_0x40d289(0x222)});return;}await trySend(_0x27fc42,{'text':_0x40d289(0x241)+_0x40d289(0x224)+_0x40d289(0x215)+_0x40d289(0x223)+(_0x425554?'ON':'OFF')+'*'});return;}if(_0x488eb1==='p'||_0x488eb1==='pm'){const _0x25833c=await savePref(_0x40d289(0x1b6),'p');if(!_0x25833c){await trySend(_0x27fc42,{'text':_0x40d289(0x241)+_0x40d289(0x234)+_0x40d289(0x233)});return;}await trySend(_0x27fc42,{'text':_0x40d289(0x241)+_0x40d289(0x1a9)+_0x40d289(0x244)});return;}if(_0x488eb1==='g'||_0x488eb1===_0x40d289(0x279)||_0x488eb1==='gp'){const _0x3f90f9=await savePref(_0x40d289(0x1b6),'g');if(!_0x3f90f9){await trySend(_0x27fc42,{'text':_0x40d289(0x241)+_0x40d289(0x234)+_0x40d289(0x233)});return;}const _0x29bddb=TARGET_JID?_0x40d289(0x25d)+'\x20group:\x20'+TARGET_JID:_0x40d289(0x220)+_0x40d289(0x238);await trySend(_0x27fc42,{'text':_0x40d289(0x241)+'\x20Mode\x20set\x20'+'to\x20GROUP.\x20'+_0x29bddb});return;}if(_0x488eb1&&_0x488eb1[_0x40d289(0x18e)]('@')){const _0x4a197e=normalizeToUserJid(_0x488eb1),_0x36ccb1=await savePref(_0x40d289(0x210),_0x4a197e);if(_0x36ccb1)await trySend(_0x27fc42,{'text':_0x40d289(0x241)+_0x40d289(0x28d)+'D\x20saved:\x20'+_0x4a197e});else await trySend(_0x27fc42,{'text':_0x40d289(0x241)+'\x20Failed\x20to'+_0x40d289(0x202)+_0x40d289(0x243)+_0x4a197e});return;}if(_0x488eb1==='clear'||_0x488eb1===_0x40d289(0x195)||_0x488eb1===_0x40d289(0x205)){const _0x41103a=await savePref(_0x40d289(0x210),'');if(_0x41103a)await trySend(_0x27fc42,{'text':_0x40d289(0x241)+_0x40d289(0x28d)+_0x40d289(0x1bc)});else await trySend(_0x27fc42,{'text':_0x40d289(0x241)+_0x40d289(0x234)+_0x40d289(0x24c)+_0x40d289(0x24b)});return;}const _0x4ad518=MODE==='g'?_0x40d289(0x245)+(TARGET_JID||_0x40d289(0x217))+')':'PM';await trySend(_0x27fc42,{'text':_0x40d289(0x1c9)+_0x40d289(0x26f)+_0x40d289(0x1fe)+_0x40d289(0x1d6)+(_0x40d289(0x20d)+_0x40d289(0x1f6)+(NOTIFY_VIEWONCE?'ON':_0x40d289(0x277))+(_0x40d289(0x1d9)+_0x40d289(0x18f)+'|off`\x0a'))+('*Send\x20Targ'+_0x40d289(0x1a7)+_0x4ad518+(_0x40d289(0x1d9)+_0x40d289(0x286)))+(_0x40d289(0x23e)+'D*:\x20`'+(TARGET_JID||_0x40d289(0x1e7))+('`\x20`viewonc'+_0x40d289(0x1ee)))+(_0x40d289(0x19f)+_0x40d289(0x24a)+_0x40d289(0x1b3)+'once\x20messa'+_0x40d289(0x1ff)+_0x40d289(0x1e0)+_0x40d289(0x18c)+_0x40d289(0x1e6)+_0x40d289(0x261)+').')});}catch(_0xa49bc0){warn('['+name+(']\x20handleCo'+'mmand\x20erro'+'r:\x20')+(_0xa49bc0?.['message']||_0xa49bc0));}}export async function initialize(_0x4c8c10){const _0x2f1495=_0x8a9f0e;if(!_0x4c8c10)throw new Error(_0x2f1495(0x187)+_0x2f1495(0x181)+_0x2f1495(0x203)+_0x2f1495(0x21b)+'e');botRef=_0x4c8c10,await ensureSchema(),refreshConfig(),startManagedListener({'botRef':botRef,'eventName':'messages.u'+_0x2f1495(0x1d5),'handler':upsertHandler,'moduleName':name}),info('['+name+(_0x2f1495(0x28b)+'zed\x20(centr'+_0x2f1495(0x1eb)+_0x2f1495(0x19c)));}export async function cleanup(){const _0x2cc83b=_0x8a9f0e;try{stopManagedListener(name,_0x2cc83b(0x265)+'psert');for(const _0x2b2411 of processedKeys[_0x2cc83b(0x249)]())try{clearTimeout(_0x2b2411);}catch(_0x44008a){}processedKeys['clear']();}catch(_0x5a3dd8){warn(name+(_0x2cc83b(0x1a1)+'error:\x20')+(_0x5a3dd8?.['message']||_0x5a3dd8));}finally{botRef=null,info(name+(_0x2cc83b(0x19b)+'p'));}}export default{'name':name,'version':version,'priority':priority,'commands':commands,'initialize':initialize,'onMessage':onMessage,'cleanup':cleanup};