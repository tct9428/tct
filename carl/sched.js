const _0x563749=_0xd8bc;function _0xd8bc(_0x78c993,_0x5b8566){const _0x59261a=_0x82f4();return _0xd8bc=function(_0x194dfe,_0x5c2624){_0x194dfe=_0x194dfe-(0x1a95+0x9f4+-0x8e1*0x4);let _0x5bb6c6=_0x59261a[_0x194dfe];return _0x5bb6c6;},_0xd8bc(_0x78c993,_0x5b8566);}(function(_0x4e0eac,_0x9c7924){const _0x36cbf6=_0xd8bc,_0x1cb244=_0x4e0eac();while(!![]){try{const _0x37cd05=parseInt(_0x36cbf6(0x255))/(0xb18*0x3+0x69e*-0x1+-0xc3*0x23)*(parseInt(_0x36cbf6(0x359))/(-0x1723+-0x3d1*0x4+-0x1*-0x2669))+-parseInt(_0x36cbf6(0x280))/(-0xa39*-0x1+0x1726*0x1+-0x215c)+parseInt(_0x36cbf6(0x3de))/(-0x225e+-0x99b*-0x4+-0x2f*0x16)*(parseInt(_0x36cbf6(0x2d6))/(-0x1*-0x991+-0x21ab+0x181f))+parseInt(_0x36cbf6(0x3ec))/(-0x1d0d+-0x14ba+-0xb*-0x487)+-parseInt(_0x36cbf6(0x32c))/(0x24a8+-0x25f+0x1*-0x2242)+-parseInt(_0x36cbf6(0x338))/(-0xcfe+-0x13*-0xff+-0x5e7*0x1)+parseInt(_0x36cbf6(0x2e8))/(-0x17bb+0x1b7+0x160d*0x1)*(parseInt(_0x36cbf6(0x201))/(-0x552+0x16a4+-0x1148));if(_0x37cd05===_0x9c7924)break;else _0x1cb244['push'](_0x1cb244['shift']());}catch(_0xde3e6c){_0x1cb244['push'](_0x1cb244['shift']());}}}(_0x82f4,0x11e353+-0x181dc+0x244e*-0x2e));import{DateTime}from'luxon';import{info,warn,error}from'../utils/logger.js';import{getConfig,hotReloadConfig}from'../utils/config.js';import{db}from'../utils/database.js';import{getDefault,getConnection}from'../utils/connection.js';import{isadmin}from'../utils/isadmin.js';import*as _0xc0fbfe from'../utils/groups.js';import{isSudo,userJidFromCtx,listSudo,normalizeToJid}from'../utils/sudo.js';import{getBotJid}from'../utils/bot-state.js';import{startManagedListener,stopManagedListener}from'../utils/listenerManager.js';export const name=_0x563749(0x1c5);export const version=_0x563749(0x198);export const priority=-0x175*-0x19+-0xc06*-0x3+-0x180e*0x3;export const commands=[_0x563749(0x1c5),_0x563749(0x2ae)];function _0x82f4(){const _0x51f0b7=['ctReply','(id:','function','ble\x20rename','eserved.\x0a\x0a','\x20?,\x20?,\x20?)','(listenerM','LE\x20IF\x20NOT\x20','tTableColu','r\x20id=','les\x20for\x20to','isValid','Schedule\x20#','from','\x20failed\x20de','ezone\x20FROM','led\x20for\x20id','tupSendApi','1918416YgRDIJ','\x20fatal','ying.','TEXT\x0a\x20\x20\x20\x20\x20','ndStoredMa','ge...>','k\x20failed','INTEGER\x20PR','of\x20a\x20sched','ror:\x20','buttonsRes','moveSchedu','send_attem','SELECT\x20tim','oss\x20your\x20d','creator','all\x20schedu','r,...|all>','eated\x20cano','\x20made.','tReloadCon','ENT','days_of_we','d\x20to\x20remov','d\x20INTEGER\x20','<number>`\x20','replace','le\x20id=','seMessage','\x0a);','\x20\x20\x20\x20creato','s/days/min','tChatTimez','SCHED_SEND','d\x20for\x20conn','ne;\x20old\x20ta','participan','INSERT\x20INT','quency.','for\x20defaul','ault.','wId','[sched]\x20on','ge:\x20sched\x20','failed','[sched]\x20ex','schedule','reviously\x20','XISTS\x20sche','value','resolve\x20gp','\x20\x20\x20\x20send_a','ult\x20TZ','ALTER\x20TABL','HH:mm\x20|\x20YY','dateSchedu','[sched]\x20co','faults\x20as\x20','[sched]\x20fi','catch','ating\x20safe','zone','ow\x20error:\x20',':00\x20Hello\x20','diff','sage...>`\x0a','Message\x20er','s_new\x20(cha','edit','requested\x20','edules_new','\x20\x20\x20chat_ji','chedules(c','yes','le_info(','end_at\x20INT','iled\x20to\x20re','=2\x20every\x202','\x20last_sent','owing\x20line','F_MS','message','e\x20or\x20multi','\x20enabled:','help','get','5QUuiXs','ler_settin','floor','\x20at\x20','weekday','ys/minutes','exec','fter\x20time\x20','.update','send_at','map','te\x20listene','r\x20defaults','ules\x20detec','mn:\x20','c.\x0a\x0a>\x20*sch','at_jid\x20=\x20?','plus','11594790TYZzCt','[sched]\x20cl','alias,\x20gp:','Deleted\x20','test','tchFromFin','ble\x20appear','xample:\x0asc',',2,3\x20OR\x20sc','eator_jid\x20','anager\x20use','t_jid\x20TEXT','ge\x20text\x20(s','sureSchema','parse_fail','toLowerCas','les\x20WHERE\x20','ge.\x0a\x0a>\x20*sc','instead','caption','ONFLICT(ch','ias|jid|al','fallback','lias|jid|a','\x20schedule(','endsWith',':mm|in\x20N\x20h','mMe)','original\x20n','vide\x20messa','chatJid','\x203\x20OR\x20sche','[sched]\x20de','\x20\x20\x20\x20\x20\x20\x20las','tempt\x20INTE','key','chatid','isArray','\x20to\x20','ftime(\x27%s\x27','val:\x20`n=1`','stSchedule','lizeExisti','split','ttempts\x20IN','db\x20delete\x20','CREMENT,\x0a\x20','=\x20?','No\x20schedul','\x20freq:','ring','hedules.\x20E','EGER\x20DEFAU','O\x20schedule','\x20found\x20acr','found\x20for\x20','REATE\x20TABL','\x20<number>\x20','empt\x20#','CREATE\x20TAB','startOf','ed\x20frequen','gacy\x20sched','T\x201,\x0a\x20\x20\x20\x20\x20','TEGER,\x0a\x20\x20\x20','available','filter','itialized\x20','7863667ShqHoe','frequency','push','videoMessa','jid|all>','rval=','ed\x20delete\x20','t*\x0aâ€£\x20View\x20','\x20\x20\x20\x20enable','H:mm>\x20[Nda','db_failed','\x20->\x20','8295528QWGfyP','utor\x20error','s).\x20gp:<al','\x20\x20\x20\x20\x20\x20\x20cha','ncy*\x20`<num','error:\x20','msg','EXISTS\x20idx','hed\x20freque','ite_master','ed\x20edit*\x20`','gration\x20do','onnection(','er>`\x0aâ€£\x20Re-','ndexes\x20pro','enabled','WHERE\x20chat','Unsupporte','delete','leByDBId\x20e','ed,\x20schedu','ings\x20(\x0a\x20\x20\x20','gp:<alias|','set','Please\x20pro','gs\x20(\x0a\x20\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20','timestamp','not\x20availa','led\x20messag','add','has','ap\x20tables\x20','41276jRjVcw','\x20\x20\x20);\x0a\x20\x20\x20\x20','essage\x20TEX','ed\x20message','\x20failed:\x20','CREATE\x20IND','livery\x20per','livery\x20att','\x20WHERE\x20id\x20','ded\x20last_a','\x20all','time_at','\x20?\x20ORDER\x20B','in\x20N\x20hours','backup_','_RETRIES','not-availa','o\x20recurrin','vided.\x20Usa','d_time','heduler\x20st','\x20is\x20provid','If\x20`Ndays`','unsupporte','s)\x20across\x20','DATETIME_M','empt\x20colum','ts\x20(','timezone','\x20=\x20?','one-off\x20fo','join','MN\x20send_at',',\x27now\x27))','pdate\x20hand','status','s\x20(chat_ji','\x20scheduled','length','ates)','edules\x20SET','for\x20','SCHED_INIT','sendMessag','nd\x20attempt','INTEGER\x20DE','th\x20/setdef','EGER,\x0a\x20\x20\x20\x20','plies\x20(fro','\x20updated\x20t','Africa/Nai','`<HH:mm\x20|\x20','ed\x20add*\x20`<','as|jid|all','setup\x20send','all','EFAULT\x20\x27da','\x20available','ded\x20schedu','ULL','ULL,\x0a\x20\x20\x20\x20\x20','ðŸ“…\x20*SchedHe','>`\x0aâ€£\x20Tempo','arted\x20(ali','listRespon','s):\x20','TEGER\x20DEFA','days','rarily\x20dis','e\x20TEXT\x0a\x20\x20\x20','startsWith','ES\x20(?,\x20?,\x20','\x20(chat_jid','extendedTe','type','hat_jid);','schedules_','_chat\x20ON\x20s','trim','\x20but\x20faile','\x20Delete\x20on','\x20\x20\x20\x20);','\x20|\x20all>`\x0aâ€£','mm>`\x20`[Nda','uld\x20not\x20ad','\x20(\x0a\x20\x20\x20\x20\x20\x20\x20','ecutor\x20ite','Api\x20(manag','hasSame','e\x20FROM\x20sql','[sched]\x20in','les','livered\x20re','toMillis','E\x20schedule','=\x20OFF;','nutes)','\x20time.\x0a\x0a>\x20','s*\x0a\x0a>\x20*sch','eign_keys\x20','include\x20gp','resolveNam','robi','[sched]\x20se','s\x20INTEGER,','No\x20valid\x20i','no\x20sendApi','K_INTERVAL','\x20done;\x20sen','t\x20lines\x20â€”\x20','e\x20#','IF\x20NOT\x20EXI',')\x20id:','\x20when:','MN\x20last_at','g\x20at\x20','bled\x20state','SCHED_CHEC','sage,\x20time','ler\x20error:','recoverabl','[sched]\x20Fi','GER','\x20\x20\x20\x20\x20\x20\x20\x20se','\x20\x20\x20enabled','d\x20delete\x201',',\x0a\x20\x20','ttonId','d\x20removed\x20','author','rget\x20avail','moveAllSch','number','2506436dpqRUB','one\x20error:','2\x20days,\x20et','keys','TEXT\x20NOT\x20N','mat\x20for\x20ed','\x20->\x20id:','remoteJid','ed\x20edit\x20<n','unrecovera','s.\x0a\x0a>\x20*sch','nnection.u','able\x20(expl','1\x20ORDER\x20BY','2622384TGzcyW','singleSele','[sched]\x20mi','isInteger','anaging\x20sc','ROM\x20schedu','ed\x20add\x20<HH','IAL_BACKOF','update\x20fre','_MS','TEXT','_jid,\x20enab','toLocaleSt','\x0a\x20\x20\x20\x20\x20\x20\x20VA',',\x20timezone',',\x20send_at,','\x20for\x20id=',',\x20time,\x20se','hat\x20error:','empts\x20colu','DELETE\x20FRO','ime\x20inline','Usage:\x20sch','indexOf','\x20\x20\x20\x20\x20\x20\x20\x20en','AND\x20name=?','uled\x20messa','shed:\x20inte','sage...>\x20g','p:<alias|j','ttempt\x20col','r:\x20','time\x20TEXT,','day','efaults.','string','[sched]\x20ca',',\x0a\x20\x20\x20\x20\x20\x20\x20\x20','s\x20ADD\x20COLU','EX\x20IF\x20NOT\x20','last_sent','last_attem','includes','it.','chat',',\x20?,\x20?,\x20?,','selectedBu','schedule_t','essage.\x0a','es\x20created','FAULT\x201','mber,numbe','min','[sched]\x20up','edule.','LUES\x20(?,\x20?','lp\x20Command','EXISTS\x20sch','*sched\x20lis','\x20daily,\x20`n','uires\x20bot\x20','nal\x20send\x20a','Scheduled\x20','weekly','T\x20(strftim','dScheduleR','normalizeT','\x20id\x20INTEGE','E\x20IF\x20NOT\x20E','nd_attempt','rate','\x20chat:','[sched]\x20sw','dings\x20erro','>\x20<n>\x20\x20(n=','solveDefau','not\x20found','\x20frequency','conversati','delete:\x20','ry\x20on\x20next',':\x20bot\x20JID\x20','sched.init','\x20PRIMARY\x20K','[sched]\x20id','selectedRo','SCHED_DEFA','created_by','m\x20error\x20fo','e\x20from\x20DB;','opped','match','ration\x20fai','r_jid\x20TEXT','update\x20ena','`\x0aâ€£\x20Set\x20re','\x0a\x20\x20\x20\x20\x20\x20CRE','\x20|\x20YYYY-MM','sage.\x0a\x0a>\x20*','\x0a\x20\x20\x20\x20\x20\x20\x20\x20e','chat_jid','DEFAULT\x201,','delete\x201\x202','ted\x20target','forbidden','recurrence','leFields\x20e','toSeconds','p\x20error:\x20','led\x20entrie','s\x20at\x20given','ble\x20error\x20','run','\x20set\x20to\x20','=2`\x20every\x20','[sched]\x20fa','\x20\x20\x20\x20freque','dules_new\x20','o\x20one-off\x20','every','enable','ame\x20line\x20a','lastID','livered\x20an','[sched]\x20ad','UPDATE\x20sch','|jid|all>','\x20or\x20on\x20nex','SELECT\x20nam','ndleSchedC','ed\x20disable','>`\x20`<messa','time.','d\x20TEXT\x20PRI','[sched]\x20DB','\x5c$&','itial\x20exec','ction.upda','LT\x200','ATE\x20TABLE\x20','\x0amsg:\x0a','s\x20WHERE\x20ch','mezone\x20TEX','hhmm','t\x20INTEGER,','PRAGMA\x20tab','ngSchedule','once','2.4.0','utes>\x20<mes','isNaN','mns\x20error\x20','â€£\x20One-off\x20','duler_sett','chat_jid\x20=','d_at)\x20VALU','disable','default\x20wi','ys:','T\x20NOT\x20NULL','ble','curring\x20id','reason','.\x20Will\x20ret','schedules','Failed\x20to\x20','IMARY\x20KEY\x20','eated\x20sche','\x20scheduler','umn','.)\x20gp:<ali','text','success','toFormat','trimEnd','d\x20time\x20for','datetime','STS\x20schedu','ms\x20default','ast_attemp','sendAt',',\x20last_sen','hed).\x20Disa','GER\x20DEFAUL','[sched]\x20ha','M\x20schedule','fromMillis','\x0a\x20\x20\x20\x20\x20\x20\x20\x20s','sendat','target_jid','created_at','list','AUTOINCREM','sched','\x20NOT\x20NULL,','ded\x20send_a','when','changes','[sched]\x20Le','PRAGMA\x20for','ple\x20schedu','assign','s):\x0a','[sched]\x20is','ys]`\x20`<mes','ommandGrou','connection','jid','d|all>\x20inl','INTEGER','sock','no\x20send\x20ta','\x20days,\x20etc','r_settings','aged\x20conne','sForChat\x20e','send','parse\x20new\x20','led:\x20','ber>`\x20`<n>','lumn','toISO','there\x0amore','d\x20send_att','ncy\x20TEXT,\x0a','LE\x20schedul','\x20|\x20number,','\x20all\x20gp:<a','disabled\x20m','ttempts\x20co','eator_jid)','<number|nu','dules;','`\x0aâ€£\x20Change','reated_at\x20','KEY\x20AUTOIN','imageMessa','body','every_n_da','Failed\x20for','ed\x20schedul','*\x20`<number','):\x0a\x0a','daily','M-DDTHH:mm','@g.us','d\x20to\x20backu','\x0a\x20\x20\x20\x20\x20\x20\x20\x20m','_jid\x20=\x20?','SELECT\x20*\x20F','ed\x20once\x20<H','ltChatJids','|in\x20N\x20hour','10pQYtJO','or\x20on\x20foll','fromISO','scheduled_','ys]\x20<messa','R\x20PRIMARY\x20','ge...>`\x0aâ€£\x20','umber>\x20<HH','led,\x20send_','gister\x20man','fig\x20regist','hed\x20delete','[sched]\x20en','without\x20de','zoneName','defaults:\x20','s\x20canonica','nnection\x20','le*\x20`<numb','\x20target(s)','\x20connectio','oss\x20reques','pts','[sched]\x20re','ed\x20','ek:','d,\x20message','s_new\x20RENA','chat_id','hedules\x20ta','\x0a\x20\x20\x20\x20\x20\x20\x20\x20l',':mm|YYYY-M','rror:\x20','EY,\x0a\x20\x20\x20\x20\x20\x20','sent_at','d|all>)','rved\x20-\x20re-','instance','adAndNorma','bleExists\x20','data','th:','FAULT\x20(str','slice','ours|YYYY-','able\x20a\x20sch','n:\x20','.\x20Not\x20retr','\x20id\x20ASC','Could\x20not\x20','[sched]\x20sc','LT\x20\x27daily\x27','\x20\x20\x20\x20\x20\x20\x20\x20ti',':<alias|ji','now','oUserJid','time','padStart','MM-DDTHH:m','ponseMessa','xtMessage','creator_ji','=\x20ON;','FAULT\x200','failed:\x20','[sched]\x20cr','cy\x20<number','[sched]\x20ge','[sched]\x20ho','\x20timezone\x20','bling\x20sche','w\x27))\x0a\x20\x20\x20\x20\x20','unknown','HH:mm','es\x20(\x0a\x20\x20','sched\x20enab','enable\x20a\x20p','ection\x20upd','or\x20max\x20att','iled:\x20','\x20default\x20c','-DDTHH:mm>','setZone','\x20error:\x20','53hWlIlV','\x20lines\x0agp:','\x20messages\x20','update\x20sch','e\x20for\x20','ommandPM\x20e','No\x20changes','_schedules','gned\x20to\x20mi','getUniqueJ','findings','\x20\x20\x20\x20\x20\x20\x20\x20cr','?,\x20?,\x20?,\x20?','nd_at,\x20fre','\x22.\x20Use\x20gp:','at\x20','\x20?,\x20?)','ME\x20TO\x20sche','\x20INTEGER,\x0a','PM\x20usage:\x20','es.\x0a\x0a>\x20*sc','ULT_TIMEZO','Y\x20id\x20ASC','\x20);','ily\x27,\x0a\x20\x20\x20\x20'];_0x82f4=function(){return _0x51f0b7;};return _0x82f4();}export const configKeys=['SCHED_CHEC'+'K_INTERVAL'+_0x563749(0x10d),_0x563749(0x15a)+_0x563749(0x26a)+'NE',_0x563749(0x2a1)+_0x563749(0x368),_0x563749(0x383)+_0x563749(0x10b)+'F_MS'];let botRef=null,sendApi=null,schedulerIntervalHandle=null,executorRunning=![],CHECK_INTERVAL_MS=(0x12f9*0x1+0x622+-0x18df)*(0x26*0x37+0x53*-0x49+-0x1369*-0x1),DEFAULT_TIMEZONE=_0x563749(0x38b)+_0x563749(0x3bf),SEND_RETRIES=-0x264d+0xb38+0x1b18,INITIAL_BACKOFF_MS=-0x41*-0x13+0x265*0x8+-0x1607;const MAX_DB_ATTEMPTS=-0x4bb+0x5*0x121+-0xe7;function ensureArray(_0x13f929){const _0x551608=_0x563749;if(!_0x13f929)return[];if(Array[_0x551608(0x30d)](_0x13f929))return _0x13f929;return[_0x13f929];}function uniqArray(_0x4e27ed){const _0x3a02ab=_0x563749,_0xf7d030=new Set(),_0x7ddfc4=[];for(const _0x201875 of _0x4e27ed||[]){const _0x538d7a=String(_0x201875||'')['trim']();if(!_0x538d7a)continue;!_0xf7d030[_0x3a02ab(0x357)](_0x538d7a)&&(_0xf7d030[_0x3a02ab(0x356)](_0x538d7a),_0x7ddfc4[_0x3a02ab(0x32e)](_0x538d7a));}return _0x7ddfc4;}async function tableExists(_0x622d4f){const _0x32f7d0=_0x563749;try{const _0x3eab22=await db[_0x32f7d0(0x2d5)](_0x32f7d0(0x184)+_0x32f7d0(0x3b2)+_0x32f7d0(0x341)+'\x20WHERE\x20typ'+'e=\x27table\x27\x20'+_0x32f7d0(0x11d),[_0x622d4f]);return!!_0x3eab22;}catch(_0x39cd4a){return warn('[sched]\x20ta'+_0x32f7d0(0x228)+_0x32f7d0(0x33d)+(_0x39cd4a?.[_0x32f7d0(0x2d1)]||_0x39cd4a)),![];}}async function getTableColumns(_0x430861){const _0x2bdb8b=_0x563749;try{const _0x18dd3f=await db[_0x2bdb8b(0x390)](_0x2bdb8b(0x195)+_0x2bdb8b(0x2ca)+_0x430861+')');return(_0x18dd3f||[])[_0x2bdb8b(0x2e0)](_0x344513=>_0x344513['name']);}catch(_0x2ab1e7){return warn(_0x2bdb8b(0x244)+_0x2bdb8b(0x276)+_0x2bdb8b(0x19b)+_0x2bdb8b(0x382)+_0x430861+':\x20'+(_0x2ab1e7?.['message']||_0x2ab1e7)),[];}}function resolveChatJidFromRow(_0x19bb90){const _0x51fa9a=_0x563749,_0x25c42b=[_0x51fa9a(0x168),_0x51fa9a(0x30c),_0x51fa9a(0x21d),'jid',_0x51fa9a(0x130),'room',_0x51fa9a(0x1c1)];for(const _0xe74230 of _0x25c42b)if(_0xe74230 in _0x19bb90&&_0x19bb90[_0xe74230])return String(_0x19bb90[_0xe74230]);for(const _0x5f3ccf of Object[_0x51fa9a(0x3e1)](_0x19bb90)){const _0x4ef87c=_0x19bb90[_0x5f3ccf];if(typeof _0x4ef87c===_0x51fa9a(0x127)&&_0x4ef87c[_0x51fa9a(0x12e)]('@'))return _0x4ef87c;}return null;}function resolveMessageFromRow(_0x549ec1){const _0x57e7b3=_0x563749,_0x50ad8d=[_0x57e7b3(0x2d1),_0x57e7b3(0x33e),_0x57e7b3(0x1af),_0x57e7b3(0x1f1),_0x57e7b3(0x2b1)];for(const _0x4bba53 of _0x50ad8d)if(_0x4bba53 in _0x549ec1&&_0x549ec1[_0x4bba53]!=null)return String(_0x549ec1[_0x4bba53]);for(const _0xfaf2a9 of Object['keys'](_0x549ec1)){if(typeof _0x549ec1[_0xfaf2a9]===_0x57e7b3(0x127)&&_0x549ec1[_0xfaf2a9]['length']>0x1*-0x57+0x26c1*-0x1+0x2718&&!_0x549ec1[_0xfaf2a9][_0x57e7b3(0x12e)]('@'))return _0x549ec1[_0xfaf2a9];}return'';}function resolveWhenFromRow(_0x46b643){const _0x3b106b=_0x563749,_0xf53953=[_0x3b106b(0x2df),_0x3b106b(0x1b8),_0x3b106b(0x1c0),_0x3b106b(0x1dc),_0x3b106b(0x353),'ts',_0x3b106b(0x364)];for(const _0x5646df of _0xf53953){if(_0x5646df in _0x46b643&&_0x46b643[_0x5646df]){const _0x4ca88a=Number(_0x46b643[_0x5646df]);if(!Number[_0x3b106b(0x19a)](_0x4ca88a)&&_0x4ca88a>0x1433a3aa+-0x72a57ba4+0x2*0x4d0650fd)return{'send_at':_0x4ca88a};}}const _0x5c8273=[_0x3b106b(0x239),_0x3b106b(0x193),_0x3b106b(0x133)+'ime',_0x3b106b(0x204)+_0x3b106b(0x239)];for(const _0x4bf850 of _0x5c8273){if(_0x4bf850 in _0x46b643&&_0x46b643[_0x4bf850]){const _0x5ba48b=String(_0x46b643[_0x4bf850])[_0x3b106b(0x3a7)]();if(/^\d{1,2}:\d{2}$/[_0x3b106b(0x2ec)](_0x5ba48b))return{'time':_0x5ba48b};}}return{'time':null,'send_at':null};}async function readAndNormalizeExistingSchedules(){const _0x5be9d1=_0x563749;try{const _0x102e59=await db[_0x5be9d1(0x390)](_0x5be9d1(0x1fd)+_0x5be9d1(0x109)+_0x5be9d1(0x3b4)),_0x337fd6=[];for(const _0x1bdab3 of _0x102e59||[]){const _0x2c44b6=resolveChatJidFromRow(_0x1bdab3)||'',_0x1f7032=resolveMessageFromRow(_0x1bdab3)||'',_0x5ae036=resolveWhenFromRow(_0x1bdab3)||{};let _0x55e608=_0x1bdab3['frequency']||_0x1bdab3['freq']||_0x1bdab3['repeat']||_0x1bdab3[_0x5be9d1(0x16d)]||'daily';if(typeof _0x55e608===_0x5be9d1(0x3dd))_0x55e608='every_n_da'+_0x5be9d1(0x1a2)+_0x55e608;const _0xe51352=_0x1bdab3[_0x5be9d1(0x375)]||_0x1bdab3['tz']||null,_0x4b0044=_0x1bdab3['creator_ji'+'d']||_0x1bdab3['created_by']||_0x1bdab3[_0x5be9d1(0x3da)]||_0x1bdab3[_0x5be9d1(0x28f)]||'';let _0x40290d=Number(_0x1bdab3[_0x5be9d1(0x1c2)]||_0x1bdab3['ts']||_0x1bdab3[_0x5be9d1(0x353)]||0x1*0x1e07+0x269f+-0x44a6);if(!_0x40290d)_0x40290d=Math[_0x5be9d1(0x2d8)](Date[_0x5be9d1(0x237)]()/(-0xa4c+-0x23ad*0x1+0x31e1));_0x337fd6['push']({'chat_jid':_0x2c44b6,'message':_0x1f7032,'time':_0x5ae036[_0x5be9d1(0x239)]||null,'send_at':_0x5ae036[_0x5be9d1(0x2df)]||null,'frequency':_0x55e608||'daily','timezone':_0xe51352,'last_sent':Number(_0x1bdab3[_0x5be9d1(0x12c)]||_0x1bdab3[_0x5be9d1(0x223)]||-0x93d+0xe65+-0x14a*0x4)||0x1cf5+-0x1fe4+0x2ef,'creator_jid':_0x4b0044||'','created_at':_0x40290d});}return _0x337fd6;}catch(_0x35ba50){return warn('[sched]\x20re'+_0x5be9d1(0x227)+_0x5be9d1(0x312)+_0x5be9d1(0x196)+'s\x20failed:\x20'+(_0x35ba50?.[_0x5be9d1(0x2d1)]||_0x35ba50)),[];}}async function ensureSchema(){const _0x4e18e3=_0x563749,_0x26ee5b={'id':_0x4e18e3(0x287)+_0x4e18e3(0x1aa)+_0x4e18e3(0x1c4)+_0x4e18e3(0x295),'chat_jid':_0x4e18e3(0x3e2)+_0x4e18e3(0x394),'message':'TEXT\x20NOT\x20N'+'ULL','time':_0x4e18e3(0x10e),'send_at':'INTEGER','frequency':'TEXT\x20DEFAU'+_0x4e18e3(0x234),'timezone':'TEXT','last_sent':_0x4e18e3(0x1d5),'creator_jid':_0x4e18e3(0x3e2)+_0x4e18e3(0x394),'enabled':'INTEGER\x20DE'+_0x4e18e3(0x136),'send_attempts':_0x4e18e3(0x386)+_0x4e18e3(0x240),'last_attempt':'INTEGER','created_at':_0x4e18e3(0x386)+_0x4e18e3(0x22b)+_0x4e18e3(0x30f)+_0x4e18e3(0x37a)};try{const _0x43aac2=await tableExists('schedules');if(!_0x43aac2){const _0x121429=Object['entries'](_0x26ee5b)['map'](([_0x7b2fe8,_0x762a89])=>_0x7b2fe8+'\x20'+_0x762a89)[_0x4e18e3(0x378)](_0x4e18e3(0x3d7));await db[_0x4e18e3(0x2dc)]('CREATE\x20TAB'+_0x4e18e3(0x1e5)+_0x4e18e3(0x24b)+_0x121429+_0x4e18e3(0x29d));try{await db['exec']('CREATE\x20IND'+_0x4e18e3(0x12b)+_0x4e18e3(0x33f)+_0x4e18e3(0x25c)+_0x4e18e3(0x3a6)+_0x4e18e3(0x2c8)+'hat_jid);');}catch(_0x374d27){}info(_0x4e18e3(0x242)+_0x4e18e3(0x292)+'nical\x20sche'+'dules\x20tabl'+'e'),await db[_0x4e18e3(0x2dc)]('\x0a\x20\x20\x20\x20\x20\x20\x20\x20C'+_0x4e18e3(0x320)+_0x4e18e3(0x148)+_0x4e18e3(0x2b0)+'duler_sett'+_0x4e18e3(0x34d)+'\x20\x20\x20\x20\x20\x20\x20cha'+_0x4e18e3(0x2f3)+_0x4e18e3(0x157)+_0x4e18e3(0x222)+_0x4e18e3(0x334)+_0x4e18e3(0x298)+_0x4e18e3(0x169)+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x4e18e3(0x246)+_0x4e18e3(0x283)+_0x4e18e3(0x35a)+'\x20\x20');return;}const _0x5d741f=await getTableColumns(_0x4e18e3(0x1a8)),_0x1cb3cd=_0x5d741f[_0x4e18e3(0x12e)](_0x4e18e3(0x168)),_0x12cf4f=_0x5d741f['includes'](_0x4e18e3(0x2d1))||_0x5d741f[_0x4e18e3(0x12e)](_0x4e18e3(0x33e))||_0x5d741f[_0x4e18e3(0x12e)](_0x4e18e3(0x1f1))||_0x5d741f['includes']('text'),_0x19f68d=_0x5d741f['includes'](_0x4e18e3(0x23e)+'d')||_0x5d741f[_0x4e18e3(0x12e)](_0x4e18e3(0x15b))||_0x5d741f[_0x4e18e3(0x12e)](_0x4e18e3(0x3da));if(_0x1cb3cd&&_0x12cf4f&&_0x19f68d){if(!_0x5d741f[_0x4e18e3(0x12e)](_0x4e18e3(0x28c)+_0x4e18e3(0x217)))try{await db['exec'](_0x4e18e3(0x2b5)+_0x4e18e3(0x3b7)+_0x4e18e3(0x12a)+_0x4e18e3(0x379)+'tempts\x20INT'+_0x4e18e3(0x31c)+_0x4e18e3(0x18e)),info(_0x4e18e3(0x180)+_0x4e18e3(0x1c7)+_0x4e18e3(0x1e9)+_0x4e18e3(0x1e0));}catch(_0x336482){warn(_0x4e18e3(0x2b8)+_0x4e18e3(0x3ad)+_0x4e18e3(0x1e3)+_0x4e18e3(0x117)+_0x4e18e3(0x2e4)+(_0x336482?.[_0x4e18e3(0x2d1)]||_0x336482));}if(!_0x5d741f[_0x4e18e3(0x12e)](_0x4e18e3(0x12d)+'pt'))try{await db[_0x4e18e3(0x2dc)](_0x4e18e3(0x2b5)+'E\x20schedule'+_0x4e18e3(0x12a)+_0x4e18e3(0x3cb)+_0x4e18e3(0x30a)+_0x4e18e3(0x3d3)),info(_0x4e18e3(0x180)+_0x4e18e3(0x362)+_0x4e18e3(0x122)+_0x4e18e3(0x1ad));}catch(_0xd28836){warn(_0x4e18e3(0x2b8)+_0x4e18e3(0x3ad)+'d\x20last_att'+_0x4e18e3(0x373)+_0x4e18e3(0x22f)+(_0xd28836?.[_0x4e18e3(0x2d1)]||_0xd28836));}try{await db[_0x4e18e3(0x2dc)](_0x4e18e3(0x35e)+_0x4e18e3(0x12b)+'EXISTS\x20idx'+_0x4e18e3(0x25c)+_0x4e18e3(0x3a6)+_0x4e18e3(0x2c8)+_0x4e18e3(0x3a4));}catch(_0x447809){}await db[_0x4e18e3(0x2dc)]('\x0a\x20\x20\x20\x20\x20\x20\x20\x20C'+_0x4e18e3(0x320)+_0x4e18e3(0x148)+'XISTS\x20sche'+_0x4e18e3(0x19d)+_0x4e18e3(0x34d)+_0x4e18e3(0x33b)+_0x4e18e3(0x2f3)+_0x4e18e3(0x157)+_0x4e18e3(0x222)+'\x20\x20\x20\x20enable'+'d\x20INTEGER\x20'+_0x4e18e3(0x169)+_0x4e18e3(0x352)+_0x4e18e3(0x246)+_0x4e18e3(0x283)+_0x4e18e3(0x35a)+'\x20\x20'),info(_0x4e18e3(0x233)+_0x4e18e3(0x21e)+_0x4e18e3(0x2ee)+_0x4e18e3(0x211)+'l/adequate');return;}info(_0x4e18e3(0x1ca)+_0x4e18e3(0x326)+_0x4e18e3(0x2e3)+'ted\x20â€”\x20migr'+_0x4e18e3(0x2bc)+'ly');const _0x349437=await readAndNormalizeExistingSchedules();await db[_0x4e18e3(0x2dc)](_0x4e18e3(0x1cb)+_0x4e18e3(0x3bc)+_0x4e18e3(0x3b8));try{await db[_0x4e18e3(0x2dc)](_0x4e18e3(0x323)+_0x4e18e3(0x275)+_0x4e18e3(0x13d)+_0x4e18e3(0x2c6)+_0x4e18e3(0x3ae)+_0x4e18e3(0x147)+_0x4e18e3(0x206)+_0x4e18e3(0x1ef)+_0x4e18e3(0x316)+_0x4e18e3(0x33b)+_0x4e18e3(0x2f3)+_0x4e18e3(0x1c6)+_0x4e18e3(0x1fb)+_0x4e18e3(0x35b)+_0x4e18e3(0x1a3)+_0x4e18e3(0x129)+_0x4e18e3(0x124)+_0x4e18e3(0x1bf)+_0x4e18e3(0x2cb)+'EGER,\x0a\x20\x20\x20\x20'+_0x4e18e3(0x178)+'ncy\x20TEXT\x20D'+_0x4e18e3(0x391)+_0x4e18e3(0x26d)+'\x20\x20\x20\x20timezo'+'ne\x20TEXT,\x0a\x20'+_0x4e18e3(0x309)+'t_sent\x20INT'+'EGER,\x0a\x20\x20\x20\x20'+_0x4e18e3(0x29e)+_0x4e18e3(0x161)+_0x4e18e3(0x1c6)+_0x4e18e3(0x167)+'nabled\x20INT'+_0x4e18e3(0x31c)+'LT\x201,\x0a\x20\x20\x20\x20'+_0x4e18e3(0x2b3)+_0x4e18e3(0x314)+_0x4e18e3(0x39b)+'ULT\x200,\x0a\x20\x20\x20'+'\x20\x20\x20\x20\x20last_'+'attempt\x20IN'+_0x4e18e3(0x328)+'\x20\x20\x20\x20\x20creat'+'ed_at\x20INTE'+_0x4e18e3(0x1bb)+_0x4e18e3(0x144)+'e(\x27%s\x27,\x27no'+_0x4e18e3(0x248)+_0x4e18e3(0x26c));}catch(_0x1956fd){await db[_0x4e18e3(0x2dc)](_0x4e18e3(0x323)+'LE\x20IF\x20NOT\x20'+_0x4e18e3(0x13d)+_0x4e18e3(0x2c6)+'\x20(\x0a\x20\x20\x20\x20\x20\x20\x20'+'\x20id\x20INTEGE'+'R\x20PRIMARY\x20'+_0x4e18e3(0x1ef)+'CREMENT,\x0a\x20'+_0x4e18e3(0x33b)+_0x4e18e3(0x2f3)+_0x4e18e3(0x1c6)+_0x4e18e3(0x1fb)+_0x4e18e3(0x35b)+'T\x20NOT\x20NULL'+',\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+'time\x20TEXT,'+_0x4e18e3(0x1bf)+_0x4e18e3(0x2cb)+_0x4e18e3(0x388)+_0x4e18e3(0x178)+_0x4e18e3(0x1e4)+_0x4e18e3(0x235)+_0x4e18e3(0x192)+'T,\x0a\x20\x20\x20\x20\x20\x20\x20'+_0x4e18e3(0x2ce)+'\x20INTEGER,\x0a'+_0x4e18e3(0x260)+_0x4e18e3(0x2f1)+_0x4e18e3(0x3e2)+_0x4e18e3(0x395)+_0x4e18e3(0x3d5)+_0x4e18e3(0x267)+_0x4e18e3(0x3d4)+_0x4e18e3(0x149)+_0x4e18e3(0x3c1)+_0x4e18e3(0x21f)+_0x4e18e3(0x1b7)+_0x4e18e3(0x194)+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20c'+_0x4e18e3(0x1ee)+'INTEGER\x0a\x20\x20'+_0x4e18e3(0x3aa)),warn('[sched]\x20cr'+_0x4e18e3(0x1ab)+_0x4e18e3(0x179)+_0x4e18e3(0x20e)+_0x4e18e3(0x2b9)+_0x4e18e3(0x2fe));}const _0x4a63c9=await db['prepare'](_0x4e18e3(0x2a5)+'O\x20schedule'+_0x4e18e3(0x2c3)+'t_jid,\x20mes'+_0x4e18e3(0x3cf)+_0x4e18e3(0x113)+_0x4e18e3(0x151)+_0x4e18e3(0x112)+_0x4e18e3(0x1b9)+'t,\x20creator'+_0x4e18e3(0x10f)+_0x4e18e3(0x209)+'attempts,\x20'+'last_attem'+'pt,\x20create'+_0x4e18e3(0x19f)+_0x4e18e3(0x3a0)+_0x4e18e3(0x261)+_0x4e18e3(0x131)+_0x4e18e3(0x273));try{for(const _0x56ff3c of _0x349437){try{await _0x4a63c9[_0x4e18e3(0x174)](_0x56ff3c['chat_jid']||'',_0x56ff3c['message']||'',_0x56ff3c[_0x4e18e3(0x239)]||null,_0x56ff3c['send_at']||null,_0x56ff3c[_0x4e18e3(0x32d)]||_0x4e18e3(0x1f7),_0x56ff3c[_0x4e18e3(0x375)]||null,_0x56ff3c['last_sent']||-0x1739+-0xa*0x107+0x1*0x217f,_0x56ff3c[_0x4e18e3(0x23e)+'d']||'',-0x1*0x1b56+-0x1*0x21cb+0x3d22,-0x2389+0x156f+0xe1a,null,_0x56ff3c[_0x4e18e3(0x1c2)]||Math[_0x4e18e3(0x2d8)](Date[_0x4e18e3(0x237)]()/(-0xc1*-0x7+-0x17c9+0x166a)));}catch(_0x48dd0b){warn(_0x4e18e3(0x128)+'nnot\x20inser'+'t\x20normaliz'+_0x4e18e3(0x1f4)+_0x4e18e3(0x259)+_0x56ff3c[_0x4e18e3(0x168)]+':\x20'+(_0x48dd0b?.[_0x4e18e3(0x2d1)]||_0x48dd0b));}}}finally{try{await _0x4a63c9['finalize']();}catch(_0x510963){}}try{const _0xcb557f=_0x4e18e3(0x3a5)+_0x4e18e3(0x367)+Math[_0x4e18e3(0x2d8)](Date[_0x4e18e3(0x237)]()/(0x1880+0xef8+-0x2390));await db['exec'](_0x4e18e3(0x2b5)+_0x4e18e3(0x3b7)+'s\x20RENAME\x20T'+'O\x20'+_0xcb557f+';'),await db['exec'](_0x4e18e3(0x2b5)+'E\x20schedule'+_0x4e18e3(0x21c)+_0x4e18e3(0x266)+_0x4e18e3(0x1ec));try{await db[_0x4e18e3(0x2dc)](_0x4e18e3(0x35e)+_0x4e18e3(0x12b)+_0x4e18e3(0x33f)+_0x4e18e3(0x25c)+'_chat\x20ON\x20s'+_0x4e18e3(0x2c8)+_0x4e18e3(0x3a4));}catch(_0x4db9c0){}info(_0x4e18e3(0x106)+_0x4e18e3(0x343)+_0x4e18e3(0x2a3)+_0x4e18e3(0x271)+_0x4e18e3(0x1fa)+'p');}catch(_0x33670e){warn(_0x4e18e3(0x14c)+_0x4e18e3(0x358)+_0x4e18e3(0x241)+(_0x33670e?.[_0x4e18e3(0x2d1)]||_0x33670e));throw _0x33670e;}finally{await db[_0x4e18e3(0x2dc)]('PRAGMA\x20for'+_0x4e18e3(0x3bc)+_0x4e18e3(0x23f));}await db[_0x4e18e3(0x2dc)](_0x4e18e3(0x164)+_0x4e18e3(0x18f)+_0x4e18e3(0x3c8)+_0x4e18e3(0x1b5)+_0x4e18e3(0x2d7)+_0x4e18e3(0x351)+_0x4e18e3(0x2c7)+_0x4e18e3(0x189)+'MARY\x20KEY,\x0a'+_0x4e18e3(0x11c)+'abled\x20INTE'+'GER\x20DEFAUL'+_0x4e18e3(0x327)+'\x20\x20\x20timezon'+_0x4e18e3(0x39e)+_0x4e18e3(0x35a));}catch(_0x32dd7a){error(_0x32dd7a,_0x4e18e3(0x20d)+_0x4e18e3(0x2f5)+_0x4e18e3(0x281));throw _0x32dd7a;}}function refreshConfig(){const _0x45400a=_0x563749;try{const _0x18b925=getConfig()||{};CHECK_INTERVAL_MS=Number(_0x18b925[_0x45400a(0x3ce)+_0x45400a(0x3c4)+'_MS']??CHECK_INTERVAL_MS),DEFAULT_TIMEZONE=_0x18b925[_0x45400a(0x15a)+_0x45400a(0x26a)+'NE']||DEFAULT_TIMEZONE,SEND_RETRIES=Number(_0x18b925[_0x45400a(0x2a1)+_0x45400a(0x368)]??SEND_RETRIES),INITIAL_BACKOFF_MS=Number(_0x18b925[_0x45400a(0x383)+_0x45400a(0x10b)+_0x45400a(0x2d0)]??INITIAL_BACKOFF_MS),info('[sched]\x20co'+'nfig\x20refre'+_0x45400a(0x11f)+_0x45400a(0x331)+CHECK_INTERVAL_MS+(_0x45400a(0x1b6)+'TZ=')+DEFAULT_TIMEZONE);}catch(_0x2b1fc4){warn(_0x45400a(0x218)+'freshConfi'+'g\x20error:\x20'+(_0x2b1fc4?.[_0x45400a(0x2d1)]||_0x2b1fc4));}}try{typeof hotReloadConfig==='function'&&hotReloadConfig((_0x1ebbe8=[])=>{const _0x458c0a=_0x563749;try{refreshConfig();}catch(_0x138b2e){warn(_0x458c0a(0x245)+'tReload\x20ha'+'ndler\x20erro'+'r:\x20'+(_0x138b2e?.[_0x458c0a(0x2d1)]||_0x138b2e));}});}catch(_0x9f4d96){warn(_0x563749(0x245)+_0x563749(0x294)+_0x563749(0x20b)+_0x563749(0x160)+_0x563749(0x1de)+(_0x9f4d96?.[_0x563749(0x2d1)]||_0x9f4d96));}refreshConfig();function tryBuildSendApiFromBot(_0x214729){const _0x25f703=_0x563749;if(!_0x214729)return null;if(typeof _0x214729['sendMessag'+'e']===_0x25f703(0x270))return async(_0x2e224e,_0x53453c)=>_0x214729[_0x25f703(0x384)+'e'](_0x2e224e,_0x53453c);else{if(_0x214729['sock']&&typeof _0x214729[_0x25f703(0x1d6)][_0x25f703(0x384)+'e']===_0x25f703(0x270))return async(_0x401cf3,_0x621caf)=>_0x214729[_0x25f703(0x1d6)][_0x25f703(0x384)+'e'](_0x401cf3,_0x621caf);}return null;}function setupSendApi(_0x43fd85){const _0x2ce49b=_0x563749;botRef=_0x43fd85,sendApi=tryBuildSendApiFromBot(botRef),info(_0x2ce49b(0x3c0)+_0x2ce49b(0x27f)+_0x2ce49b(0x3c5)+'dApi\x20'+(sendApi?_0x2ce49b(0x329):_0x2ce49b(0x369)+_0x2ce49b(0x1a4)));}async function performSend(_0x46d797,_0x5657c5){const _0x4c2b75=_0x563749,_0xd4dcfc=_0x46d797||null;if(!_0xd4dcfc)throw new Error(_0x4c2b75(0x1d7)+_0x4c2b75(0x3db)+_0x4c2b75(0x3ea)+'icit\x20targe'+'t\x20required'+')');if(typeof sendApi===_0x4c2b75(0x270)){await sendApi(_0xd4dcfc,_0x5657c5);return;}if(botRef&&typeof botRef[_0x4c2b75(0x384)+'e']==='function'){await botRef[_0x4c2b75(0x384)+'e'](_0xd4dcfc,_0x5657c5);return;}if(botRef&&botRef[_0x4c2b75(0x1d6)]&&typeof botRef['sock'][_0x4c2b75(0x384)+'e']===_0x4c2b75(0x270)){await botRef[_0x4c2b75(0x1d6)]['sendMessag'+'e'](_0xd4dcfc,_0x5657c5);return;}throw new Error(_0x4c2b75(0x3c3)+_0x4c2b75(0x392));}async function sendWithRetry(_0x5e719c,_0x4a9305){const _0x46b319=_0x563749,_0x39b4ff=Number(SEND_RETRIES||-0xcbb+-0xc12+0x18d0);let _0x23adb4=-0x746+0x6fe+-0x24*-0x2,_0x444d6b=Number(INITIAL_BACKOFF_MS||0x1f97+0x2a1*-0x6+-0xddd);while(_0x23adb4<_0x39b4ff){try{return await performSend(_0x5e719c,_0x4a9305),!![];}catch(_0x4425c0){_0x23adb4++;const _0x37f771=String(_0x4425c0?.[_0x46b319(0x2d1)]||'')[_0x46b319(0x2f7)+'e']()['includes'](_0x46b319(0x14a))||_0x4425c0?.[_0x46b319(0x37c)]===0x5e3*0x3+-0x236d+-0x2c7*-0x7;warn(_0x46b319(0x3c0)+_0x46b319(0x385)+'\x20'+_0x23adb4+'\x20failed:\x20'+(_0x4425c0?.[_0x46b319(0x2d1)]||_0x4425c0));if(_0x23adb4>=_0x39b4ff||!_0x37f771)return![];await new Promise(_0x2a6458=>setTimeout(_0x2a6458,_0x444d6b)),_0x444d6b*=-0x4ac+-0x96b+0xe19;try{setupSendApi(botRef);}catch(_0x1959ba){}}}return![];}async function sendScheduledMessage(_0x599b15){const _0x3eed82=_0x563749,{id:_0xdc6291,chat_jid:_0x16adf4,message:_0x13b685}=_0x599b15,_0x274fcb={'text':_0x13b685},_0x4c7188=Number(SEND_RETRIES||0x17ec*0x1+-0x646+-0x11a3);let _0x479859=0x1*-0x3b+-0x2117+0x2152,_0x29721f=Number(INITIAL_BACKOFF_MS||0xbe6+0x16f*-0x5+-0x1*0x2c7);while(_0x479859<_0x4c7188){_0x479859++;try{return await performSend(_0x16adf4,_0x274fcb),{'success':!![],'unrecoverable':![]};}catch(_0x34b173){const _0x1ad1f4=_0x34b173?.['message']||String(_0x34b173),_0x5666c4=_0x1ad1f4[_0x3eed82(0x2f7)+'e']()[_0x3eed82(0x12e)](_0x3eed82(0x16c))||_0x34b173?.[_0x3eed82(0x229)]===0xb8*0x5+-0xa0b+0x806,_0x1aa00f=_0x1ad1f4[_0x3eed82(0x2f7)+'e']()[_0x3eed82(0x12e)](_0x3eed82(0x150))||_0x34b173?.[_0x3eed82(0x229)]===0x54*0x5b+0x1cec+-0x3934;warn(_0x3eed82(0x3c0)+'nd\x20attempt'+'\x20'+_0x479859+'/'+_0x4c7188+_0x3eed82(0x114)+_0xdc6291+_0x3eed82(0x35d)+_0x1ad1f4);if(_0x5666c4||_0x1aa00f)return error('[sched]\x20Un'+_0x3eed82(0x3d1)+'e\x20error\x20fo'+_0x3eed82(0x277)+_0xdc6291+':\x20'+_0x1ad1f4+(_0x3eed82(0x230)+_0x3eed82(0x282))),{'success':![],'unrecoverable':!![]};if(_0x479859>=_0x4c7188)return error(_0x3eed82(0x3d2)+_0x3eed82(0x141)+'ttempt\x20fai'+_0x3eed82(0x27e)+'='+_0xdc6291+'.'),{'success':![],'unrecoverable':![]};await new Promise(_0x46d52d=>setTimeout(_0x46d52d,_0x29721f)),_0x29721f*=-0xfdf+0x2456+0x1475*-0x1;try{setupSendApi(botRef);}catch(_0x4410cb){}}}return{'success':![],'unrecoverable':![]};}function parseTimeToken(_0x59396a,_0x35876c=DEFAULT_TIMEZONE){const _0x192e70=_0x563749;if(!_0x59396a||typeof _0x59396a!=='string')return null;const _0xcc0c59=_0x59396a[_0x192e70(0x3a7)](),_0xed14f1=_0xcc0c59['match'](/^in\s+(\d+)\s*(minute|min|minutes|m|hour|hours|hr|h|day|days|d)$/i);if(_0xed14f1){const _0x4059ca=Number(_0xed14f1[-0x1354+0x1927*0x1+-0xa*0x95]),_0x495f0e=_0xed14f1[0x3*-0x51+-0xea*0x11+0x107f]['toLowerCas'+'e']();let _0x1b6c6f=DateTime[_0x192e70(0x237)]()[_0x192e70(0x253)](_0x35876c);if(_0x495f0e[_0x192e70(0x39f)](_0x192e70(0x138))||_0x495f0e==='m')_0x1b6c6f=_0x1b6c6f[_0x192e70(0x2e7)]({'minutes':_0x4059ca});else{if(_0x495f0e['startsWith']('h')||_0x495f0e['startsWith']('hr'))_0x1b6c6f=_0x1b6c6f[_0x192e70(0x2e7)]({'hours':_0x4059ca});else{if(_0x495f0e[_0x192e70(0x39f)]('d'))_0x1b6c6f=_0x1b6c6f[_0x192e70(0x2e7)]({'days':_0x4059ca});}}if(_0x1b6c6f['isValid'])return{'type':_0x192e70(0x1b4),'dt':_0x1b6c6f};}if(/^\d{4}-\d{2}-\d{2}[ T]\d{1,2}:\d{2}$/[_0x192e70(0x2ec)](_0xcc0c59)){const _0xbc788f=_0xcc0c59[_0x192e70(0x29a)]('\x20','T'),_0x214445=DateTime[_0x192e70(0x203)](_0xbc788f,{'zone':_0x35876c});if(_0x214445[_0x192e70(0x279)])return{'type':_0x192e70(0x1b4),'dt':_0x214445};}if(/^\d{1,2}:\d{2}$/[_0x192e70(0x2ec)](_0xcc0c59)){const [_0x31d709,_0x3d1b42]=_0xcc0c59[_0x192e70(0x313)](':')[_0x192e70(0x2e0)](Number);if(Number[_0x192e70(0x107)](_0x31d709)&&Number[_0x192e70(0x107)](_0x3d1b42)&&_0x31d709>=-0x238d+0xb06+0x15*0x12b&&_0x31d709<=-0x1a4c+-0x7*0x278+0x63d*0x7&&_0x3d1b42>=-0x56*0x42+-0xa*-0x200+0x22c*0x1&&_0x3d1b42<=0x28d*-0x9+-0x244+0x1974)return{'type':_0x192e70(0x193),'hhmm':String(_0x31d709)['padStart'](-0xb37+-0xfe8+0x1b21*0x1,'0')+':'+String(_0x3d1b42)[_0x192e70(0x23a)](-0xd73+0x2*0xae3+-0x851,'0')};}return null;}function shouldSendSlot(_0x33be4f,_0x30fe74){const _0x3b8379=_0x563749,_0x1c409c=_0x33be4f[_0x3b8379(0x32d)]||_0x3b8379(0x1f7),_0x16bc15=_0x33be4f[_0x3b8379(0x12c)]||0x21d9+0x41d+-0x25f6,_0x1ba70a=_0x16bc15?DateTime['fromMillis'](_0x16bc15*(0x44*0x28+0x5*-0x623+0x17f7))[_0x3b8379(0x253)](_0x30fe74[_0x3b8379(0x2bd)]):null;if(!_0x1ba70a)return!![];if(_0x1c409c===_0x3b8379(0x1f7))return!_0x1ba70a[_0x3b8379(0x3b1)](_0x30fe74,_0x3b8379(0x125));if(_0x1c409c===_0x3b8379(0x143))return _0x30fe74[_0x3b8379(0x2c0)](_0x1ba70a,'days')[_0x3b8379(0x39c)]>=0x12d4+-0xcf*-0xb+-0x1bb2;if(_0x1c409c['startsWith'](_0x3b8379(0x1f2)+_0x3b8379(0x1a2))){const _0x268233=parseInt(_0x1c409c[_0x3b8379(0x313)](':')[0x21*0x1b+-0x17a7*-0x1+-0x1b21],0x1912+-0x1836+-0xd2);if(isNaN(_0x268233)||_0x268233<-0x115f+-0x48f*0x5+0x282b)return![];return _0x30fe74['diff'](_0x1ba70a,_0x3b8379(0x39c))[_0x3b8379(0x39c)]>=_0x268233;}if(_0x1c409c[_0x3b8379(0x39f)](_0x3b8379(0x296)+_0x3b8379(0x21a))){const _0xfdee25=_0x1c409c[_0x3b8379(0x313)](':')[0x10f3*0x2+0x1ce*0x11+-0x3d*0x10f][_0x3b8379(0x313)](',')['map'](_0x19c8e7=>parseInt(_0x19c8e7,0x6*-0x2cb+-0x20*-0x101+-0x1*0xf54))['filter'](Boolean);return _0xfdee25[_0x3b8379(0x12e)](_0x30fe74[_0x3b8379(0x2da)])&&!_0x1ba70a[_0x3b8379(0x3b1)](_0x30fe74,'day');}if(_0x1c409c[_0x3b8379(0x39f)]('day_of_mon'+_0x3b8379(0x22a))){const _0x58ef15=parseInt(_0x1c409c[_0x3b8379(0x313)](':')[0x1a67+-0x93*-0x6+-0x1dd8],-0x10c8+0x1bc*-0x13+0x31c6);return _0x30fe74['day']===_0x58ef15&&!_0x1ba70a['hasSame'](_0x30fe74,'day');}return![];}async function addScheduleRow(_0x22206a){const _0x2c87e8=_0x563749;try{const _0x2646d=await db[_0x2c87e8(0x174)](_0x2c87e8(0x2a5)+'O\x20schedule'+_0x2c87e8(0x37d)+_0x2c87e8(0x21b)+_0x2c87e8(0x115)+_0x2c87e8(0x262)+'quency,\x20ti'+'mezone,\x20cr'+_0x2c87e8(0x1ea)+_0x2c87e8(0x111)+_0x2c87e8(0x13b)+_0x2c87e8(0x131)+_0x2c87e8(0x265),[_0x22206a['chat_jid'],_0x22206a[_0x2c87e8(0x2d1)],_0x22206a['time'],_0x22206a[_0x2c87e8(0x2df)],_0x22206a[_0x2c87e8(0x32d)]||_0x2c87e8(0x1f7),_0x22206a[_0x2c87e8(0x375)]||null,_0x22206a[_0x2c87e8(0x23e)+'d']]),_0x2ec2f4=_0x2646d?.[_0x2c87e8(0x17e)]||null;return info(_0x2c87e8(0x180)+_0x2c87e8(0x393)+_0x2c87e8(0x29b)+_0x2ec2f4+'\x20chat='+_0x22206a[_0x2c87e8(0x168)]+'\x20time='+(_0x22206a[_0x2c87e8(0x239)]||_0x22206a[_0x2c87e8(0x2df)])),_0x2ec2f4;}catch(_0x505d39){return warn('[sched]\x20ad'+_0x2c87e8(0x145)+_0x2c87e8(0x2be)+(_0x505d39?.[_0x2c87e8(0x2d1)]||_0x505d39)),null;}}async function listSchedulesForChat(_0x5e6f2e){const _0x23e767=_0x563749;try{const _0x7d8eff=await db['all']('SELECT\x20*\x20F'+_0x23e767(0x109)+_0x23e767(0x2f8)+_0x23e767(0x19e)+_0x23e767(0x365)+_0x23e767(0x26b),[_0x5e6f2e]);return _0x7d8eff||[];}catch(_0x3991ca){return warn('[sched]\x20li'+_0x23e767(0x311)+_0x23e767(0x1db)+'rror:\x20'+(_0x3991ca?.['message']||_0x3991ca)),[];}}async function removeScheduleByDBId(_0x1205dd){const _0x3f41e2=_0x563749;try{const _0x184fee=await db[_0x3f41e2(0x174)](_0x3f41e2(0x118)+'M\x20schedule'+'s\x20WHERE\x20id'+_0x3f41e2(0x376),[_0x1205dd]);return _0x184fee?.[_0x3f41e2(0x1c9)]?!![]:![];}catch(_0x3d4af1){return warn(_0x3f41e2(0x218)+_0x3f41e2(0x28b)+_0x3f41e2(0x34b)+_0x3f41e2(0x221)+(_0x3d4af1?.[_0x3f41e2(0x2d1)]||_0x3d4af1)),![];}}async function removeAllSchedulesForChat(_0x5b449c){const _0xeeac=_0x563749;try{const _0x1fa3ed=await db[_0xeeac(0x174)](_0xeeac(0x118)+_0xeeac(0x1bd)+_0xeeac(0x191)+_0xeeac(0x2e6),[_0x5b449c]);return _0x1fa3ed?.[_0xeeac(0x1c9)]||-0x1*-0x2687+-0x27a*0xb+0x3*-0x3c3;}catch(_0x54eabe){return warn(_0xeeac(0x218)+_0xeeac(0x3dc)+'edulesForC'+_0xeeac(0x116)+'\x20'+(_0x54eabe?.[_0xeeac(0x2d1)]||_0x54eabe)),0x1085*-0x2+-0x685*0x1+0x278f;}}async function updateScheduleFields(_0x150e0a,_0x5d793d={}){const _0x5498eb=_0x563749;try{const _0x5b58b5=[],_0x2fd5b6=[];for(const _0x2585ce of Object[_0x5498eb(0x3e1)](_0x5d793d)){_0x5b58b5['push'](_0x2585ce+'\x20=\x20?'),_0x2fd5b6[_0x5498eb(0x32e)](_0x5d793d[_0x2585ce]);}if(!_0x5b58b5['length'])return![];_0x2fd5b6['push'](_0x150e0a);const _0x1e48ce=_0x5498eb(0x181)+_0x5498eb(0x381)+'\x20'+_0x5b58b5['join'](',\x20')+(_0x5498eb(0x361)+_0x5498eb(0x317)),_0x21d5d4=await db[_0x5498eb(0x174)](_0x1e48ce,_0x2fd5b6);return _0x21d5d4?.[_0x5498eb(0x1c9)]?!![]:![];}catch(_0x487d5b){return warn(_0x5498eb(0x139)+_0x5498eb(0x2b7)+_0x5498eb(0x16e)+'rror:\x20'+(_0x487d5b?.['message']||_0x487d5b)),![];}}async function getChatTimezone(_0x39659a){const _0x1aaf79=_0x563749;try{const _0xb7a839=await db[_0x1aaf79(0x2d5)](_0x1aaf79(0x28d)+_0x1aaf79(0x27d)+_0x1aaf79(0x1ac)+'_settings\x20'+_0x1aaf79(0x348)+_0x1aaf79(0x1fc),[_0x39659a]);return _0xb7a839?.[_0x1aaf79(0x375)]||null;}catch(_0x39accf){return warn(_0x1aaf79(0x244)+_0x1aaf79(0x2a0)+'one\x20error:'+'\x20'+(_0x39accf?.[_0x1aaf79(0x2d1)]||_0x39accf)),null;}}async function setChatTimezone(_0xb2e1f2,_0x51c5c4){const _0x3f86a3=_0x563749;try{return await db[_0x3f86a3(0x174)](_0x3f86a3(0x2a5)+_0x3f86a3(0x31d)+_0x3f86a3(0x1d9)+_0x3f86a3(0x3a1)+',\x20timezone'+')\x20VALUES\x20('+'?,\x20?)\x20ON\x20C'+_0x3f86a3(0x2fc)+'at_jid)\x20DO'+'\x20UPDATE\x20SE'+'T\x20timezone'+'=excluded.'+'timezone',[_0xb2e1f2,_0x51c5c4]),!![];}catch(_0x323df4){return warn('[sched]\x20se'+_0x3f86a3(0x2a0)+_0x3f86a3(0x3df)+'\x20'+(_0x323df4?.[_0x3f86a3(0x2d1)]||_0x323df4)),![];}}async function executorTick(){const _0x477634=_0x563749;if(executorRunning)return;executorRunning=!![];try{const _0xc971d9=await db[_0x477634(0x390)](_0x477634(0x1fd)+_0x477634(0x109)+'les\x20WHERE\x20'+'enabled\x20=\x20'+_0x477634(0x3eb)+_0x477634(0x231));if(!_0xc971d9||_0xc971d9[_0x477634(0x37f)]===-0x18a*0x4+-0xa3c+0x1064)return;for(const _0x2c0a10 of _0xc971d9){try{const _0x3c88bd=_0x2c0a10['timezone']||await getChatTimezone(_0x2c0a10[_0x477634(0x168)])||DEFAULT_TIMEZONE,_0x54b18d=DateTime[_0x477634(0x237)]()['setZone'](_0x3c88bd),_0x1494a7=Math[_0x477634(0x2d8)](_0x54b18d[_0x477634(0x16f)]());let _0x14dab1=![],_0x56a919=![];if(_0x2c0a10[_0x477634(0x2df)]&&Number(_0x2c0a10[_0x477634(0x2df)])>-0x21e8+-0xeb1+0x3099)_0x56a919=!![],Number(_0x2c0a10[_0x477634(0x2df)])<=_0x1494a7&&(_0x14dab1=!![]);else{if(_0x2c0a10[_0x477634(0x239)]){const _0x401dd0=_0x54b18d[_0x477634(0x1b1)](_0x477634(0x24a));if(_0x401dd0===_0x2c0a10[_0x477634(0x239)]){const _0x5a33dc={'id':_0x2c0a10['id'],'frequency':_0x2c0a10['frequency']||_0x477634(0x1f7),'last_sent':_0x2c0a10['last_sent']||-0xd+-0xec8+0xed5};shouldSendSlot(_0x5a33dc,_0x54b18d)&&(_0x14dab1=!![]);}}}if(!_0x14dab1)continue;const _0x25d8ab=await sendScheduledMessage(_0x2c0a10);if(_0x25d8ab[_0x477634(0x1b0)]){if(_0x56a919){const _0x23995c=await removeScheduleByDBId(_0x2c0a10['id']);_0x23995c?info(_0x477634(0x308)+_0x477634(0x17f)+_0x477634(0x3d9)+'one-off\x20id'+'='+_0x2c0a10['id']+_0x477634(0x30e)+_0x2c0a10[_0x477634(0x168)]):(await updateScheduleFields(_0x2c0a10['id'],{'enabled':0x0,'last_sent':_0x1494a7}),warn(_0x477634(0x308)+'livered\x20on'+'e-off\x20id='+_0x2c0a10['id']+_0x477634(0x30e)+_0x2c0a10[_0x477634(0x168)]+(_0x477634(0x3a8)+_0x477634(0x297)+_0x477634(0x15d)+'\x20disabled\x20'+_0x477634(0x2fa))));}else await updateScheduleFields(_0x2c0a10['id'],{'last_sent':_0x1494a7,'send_attempts':0x0}),info(_0x477634(0x308)+_0x477634(0x3b5)+_0x477634(0x1a5)+'='+_0x2c0a10['id']+_0x477634(0x30e)+_0x2c0a10[_0x477634(0x168)]+_0x477634(0x2d9)+_0x2c0a10['time']+'\x20('+_0x3c88bd+')');}else{const _0x1e4a70=(_0x2c0a10[_0x477634(0x28c)+_0x477634(0x217)]||-0x1*-0xaa2+-0x1fb9+0x1517)+(-0xbf7*0x1+0x3be+0x83a);_0x25d8ab[_0x477634(0x3e7)+'ble']||_0x1e4a70>=MAX_DB_ATTEMPTS?(error('[sched]\x20id'+'='+_0x2c0a10['id']+(_0x477634(0x27c)+_0x477634(0x35f)+'manently\x20('+_0x477634(0x3e7)+_0x477634(0x173)+_0x477634(0x24f)+'empts\x20reac'+_0x477634(0x1ba)+_0x477634(0x247)+'dule.')),await updateScheduleFields(_0x2c0a10['id'],{'enabled':0x0,'last_attempt':_0x1494a7})):(warn(_0x477634(0x158)+'='+_0x2c0a10['id']+('\x20failed\x20de'+_0x477634(0x360)+_0x477634(0x322))+_0x1e4a70+(_0x477634(0x1a7)+_0x477634(0x154)+'\x20cycle.')),await updateScheduleFields(_0x2c0a10['id'],{'send_attempts':_0x1e4a70,'last_attempt':_0x1494a7}));}}catch(_0x4521ce){warn(_0x477634(0x2ad)+_0x477634(0x3af)+_0x477634(0x15c)+'r\x20id='+_0x2c0a10['id']+':\x20'+(_0x4521ce?.[_0x477634(0x2d1)]||_0x4521ce));}}}catch(_0x248837){error(_0x477634(0x2ad)+'ecutorTick'+'\x20error:\x20'+(_0x248837?.[_0x477634(0x2d1)]||_0x248837));}finally{executorRunning=![];}}function startSchedulerAligned(){const _0x2d8d56=_0x563749;stopScheduler();const _0x1da9dc=-0x1b9b8+0x1b17e*-0x1+0x45596-Date[_0x2d8d56(0x237)]()%(-0x13*0x53d+0x19*-0x9ef+0x1*0x2463e);setTimeout(()=>{const _0x3e1db3=_0x2d8d56;executorTick()[_0x3e1db3(0x2bb)](_0x1bc399=>warn('[sched]\x20in'+_0x3e1db3(0x18c)+_0x3e1db3(0x339)+':\x20'+(_0x1bc399?.[_0x3e1db3(0x2d1)]||_0x1bc399))),schedulerIntervalHandle=setInterval(()=>{const _0x5d1c4c=_0x3e1db3;executorTick()[_0x5d1c4c(0x2bb)](_0x73d0a7=>warn(_0x5d1c4c(0x2ad)+'ecutorTick'+_0x5d1c4c(0x254)+(_0x73d0a7?.[_0x5d1c4c(0x2d1)]||_0x73d0a7)));},CHECK_INTERVAL_MS),info('[sched]\x20sc'+_0x3e1db3(0x36d)+_0x3e1db3(0x398)+_0x3e1db3(0x25d)+_0x3e1db3(0x3b9));},_0x1da9dc);}function stopScheduler(){const _0x411390=_0x563749;schedulerIntervalHandle&&(clearInterval(schedulerIntervalHandle),schedulerIntervalHandle=null,info(_0x411390(0x233)+_0x411390(0x36d)+_0x411390(0x15e)));}function extractTextFromMessage(_0x2fe6ea){const _0x3a5c42=_0x563749;if(!_0x2fe6ea||!_0x2fe6ea[_0x3a5c42(0x2d1)])return'';const _0x5b3839=_0x2fe6ea[_0x3a5c42(0x2d1)];if(_0x5b3839[_0x3a5c42(0x152)+'on'])return _0x5b3839['conversati'+'on'];if(_0x5b3839[_0x3a5c42(0x3a2)+'xtMessage']?.['text'])return _0x5b3839[_0x3a5c42(0x3a2)+_0x3a5c42(0x23d)][_0x3a5c42(0x1af)];if(_0x5b3839[_0x3a5c42(0x1f0)+'ge']?.[_0x3a5c42(0x2fb)])return _0x5b3839['imageMessa'+'ge'][_0x3a5c42(0x2fb)];if(_0x5b3839[_0x3a5c42(0x32f)+'ge']?.[_0x3a5c42(0x2fb)])return _0x5b3839[_0x3a5c42(0x32f)+'ge'][_0x3a5c42(0x2fb)];if(_0x5b3839['buttonsRes'+_0x3a5c42(0x23c)+'ge']?.[_0x3a5c42(0x132)+_0x3a5c42(0x3d8)])return _0x5b3839[_0x3a5c42(0x28a)+'ponseMessa'+'ge'][_0x3a5c42(0x132)+'ttonId'];if(_0x5b3839[_0x3a5c42(0x399)+'seMessage']?.['singleSele'+_0x3a5c42(0x26e)]?.[_0x3a5c42(0x159)+'wId'])return _0x5b3839[_0x3a5c42(0x399)+_0x3a5c42(0x29c)][_0x3a5c42(0x105)+'ctReply'][_0x3a5c42(0x159)+_0x3a5c42(0x2a9)];return'';}function splitFirstLinePreserveRest(_0x4fb8ac){const _0x449c5f=_0x563749,_0x4867f4=_0x4fb8ac[_0x449c5f(0x313)](/\r?\n/),_0x56f0f4=_0x4867f4[_0x449c5f(0x37f)]>0x1*-0x335+-0x20*-0x20+0xcb*-0x1?_0x4867f4['shift']():'',_0x2999f7=_0x4867f4[_0x449c5f(0x378)]('\x0a'),_0x126bf4=_0x56f0f4[_0x449c5f(0x3a7)]()['split'](/\s+/)[_0x449c5f(0x32a)](Boolean);return{'firstLine':_0x56f0f4,'restText':_0x2999f7,'firstTokens':_0x126bf4};}function findGpAndCleanBodyFromRestAndFirst(_0x478391,_0x4cfafc){const _0xf1d1e7=_0x563749,_0x40c989=(_0x4cfafc&&_0x4cfafc[_0xf1d1e7(0x37f)]?_0x4cfafc:'')+'\x0a'+(_0x478391||''),_0x1fdef8=_0x40c989['match'](/\bgp[:\s]+(\S+)/i),_0x42e574=_0x1fdef8?_0x1fdef8[-0xa29+-0xe58+0x1882][_0xf1d1e7(0x3a7)]():null;let _0x5c7ad6=(_0x4cfafc||'')[_0xf1d1e7(0x313)](/\r?\n/);if(!_0x5c7ad6||_0x5c7ad6['length']===-0xd72*-0x1+0xb70+-0x18e2||_0x5c7ad6[_0xf1d1e7(0x17b)](_0x1251a9=>!_0x1251a9[_0xf1d1e7(0x3a7)]()))return{'gpValue':_0x42e574,'cleanedBody':''};const _0x4a562b=_0x5c7ad6['map'](_0x166d82=>_0x166d82[_0xf1d1e7(0x29a)](/^\s*gp[:\s]+\S+\s*$/i,'')['replace'](/\s*\bgp[:\s]+\S+\s*$/i,'')[_0xf1d1e7(0x1b2)]())[_0xf1d1e7(0x32a)](_0x53527c=>_0x53527c[_0xf1d1e7(0x37f)]>0x1*-0x1b62+0x20f1+0x58f*-0x1),_0x26748e=_0x4a562b[_0xf1d1e7(0x378)]('\x0a')[_0xf1d1e7(0x3a7)]();return{'gpValue':_0x42e574,'cleanedBody':_0x26748e};}function extractInlineAfterToken(_0x4ff976,_0x5144e2){const _0x2e8389=_0x563749;if(!_0x4ff976||!_0x5144e2)return'';try{const _0x463620=new RegExp('\x5cb'+_0x5144e2[_0x2e8389(0x29a)](/[.*+?^${}()|[\]\\]/g,_0x2e8389(0x18b))+'\x5cb'),_0x5e1269=_0x4ff976[_0x2e8389(0x15f)](_0x463620);if(!_0x5e1269)return'';const _0x20f628=_0x4ff976[_0x2e8389(0x11b)](_0x5e1269[0x1160+0xef*-0x11+-0x23*0xb]),_0x3c567f=_0x20f628+_0x5e1269[-0x45*-0x44+0x15d7+-0x282b]['length'];let _0x534c12=_0x4ff976[_0x2e8389(0x22c)](_0x3c567f)[_0x2e8389(0x29a)](/^\s+/,'');return _0x534c12=_0x534c12[_0x2e8389(0x29a)](/\s*\bgp[:\s]+\S+\s*$/i,'')[_0x2e8389(0x3a7)](),_0x534c12;}catch(_0x4a43da){return'';}}const USAGE=_0x563749(0x396)+_0x563749(0x13c)+_0x563749(0x3bb)+_0x563749(0x38d)+_0x563749(0x2b6)+'YY-MM-DDTH'+'H:mm\x20|\x20in\x20'+'N\x20hours/da'+_0x563749(0x2db)+_0x563749(0x187)+_0x563749(0x207)+'Message\x20ca'+'n\x20follow\x20t'+_0x563749(0x119)+_0x563749(0x183)+_0x563749(0x3c6)+_0x563749(0x304)+'ewlines\x20pr'+_0x563749(0x272)+'>\x20*sched\x20o'+'nce*\x20`<HH:'+_0x563749(0x3ac)+_0x563749(0x1d0)+_0x563749(0x2c1)+_0x563749(0x19c)+'schedule.\x20'+_0x563749(0x36f)+_0x563749(0x36e)+_0x563749(0x34c)+_0x563749(0x278)+'day\x20+\x20Nday'+_0x563749(0x172)+_0x563749(0x3ba)+_0x563749(0x13e)+_0x563749(0x333)+_0x563749(0x290)+_0x563749(0x355)+_0x563749(0x269)+_0x563749(0x20c)+_0x563749(0x1f5)+_0x563749(0x1e6)+'number,...'+_0x563749(0x3ab)+_0x563749(0x3a9)+_0x563749(0x2d2)+_0x563749(0x1cc)+_0x563749(0x171)+_0x563749(0x3e8)+_0x563749(0x342)+_0x563749(0x299)+_0x563749(0x38c)+_0x563749(0x366)+_0x563749(0x165)+_0x563749(0x252)+_0x563749(0x1ed)+'\x20the\x20time\x20'+_0x563749(0x288)+_0x563749(0x11e)+_0x563749(0x2f9)+_0x563749(0x340)+_0x563749(0x33c)+_0x563749(0x1df)+_0x563749(0x163)+'peat\x20inter'+_0x563749(0x310)+_0x563749(0x13f)+_0x563749(0x176)+_0x563749(0x3e0)+_0x563749(0x2e5)+_0x563749(0x186)+_0x563749(0x1f5)+_0x563749(0x397)+_0x563749(0x39d)+_0x563749(0x22e)+'eduled\x20mes'+_0x563749(0x166)+_0x563749(0x24c)+_0x563749(0x213)+_0x563749(0x345)+_0x563749(0x24d)+_0x563749(0x2af)+_0x563749(0x1e8)+_0x563749(0x134),processedCmdKeys=new Map(),CMD_DEDUPE_TTL_MS=(-0x2*0xc48+-0x4d8+0xde*0x22)*(0x1336+-0xda5+-0x1a9);function markCmdProcessed(_0x28765a){const _0x5cdb24=_0x563749;if(!_0x28765a)return;if(processedCmdKeys['has'](_0x28765a))try{clearTimeout(processedCmdKeys['get'](_0x28765a));}catch(_0x1e0692){}const _0x5f1ff9=setTimeout(()=>processedCmdKeys[_0x5cdb24(0x34a)](_0x28765a),CMD_DEDUPE_TTL_MS);processedCmdKeys[_0x5cdb24(0x34f)](_0x28765a,_0x5f1ff9);}function isCmdProcessed(_0x4b6a43){return _0x4b6a43&&processedCmdKeys['has'](_0x4b6a43);}async function resolveDefaultChatJidsForUser(_0x25983f){const _0x3980bb=_0x563749;try{const _0x4a5cb9=await getDefault(_0x25983f)[_0x3980bb(0x2bb)](()=>null);if(!_0x4a5cb9||Array[_0x3980bb(0x30d)](_0x4a5cb9)&&_0x4a5cb9[_0x3980bb(0x37f)]===0x1b66+0x20e4+-0x3c4a*0x1)return[];const _0x4d0473=Array[_0x3980bb(0x30d)](_0x4a5cb9)?_0x4a5cb9:[_0x4a5cb9],_0x59748b=[];for(const _0x1c0aa0 of _0x4d0473){try{const _0x523c78=await getConnection(_0x1c0aa0)[_0x3980bb(0x2bb)](()=>null);if(Array['isArray'](_0x523c78))_0x59748b[_0x3980bb(0x32e)](..._0x523c78);else{if(_0x523c78)_0x59748b[_0x3980bb(0x32e)](String(_0x523c78));}}catch(_0xcc80b0){warn(_0x3980bb(0x218)+'solving\x20co'+_0x3980bb(0x212)+_0x1c0aa0+_0x3980bb(0x35d)+(_0xcc80b0?.[_0x3980bb(0x2d1)]||_0xcc80b0));}}return uniqArray(_0x59748b);}catch(_0x528039){return warn(_0x3980bb(0x218)+_0x3980bb(0x14f)+_0x3980bb(0x1ff)+'ForUser\x20er'+_0x3980bb(0x289)+(_0x528039?.[_0x3980bb(0x2d1)]||_0x528039)),[];}}async function getCombinedSchedulesForChats(_0x3ece0e){const _0x5ac2f6=_0x563749,_0x1e7b27=[];for(const _0x2bd3b8 of _0x3ece0e){const _0x5f1319=await listSchedulesForChat(_0x2bd3b8);for(const _0x2f3c87 of _0x5f1319){_0x1e7b27[_0x5ac2f6(0x32e)](Object[_0x5ac2f6(0x1cd)]({},_0x2f3c87,{'chat_jid':_0x2bd3b8}));}}return _0x1e7b27;}async function resolveNumberToDbId(_0x489849,_0x56a37c){const _0x26cb8=_0x563749;if(!_0x489849||!Number[_0x26cb8(0x107)](_0x489849)||_0x489849<-0x2*-0x9a4+-0x5b+-0x12ec)return null;const _0x4e5199=await getCombinedSchedulesForChats(_0x56a37c);if(!_0x4e5199||_0x4e5199['length']<_0x489849)return null;return _0x4e5199[_0x489849-(-0x1*-0x455+0x152*0x16+-0x2160)]['id'];}async function findStoredMatchFromFindings(_0x21a26c=[]){const _0x1fa8a6=_0x563749;try{const _0x54a6ed=await listSudo();if(!Array[_0x1fa8a6(0x30d)](_0x54a6ed)||_0x54a6ed['length']===0xc7*-0x7+0x2482+-0x3*0xa5b)return null;const _0x24853f=new Set(_0x54a6ed[_0x1fa8a6(0x2e0)](String));for(const _0x204836 of _0x21a26c||[]){if(!_0x204836||typeof _0x204836[_0x1fa8a6(0x1d3)]!=='string')continue;const _0x366cf3=normalizeToJid(_0x204836['jid']);if(_0x366cf3&&_0x24853f[_0x1fa8a6(0x357)](_0x366cf3))return _0x366cf3;if(_0x24853f[_0x1fa8a6(0x357)](_0x204836[_0x1fa8a6(0x1d3)]))return _0x204836['jid'];const _0xa4dc86=String(_0x204836[_0x1fa8a6(0x1d3)])[_0x1fa8a6(0x313)]('@')[0x1*0xc46+-0x113f+0x4f9][_0x1fa8a6(0x313)](':')[-0x36*0x55+0x8*0x290+-0x292*0x1];if(_0xa4dc86)for(const _0x12c5fc of _0x54a6ed){const _0x2c4bd=String(_0x12c5fc)[_0x1fa8a6(0x313)]('@')[-0x203c+0x542+0x1afa];if(_0x2c4bd&&_0x2c4bd===_0xa4dc86)return _0x12c5fc;}}return null;}catch(_0xf53de0){return warn(_0x1fa8a6(0x2ba)+_0x1fa8a6(0x284)+_0x1fa8a6(0x2ed)+_0x1fa8a6(0x14d)+_0x1fa8a6(0x123)+(_0xf53de0?.[_0x1fa8a6(0x2d1)]||_0xf53de0)),null;}}export async function onMessage(_0x370ca7){const _0xc7336a=_0x563749;try{if(!_0x370ca7||!_0x370ca7[_0xc7336a(0x30b)]||!_0x370ca7['message'])return;const _0x11c971=String(_0x370ca7[_0xc7336a(0x30b)]['remoteJid']||'')+'::'+String(_0x370ca7[_0xc7336a(0x30b)]['id']||_0x370ca7[_0xc7336a(0x30b)][_0xc7336a(0x2a4)+'t']||'');if(isCmdProcessed(_0x11c971))return;markCmdProcessed(_0x11c971);if(!_0x370ca7['isCommand'])return;const _0x31d25b=typeof _0x370ca7['text']==='string'&&_0x370ca7[_0xc7336a(0x1af)][_0xc7336a(0x3a7)]()[_0xc7336a(0x37f)]?_0x370ca7['text']:extractTextFromMessage(_0x370ca7)||'';if(!_0x31d25b)return;const _0xecf02e=_0x370ca7[_0xc7336a(0x30b)][_0xc7336a(0x3e5)],_0x5d1f6e=typeof _0xecf02e===_0xc7336a(0x127)&&_0xecf02e[_0xc7336a(0x301)](_0xc7336a(0x1f9));if(_0x5d1f6e){let _0x4d1906=![];try{_0x4d1906=await isadmin(botRef,_0x370ca7);}catch(_0x1f63a4){warn(_0xc7336a(0x1cf)+'admin\x20chec'+_0xc7336a(0x286)),_0x4d1906=![];}if(!_0x4d1906)return;const _0x501231=String(_0x31d25b)[_0xc7336a(0x3a7)](),{firstLine:_0x3d026a,restText:_0x144972,firstTokens:_0x2d22bd}=splitFirstLinePreserveRest(_0x501231),_0x251062=(_0x2d22bd[-0x631*-0x4+0xa*0x2c+-0x1a7c]||'')['toLowerCas'+'e']();if(!commands[_0xc7336a(0x12e)](_0x251062))return;const _0x345a59=(_0x2d22bd[-0xe85+0x129c*0x2+-0x16b2]||'')['toLowerCas'+'e'](),_0x20f6bb=_0x370ca7[_0xc7336a(0x30b)][_0xc7336a(0x2a4)+'t']||_0x370ca7[_0xc7336a(0x30b)][_0xc7336a(0x27b)]||_0x370ca7['key'][_0xc7336a(0x3e5)]||'',_0x8a5e2e=(_0x20f6bb||'')[_0xc7336a(0x313)]('@')[-0x54c+-0x4e2*0x3+0x13f2],_0x3a9175=await resolveDefaultChatJidsForUser(_0x8a5e2e),_0x420f86=_0xecf02e;if(!_0x3a9175||_0x3a9175[_0xc7336a(0x37f)]===-0x13a4+-0x58*-0x2e+-0x2*-0x1ea){await sendWithRetry(_0x420f86,{'text':'Could\x20not\x20'+'resolve\x20yo'+'ur\x20default'+_0xc7336a(0x215)+'n(s).\x20Set\x20'+_0xc7336a(0x1a1)+_0xc7336a(0x387)+_0xc7336a(0x2a8)});return;}await handleSchedCommandGroup(_0x370ca7,{'firstLine':_0x3d026a,'restText':_0x144972,'firstTokens':_0x2d22bd,'sub':_0x345a59,'defaultChatJids':_0x3a9175,'confirmationTarget':_0x420f86,'senderJid':_0x20f6bb});return;}const _0x38b627=Boolean(_0x370ca7[_0xc7336a(0x30b)]['fromMe']);let _0x934d2b=null;if(_0x38b627){const _0x31bea3=getBotJid();if(!_0x31bea3){warn('[sched]\x20PM'+_0xc7336a(0x155)+_0xc7336a(0x354)+'ble\x20for\x20re'+_0xc7336a(0x389)+_0xc7336a(0x303));return;}_0x934d2b=_0x31bea3;}else{let _0x696265=![];try{_0x696265=await isSudo(botRef,_0x370ca7);}catch(_0x1c2967){_0x696265=![];}if(!_0x696265)return;const _0x4132cf=userJidFromCtx(_0x370ca7)||{'findings':[]},_0x19e963=await findStoredMatchFromFindings(_0x4132cf[_0xc7336a(0x25f)]||[]);if(!_0x19e963)return;_0x934d2b=_0x19e963;}const _0x55be8a=String(_0x31d25b),{firstLine:_0xb4a09c,restText:_0x4b5cdd,firstTokens:_0x594557}=splitFirstLinePreserveRest(_0x55be8a),_0x4c9fff=(_0x594557[0x12b2+0x3*-0xa59+0xc59]||'')[_0xc7336a(0x2f7)+'e']();if(!commands[_0xc7336a(0x12e)](_0x4c9fff))return;const _0xb89b81=(_0x594557[-0x6*-0x36f+0x1577+-0x2a10]||'')[_0xc7336a(0x2f7)+'e']();if(!_0xb89b81||_0xb89b81===_0xc7336a(0x2d4)){await sendWithRetry(_0x934d2b,{'text':USAGE});return;}const _0x275543=[_0xc7336a(0x197),_0xc7336a(0x356),'list',_0xc7336a(0x34a),_0xc7336a(0x2c4),_0xc7336a(0x32d),_0xc7336a(0x1a0),_0xc7336a(0x17c)],{gpValue:_0xa8bb79,cleanedBody:_0x48fafc}=findGpAndCleanBodyFromRestAndFirst(_0xb4a09c,_0x4b5cdd);if(_0x275543[_0xc7336a(0x12e)](_0xb89b81)&&!_0xa8bb79){await sendWithRetry(_0x934d2b,{'text':_0xc7336a(0x268)+_0xc7336a(0x3bd)+_0xc7336a(0x236)+_0xc7336a(0x1d4)+'ine\x20when\x20m'+_0xc7336a(0x108)+_0xc7336a(0x31b)+_0xc7336a(0x2ef)+'hed\x20add\x2009'+_0xc7336a(0x2bf)+_0xc7336a(0x1e2)+_0xc7336a(0x256)+'alias'});return;}let _0x14a471=[];if(_0xa8bb79){const _0x1f7095=_0xa8bb79[_0xc7336a(0x3a7)]();if(_0x1f7095[_0xc7336a(0x2f7)+'e']()===_0xc7336a(0x390))_0x14a471=await _0xc0fbfe[_0xc7336a(0x25e)+'ids']();else{const _0x3a9f17=await _0xc0fbfe[_0xc7336a(0x3be)+'e'](_0x1f7095);if(_0x3a9f17)_0x14a471=[_0x3a9f17];else{if(_0x1f7095[_0xc7336a(0x12e)]('@'))_0x14a471=[_0xc0fbfe[_0xc7336a(0x146)+_0xc7336a(0x238)](_0x1f7095)];}}if(_0x275543[_0xc7336a(0x12e)](_0xb89b81)&&(!_0x14a471||_0x14a471[_0xc7336a(0x37f)]===0x1*0x12e4+0x1221+-0x2505)){await sendWithRetry(_0x934d2b,{'text':_0xc7336a(0x232)+_0xc7336a(0x2b2)+':\x20\x22'+_0xa8bb79+(_0xc7336a(0x263)+_0xc7336a(0x2ea)+'all\x20or\x20a\x20g'+'roup\x20JID.')});return;}}await handleSchedCommandPM(_0x370ca7,{'sub':_0xb89b81,'firstLine':_0xb4a09c,'restText':_0x4b5cdd,'firstTokens':_0x594557,'targetChatJids':_0x14a471,'confirmationTarget':_0x934d2b,'senderJid':_0x370ca7[_0xc7336a(0x30b)]['participan'+'t']||_0x370ca7[_0xc7336a(0x30b)][_0xc7336a(0x27b)]||'','cleanedBody':_0x48fafc});return;}catch(_0x647185){error(_0xc7336a(0x2aa)+_0xc7336a(0x2c2)+_0xc7336a(0x289)+(_0x647185?.[_0xc7336a(0x2d1)]||_0x647185));}}async function handleSchedCommandGroup(_0x4105da,{firstLine:_0x548783,restText:_0x125f76,firstTokens:_0x44cf0b,sub:_0x5e64a1,defaultChatJids:_0x255621,confirmationTarget:_0x5d6fb4,senderJid:_0x4c72cd}){const _0xdd936a=_0x563749;try{if(!_0x5e64a1||_0x5e64a1===_0xdd936a(0x2d4)){await sendWithRetry(_0x5d6fb4,{'text':USAGE});return;}if(_0x5e64a1===_0xdd936a(0x197)){const _0x401175=_0x44cf0b[0x216a+0x5ba*-0x1+-0x1bae],_0x261c74=_0x44cf0b[-0xdb8+-0x1*0x167+0xf22]&&/^\d+$/[_0xdd936a(0x2ec)](_0x44cf0b[-0x8*0x4d5+-0x144a+0xd*0x489])?Number(_0x44cf0b[0x1a08+-0x1*-0x11b6+0x2bbb*-0x1]):null;let _0x202095='';if(_0x401175){const _0x1df90d=new RegExp('\x5cb'+_0x401175[_0xdd936a(0x29a)](/[.*+?^${}()|[\]\\]/g,_0xdd936a(0x18b))+'\x5cb'),_0xed8de6=_0x548783['match'](_0x1df90d);if(_0xed8de6){const _0x51e7fb=_0x548783[_0xdd936a(0x11b)](_0xed8de6[-0x83d*0x1+-0x2406+0x9*0x4eb]),_0x2e8eac=_0x51e7fb+_0xed8de6[-0xa7f*0x1+-0x1e85+0x2904]['length'];_0x202095=_0x548783[_0xdd936a(0x22c)](_0x2e8eac)['replace'](/^\s*/,'');if(_0x202095&&/^\d+/[_0xdd936a(0x2ec)](_0x202095))_0x202095=_0x202095[_0xdd936a(0x29a)](/^\d+\s*/,'');}}const _0x45a7a7=_0x202095&&_0x125f76?_0x202095+'\x0a'+_0x125f76:_0x202095||_0x125f76||'';if(!_0x401175||!_0x45a7a7||_0x45a7a7[_0xdd936a(0x3a7)]()[_0xdd936a(0x37f)]===-0xf8d+-0x1069+0x2*0xffb){await sendWithRetry(_0x5d6fb4,{'text':_0xdd936a(0x11a)+_0xdd936a(0x1fe)+'H:mm>\x20[Nda'+_0xdd936a(0x205)+_0xdd936a(0x285)});return;}const _0x3767bb=[];for(const _0x4c8702 of _0x255621){const _0x16be28=await getChatTimezone(_0x4c8702)||DEFAULT_TIMEZONE,_0x4c3068=parseTimeToken(_0x401175,_0x16be28);if(!_0x4c3068){_0x3767bb[_0xdd936a(0x32e)]({'chat':_0x4c8702,'ok':![],'reason':_0xdd936a(0x2f6)+'ed'});continue;}if(_0x4c3068[_0xdd936a(0x3a3)]===_0xdd936a(0x1b4)){const _0x2dec18=_0x4c3068['dt'],_0x55d059=Math[_0xdd936a(0x2d8)](_0x2dec18[_0xdd936a(0x3b6)]()/(-0xef1+-0x116d+-0x1*-0x2446)),_0x306cf1=await addScheduleRow({'chat_jid':_0x4c8702,'message':_0x45a7a7,'time':null,'send_at':_0x55d059,'frequency':_0xdd936a(0x197),'timezone':_0x2dec18[_0xdd936a(0x20f)]||_0x16be28,'creator_jid':_0x4c72cd});if(_0x306cf1)_0x3767bb[_0xdd936a(0x32e)]({'chat':_0x4c8702,'ok':!![],'id':_0x306cf1,'when':_0x2dec18['toLocaleSt'+_0xdd936a(0x31a)](DateTime[_0xdd936a(0x372)+'ED'])});else _0x3767bb[_0xdd936a(0x32e)]({'chat':_0x4c8702,'ok':![],'reason':_0xdd936a(0x336)});continue;}if(_0x4c3068['type']===_0xdd936a(0x193)){const [_0x4921ac,_0x579cdc]=_0x4c3068['hhmm'][_0xdd936a(0x313)](':')['map'](Number);let _0x28029d=DateTime[_0xdd936a(0x237)]()['setZone'](_0x16be28),_0x361612=_0x28029d[_0xdd936a(0x324)](_0xdd936a(0x125))[_0xdd936a(0x34f)]({'hour':_0x4921ac,'minute':_0x579cdc,'second':0x0,'millisecond':0x0});if(_0x261c74&&Number['isInteger'](_0x261c74)&&_0x261c74>=0xef*-0x16+-0xb45+0x1fd0)_0x361612=_0x361612['plus']({'days':Number(_0x261c74)});else{if(_0x361612<=_0x28029d)_0x361612=_0x361612[_0xdd936a(0x2e7)]({'days':0x1});}const _0x2061f8=Math[_0xdd936a(0x2d8)](_0x361612['toMillis']()/(0x61*-0x47+-0x1daf*-0x1+0x10*0x12)),_0x50317c=await addScheduleRow({'chat_jid':_0x4c8702,'message':_0x45a7a7,'time':null,'send_at':_0x2061f8,'frequency':_0xdd936a(0x197),'timezone':_0x16be28,'creator_jid':_0x4c72cd});if(_0x50317c)_0x3767bb[_0xdd936a(0x32e)]({'chat':_0x4c8702,'ok':!![],'id':_0x50317c,'when':_0x361612[_0xdd936a(0x110)+'ring'](DateTime[_0xdd936a(0x372)+'ED'])});else _0x3767bb[_0xdd936a(0x32e)]({'chat':_0x4c8702,'ok':![],'reason':'db_failed'});continue;}_0x3767bb[_0xdd936a(0x32e)]({'chat':_0x4c8702,'ok':![],'reason':_0xdd936a(0x370)+_0xdd936a(0x36c)});}const _0x13e4ee=_0x3767bb[_0xdd936a(0x32a)](_0x23eaeb=>_0x23eaeb['ok']),_0x245859=_0x3767bb[_0xdd936a(0x32a)](_0x1cdfdb=>!_0x1cdfdb['ok']);let _0x1b5ded='';if(_0x13e4ee[_0xdd936a(0x37f)]){_0x1b5ded+=_0xdd936a(0x142)+'one-off\x20fo'+'r\x20'+_0x13e4ee[_0xdd936a(0x37f)]+(_0xdd936a(0x251)+_0xdd936a(0x344)+'s):\x0a');for(const _0xa316d of _0x13e4ee)_0x1b5ded+='â€¢\x20'+_0xa316d[_0xdd936a(0x130)]+'\x20->\x20id:'+_0xa316d['id']+_0xdd936a(0x2d9)+_0xa316d[_0xdd936a(0x1c8)]+'\x0a';}if(_0x245859[_0xdd936a(0x37f)]){_0x1b5ded+=_0xdd936a(0x1f3)+'\x20'+_0x245859[_0xdd936a(0x37f)]+('\x20default\x20c'+_0xdd936a(0x344)+_0xdd936a(0x1ce));for(const _0x3fe25c of _0x245859)_0x1b5ded+='â€¢\x20'+_0x3fe25c[_0xdd936a(0x130)]+_0xdd936a(0x337)+_0x3fe25c[_0xdd936a(0x1a6)]+'\x0a';}await sendWithRetry(_0x5d6fb4,{'text':_0x1b5ded['trim']()||_0xdd936a(0x318)+_0xdd936a(0x135)+'.'});return;}if(_0x5e64a1===_0xdd936a(0x356)){if(!_0x44cf0b[-0x25a5+-0x18f1+0x3e98]){await sendWithRetry(_0x5d6fb4,{'text':_0xdd936a(0x11a)+_0xdd936a(0x10a)+_0xdd936a(0x220)+_0xdd936a(0x1f8)+'|in\x20N\x20hour'+_0xdd936a(0x29f)+'utes>\x20<mes'+'sage...>'});return;}const _0x3d792e=_0x44cf0b[0xee8+0xf9c+-0x1e82],_0x4fb59a=_0x44cf0b[0x1f80+-0x1df9+-0x184]&&/^\d+$/[_0xdd936a(0x2ec)](_0x44cf0b[-0x1140+0x6fc+-0x3*-0x36d])?Number(_0x44cf0b[-0x1441+-0x7f2+0x1c36]):null;let _0x5982d0='';const _0x49f98c=new RegExp('\x5cb'+_0x3d792e[_0xdd936a(0x29a)](/[.*+?^${}()|[\]\\]/g,_0xdd936a(0x18b))+'\x5cb'),_0x240703=_0x548783['match'](_0x49f98c);if(_0x240703){const _0x453506=_0x548783[_0xdd936a(0x11b)](_0x240703[0x2*-0x124c+-0x1b01*-0x1+0x5*0x1eb]),_0x32bb75=_0x453506+_0x240703[0x7*0x3ca+0x1a8b*0x1+-0x3511][_0xdd936a(0x37f)];_0x5982d0=_0x548783[_0xdd936a(0x22c)](_0x32bb75)[_0xdd936a(0x29a)](/^\s*/,'');if(_0x5982d0&&/^\d+/[_0xdd936a(0x2ec)](_0x5982d0))_0x5982d0=_0x5982d0[_0xdd936a(0x29a)](/^\d+\s*/,'');}const _0x42f9b6=_0x5982d0&&_0x125f76?_0x5982d0+'\x0a'+_0x125f76:_0x5982d0||_0x125f76||'';if(!_0x42f9b6||_0x42f9b6[_0xdd936a(0x3a7)]()[_0xdd936a(0x37f)]===0x174*0x11+-0x4f+-0x1865){await sendWithRetry(_0x5d6fb4,{'text':'Please\x20pro'+_0xdd936a(0x305)+_0xdd936a(0x2f4)+_0xdd936a(0x17d)+_0xdd936a(0x2dd)+_0xdd936a(0x202)+_0xdd936a(0x2cf)+'s).'});return;}const _0x35a7b0=[];for(const _0x2281f5 of _0x255621){const _0x3b413e=await getChatTimezone(_0x2281f5)||DEFAULT_TIMEZONE,_0x42aaca=parseTimeToken(_0x3d792e,_0x3b413e);if(!_0x42aaca){_0x35a7b0[_0xdd936a(0x32e)]({'chat':_0x2281f5,'ok':![],'reason':_0xdd936a(0x2f6)+'ed'});continue;}const _0x11f9bd=_0x4c72cd;if(_0x42aaca[_0xdd936a(0x3a3)]===_0xdd936a(0x1b4)){const _0x451e00=_0x42aaca['dt'],_0x10952b=Math['floor'](_0x451e00[_0xdd936a(0x3b6)]()/(0xc0e*-0x3+0x731+0x20e1)),_0x4d87a6=await addScheduleRow({'chat_jid':_0x2281f5,'message':_0x42f9b6,'time':null,'send_at':_0x10952b,'frequency':'once','timezone':_0x451e00[_0xdd936a(0x20f)]||_0x3b413e,'creator_jid':_0x11f9bd});if(_0x4d87a6)_0x35a7b0['push']({'chat':_0x2281f5,'ok':!![],'id':_0x4d87a6,'when':_0x451e00[_0xdd936a(0x110)+_0xdd936a(0x31a)](DateTime[_0xdd936a(0x372)+'ED'])});else _0x35a7b0[_0xdd936a(0x32e)]({'chat':_0x2281f5,'ok':![],'reason':_0xdd936a(0x336)});continue;}if(_0x42aaca['type']===_0xdd936a(0x193)){const _0xc7df81=_0x42aaca[_0xdd936a(0x193)];if(_0x4fb59a&&Number[_0xdd936a(0x107)](_0x4fb59a)&&_0x4fb59a>=0x15c+-0x1ad5+0x3*0x87e){let _0x493649=DateTime[_0xdd936a(0x237)]()[_0xdd936a(0x253)](_0x3b413e);const [_0x1b3225,_0x111ed6]=_0xc7df81[_0xdd936a(0x313)](':')[_0xdd936a(0x2e0)](Number);let _0x35ba95=_0x493649[_0xdd936a(0x324)]('day')[_0xdd936a(0x34f)]({'hour':_0x1b3225,'minute':_0x111ed6,'second':0x0,'millisecond':0x0});_0x35ba95=_0x35ba95[_0xdd936a(0x2e7)]({'days':Number(_0x4fb59a)});const _0x4f79dd=Math[_0xdd936a(0x2d8)](_0x35ba95[_0xdd936a(0x3b6)]()/(0x1f41+0x1e6e+-0x39c7)),_0x4a867a=await addScheduleRow({'chat_jid':_0x2281f5,'message':_0x42f9b6,'time':null,'send_at':_0x4f79dd,'frequency':_0xdd936a(0x197),'timezone':_0x3b413e,'creator_jid':_0x11f9bd});if(_0x4a867a)_0x35a7b0['push']({'chat':_0x2281f5,'ok':!![],'id':_0x4a867a,'when':_0x35ba95['toLocaleSt'+'ring'](DateTime[_0xdd936a(0x372)+'ED'])});else _0x35a7b0[_0xdd936a(0x32e)]({'chat':_0x2281f5,'ok':![],'reason':'db_failed'});continue;}const _0x3c35e5=await addScheduleRow({'chat_jid':_0x2281f5,'message':_0x42f9b6,'time':_0xc7df81,'send_at':null,'frequency':_0xdd936a(0x1f7),'timezone':_0x3b413e,'creator_jid':_0x11f9bd});if(_0x3c35e5)_0x35a7b0[_0xdd936a(0x32e)]({'chat':_0x2281f5,'ok':!![],'id':_0x3c35e5,'when':_0xc7df81+'\x20('+_0x3b413e+')'});else _0x35a7b0[_0xdd936a(0x32e)]({'chat':_0x2281f5,'ok':![],'reason':_0xdd936a(0x336)});continue;}_0x35a7b0[_0xdd936a(0x32e)]({'chat':_0x2281f5,'ok':![],'reason':'unsupporte'+_0xdd936a(0x36c)});}const _0x3f3135=_0x35a7b0[_0xdd936a(0x32a)](_0x1d1fea=>_0x1d1fea['ok']),_0x2c8605=_0x35a7b0[_0xdd936a(0x32a)](_0x4c9899=>!_0x4c9899['ok']);let _0x34e23a='';if(_0x3f3135[_0xdd936a(0x37f)]){_0x34e23a+=_0xdd936a(0x142)+_0xdd936a(0x382)+_0x3f3135[_0xdd936a(0x37f)]+(_0xdd936a(0x251)+'onnection('+_0xdd936a(0x1ce));for(const _0xc721f9 of _0x3f3135)_0x34e23a+='â€¢\x20'+_0xc721f9[_0xdd936a(0x130)]+_0xdd936a(0x3e4)+_0xc721f9['id']+_0xdd936a(0x3ca)+_0xc721f9['when']+'\x0a';}if(_0x2c8605[_0xdd936a(0x37f)]){_0x34e23a+=_0xdd936a(0x1f3)+'\x20'+_0x2c8605[_0xdd936a(0x37f)]+(_0xdd936a(0x251)+_0xdd936a(0x344)+_0xdd936a(0x1ce));for(const _0x4210a0 of _0x2c8605)_0x34e23a+='â€¢\x20'+_0x4210a0[_0xdd936a(0x130)]+_0xdd936a(0x337)+_0x4210a0[_0xdd936a(0x1a6)]+'\x0a';}await sendWithRetry(_0x5d6fb4,{'text':_0x34e23a[_0xdd936a(0x3a7)]()||_0xdd936a(0x318)+_0xdd936a(0x135)+'.'});return;}if(_0x5e64a1==='list'){const _0x4e037b=await getCombinedSchedulesForChats(_0x255621);if(!_0x4e037b[_0xdd936a(0x37f)]){await sendWithRetry(_0x5d6fb4,{'text':_0xdd936a(0x318)+_0xdd936a(0x35c)+'s\x20found\x20fo'+_0xdd936a(0x2e2)+':\x20'+_0x255621[_0xdd936a(0x378)](',\x20')});return;}const _0x3eff02=_0x4e037b[_0xdd936a(0x2e0)]((_0x3b7860,_0x400394)=>{const _0x144cb3=_0xdd936a,_0x6bc32d=_0x3b7860['send_at']?DateTime[_0x144cb3(0x1be)](Number(_0x3b7860['send_at'])*(0x35*0x65+0x17*0xad+-0x823*0x4))[_0x144cb3(0x253)](_0x3b7860[_0x144cb3(0x375)]||DEFAULT_TIMEZONE)[_0x144cb3(0x1e1)]({'suppressSeconds':!![]}):_0x3b7860[_0x144cb3(0x239)]?_0x3b7860['time']+'\x20('+(_0x3b7860[_0x144cb3(0x375)]||'group/defa'+_0x144cb3(0x2b4))+')':'unknown',_0x19fac3=(_0x3b7860[_0x144cb3(0x2d1)]||'')['split']('\x0a')['map'](_0x2ad6e8=>_0x2ad6e8['trimEnd']())['join']('\x0a');return _0x400394+(-0x3*-0x8ff+-0x5*0x677+-0x557*-0x1)+_0x144cb3(0x3c9)+_0x3b7860['id']+_0x144cb3(0x14b)+_0x3b7860[_0x144cb3(0x168)]+_0x144cb3(0x3ca)+_0x6bc32d+_0x144cb3(0x319)+(_0x3b7860['frequency']||'daily')+_0x144cb3(0x2d3)+(_0x3b7860['enabled']?_0x144cb3(0x2c9):'no')+_0x144cb3(0x190)+_0x19fac3;}),_0x4abecd=_0xdd936a(0x142)+_0xdd936a(0x2a7)+_0xdd936a(0x374)+_0x255621[_0xdd936a(0x378)](',\x20')+_0xdd936a(0x1f6)+_0x3eff02['join']('\x0a\x0a');await sendWithRetry(_0x5d6fb4,{'text':_0x4abecd});return;}if(_0x5e64a1===_0xdd936a(0x34a)){const _0x36bff4=_0x44cf0b[_0xdd936a(0x22c)](0x471+-0x19b1*0x1+0x1542);let _0x21c151=_0x36bff4[_0xdd936a(0x378)]('\x20');if(!_0x21c151&&_0x125f76)_0x21c151=_0x125f76[_0xdd936a(0x3a7)]();if(!_0x21c151){await sendWithRetry(_0x5d6fb4,{'text':_0xdd936a(0x11a)+_0xdd936a(0x332)+'<number|nu'+_0xdd936a(0x137)+_0xdd936a(0x291)});return;}if(/^\s*all\s*$/i[_0xdd936a(0x2ec)](_0x21c151)){let _0x5aa2f9=0x132f*-0x2+0xa*-0x3d7+0x4cc4;for(const _0x285fe1 of _0x255621){const _0x49889f=await removeAllSchedulesForChat(_0x285fe1);_0x5aa2f9+=_0x49889f;}await sendWithRetry(_0x5d6fb4,{'text':'Deleted\x20'+_0x5aa2f9+('\x20schedule('+'s)\x20across\x20'+_0xdd936a(0x210))+_0x255621['join'](',\x20')});return;}const _0x54e1cc=_0x21c151[_0xdd936a(0x313)](/[\s,]+/)[_0xdd936a(0x2e0)](_0x52a64e=>_0x52a64e[_0xdd936a(0x3a7)]())[_0xdd936a(0x32a)](Boolean),_0x4b4fc9=_0x54e1cc[_0xdd936a(0x2e0)](_0x5b80e3=>Number(_0x5b80e3))[_0xdd936a(0x32a)](_0x4337ae=>!Number[_0xdd936a(0x19a)](_0x4337ae)&&Number[_0xdd936a(0x107)](_0x4337ae)&&_0x4337ae>0x9c9+0x160e+-0x1fd7);if(!_0x4b4fc9['length']){await sendWithRetry(_0x5d6fb4,{'text':'No\x20valid\x20i'+_0xdd936a(0x346)+_0xdd936a(0x36b)+'ge:\x20sched\x20'+_0xdd936a(0x16a)+_0xdd936a(0x307)+'d\x20delete\x201'+_0xdd936a(0x2f0)+_0xdd936a(0x20c)+_0xdd936a(0x363)});return;}const _0x51ad35=[...new Set(_0x4b4fc9)],_0x25de22=await getCombinedSchedulesForChats(_0x255621),_0x32702a=[],_0x1ea981=[];for(const _0x483d2b of _0x51ad35){if(_0x483d2b<-0x483+-0x1f92+-0x95*-0x3e||_0x483d2b>_0x25de22[_0xdd936a(0x37f)]){_0x1ea981[_0xdd936a(0x32e)]({'n':_0x483d2b,'reason':_0xdd936a(0x150)});continue;}const _0x4e2854=_0x25de22[_0x483d2b-(0x11*0x29+-0x1*0x19f9+0x1741)]['id'],_0x132eac=await removeScheduleByDBId(_0x4e2854);if(_0x132eac)_0x32702a[_0xdd936a(0x32e)]({'n':_0x483d2b,'id':_0x4e2854});else _0x1ea981['push']({'n':_0x483d2b,'reason':_0xdd936a(0x315)+_0xdd936a(0x2ac)});}let _0x56728d='';if(_0x32702a['length'])_0x56728d+=_0xdd936a(0x2eb)+_0x32702a[_0xdd936a(0x37f)]+(_0xdd936a(0x300)+_0xdd936a(0x39a))+_0x32702a[_0xdd936a(0x2e0)](_0x119687=>_0x119687['n']+_0xdd936a(0x26f)+_0x119687['id']+')')[_0xdd936a(0x378)](',\x20')+'.\x0a';if(_0x1ea981[_0xdd936a(0x37f)])_0x56728d+=_0xdd936a(0x1a9)+_0xdd936a(0x153)+_0x1ea981[_0xdd936a(0x2e0)](_0x2e4800=>_0x2e4800['n']+'('+_0x2e4800['reason']+')')[_0xdd936a(0x378)](',\x20')+'.';await sendWithRetry(_0x5d6fb4,{'text':_0x56728d['trim']()||'No\x20changes'+_0xdd936a(0x293)});return;}if(_0x5e64a1===_0xdd936a(0x2c4)){const _0x3410ad=Number(_0x44cf0b[-0x2*-0x46d+0x14b0+0x24*-0xd2]),_0x383ffe=_0x44cf0b[-0x29d*0x8+0x2519*-0x1+0x5e*0x9e]||(_0x125f76?_0x125f76[_0xdd936a(0x313)](/\r?\n/)[-0x3*-0x797+-0x137*0x2+-0x1457][_0xdd936a(0x3a7)]():null);if(!_0x3410ad||!_0x383ffe){await sendWithRetry(_0x5d6fb4,{'text':_0xdd936a(0x11a)+'ed\x20edit\x20<n'+'umber>\x20<HH'+_0xdd936a(0x302)+_0xdd936a(0x22d)+_0xdd936a(0x23b)+'m>'});return;}const _0x17c8e7=await getCombinedSchedulesForChats(_0x255621);if(!_0x17c8e7||_0x17c8e7[_0xdd936a(0x37f)]<_0x3410ad){await sendWithRetry(_0x5d6fb4,{'text':_0xdd936a(0x318)+_0xdd936a(0x3c7)+_0x3410ad+(_0xdd936a(0x31e)+'oss\x20your\x20d'+_0xdd936a(0x126))});return;}const _0x355145=_0x17c8e7[_0x3410ad-(-0x23ab+-0x1b*0xf9+0x3def)]['id'];if(!_0x355145){await sendWithRetry(_0x5d6fb4,{'text':_0xdd936a(0x318)+_0xdd936a(0x3c7)+_0x3410ad+(_0xdd936a(0x31e)+'oss\x20your\x20d'+_0xdd936a(0x126))});return;}const _0x1e643e=parseTimeToken(_0x383ffe,DEFAULT_TIMEZONE);if(!_0x1e643e){await sendWithRetry(_0x5d6fb4,{'text':_0xdd936a(0x1a9)+_0xdd936a(0x1dd)+'time.'});return;}if(_0x1e643e['type']==='datetime'){const _0x1a495c=_0x1e643e['dt'],_0x479325=Math[_0xdd936a(0x2d8)](_0x1a495c[_0xdd936a(0x3b6)]()/(0x14c*0x9+0x1e36+-0x25fa)),_0x2d6db1=await updateScheduleFields(_0x355145,{'send_at':_0x479325,'time':null,'frequency':'once','timezone':_0x1a495c[_0xdd936a(0x20f)]||DEFAULT_TIMEZONE});if(_0x2d6db1)await sendWithRetry(_0x5d6fb4,{'text':'Schedule\x20#'+_0x3410ad+(_0xdd936a(0x38a)+_0xdd936a(0x17a)+_0xdd936a(0x264))+_0x1a495c[_0xdd936a(0x110)+_0xdd936a(0x31a)](DateTime['DATETIME_M'+'ED'])+'\x20('+_0x1a495c[_0xdd936a(0x20f)]+')'});else await sendWithRetry(_0x5d6fb4,{'text':'Failed\x20to\x20'+_0xdd936a(0x258)+'edule.'});return;}else{if(_0x1e643e[_0xdd936a(0x3a3)]===_0xdd936a(0x193)){const _0x9b6465=_0x1e643e[_0xdd936a(0x193)],_0x11c15c=_0x17c8e7[_0x3410ad-(-0x17ab+-0x4d3+0x1c7f)],_0x2c8b7e=_0x11c15c[_0xdd936a(0x375)]||await getChatTimezone(_0x11c15c[_0xdd936a(0x168)])||DEFAULT_TIMEZONE,_0x1a2fef=await updateScheduleFields(_0x355145,{'time':_0x9b6465,'send_at':null,'frequency':_0xdd936a(0x1f7),'timezone':_0x2c8b7e});if(_0x1a2fef)await sendWithRetry(_0x5d6fb4,{'text':_0xdd936a(0x27a)+_0x3410ad+(_0xdd936a(0x38a)+_0xdd936a(0x36a)+_0xdd936a(0x3cc))+_0x9b6465+'\x20('+_0x2c8b7e+')'});else await sendWithRetry(_0x5d6fb4,{'text':_0xdd936a(0x1a9)+_0xdd936a(0x258)+'edule.'});return;}else{await sendWithRetry(_0x5d6fb4,{'text':_0xdd936a(0x349)+_0xdd936a(0x1b3)+_0xdd936a(0x3e3)+'it.'});return;}}}if(_0x5e64a1===_0xdd936a(0x32d)){const _0xd2e79d=Number(_0x44cf0b[-0x1*0x989+-0x17*-0x15+-0x8c*-0xe]),_0x4cc522=Number(_0x44cf0b[0xbc1+-0x7*-0x1f9+-0x1*0x198d]);if(!_0xd2e79d||!_0x4cc522||_0x4cc522<-0x6e6*0x5+-0x142f+-0x36ae*-0x1){await sendWithRetry(_0x5d6fb4,{'text':_0xdd936a(0x11a)+_0xdd936a(0x325)+'cy\x20<number'+_0xdd936a(0x14e)+'1\x20daily,\x20n'+_0xdd936a(0x2cd)+_0xdd936a(0x1d8)+'.)'});return;}const _0x5c14ec=await getCombinedSchedulesForChats(_0x255621);if(!_0x5c14ec||_0x5c14ec[_0xdd936a(0x37f)]<_0xd2e79d){await sendWithRetry(_0x5d6fb4,{'text':_0xdd936a(0x318)+_0xdd936a(0x3c7)+_0xd2e79d+('\x20found\x20acr'+'oss\x20your\x20d'+_0xdd936a(0x126))});return;}const _0x9d3228=_0x5c14ec[_0xd2e79d-(-0x1537*-0x1+0x2*0xd32+-0x2f9a)]['id'];if(!_0x9d3228){await sendWithRetry(_0x5d6fb4,{'text':'No\x20schedul'+_0xdd936a(0x3c7)+_0xd2e79d+(_0xdd936a(0x31e)+'oss\x20your\x20d'+'efaults.')});return;}let _0x2f57ed=_0xdd936a(0x1f7);if(_0x4cc522===-0x23dd*0x1+-0xf1c+0x32fa)_0x2f57ed='daily';else _0x2f57ed='every_n_da'+_0xdd936a(0x1a2)+_0x4cc522;const _0x459c19=await updateScheduleFields(_0x9d3228,{'frequency':_0x2f57ed});if(_0x459c19)await sendWithRetry(_0x5d6fb4,{'text':_0xdd936a(0x27a)+_0xd2e79d+(_0xdd936a(0x151)+_0xdd936a(0x175))+_0x2f57ed});else await sendWithRetry(_0x5d6fb4,{'text':_0xdd936a(0x1a9)+_0xdd936a(0x10c)+_0xdd936a(0x2a6)});return;}if(_0x5e64a1===_0xdd936a(0x1a0)||_0x5e64a1===_0xdd936a(0x17c)){const _0x5677b8=Number(_0x44cf0b[-0x14a+-0x1c*0x131+0x22a8]);if(!_0x5677b8){await sendWithRetry(_0x5d6fb4,{'text':_0xdd936a(0x11a)+_0xdd936a(0x219)+_0x5e64a1+'\x20<number>'});return;}const _0x48f697=await getCombinedSchedulesForChats(_0x255621);if(!_0x48f697||_0x48f697[_0xdd936a(0x37f)]<_0x5677b8){await sendWithRetry(_0x5d6fb4,{'text':_0xdd936a(0x318)+'e\x20#'+_0x5677b8+('\x20found\x20acr'+_0xdd936a(0x28e)+_0xdd936a(0x126))});return;}const _0x2242ac=_0x48f697[_0x5677b8-(0x5bf*-0x5+-0x1102+0x493*0xa)]['id'];if(!_0x2242ac){await sendWithRetry(_0x5d6fb4,{'text':'No\x20schedul'+_0xdd936a(0x3c7)+_0x5677b8+(_0xdd936a(0x31e)+_0xdd936a(0x28e)+_0xdd936a(0x126))});return;}const _0x4877f1=await updateScheduleFields(_0x2242ac,{'enabled':_0x5e64a1===_0xdd936a(0x17c)?-0x14d*0x1a+0x1*0xe5c+-0x1*-0x1377:0x1*0x1af3+0x61*-0x3e+-0x375});if(_0x4877f1)await sendWithRetry(_0x5d6fb4,{'text':_0xdd936a(0x27a)+_0x5677b8+'\x20'+_0x5e64a1+'d.'});else await sendWithRetry(_0x5d6fb4,{'text':_0xdd936a(0x1a9)+_0xdd936a(0x162)+'bled\x20state'+'.'});return;}await sendWithRetry(_0x5d6fb4,{'text':USAGE});}catch(_0x5d1f9f){warn('[sched]\x20ha'+'ndleSchedC'+_0xdd936a(0x1d1)+_0xdd936a(0x170)+(_0x5d1f9f?.[_0xdd936a(0x2d1)]||_0x5d1f9f));}}async function handleSchedCommandPM(_0x4a7b49,{sub:_0x2e1300,firstLine:_0x242bd0,restText:_0x4d1808,firstTokens:_0x2d5b56,targetChatJids:_0x46d676,confirmationTarget:_0x329bb2,senderJid:_0x480941,cleanedBody:_0x52931d}){const _0x3b8105=_0x563749;try{if(!_0x2e1300||_0x2e1300===_0x3b8105(0x2d4)){await sendWithRetry(_0x329bb2,{'text':USAGE});return;}if(_0x2e1300==='once'){const _0x26a8fd=_0x2d5b56[-0x59*0x13+0x2611*-0x1+0x2cae],_0x5a0ad5=_0x2d5b56[-0x655*0x4+0x1*-0x1021+0x2978]&&/^\d+$/[_0x3b8105(0x2ec)](_0x2d5b56[-0x9b*-0x19+-0x19*-0x1+-0xf39])?Number(_0x2d5b56[-0x1282+-0x14b2+0x2737]):null;let _0x5ce2b7=(_0x52931d||'')[_0x3b8105(0x3a7)]();!_0x5ce2b7&&_0x26a8fd&&(_0x5ce2b7=extractInlineAfterToken(_0x242bd0,_0x26a8fd));if(!_0x26a8fd||!_0x5ce2b7||_0x5ce2b7[_0x3b8105(0x3a7)]()[_0x3b8105(0x37f)]===0xd9+-0x3ff+0x326){await sendWithRetry(_0x329bb2,{'text':_0x3b8105(0x11a)+'ed\x20once\x20<H'+_0x3b8105(0x335)+_0x3b8105(0x205)+'ge...>\x20\x20\x20('+_0x3b8105(0x3bd)+_0x3b8105(0x236)+_0x3b8105(0x224)});return;}const _0xd839e0=[];for(const _0x3f558e of _0x46d676){const _0x3979b0=await getChatTimezone(_0x3f558e)||DEFAULT_TIMEZONE,_0x58c5c1=parseTimeToken(_0x26a8fd,_0x3979b0);if(!_0x58c5c1){_0xd839e0[_0x3b8105(0x32e)]({'chat':_0x3f558e,'ok':![],'reason':'parse_fail'+'ed'});continue;}if(_0x58c5c1[_0x3b8105(0x3a3)]===_0x3b8105(0x1b4)){const _0x25c659=_0x58c5c1['dt'],_0x1e058d=Math['floor'](_0x25c659[_0x3b8105(0x3b6)]()/(-0x134*-0x3+0xf7d+-0xf31)),_0x54d4a9=await addScheduleRow({'chat_jid':_0x3f558e,'message':_0x5ce2b7,'time':null,'send_at':_0x1e058d,'frequency':_0x3b8105(0x197),'timezone':_0x25c659[_0x3b8105(0x20f)]||_0x3979b0,'creator_jid':_0x480941});if(_0x54d4a9)_0xd839e0[_0x3b8105(0x32e)]({'chat':_0x3f558e,'ok':!![],'id':_0x54d4a9,'when':_0x25c659['toLocaleSt'+'ring'](DateTime[_0x3b8105(0x372)+'ED'])});else _0xd839e0[_0x3b8105(0x32e)]({'chat':_0x3f558e,'ok':![],'reason':_0x3b8105(0x336)});continue;}if(_0x58c5c1[_0x3b8105(0x3a3)]===_0x3b8105(0x193)){const [_0x1441e2,_0x103b7c]=_0x58c5c1[_0x3b8105(0x193)][_0x3b8105(0x313)](':')[_0x3b8105(0x2e0)](Number);let _0x5b54e3=DateTime[_0x3b8105(0x237)]()[_0x3b8105(0x253)](_0x3979b0),_0x1aa2b5=_0x5b54e3[_0x3b8105(0x324)](_0x3b8105(0x125))['set']({'hour':_0x1441e2,'minute':_0x103b7c,'second':0x0,'millisecond':0x0});if(_0x5a0ad5&&Number[_0x3b8105(0x107)](_0x5a0ad5)&&_0x5a0ad5>=0x12c*0x6+-0x15a*0x9+0x523)_0x1aa2b5=_0x1aa2b5[_0x3b8105(0x2e7)]({'days':Number(_0x5a0ad5)});else{if(_0x1aa2b5<=_0x5b54e3)_0x1aa2b5=_0x1aa2b5[_0x3b8105(0x2e7)]({'days':0x1});}const _0x1f9b47=Math[_0x3b8105(0x2d8)](_0x1aa2b5['toMillis']()/(0x17db+-0x1d9e+-0xb*-0xe1)),_0x4db849=await addScheduleRow({'chat_jid':_0x3f558e,'message':_0x5ce2b7,'time':null,'send_at':_0x1f9b47,'frequency':_0x3b8105(0x197),'timezone':_0x3979b0,'creator_jid':_0x480941});if(_0x4db849)_0xd839e0[_0x3b8105(0x32e)]({'chat':_0x3f558e,'ok':!![],'id':_0x4db849,'when':_0x1aa2b5['toLocaleSt'+_0x3b8105(0x31a)](DateTime[_0x3b8105(0x372)+'ED'])});else _0xd839e0[_0x3b8105(0x32e)]({'chat':_0x3f558e,'ok':![],'reason':_0x3b8105(0x336)});continue;}_0xd839e0[_0x3b8105(0x32e)]({'chat':_0x3f558e,'ok':![],'reason':_0x3b8105(0x370)+'d_time'});}const _0xa5933b=_0xd839e0[_0x3b8105(0x32a)](_0x4a32bd=>_0x4a32bd['ok']),_0x16f8f0=_0xd839e0[_0x3b8105(0x32a)](_0x382444=>!_0x382444['ok']);let _0x42f1f9='';if(_0xa5933b[_0x3b8105(0x37f)]){_0x42f1f9+=_0x3b8105(0x142)+_0x3b8105(0x377)+'r\x20'+_0xa5933b[_0x3b8105(0x37f)]+(_0x3b8105(0x214)+':\x0a');for(const _0x1cca32 of _0xa5933b)_0x42f1f9+='â€¢\x20'+_0x1cca32['chat']+_0x3b8105(0x3e4)+_0x1cca32['id']+_0x3b8105(0x2d9)+_0x1cca32[_0x3b8105(0x1c8)]+'\x0a';}if(_0x16f8f0['length']){_0x42f1f9+=_0x3b8105(0x1f3)+'\x20'+_0x16f8f0[_0x3b8105(0x37f)]+(_0x3b8105(0x214)+':\x0a');for(const _0x59a946 of _0x16f8f0)_0x42f1f9+='â€¢\x20'+_0x59a946['chat']+'\x20->\x20'+_0x59a946[_0x3b8105(0x1a6)]+'\x0a';}await sendWithRetry(_0x329bb2,{'text':_0x42f1f9['trim']()||_0x3b8105(0x318)+_0x3b8105(0x135)+'.'});return;}if(_0x2e1300===_0x3b8105(0x356)){if(!_0x2d5b56[0x2424+-0x1*-0x165b+-0x3a7d]){await sendWithRetry(_0x329bb2,{'text':_0x3b8105(0x11a)+_0x3b8105(0x10a)+_0x3b8105(0x220)+_0x3b8105(0x1f8)+_0x3b8105(0x200)+_0x3b8105(0x29f)+_0x3b8105(0x199)+_0x3b8105(0x120)+_0x3b8105(0x121)+'id|all>'});return;}const _0xb6c67c=_0x2d5b56[0x7d6*0x1+0x22*-0x73+0x2*0x3b9],_0x5194f7=_0x2d5b56[0xf*0x2c+0xffa+-0x128b]&&/^\d+$/[_0x3b8105(0x2ec)](_0x2d5b56[0x75a+0x1c49+0xa*-0x390])?Number(_0x2d5b56[0x24d3+-0x1a1d+-0xab3]):null;let _0x432f33=(_0x52931d||'')[_0x3b8105(0x3a7)]();!_0x432f33&&(_0x432f33=extractInlineAfterToken(_0x242bd0,_0xb6c67c));if(!_0x432f33||_0x432f33[_0x3b8105(0x3a7)]()[_0x3b8105(0x37f)]===-0x6*0x24b+-0x2127+-0x1*-0x2ee9){await sendWithRetry(_0x329bb2,{'text':_0x3b8105(0x350)+_0x3b8105(0x305)+_0x3b8105(0x2f4)+_0x3b8105(0x17d)+_0x3b8105(0x2dd)+_0x3b8105(0x202)+'owing\x20line'+_0x3b8105(0x33a)+_0x3b8105(0x2fd)+'l>'});return;}const _0x556c1a=[];for(const _0x6dc846 of _0x46d676){const _0x14b133=await getChatTimezone(_0x6dc846)||DEFAULT_TIMEZONE,_0x46db3e=parseTimeToken(_0xb6c67c,_0x14b133);if(!_0x46db3e){_0x556c1a[_0x3b8105(0x32e)]({'chat':_0x6dc846,'ok':![],'reason':'parse_fail'+'ed'});continue;}const _0x424ff3=_0x480941;if(_0x46db3e[_0x3b8105(0x3a3)]===_0x3b8105(0x1b4)){const _0x46a34e=_0x46db3e['dt'],_0x3df35c=Math[_0x3b8105(0x2d8)](_0x46a34e['toMillis']()/(0xbea+0x1c40+-0xb6*0x33)),_0x1d1ec6=await addScheduleRow({'chat_jid':_0x6dc846,'message':_0x432f33,'time':null,'send_at':_0x3df35c,'frequency':_0x3b8105(0x197),'timezone':_0x46a34e[_0x3b8105(0x20f)]||_0x14b133,'creator_jid':_0x424ff3});if(_0x1d1ec6)_0x556c1a[_0x3b8105(0x32e)]({'chat':_0x6dc846,'ok':!![],'id':_0x1d1ec6,'when':_0x46a34e[_0x3b8105(0x110)+_0x3b8105(0x31a)](DateTime[_0x3b8105(0x372)+'ED'])});else _0x556c1a['push']({'chat':_0x6dc846,'ok':![],'reason':'db_failed'});continue;}if(_0x46db3e[_0x3b8105(0x3a3)]==='hhmm'){const _0x1ec368=_0x46db3e['hhmm'];if(_0x5194f7&&Number[_0x3b8105(0x107)](_0x5194f7)&&_0x5194f7>=-0x1a*0x97+-0x2084+0x1*0x2fdb){let _0x3e80cb=DateTime[_0x3b8105(0x237)]()[_0x3b8105(0x253)](_0x14b133);const [_0x341e65,_0x29ed04]=_0x1ec368['split'](':')['map'](Number);let _0x2801eb=_0x3e80cb[_0x3b8105(0x324)](_0x3b8105(0x125))[_0x3b8105(0x34f)]({'hour':_0x341e65,'minute':_0x29ed04,'second':0x0,'millisecond':0x0});_0x2801eb=_0x2801eb[_0x3b8105(0x2e7)]({'days':Number(_0x5194f7)});const _0x2525ee=Math[_0x3b8105(0x2d8)](_0x2801eb[_0x3b8105(0x3b6)]()/(-0x18e2+0x183f+-0x1*-0x48b)),_0x2710e8=await addScheduleRow({'chat_jid':_0x6dc846,'message':_0x432f33,'time':null,'send_at':_0x2525ee,'frequency':'once','timezone':_0x14b133,'creator_jid':_0x424ff3});if(_0x2710e8)_0x556c1a[_0x3b8105(0x32e)]({'chat':_0x6dc846,'ok':!![],'id':_0x2710e8,'when':_0x2801eb[_0x3b8105(0x110)+_0x3b8105(0x31a)](DateTime[_0x3b8105(0x372)+'ED'])});else _0x556c1a[_0x3b8105(0x32e)]({'chat':_0x6dc846,'ok':![],'reason':_0x3b8105(0x336)});continue;}const _0x241f5a=await addScheduleRow({'chat_jid':_0x6dc846,'message':_0x432f33,'time':_0x1ec368,'send_at':null,'frequency':_0x3b8105(0x1f7),'timezone':_0x14b133,'creator_jid':_0x424ff3});if(_0x241f5a)_0x556c1a[_0x3b8105(0x32e)]({'chat':_0x6dc846,'ok':!![],'id':_0x241f5a,'when':_0x1ec368+'\x20('+_0x14b133+')'});else _0x556c1a[_0x3b8105(0x32e)]({'chat':_0x6dc846,'ok':![],'reason':_0x3b8105(0x336)});continue;}_0x556c1a[_0x3b8105(0x32e)]({'chat':_0x6dc846,'ok':![],'reason':'unsupporte'+_0x3b8105(0x36c)});}const _0x5553c4=_0x556c1a[_0x3b8105(0x32a)](_0x337466=>_0x337466['ok']),_0x1186f0=_0x556c1a['filter'](_0x1ee87f=>!_0x1ee87f['ok']);let _0x33f213='';if(_0x5553c4[_0x3b8105(0x37f)]){_0x33f213+=_0x3b8105(0x142)+'for\x20'+_0x5553c4['length']+(_0x3b8105(0x214)+':\x0a');for(const _0x34afd0 of _0x5553c4)_0x33f213+='â€¢\x20'+_0x34afd0[_0x3b8105(0x130)]+'\x20->\x20id:'+_0x34afd0['id']+_0x3b8105(0x3ca)+_0x34afd0[_0x3b8105(0x1c8)]+'\x0a';}if(_0x1186f0['length']){_0x33f213+=_0x3b8105(0x1f3)+'\x20'+_0x1186f0[_0x3b8105(0x37f)]+('\x20target(s)'+':\x0a');for(const _0xb54de7 of _0x1186f0)_0x33f213+='â€¢\x20'+_0xb54de7[_0x3b8105(0x130)]+'\x20->\x20'+_0xb54de7[_0x3b8105(0x1a6)]+'\x0a';}await sendWithRetry(_0x329bb2,{'text':_0x33f213[_0x3b8105(0x3a7)]()||_0x3b8105(0x318)+_0x3b8105(0x135)+'.'});return;}if(_0x2e1300===_0x3b8105(0x1c3)){const _0x175cd9=[];for(const _0xd8ffeb of _0x46d676){const _0x190c5b=await listSchedulesForChat(_0xd8ffeb);for(const _0x184ba5 of _0x190c5b)_0x175cd9[_0x3b8105(0x32e)]({'chatJid':_0xd8ffeb,..._0x184ba5});}if(!_0x175cd9['length']){await sendWithRetry(_0x329bb2,{'text':'[sched]\x20No'+_0x3b8105(0x37e)+_0x3b8105(0x257)+_0x3b8105(0x31f)+_0x3b8105(0x2c5)+'targets.'});return;}let _0x208041='';for(const _0x345d4c of _0x175cd9){const _0x560e42=_0x345d4c[_0x3b8105(0x2df)]?DateTime[_0x3b8105(0x1be)](Number(_0x345d4c[_0x3b8105(0x2df)])*(0x457+0x1a45+-0x1ab4))[_0x3b8105(0x253)](_0x345d4c['timezone']||DEFAULT_TIMEZONE)[_0x3b8105(0x1e1)]({'suppressSeconds':!![]}):_0x345d4c[_0x3b8105(0x239)]?_0x345d4c['time']+'\x20('+(_0x345d4c['timezone']||'group/defa'+_0x3b8105(0x2b4))+')':_0x3b8105(0x249),_0x676cdd=(_0x345d4c[_0x3b8105(0x2d1)]||'')['split']('\x0a')[_0x3b8105(0x2e0)](_0x4758c1=>_0x4758c1[_0x3b8105(0x1b2)]())[_0x3b8105(0x378)]('\x0a'),_0x356052=_0x345d4c[_0x3b8105(0x306)]+':'+_0x345d4c['id']+_0x3b8105(0x3ca)+_0x560e42+_0x3b8105(0x319)+(_0x345d4c[_0x3b8105(0x32d)]||_0x3b8105(0x1f7))+_0x3b8105(0x2d3)+(_0x345d4c[_0x3b8105(0x347)]?'yes':'no')+_0x3b8105(0x190)+_0x676cdd+'\x0a\x0a';(_0x208041+_0x356052)['length']>0x25b8+-0x1d0a+-0x2d2&&(await sendWithRetry(_0x329bb2,{'text':_0x208041['trim']()}),_0x208041=''),_0x208041+=_0x356052;}if(_0x208041['trim']())await sendWithRetry(_0x329bb2,{'text':_0x208041[_0x3b8105(0x3a7)]()});return;}if(_0x2e1300===_0x3b8105(0x34a)){const _0x41ef22=_0x2d5b56[_0x3b8105(0x22c)](-0x24a*0xd+-0xb96*-0x3+-0x3*0x1aa);let _0x33238a=_0x41ef22['join']('\x20');if(!_0x33238a&&_0x4d1808)_0x33238a=_0x4d1808[_0x3b8105(0x3a7)]();if(!_0x33238a){await sendWithRetry(_0x329bb2,{'text':'Usage:\x20sch'+_0x3b8105(0x332)+_0x3b8105(0x1eb)+_0x3b8105(0x137)+_0x3b8105(0x291)+'\x20gp:<alias'+_0x3b8105(0x182)});return;}if(/^\s*all\s*$/i[_0x3b8105(0x2ec)](_0x33238a)){let _0x203bc9=-0x1*-0x1455+-0x1*0xe6d+0x1f8*-0x3;for(const _0x1b0d64 of _0x46d676){const _0xc04151=await removeAllSchedulesForChat(_0x1b0d64);_0x203bc9+=_0xc04151;}await sendWithRetry(_0x329bb2,{'text':'Deleted\x20'+_0x203bc9+(_0x3b8105(0x300)+_0x3b8105(0x371)+_0x3b8105(0x2c5)+'targets.')});return;}const _0x5b408c=_0x33238a[_0x3b8105(0x313)](/[\s,]+/)[_0x3b8105(0x2e0)](_0x18a7a2=>_0x18a7a2['trim']())[_0x3b8105(0x32a)](Boolean),_0x32d104=_0x5b408c[_0x3b8105(0x2e0)](_0x8e5aca=>Number(_0x8e5aca))[_0x3b8105(0x32a)](_0x209738=>!Number[_0x3b8105(0x19a)](_0x209738)&&Number[_0x3b8105(0x107)](_0x209738)&&_0x209738>-0x279+-0x1eae+0x7b*0x45);if(!_0x32d104[_0x3b8105(0x37f)]){await sendWithRetry(_0x329bb2,{'text':_0x3b8105(0x3c2)+_0x3b8105(0x346)+_0x3b8105(0x36b)+_0x3b8105(0x2ab)+_0x3b8105(0x16a)+_0x3b8105(0x307)+_0x3b8105(0x3d6)+',2,3\x20OR\x20sc'+'hed\x20delete'+_0x3b8105(0x1e7)+_0x3b8105(0x2ff)+'ll>'});return;}const _0x1217ce=[...new Set(_0x32d104)],_0x21d687=await getCombinedSchedulesForChats(_0x46d676),_0x4101db=[],_0x8293d2=[];for(const _0x258641 of _0x1217ce){if(_0x258641<-0xdf1+0x1fa3+-0x287*0x7||_0x258641>_0x21d687[_0x3b8105(0x37f)]){_0x8293d2[_0x3b8105(0x32e)]({'n':_0x258641,'reason':'not\x20found'});continue;}const _0x5850a7=_0x21d687[_0x258641-(0x29*0x81+0xc1+-0x1569*0x1)]['id'],_0x42c9d6=await removeScheduleByDBId(_0x5850a7);if(_0x42c9d6)_0x4101db[_0x3b8105(0x32e)]({'n':_0x258641,'id':_0x5850a7});else _0x8293d2[_0x3b8105(0x32e)]({'n':_0x258641,'reason':_0x3b8105(0x315)+_0x3b8105(0x2ac)});}let _0x2e8040='';if(_0x4101db['length'])_0x2e8040+=_0x3b8105(0x2eb)+_0x4101db['length']+('\x20schedule('+_0x3b8105(0x39a))+_0x4101db[_0x3b8105(0x2e0)](_0x59081b=>_0x59081b['n']+_0x3b8105(0x26f)+_0x59081b['id']+')')[_0x3b8105(0x378)](',\x20')+'.\x0a';if(_0x8293d2[_0x3b8105(0x37f)])_0x2e8040+=_0x3b8105(0x1a9)+_0x3b8105(0x153)+_0x8293d2[_0x3b8105(0x2e0)](_0x32707d=>_0x32707d['n']+'('+_0x32707d[_0x3b8105(0x1a6)]+')')[_0x3b8105(0x378)](',\x20')+'.';await sendWithRetry(_0x329bb2,{'text':_0x2e8040['trim']()||_0x3b8105(0x25b)+'\x20made.'});return;}if(_0x2e1300==='edit'){const _0x4c1184=Number(_0x2d5b56[0x1*0x19b+-0x1*0x119b+0x1002]),_0x18bd7f=_0x2d5b56[0x14e*0x2+0x4db*0x8+-0x2971]||(_0x4d1808?_0x4d1808['split'](/\r?\n/)[-0x1*-0x13ad+0x61*-0x19+0x2*-0x51a][_0x3b8105(0x3a7)]():null);if(!_0x4c1184||!_0x18bd7f){await sendWithRetry(_0x329bb2,{'text':_0x3b8105(0x11a)+_0x3b8105(0x3e6)+_0x3b8105(0x208)+_0x3b8105(0x302)+'ours|YYYY-'+_0x3b8105(0x23b)+'m>\x20gp:<ali'+_0x3b8105(0x38e)+'>'});return;}const _0x1e1efe=await getCombinedSchedulesForChats(_0x46d676);if(!_0x1e1efe||_0x1e1efe[_0x3b8105(0x37f)]<_0x4c1184){await sendWithRetry(_0x329bb2,{'text':_0x3b8105(0x318)+_0x3b8105(0x3c7)+_0x4c1184+(_0x3b8105(0x31e)+_0x3b8105(0x216)+_0x3b8105(0x16b)+'s.')});return;}const _0xe62ef=_0x1e1efe[_0x4c1184-(0x3a4+0x173e+0x7*-0x3d7)]['id'];if(!_0xe62ef){await sendWithRetry(_0x329bb2,{'text':_0x3b8105(0x318)+_0x3b8105(0x3c7)+_0x4c1184+('\x20found\x20acr'+'oss\x20reques'+_0x3b8105(0x16b)+'s.')});return;}const _0xaae675=parseTimeToken(_0x18bd7f,DEFAULT_TIMEZONE);if(!_0xaae675){await sendWithRetry(_0x329bb2,{'text':_0x3b8105(0x1a9)+_0x3b8105(0x1dd)+_0x3b8105(0x188)});return;}if(_0xaae675[_0x3b8105(0x3a3)]===_0x3b8105(0x1b4)){const _0x50cea6=_0xaae675['dt'],_0x1295e2=Math[_0x3b8105(0x2d8)](_0x50cea6[_0x3b8105(0x3b6)]()/(-0x17*-0x163+-0x4f*0x36+-0xb53)),_0x2d2d75=await updateScheduleFields(_0xe62ef,{'send_at':_0x1295e2,'time':null,'frequency':_0x3b8105(0x197),'timezone':_0x50cea6[_0x3b8105(0x20f)]||DEFAULT_TIMEZONE});if(_0x2d2d75)await sendWithRetry(_0x329bb2,{'text':_0x3b8105(0x27a)+_0x4c1184+(_0x3b8105(0x38a)+_0x3b8105(0x17a)+_0x3b8105(0x264))+_0x50cea6[_0x3b8105(0x110)+_0x3b8105(0x31a)](DateTime['DATETIME_M'+'ED'])+'\x20('+_0x50cea6['zoneName']+')'});else await sendWithRetry(_0x329bb2,{'text':_0x3b8105(0x1a9)+_0x3b8105(0x258)+_0x3b8105(0x13a)});return;}else{if(_0xaae675['type']===_0x3b8105(0x193)){const _0x137303=_0xaae675[_0x3b8105(0x193)],_0x158332=_0x1e1efe[_0x4c1184-(-0x6b3*0x2+-0x51*-0xa+0xa3d)],_0x33d7fd=_0x158332[_0x3b8105(0x375)]||await getChatTimezone(_0x158332['chat_jid'])||DEFAULT_TIMEZONE,_0xca6b56=await updateScheduleFields(_0xe62ef,{'time':_0x137303,'send_at':null,'frequency':_0x3b8105(0x1f7),'timezone':_0x33d7fd});if(_0xca6b56)await sendWithRetry(_0x329bb2,{'text':_0x3b8105(0x27a)+_0x4c1184+('\x20updated\x20t'+_0x3b8105(0x36a)+_0x3b8105(0x3cc))+_0x137303+'\x20('+_0x33d7fd+')'});else await sendWithRetry(_0x329bb2,{'text':_0x3b8105(0x1a9)+'update\x20sch'+_0x3b8105(0x13a)});return;}else{await sendWithRetry(_0x329bb2,{'text':_0x3b8105(0x349)+_0x3b8105(0x1b3)+_0x3b8105(0x3e3)+_0x3b8105(0x12f)});return;}}}if(_0x2e1300===_0x3b8105(0x32d)){const _0x1cd978=Number(_0x2d5b56[0x1*0x18c7+-0x65f+-0x5*0x3ae]),_0x474862=Number(_0x2d5b56[-0x338+0x536+-0xd*0x27]);if(!_0x1cd978||!_0x474862||_0x474862<-0xa*-0x396+0x1a1a+-0x3*0x14a7){await sendWithRetry(_0x329bb2,{'text':'Usage:\x20sch'+'ed\x20frequen'+_0x3b8105(0x243)+'>\x20<n>\x20\x20(n='+'1\x20daily,\x20n'+'=2\x20every\x202'+'\x20days,\x20etc'+_0x3b8105(0x1ae)+_0x3b8105(0x38e)+'>'});return;}const _0x4d82e5=await getCombinedSchedulesForChats(_0x46d676);if(!_0x4d82e5||_0x4d82e5[_0x3b8105(0x37f)]<_0x1cd978){await sendWithRetry(_0x329bb2,{'text':_0x3b8105(0x318)+_0x3b8105(0x3c7)+_0x1cd978+('\x20found\x20acr'+_0x3b8105(0x216)+_0x3b8105(0x16b)+'s.')});return;}const _0x5b6ea1=_0x4d82e5[_0x1cd978-(0x1499+0x1267+-0x26ff*0x1)]['id'];if(!_0x5b6ea1){await sendWithRetry(_0x329bb2,{'text':_0x3b8105(0x318)+'e\x20#'+_0x1cd978+(_0x3b8105(0x31e)+_0x3b8105(0x216)+_0x3b8105(0x16b)+'s.')});return;}let _0x5b5625=_0x3b8105(0x1f7);if(_0x474862===-0x47*0x1b+0x2335+-0x21*0xd7)_0x5b5625=_0x3b8105(0x1f7);else _0x5b5625=_0x3b8105(0x1f2)+_0x3b8105(0x1a2)+_0x474862;const _0x5b528e=await updateScheduleFields(_0x5b6ea1,{'frequency':_0x5b5625});if(_0x5b528e)await sendWithRetry(_0x329bb2,{'text':_0x3b8105(0x27a)+_0x1cd978+(_0x3b8105(0x151)+_0x3b8105(0x175))+_0x5b5625});else await sendWithRetry(_0x329bb2,{'text':_0x3b8105(0x1a9)+_0x3b8105(0x10c)+'quency.'});return;}if(_0x2e1300==='disable'||_0x2e1300==='enable'){const _0x4c2e74=Number(_0x2d5b56[0x4*0x13c+-0x52*-0x1c+-0xde6]);if(!_0x4c2e74){await sendWithRetry(_0x329bb2,{'text':_0x3b8105(0x11a)+'ed\x20'+_0x2e1300+(_0x3b8105(0x321)+_0x3b8105(0x34e)+_0x3b8105(0x330))});return;}const _0xce8650=await getCombinedSchedulesForChats(_0x46d676);if(!_0xce8650||_0xce8650['length']<_0x4c2e74){await sendWithRetry(_0x329bb2,{'text':_0x3b8105(0x318)+_0x3b8105(0x3c7)+_0x4c2e74+(_0x3b8105(0x31e)+'oss\x20reques'+_0x3b8105(0x16b)+'s.')});return;}const _0x31a255=_0xce8650[_0x4c2e74-(0x1*0x1763+-0x10e1+-0x681)]['id'];if(!_0x31a255){await sendWithRetry(_0x329bb2,{'text':'No\x20schedul'+_0x3b8105(0x3c7)+_0x4c2e74+('\x20found\x20acr'+_0x3b8105(0x216)+_0x3b8105(0x16b)+'s.')});return;}const _0x439b3f=await updateScheduleFields(_0x31a255,{'enabled':_0x2e1300==='enable'?0x2380+0x5ab*-0x3+-0x127e:-0x666+-0x16e0+0x1d46});if(_0x439b3f)await sendWithRetry(_0x329bb2,{'text':_0x3b8105(0x27a)+_0x4c2e74+'\x20'+_0x2e1300+'d.'});else await sendWithRetry(_0x329bb2,{'text':_0x3b8105(0x1a9)+'update\x20ena'+_0x3b8105(0x3cd)+'.'});return;}await sendWithRetry(_0x329bb2,{'text':USAGE});}catch(_0x3a79d2){warn(_0x3b8105(0x1bc)+_0x3b8105(0x185)+_0x3b8105(0x25a)+_0x3b8105(0x221)+(_0x3a79d2?.[_0x3b8105(0x2d1)]||_0x3a79d2));}}export async function initialize(_0x11a08b){const _0x432741=_0x563749;if(!_0x11a08b)throw new Error(_0x432741(0x156)+'ialize\x20req'+_0x432741(0x140)+_0x432741(0x226));setupSendApi(_0x11a08b),refreshConfig();try{await ensureSchema();}catch(_0x28e35f){error(_0x432741(0x18a)+'\x20ensure\x20fa'+_0x432741(0x250)+(_0x28e35f?.[_0x432741(0x2d1)]||_0x28e35f));throw _0x28e35f;}try{startManagedListener({'botRef':_0x11a08b,'eventName':_0x432741(0x1d2)+_0x432741(0x2de),'handler':_0x4c223e=>{const _0x1fc665=_0x432741;try{info(_0x1fc665(0x2b8)+_0x1fc665(0x3e9)+'pdate\x20obse'+_0x1fc665(0x225)+_0x1fc665(0x38f)+_0x1fc665(0x3b0)+'ed\x20listene'+'r)'),setupSendApi(_0x11a08b);}catch(_0x212073){warn('[sched]\x20co'+_0x1fc665(0x3e9)+_0x1fc665(0x37b)+_0x1fc665(0x3d0)+'\x20'+(_0x212073?.['message']||_0x212073));}},'moduleName':name});}catch(_0x56d655){warn(_0x432741(0x177)+_0x432741(0x2cc)+_0x432741(0x20a)+_0x432741(0x1da)+_0x432741(0x18d)+_0x432741(0x2e1)+_0x432741(0x123)+(_0x56d655?.[_0x432741(0x2d1)]||_0x56d655));}startSchedulerAligned(),info(_0x432741(0x3b3)+_0x432741(0x32b)+_0x432741(0x274)+_0x432741(0x2f2)+_0x432741(0x2a2)+_0x432741(0x24e)+_0x432741(0x380));}export async function cleanup(){const _0x46de15=_0x563749;try{stopScheduler();try{stopManagedListener(name,_0x46de15(0x1d2)+_0x46de15(0x2de));}catch(_0x4ca363){}}catch(_0x5eb0a8){warn(_0x46de15(0x2e9)+'eanup\x20erro'+_0x46de15(0x123)+(_0x5eb0a8?.[_0x46de15(0x2d1)]||_0x5eb0a8));}finally{botRef=null,sendApi=null,info(_0x46de15(0x2e9)+'eaned\x20up');}}export default{'name':name,'version':version,'priority':priority,'configKeys':configKeys,'commands':commands,'initialize':initialize,'onMessage':onMessage,'cleanup':cleanup};